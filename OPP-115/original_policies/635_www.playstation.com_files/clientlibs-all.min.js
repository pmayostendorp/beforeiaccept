(function(e,c,a,g){var d="playstationMenu",f={animateHeightDelaySpeed:0.2,animateFade:200,returnURLParamName:"postSignInURL",returnURL:c.location.href+"#signin-complete",returnLinkSelector:".return-url-link",postSignOutURLSelector:"postSignOutURL"};
function b(k,h){this.element=k;
this.$element=e(this.element);
this.options=e.extend({},f,h);
this._name=d;
this.init()
}b.prototype.init=function(){var z=this.options,G=this.$element.find("ul.header-nav"),q=e("div.global-menu-container"),I=q.find("div.menu-wrapper"),m=I.find("div.menu-section"),w=[],r=e("li.nav-link.nav-home"),u=e("li.nav-link:not(.nav-home) a.nav-content"),p,n=false,x;
var k=e.fn.getURLVar("debug");
k=k==="nav"?true:false;
if(k==true){G.addClass("debug-mode")
}var D=false;
if(Modernizr.touch){D=true
}var l=e('.nav-link a[xHref*="/my"]');
if(typeof PDC!="undefined"){if("Customisation" in PDC){if("Header" in PDC.Customisation){this.options=e.extend({},this.options,PDC.Customisation.Header)
}}}if(Modernizr.csstransitions){I.css({"-webkit-transition":"height "+z.animateHeightDelaySpeed+"s linear","-moz-transition":"height "+z.animateHeightDelaySpeed+"s linear","-ms-transition":"height "+z.animateHeightDelaySpeed+"s linear","-o-transition":"height "+z.animateHeightDelaySpeed+"s linear",transition:"height "+z.animateHeightDelaySpeed+"s linear"})
}var y=this;
e(".visualrow, .customisablefeature, .avatar-content, .device-list, .visitusbar").each(function(o,L){var K=0,J=0;
var M=e(this).text().replace(/\s+/,"");
if(M==""){e(this).closest(".menu-section-wrapper").next("div.frosted-border-vertical").remove();
e(this).closest(".menu-section-wrapper").remove()
}});
function v(){u.each(function(J,M){var L=e(M),K=L.next("div.menu-wrapper");
if(PDC.Region.getRegion()!="SCEE"){var o=e(this);
if((o.html()==l.html())){o.click(function(){if(s!=="undefined"){if(PDC.Profile.isLoggedIn()){PDC.SC.click("navigation","username","text",null)
}else{PDC.SC.click("navigation",e(this).find(".large-title").text(),"text",null)
}}a.location.href=PDC.Header.MobileSignInAndConnectUrl
})
}}if(PDC.Region.getRegion()!="SCEE"){K.find(y.options.returnLinkSelector).each(function(){var P=e(this),O=P.attr("href"),S=y.options.returnURLParamName,Q=encodeURI(y.options.returnURL);
if((O.indexOf(S)==-1)&&(O.indexOf(y.options.postSignOutURLSelector)==-1)){P.attr("href",O+(O.indexOf("?")==-1?"?":"&")+S+"="+Q)
}pdclog("headernav: sLinkHREF=",O,"; sQSParamKey,sQSParamEncodedValue",S,Q);
var N=a.location.href,R=(N.indexOf("/my/")>-1)?N.split("my/")[0]:N;
P.attr("href",P.attr("href").replace(/postSignOutURL=[^&]+/,"postSignOutURL="+encodeURI(R)))
})
}if(L.parent().hasClass("psn-status")&&L.attr("href")!=="#"){L.on("click",function(){if(typeof s!=="undefined"){PDC.SC.click("navigation","psn-status","text",null)
}else{a.location.href=L.attr("href")
}})
}w[J]={height:K.css({display:"block"}).outerHeight(),section:K.find("div.menu-section-content").clone(),retail:K.hasClass("nav-ecom")};
w[J].classTag=w[J].section.attr("class");
K.css({display:"none"})
})
}v();
if(Modernizr.csstransitions){x=function(o,J){I.css({height:o+"px"});
if(e.isFunction(J)){c.setTimeout(J,(z.animateHeightDelaySpeed*1000))
}}
}else{x=function(o,J){I.animate({height:o},(z.animateHeightDelaySpeed*1000),J)
}
}function h(){var K=false,L=-1,J=e("div.touch-overlay");
function M(){G.unbind("resize");
e.when(m.fadeOut(z.animateFade)).done(function(){x(0,function(){e(this).hide();
e("li.selected-nav").removeClass("selected-nav")
})
});
K=false
}function o(O,N){N.addClass("selected-nav");
G.bind("resize",function(){M();
J.removeClass("visible");
G.unbind("resize")
});
if(!K){K=true;
L=O;
e.when(I.height(0).show(),m.hide().remove("div.menu-section-content").html(w[O].section.clone())).done(function(){try{if(N.hasClass("avatar")){var P=e(m).find(".avatar-content").find("#notification").find("ul").length;
if(!P){var S=e(".avatar").find(".menu-wrapper").find("#notification").find("ul").clone();
var R=e(".avatar").find(".menu-wrapper").find("#notification").find(".view-notes").clone();
e(".global-menu-container").find(".avatar-content").find("#notification").append(S).append(R)
}}}catch(Q){console.log("error getting notification")
}x(w[O].height+10,function(){m.fadeIn(z.animateFade)
})
})
}else{if(O!==L){L=O;
e.when(m.fadeOut(z.animateFade)).done(function(){try{if(N.hasClass("avatar")){var P=e(m).find(".avatar-content").find("#notification").find("ul").length;
if(!P){var S=e(".avatar").find(".menu-wrapper").find("#notification").find("ul").clone();
var R=e(".avatar").find(".menu-wrapper").find("#notification").find(".view-notes").clone();
e(".global-menu-container").find(".avatar-content").find("#notification").append(S).append(R)
}}}catch(Q){console.log("error getting notification")
}x(w[O].height+10,function(){m.remove("div.menu-section-content").html(w[O].section.clone()).fadeIn(z.animateFade)
})
})
}}}u.each(function(O,Q){var P=e(this),N=P.parent();
if(!(P.html()==l.html())||(PDC.Region.getRegion()=="SCEE")){P.click(function(R){R.preventDefault();
if(P.parent().hasClass("psn-status")){if(typeof s!=="undefined"){PDC.SC.click("navigation","psn-status","text",{open:P.attr("href")})
}else{a.location.href=P.attr("href")
}}else{a.location.href="#";
if(K&&O===L){M();
J.removeClass("visible")
}else{e("li.selected-nav").removeClass("selected-nav");
o(O,N);
J.addClass("visible")
}}})
}else{console.log("My Code goeshere")
}});
J.bind("touchstart click",function(N){N.preventDefault();
M();
J.removeClass("visible")
});
M();
J.removeClass("visible");
e(c).resize(function(){if(p){c.clearTimeout(p)
}p=c.setTimeout(function(){M();
J.removeClass("visible");
e("li.selected-nav").removeClass("selected-nav");
v()
},300)
})
}function E(M){var N,O,J=false,K=-1;
function L(){if(!k){if(!J){e("li.selected-nav").removeClass("selected-nav")
}else{O=c.setTimeout(function(){e.when(m.fadeOut(z.animateFade)).done(function(){x(0,function(){q.unbind("mouseenter").unbind("mouseleave");
e(this).hide();
e("li.selected-nav").removeClass("selected-nav")
})
});
J=false
},500)
}}}function o(Q,P){e("li.selected-nav").removeClass("selected-nav");
P.addClass("selected-nav");
if(!J){N=c.setTimeout(function(){J=true;
K=Q;
e.when(I.height(0).show(),m.hide().remove("div.menu-section-content").html(w[Q].section.clone())).done(function(){if(w[Q].retail){I.addClass("nav-ecom")
}else{I.removeClass("nav-ecom")
}try{if(P.hasClass("avatar")){var R=e(m).find(".avatar-content").find("#notification").find("ul").length;
if(!R){var U=e(".avatar").find(".menu-wrapper").find("#notification").find("ul").clone();
var T=e(".avatar").find(".menu-wrapper").find("#notification").find(".view-notes").clone();
e(".global-menu-container").find(".avatar-content").find("#notification").append(U).append(T)
}}}catch(S){console.log("error getting notification")
}x(w[Q].height+10,function(){m.fadeIn(z.animateFade);
var V=m.find(".menu-section-content"),W=V.find(".tier-1").attr("data-menu-javascript");
if(typeof W!="undefined"&&e()[W]){V[W]()
}e(c).bind("scroll",function X(){q.unbind("mouseenter").unbind("mouseleave");
e.when(m.fadeOut(z.animateFade)).done(function(){x(0,function(){e(this).hide();
e("li.selected-nav").removeClass("selected-nav")
})
});
J=false;
e(c).unbind("scroll",X)
})
})
})
},500);
q.bind("mouseenter",function(){e("li.selected-nav").removeClass("selected-nav");
e(u[K]).parent().addClass("selected-nav");
c.clearTimeout(O);
if(N){c.clearTimeout(N);
N=null
}}).bind("mouseleave",function(){if(!N){L()
}})
}else{N=c.setTimeout(function(){if(Q!==K){K=Q;
e.when(m.fadeOut(z.animateFade)).done(function(){if(w[Q].retail){I.addClass("nav-ecom")
}else{I.removeClass("nav-ecom")
}try{if(P.hasClass("avatar")){var R=e(m).find(".avatar-content").find("#notification").find("ul").length;
if(!R){var U=e(".avatar").find(".menu-wrapper").find("#notification").find("ul").clone();
var T=e(".avatar").find(".menu-wrapper").find("#notification").find(".view-notes").clone();
e(".global-menu-container").find(".avatar-content").find("#notification").append(U).append(T)
}}}catch(S){console.log("error getting notification")
}x(w[Q].height+10,function(){m.remove("div.menu-section-content").html(w[Q].section.clone()).fadeIn(z.animateFade);
var V=m.find(".menu-section-content"),W=V.find(".tier-1").attr("data-menu-javascript");
if(typeof W!="undefined"&&e()[W]){V[W]()
}})
})
}c.clearTimeout(N);
N=null
},500)
}}u.each(function(Q,S){var R=e(this),P=R.parent();
R.bind("mouseenter",function(){c.clearTimeout(N);
N=null;
c.clearTimeout(O);
if(R.parent().hasClass("psn-status")){e("li.selected-nav").removeClass("selected-nav");
P.addClass("selected-nav")
}else{o(Q,P)
}}).bind("mouseleave",function(){if(!J){if(N){c.clearTimeout(N);
N=null
}}if(R.parent().hasClass("psn-status")){e("li.selected-nav").removeClass("selected-nav")
}else{L()
}})
});
r.bind("mouseenter",function(){e("li.selected-nav").removeClass("selected-nav");
c.clearTimeout(N);
N=null;
c.clearTimeout(O);
L()
});
e(c).resize(function(){if(p){c.clearTimeout(p)
}p=c.setTimeout(function(){v()
},300)
});
if(n==true){M.trigger("mouseenter")
}}if(!Modernizr.touch){var C,B,t,A,F;
e("body").one("mousemove.firstMove",function(o){C=o.target;
if(e(C).parents("ul").hasClass("header-nav")){B=e(C).parents("a").attr("href");
e("body").bind("mousemove.navOnly",function(J){A=J.target;
if(e(A).parents("ul").hasClass("header-nav")){F=e(A).parents("a");
t=F.attr("href");
if(B!=t){n=true;
e("body").unbind("mousemove.navOnly");
E(F)
}}else{E();
e("body").unbind("mousemove.navOnly")
}})
}else{E()
}})
}else{e("header").after('<div class="touch-overlay"></div>');
h()
}if(D){var H=e(l).find("span.small-title").text();
l.empty().append(e("<span>").addClass("mobile-title").text(H));
if(PDC.Region.getRegion()!="SCEE"){e(l).click(function(){if(s!=="undefined"){if(PDC.Profile.isLoggedIn){PDC.SC.click("navigation","username","text",null)
}else{PDC.SC.click("navigation",H,"text",null)
}}a.location.href=PDC.Header.MobileSignInAndConnectUrl
})
}}};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))
}})
};
PDC.__tl_retail_toggle=function(l,m,k){console.log("retail toggle",l,m,k);
console.log("retail toggle: last",PDC.__tl_last_retail);
try{if(k){var h=PDC.__tl_last_retail;
PDC.__tl_last_retail=l;
if(h!=null){h.setValue(null)
}}else{if(PDC.__tl_last_retail==l){PDC.__tl_last_retail=null
}}}catch(n){console.log(["retail toggle error",n])
}}
})(jQuery,window,document);
(function(e,c,a,g){var d="searchField",f={};
function b(k,h){this.element=k;
this.$element=e(this.element);
this.options=e.extend({},f,h);
this._defaults=f;
this._name=d;
this.init()
}b.prototype.init=function(){console.log("init start");
var m=this,k=this.$element.find(".typeahead"),h,q=this.$element.find(".clear"),o=this.$element.find(".search"),p=e(".lt-ie9").length>0,l=e("#headerSearch"),n=e(".header-search a");
if(p){e.fn.placeholder()
}k.typeahead(m.options.typeaheadconfig.datasets,m.options.typeaheadconfig.placeholders);
q.click(function(){var r=e(this);
k.typeahead("setQuery","");
if(r.hasClass("visible")){r.removeClass("visible")
}if(p){e.fn.placeholder()
}});
k.on("keyup",function(r){clearTimeout(h);
h=setTimeout(function(){if(k.val()!=""){if(!q.hasClass("visible")){q.addClass("visible")
}}else{if(q.hasClass("visible")){q.removeClass("visible");
if(p){e.fn.placeholder()
}}}},200)
});
k.bind("keypress",function(t){var r=(t.keyCode?t.keyCode:t.which);
console.log("code=="+r);
if(r==13){e(c).trigger("playstation:search",k.val())
}});
o.click(function(){e(c).trigger("playstation:search",k.val())
});
k.bind("typeahead:selected",function(t,r){e(c).trigger("playstation:search",t.currentTarget.value)
});
k.bind("typeahead:initialized ",function(){var r=e.fn.getURLVar("q");
if(r){k.typeahead("setQuery",r);
k.setCursorToTextEnd();
if(!q.hasClass("visible")){q.addClass("visible")
}}})
};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))
}})
}
})(jQuery,window,document);
(function(e,c,a,g){var d="search",f={breakPoint:1024,searchPage:"./search_results.html",ingestibleId:"#sony-header"};
function b(k,h){this.element=k;
this.$element=e(this.element);
this.options=e.extend({},f,h);
this._defaults=f;
this._name=d;
if(this.options.ingestibleId&&this.options.ingestibleId.length>0){console.log("search-standard");
this.initStandard()
}else{console.log("search-overlay");
this.initOverlay()
}}b.prototype.initStandard=function(){var n=this,r=n.options,q=true,l,p=n.$element.find(".header-search");
p.inputField=p.find("input");
p.search=p.find("a");
if("matchMedia" in c){var k=c.matchMedia("(max-width: "+r.breakPoint+"px)");
l=function(o){if(o.matches){q=false
}else{q=true
}};
if(k.addListener){k.addListener(l)
}else{if(k.attachEvent){k.attachEvent(l)
}}l(k)
}else{var h;
l=function(){if(e(c).width()<=n.options.mediaMatchMeasure){q=false
}else{q=true
}};
l();
e(c).resize(function(){if(h){clearTimeout(h)
}h=setTimeout(l,500)
})
}p.search.on("click",function(t){t.preventDefault();
var o=p.inputField.val();
PDC.SC.click("gsasearch","search-banner","button",{events:["event17"],vars:{eVar17:o,prop17:o}});
if(q){m(o)
}else{if(o){m(o)
}else{c.location.assign(r.searchPage)
}}});
p.inputField.bind("keypress",function(u){var o=(u.keyCode?u.keyCode:u.which);
if(o==13){var t=p.inputField.val();
PDC.SC.click("gsasearch","search-banner","button",{events:["event17"],vars:{eVar17:t,prop17:t}});
e(c).trigger("playstation:search",t)
}});
e(c).bind("playstation:search",function(o,t){m(t)
});
function m(o){if(o!=""){c.location.assign(r.searchPage.replace(/%QUERY/,encodeURIComponent(o)))
}}};
b.prototype.initOverlay=function(){var p=this,k=p.options,x=true,u,q=p.$element.find(".header-search"),w=e("#search-overlay");
q.inputField=q.find("input");
q.search=q.find("a");
w.close=w.find("a.close");
w.search=w.find("a.search-all");
w.typeaheadObj=w.find(".typeahead");
var r=e.fn.getURLVar("q");
if(r){q.inputField.val(r)
}q.inputField.on("keypress",function(z){var A=e(this).val(),o=String.fromCharCode(z.which);
z.preventDefault();
w.css({display:"block"});
l(A,o)
});
e(a).on("keyup",function(o){if(o.keyCode==27){w.close.click()
}});
w.close.on("click",function(z){z.preventDefault();
var o=w.typeaheadObj.val();
w.css({display:"none"});
q.inputField.val(o);
v()
});
w.search.on("click",function(o){PDC.SC.click_hdr(this);
e(c).trigger("playstation:search",w.typeaheadObj.val())
});
q.search.on("click",function(o){o.preventDefault();
if(x){if(w.typeaheadObj.val()!=""){y(w.typeaheadObj.val())
}else{w.css({display:"block"});
l(q.inputField.val(),null)
}}else{w.css({display:"block"});
var z=q.inputField.val();
if(z===""){l("a",null)
}l(z,null)
}});
if("matchMedia" in c){var t=c.matchMedia("(max-width: "+k.breakPoint+"px)");
u=function(o){if(o.matches){x=false
}else{x=true
}};
if(t.addListener){t.addListener(u)
}else{if(t.attachEvent){t.attachEvent(u)
}}u(t)
}else{var n;
u=function(){if(e(c).width()<=p.options.mediaMatchMeasure){x=false
}else{x=true
}};
u();
e(c).resize(function(){if(n){clearTimeout(n)
}n=setTimeout(u,500)
})
}if(PDC.Browser.actAsTouch()){q.inputField.on("click",function(o){var z=e(this).val();
w.css({display:"block"});
l(z,null)
})
}else{q.inputField.on("click",function(o){var z=e(this).val();
if(z){w.css({display:"block"});
l(z,null)
}})
}function l(z,o){if(o!==null){z=z+o
}w.typeaheadObj.typeahead("setQuery",z).focus().setCursorToTextEnd();
h()
}function m(o){o=o||c.event;
if(o.preventDefault){o.preventDefault()
}o.returnValue=false
}function h(){if(c.addEventListener){c.addEventListener("DOMMouseScroll",m,false)
}c.onmousewheel=a.onmousewheel=m
}function v(){if(c.removeEventListener){c.removeEventListener("DOMMouseScroll",m,false)
}c.onmousewheel=a.onmousewheel=a.onkeydown=null
}e(c).bind("playstation:search",function(o,z){y(z)
});
function y(o){if(o!=""){try{var A=k.searchPage.replace("%QUERY",encodeURIComponent(o));
c.location.assign(A)
}catch(z){console.log(z)
}}}};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))
}})
}
})(jQuery,window,document);
(function(e,g,h,b){var f="heroActionPanel",d={};
function k(m,l){this.element=m;
this.$element=e(this.element);
this.options=e.extend({},d,l);
this._defaults=d;
this._name=f;
this.init()
}k.prototype.init=function(){var n=PDC.Profile.isLoggedIn();
var l=PDC.Region.getRegion();
if(n){e(".section-user-details").show();
e(".section-signup").hide();
c()
}else{var m=getCookie("psvisitM");
if(!m&&PDC.isUserConsentedCookie()){setCookie("psvisitM","w",".playstation.com")
}if(m){e(".box-signin label").hide();
e(".box-signup label").hide();
e(".welcomeText").css({display:"block"})
}}};
function c(){if(PDC.Profile){var o=PDC.Profile;
var r=o.getOnlineID();
var u=o.getPsPlus();
var p=o.getMediumAvatar();
var n=e(".section-user-details");
var q="";
var t=e("<h3/>");
var w=e("<div/>");
var m=e(".signouttitle").text();
var v=e(".signouttitle").attr("rel");
e(".section-user-details").html("");
if(r){var l=e("<a>").attr("href",v).text(r);
l.on("click",function(){if(typeof s!=="undefined"){PDC.SC.click("heroactionpanel","username","text",null)
}});
t.append(m+" ").append(l)
}t.appendTo(n);
if(p){q=e("<img>").addClass("avatar").attr("alt","Avatar").attr("src",p)
}if(u=="true"){w.addClass("isuser").append(e("<div/>").addClass("plusUser")).append(q)
}else{w.addClass("isuser").append(q)
}w.appendTo(n);
n.addClass("pannelPadding")
}}function a(){if(PDC.Profile){var o=PDC.Profile;
var n=o.getSmallAvatar();
var m=e(".user-icon");
var p=o.getOnlineID();
var l=e(".userhandle");
l.empty().append(e("<h3>").text(p));
if(n){m.empty().append(e("<img>").addClass("avatar").attr("alt","Avatar").attr("src",n))
}}}e.fn[f]=function(l){return this.each(function(){if(!e.data(this,"plugin_"+f)){e.data(this,"plugin_"+f,new k(this,l))
}})
}
})(jQuery,window,document);
var PDC=PDC||{};
PDC.Func=PDC.Func||{};
PDC.Func.CM066=function(){var g=$(document.getElementById("footer-else-button"));
webHelp="https://support.us.playstation.com",support="https://support.us.playstation.com/app/contact_options",community="http://community.us.playstation.com/t5/Support/ct-p/10023",oo_feedback=new OOo.Ocode({referrerRewrite:{searchPattern:/:\/\/[^\/]*/,replacePattern:"://us.playstation.com"}});
if(g.length===1){var f=g.parent(),c=g[0].href.split("#")[1],b=$(document.getElementById(c)),h="active";
if(b.length===1){g.on("click",function(k){k.preventDefault();
f.toggleClass(h);
b.stop(true,true).slideToggle("fast",function(){var l=b.is(":visible");
if(l){f.addClass(h)
}else{f.removeClass(h)
}})
})
}}function e(k,l){console.log("showWaypoint: "+k);
"use strict";
$("body").append($("<div>").attr("id","social-pod-overlay").html('<div id="oo_container"><div id="oo_waypoint_content"><div id="oo_container_header"><div id="close-button" class="close">close&#32;&#215;</div></div><a href="javascript:void(0);" id="survey-button" class="oo_sony_button">SHARE YOUR FEEDBACK</a><div id="inner_container"><a href="'+webHelp+'" id="web_help" target="_blank"></a><a href="'+support+'" id="support_Cont" target="_blank"></a><a href="'+community+'" id="community" target="_blank"></a></div></div></div><div id="oo_waypoint"></div>'));
$("#close-button").on("click",a);
$("#survey-button").on("click",d);
$("#web_help").on("click",a);
$("#support_Cont").on("click",a);
$("#community").on("click",a);
PDC.SC.click(k+"","feedback overlay","image")
}function a(){$("#social-pod-overlay").remove()
}function d(){oo_feedback.show();
a()
}$("#feedbackButtonSocialPod").on("click",function(){e("socialpod")
});
$("#feedbackButtonFooterLinkRow").on("click",function(){e("footer")
});
$("#feedbackButtonFooter").on("click",function(){e("footer")
})
};
var PDC=PDC||{};
PDC.Func=PDC.Func||{};
PDC.Func.OO01=function(){var a=$(document.getElementById("footer-else-button"));
webHelp="https://support.us.playstation.com",support="https://support.us.playstation.com/app/contact_options",community="http://community.us.playstation.com/t5/Support/ct-p/10023",oo_feedback=new OOo.Ocode({referrerRewrite:{searchPattern:/:\/\/[^\/]*/,replacePattern:"://us.playstation.com"}})
};
String.prototype.esc_sc=function(){return this.replace(/&[^;\s]+;/g,"").replace(/[^\w_-]+/g," ").replace(/^\s+/g,"").replace(/\s+$/g,"").replace(/\s+/g," ").toLowerCase()
};
String.prototype.encode_scc=function(){var a=this.replace(/&[^;\s]+;/g,"").replace(/:/g," ").trim().toLowerCase().replace(/\s+/g," ");
return a
};
String.prototype.esc_sc_ns=function(){return this.esc_sc().replace(/\s/g,"-")
};
PDC.SC=PDC.SC||{};
PDC.SC.Constants={PROVIDER:"x-sc",CAMPAIGN_ID:"smcid",SMCID_COOKIE:"smcid.cookie",SMCID_FORMAT:"smcid.format",PROFILE_REGISTER_MATCH:"profile.register.match"};
var PSC=PDC.SC.Constants;
PDC.SC.vars=PDC.SC.vars||{};
PDC.SC.vars.s_campaign_keys=/^(EMC|EMCID|EMCD|emcid|emcd)$/;
PDC.SC.vars[PSC.SMCID_COOKIE]="(?:EMC|EMCID|EMCD|emcid|emcd|smcid)";
PDC.SC.vars[PSC.SMCID_FORMAT]="channel:region:page-name:button-text:product-name:product-id:campaign";
PDC.SC.vars["smcid.fields"]=PDC.SC.vars[PSC.SMCID_FORMAT].split(/:/);
PDC.SC.vars[PSC.PROFILE_REGISTER_MATCH]="https://account.sonyentertainmentnetwork.com";
PDC.SC.vars.dynamics={prop2:"eVar2",prop3:"eVar3",prop4:"eVar4",prop10:"eVar10",prop17:"eVar17",prop18:"eVar18",prop20:"eVar20",prop40:"eVar40",prop41:"eVar41",prop47:"eVar47",prop48:"eVar48",prop49:"eVar49",prop50:"eVar50",prop51:"eVar51",prop52:"eVar52",prop53:"eVar53",prop56:"eVar56",prop57:"eVar57",prop75:"eVar75"};
PDC.SC.apply_dynamics=function(c){for(var a in PDC.SC.vars.dynamics){if(!c[a]){continue
}var b=a.replace(/prop/,"c");
c[PDC.SC.vars.dynamics[a]]="D="+b
}};
PDC.SC.find_sc_provider=function(a,b){PDC.SC.parse_sc_provider(b,$(a).data("sc"),a);
pdclog("find_sc_provider: starting ",a);
$(a).parents(".x-sc").each(function(){pdclog("find_sc_provider.parents: ",this);
PDC.SC.parse_sc_provider(b,$(this).data("sc"),this)
});
pdclog("---- done ----")
};
PDC.SC.parse_sc_provider=function(dict,jsstring,ele){pdclog("parse sc: "+jsstring);
var json={};
try{eval("json = "+jsstring);
pdclog(json);
for(var x in json){if(dict[x]==null){dict[x]=json[x]
}}if(dict.material_id_selector){var arr=[];
$(ele).find(dict.material_id_selector).each(function(){arr.push($(this).attr("src"))
});
dict.material_id_array=arr
}}catch(e){pdclog(e)
}};
PDC.SC.is_campaign=function(a){return a&&a.match(PDC.SC.vars.s_campaign_keys)
};
PDC.SC.smcid_normalize=function(d,c){var b=d.split(/:/);
for(var a=0;
a<PDC.SC.vars["smcid.fields"].length;
a++){if(PDC.SC.vars["smcid.fields"][a]!="campaign"){if(!b[a]){b[a]="null"
}continue
}if(c){b[a]=c
}}return b.join(":")
};
var eM={getDevice:function(){var c=this;
c.ua=navigator.userAgent;
if(c.device==null){var b={"PS3/HD":{f:"ckPS3HD"},"PS3/SD":{f:"ckPS3SD"},PSVita:{f:"ckPSVita"},PS4:{f:"ckPS4"},Mob:{f:"ckMob"},Tab:{f:"ckTab"},PC:{f:"ckPC"}};
for(var a in b){if(c[b[a].f]()){c.device=a;
break
}}}return c.device
},ckPS3HD:function(){if((/Playstation 3/i.test(this.ua))&&(screen.width==1920)){return true
}return false
},ckPS3SD:function(){if((/Playstation 3/i.test(this.ua))&&(screen.width<1920)){return true
}return false
},ckPSVita:function(){if((/Vita/i.test(this.ua))&&(screen.width<1920)){return true
}return false
},ckPS4:function(){if(/Playstation 4/i.test(this.ua)){return true
}return false
},ckTab:function(){if(this.isTouchDevice&&this.isTouchDevice()&&((screen.width>481)&&(screen.width<1025))){return true
}return false
},ckPC:function(){return true
},ckMob:function(){var b=navigator.userAgent||navigator.vendor||window.opera;
if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(b)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(b.substr(0,4))){return true
}else{return false
}}};
PDC.SC.process_global_vars=function(sc){PDC.SC.plugins_init();
pdclog("-- process_global_vars");
var _list="pageName,channel,prop10,eVar75,prop75,eVar68,prop68,pageName,eVar50,prop50,eVar51,prop51,eVar52,prop52,eVar1,hier1,eVar2,prop2,eVar3,prop3,eVar4,prop4,eVar20,prop20".split(",");
$(".x-sc-vars").each(function(){try{var json=$(this).data("sc");
eval("json = "+json);
for(var key in json){PDC.SC.vars[key]=json[key]
}}catch(e){}});
pdclog("sc vars",PDC.SC.vars);
var consts=PDC.SC.Constants;
if(sc[consts.SMCID_COOKIE]){PDC.SC.vars[consts.SMCID_COOKIE]=sc[consts.SMCID_COOKIE]
}if(sc[consts.SMCID_FORMAT]){PDC.SC.vars[consts.SMCID_FORMAT]=sc[consts.SMCID_FORMAT]
}var cid=document.location.href.match(new RegExp(PDC.SC.vars[consts.SMCID_COOKIE]+"=([^&]+)"));
var COOKIE_ID="sc-cmp-id";
var COOKIE_TYPE="sc-cmp-type";
if(cid){pdclog(["sc: cid=",cid]);
PDC.SC.vars[consts.SMCID_COOKIE]=cid[0].split("=")[0];
cid=cid[1].esc_sc();
console.log("sc: pretest",PDC.isUserConsentedCookie());
if(PDC.isUserConsentedCookie()){var host=".playstation.com";
if(document.location.href.indexOf("://localhost")>0){host="."+document.location.host
}if($.cookie){$.cookie(COOKIE_ID,cid,{domain:host});
$.cookie(COOKIE_TYPE,PDC.SC.vars[consts.SMCID_COOKIE],{domain:host})
}else{setCookie(COOKIE_ID,cid,host);
setCookie(COOKIE_TYPE,PDC.SC.vars[consts.SMCID_COOKIE],host)
}}}else{var cfunc=$.cookie?$.cookie:getCookie;
var cookieType=cfunc(COOKIE_TYPE);
if(cookieType!==consts.CAMPAIGN_ID){cid=cfunc(COOKIE_ID);
PDC.SC.vars[consts.SMCID_COOKIE]=cfunc(COOKIE_TYPE)
}}if(PDC.SC.vars[consts.SMCID_COOKIE]==null){PDC.SC.vars[consts.SMCID_COOKIE]="cid"
}pdclog(["sc vars after cid",PDC.SC.vars]);
s.campaignId=cid;
s.campaignType=PDC.SC.vars[consts.SMCID_COOKIE];
console.log("cid, type=",cid,s.campaignType,PDC.SC.vars.s_campaign_keys);
if(s.campaignId){if(s.campaignType&&PDC.SC.is_campaign(s.campaignType)){s.campaign=s.campaignId
}else{s.prop40=s.eVar40=s.campaignId
}}try{var url=document.location.pathname.replace(".html","");
if(sc.urlSearchReplace){var patterns=sc.urlSearchReplace.split(";;");
for(var i=0;
i<patterns.length;
i++){var findrepl=patterns[i].split("=>",2);
pdclog("sc: urlSearchReplace: ",findrepl);
try{url=url.replace(new RegExp(findrepl[0]),findrepl[1])
}catch(e){pdclog("sc: urlSearchReplace error: ",findrepl,e)
}}pdclog("sc: final url: ",url)
}var prop10="";
if(PDC.SC.vars.pageTemplate.match(/(gamepage|productpage)/)||url.indexOf("/games/")!=-1||url.indexOf("/ps4/")!=-1){prop10="detail"
}else{if(PDC.SC.vars.pageTemplate.indexOf("/homepage")>-1){prop10="home"
}else{if(url.indexOf("/footer")>-1||url.indexOf("/legal")>-1){prop10="hygiene"
}}}var loginState="guest";
if(PDC.Profile.isLoggedIn()){loginState="signed_in";
sc.eVar75=sc.prop75=PDC.Profile.getEncryptedID()
}try{sc.prop47=eM.getDevice().toLowerCase()
}catch(e){pdclog(e)
}sc.eVar71="D=User-Agent";
var pathParts=url.split("/");
if(pathParts[pathParts.length-1]==""){pathParts.pop()
}pathParts.shift();
pdclog(pathParts);
if(pathParts[0]=="content"){pathParts.shift();
pathParts.shift();
pathParts.shift()
}pdclog(pathParts);
var locale=globalLocale.toLowerCase().replace("_","-");
if(pathParts[0]==globalLocale||pathParts[0]==locale){pathParts.shift()
}pdclog(pathParts);
var sectionOffset=0;
if(sc.pageSectionOffset){sectionOffset=parseInt(sc.pageSectionOffset)
}for(var so=0;
so<sectionOffset;
so++){pdclog("sc: sectionOffset, removing ",pathParts.shift())
}var sect0="pdc"+(sc.pageNamePrefix?sc.pageNamePrefix:"");
var sect1=pathParts.length>0?sect0+":"+pathParts[0]:null;
var sect2=pathParts.length>1?sect1+":"+pathParts[1]:null;
var sect3=pathParts.length>2?sect2+":"+pathParts[2]:null;
var sect4=pathParts.length>3?sect3+":"+pathParts[3]:null;
pdclog("sc: sections");
pdclog({sect0:sect0,sect1:sect1,sect2:sect2,sect3:sect3,locale:locale});
var title=document.title;
if(CQ_Analytics&&CQ_Analytics.PageDataMgr){var _t=CQ_Analytics.PageDataMgr.getProperty("title");
if(_t&&_t!=""){title=_t
}}title=title.esc_sc();
var loc2=locale.split("-");
loc2=loc2[1]+"-"+loc2[0];
sc.channel=sect1;
sc.eVar68=sc.prop68="D=g";
sc.prop10=prop10;
sc.pageName=pathParts.length>4?sect4+":"+title:(sect4?sect4:(sect3?sect3:(sect2?sect2:(sect1?sect1:sect0))));
sc.pageName=sc.pageName.toLowerCase();
if(sc.pageName.indexOf("games:")>-1){sc.pageName=sc.pageName.replace(/games:/,"games:detail:")
}else{if(sc.prop10=="home"&&!sc.pageName.match(/:home$/)){sc.pageName+=":home"
}}sc.pageName=sc.pageName.replace(/\s+/g,"-");
if(sc.pageName=="pdc:explore:ps4"){sc.pageName+=":overview"
}sc.eVar50=sc.prop50="D=channel";
sc.prop51=sect2;
sc.prop52=sect3;
sc.prop53=sect4;
if(sc.prop10=="detail"){sc.prop53=sc.prop52?sc.prop52.replace(/games:/,"games:detail:"):null;
sc.prop52=sc.prop51?sc.prop51.replace(/games:/,"games:detail:"):null;
sc.prop51="pdc:games:detail"
}sc.eVar1=sc.hier1="D=pageName";
sc.prop2=loc2;
sc.prop3=loginState;
sc.prop4="nonplususer";
if(PDC.Profile.isLoggedIn()&&PDC.Profile.getPsPlus()==="true"){sc.prop4="plususer"
}sc.events="event1";
sc.linkTrackEvents="event1";
if(document.location.href.match(/signin-complete/)){sc.events+=",event3";
sc.linkTrackEvents+=",event3"
}sc.timestamp=(new Date()).getTime();
if((PDC.SC.vars.sku||PDC.SC.vars.upc)&&sc.prop10=="detail"){sc.prop20=(PDC.SC.vars.product_title?PDC.SC.vars.product_title.esc_sc().replace(/\s+/g,"-"):"")+":"+(PDC.SC.vars.sku||PDC.SC.vars.upc).toLowerCase();
sc.eVar20=sc.prop20
}if(PDC.SC.vars.productview=="game"){s.product=PDC.SC.vars.psnid
}else{if(PDC.SC.vars.productview=="product"){s.product=PDC.SC.vars.sku||PDC.SC.vars.upc
}else{if(PDC.SC.vars.products.length>0){}}}console.log("----");
sc.prop67=s.getPercentPageViewed();
sc.prop57=s.getNewRepeat(365,"s_getNewRepeat");
sc.prop48=s.getPreviousValue(sc.pageName,"gpv_pn","event1");
pdclog(["sc.plugins",s.getPercentPageViewed(),s.getNewRepeat(365,"s_getNewRepeat"),s.getPreviousValue(sc.pageName,"gpv_pn","event1")])
}catch(e){pdclog(["sitecatalyst: ",e])
}PDC.SC.apply_dynamics(sc);
if(document.location.href.toString().match(/scdebug/)){for(var i=0;
i<_list.length;
i++){pdclog(_list[i]+": "+sc[_list[i]])
}pdclog(PDC.SC.vars)
}$(document).ready(function(){if(typeof s!=="undefined"){PDC.SC.smcid_creator()
}})
};
PDC.SC.smcid_creator=function(d){var c={};
$(".x-sc-vars").each(function(){if(c.produc_title){return
}PDC.SC.parse_sc_provider(c,$(this).data("sc"),this)
});
var b=s.pageName.esc_sc_ns();
var e=c.product_title?c.product_title.esc_sc_ns():"null";
var h=c.sku;
if(!h){h=c.upc
}if(!h){h="null"
}h=h.esc_sc();
var a=PDC.SC.is_campaign(s.campaignType)?":"+s.campaignId:"";
pdclog(["sc: smcid: campaign: ",s.campaignType,s.campaignId,a]);
var g=document.location.href.toString().match(/[^\w]?cid=([^&]+)/);
if(g){g=":"+g[1]
}else{g=""
}var f=d?$(d).find("a"):$("a");
f.each(function(){var o=$(this);
var m=o.attr("href");
var p=o.data("href");
var t=false;
if(p&&p!=""&&m&&m.indexOf("javascript:")==0){m=p;
t=true
}pdclog(["sc: smcid: A: ",m,t]);
if(m&&((m.indexOf("https://store.sonyentertainmentnetwork.com")==0||m.indexOf("https://store.playstation.com")==0||m.indexOf("psns:browse")>-1)&&m.indexOf("smcid=")==-1)){var n="";
o.parents().each(function(){var w=this.className;
var v=w?w.match(/cm[0-9]+-([^\s"']+)/i):null;
if(v&&n==""){n=v[1].replace(/-/g,"").toLowerCase()+"-"
}});
var r={};
var q=h;
var k=e;
var l=m.match(/[^\w]?cid=([^&]+)/);
if(l){q=l[1]
}PDC.SC.click_extract_embedded_xmap(m,r);
PDC.SC.click_extract_embedded_xmap(this.className||"",r);
if(r.psnid){r.sku=r.psnid
}if(r.sku&&r.sku!=""){q=r.sku.esc_sc();
m=m.replace(/x-sku-[^#&]+/,"");
o.data("product-sku",r.sku)
}if(r.title&&r.title!=""){k=r.title.esc_sc_ns();
m=m.replace(/x-title-[^#&]+/,"");
o.data("product-title",r.title)
}var u="pdc:"+s.prop2+":"+b+":"+n+o.text().esc_sc_ns()+":"+k+":"+q;
m+=(m.indexOf("?")>-1?"&":"?")+"smcid="+u+g;
if(t){o.data("href",m)
}else{o.attr("href",m)
}}})
};
PDC.SC.set_product=function(a,b){if(PDC.SC.vars.product){return
}PDC.SC.vars.product=b;
PDC.SC.vars.product_type=a
};
PDC.SC.add_product=function(a,b){if(!b){return
}PDC.SC.set_product(a,b);
PDC.SC.vars.products[a].push(b)
};
PDC.SC.products_string=function(){return";"+PDC.SC.vars.products.psnid.join(",")+";"+PDC.SC.vars.products.sku.join(",")+";"+PDC.SC.vars.products.upc.join(",")
};
PDC.SC.rs={};
PDC.SC.rs_rec=["snepdcar|es-ar|latam|Argentina","snepdccl|es-cl|latam|Chile","snepdcco|es-co|latam|Columbia","snepdccr|es-cr|latam|Costa Rica","snepdcec|es-ec|latam|Ecuador","snepdcsv|es-sv|latam|El Savador","snepdcgt|es-gt|latam|Guatemala","snepdchn|es-hn|latam|Honduras","snepdcmx|es-mx|latam|Mexico","snepdcni|es-ni|latam|Nicaragua","snepdcpa|es-pa|latam|Panama","snepdcpe|es-pe|latam|Peru","snepdcve|es-ve|latam|Venezuela","snepdcbr|pt-br|latam|Brazil","snepdcus|en-us|scea|US","snepdcca|en-ca|scea|Canada","snepdcca|fr-ca|scea|Canada","snepdcfr|fr-fr|scee|France","snepdcit|it-it|scee|Italy","snepdcde|de-de|scee|Germany","snepdcnl|nl-nl|scee|Netherlands","snepdcbe|nl-be|scee|Belgium","snepdccz|cs-cz|scee|Czech Republic","snepdcdk|da-dk|scee|Denmark","snepdcgr|el-gr|scee|Greece","snepdces|es-es|scee|Spain","snepdcno|no-no|scee|Norway","snepdcpl|pl-pl|scee|Poland","snepdcpt|pt-pt|scee|Portugal","snepdcru|ru-ru|scee|Russia","snepdcfi|fi-fi|scee|Finland","snepdcse|sv-se|scee|Sweden","snepdctr|tr-tr|scee|Turkey","snepdcat|de-at|scee|Austria","snepdcch|de-ch|scee|Switzerland","snepdcch|fr-ch|scee|Switzerland","snepdcch|it-ch|scee|Switzerland","snepdcbg|fr-be|scee|Bulgaria ","snepdclu|fr-lu|scee|Luxembourg","snepdclu|de-lu|scee|Luxembourg","snepdcau|en-au|scee|Australia","snepdcnz|en-nz|scee|New Zealand","snepdcie|en-ie|scee|Ireland","snepdcin|en-in|scee|India","snepdcza|en-za|scee|South Africa","snepdcae|en-ae|scee|United Arab Emirates","snepdcgb|en-gb|scee|United Kingdom","snepdcae|en-ae|scee|Mideast","snepdclatam|latam|latam|All latam Countries","snepdcscee|scee|scee|All European Countries","snepdcscea|scea|scea|US"];
for(var __i=0;
__i<PDC.SC.rs_rec.length;
__i++){var ele=PDC.SC.rs_rec[__i].split(/\|/);
PDC.SC.rs[ele[1]]={rs:ele[0],cat:ele[2]};
if(PDC.SC.rs[ele[1]].cat=="scee"&&PDC.SC.rs[ele[1]].rs!="scee"){PDC.SC.rs[ele[1]].rs="snepdc5gb-dev"
}}PDC.SC.territories={"mx-es":"latam","ca-en":"usca","us-en":"usca","br-pt":"latam","ca-fr":"usca","mx-en":"latam","cl-es":"latam","ar-es":"latam","ar-en":"latam","br-en":"latam","cl-en":"latam","co-es":"latam","co-en":"latam","pe-en":"latam","us-es":"usca","pe-es":"latam","cr-es":"latam","ec-es":"latam","gt-es":"latam","hn-es":"latam","ni-es":"latam","pa-es":"latam","sv-es":"latam","ve-es":"latam","cz-cs":"eastern europe","gr-el":"europe other","gb-en":"efigs","ae-en":"middle east","at-de":"europe other","au-en":"anz","be-fr":"benelux","be-nl":"benelux","bg-en":"eastern europe","bh-en":"middle east","ch-de":"europe other","ch-fr":"europe other","ch-it":"europe other","cy-en":"europe other","cz-en":"eastern europe","de-de":"efigs","dk-da":"nordics","dk-en":"nordics","es-es":"efigs","fi-en":"nordics","fi-fi":"nordics","fr-fr":"efigs","gr-en":"europe other","hk-en":"sceh","hk-zh_cn":"sceh","hk-zh_tw":"sceh","hr-en":"europe other","hu-en":"eastern europe","id-en":"sceh","ie-en":"europe other","il-en":"middle east","in-en":"europe other","is-en":"europe other","it-it":"efigs","jp-ja":"scej","kr-ko":"scek","kw-en":"middle east","lb-en":"middle east","lu-de":"benelux","lu-fr":"benelux","mt-en":"europe other","my-en":"sceh","nl-nl":"benelux","no-en":"nordics","no-no":"nordics","nz-en":"anz","om-en":"middle east","pl-en":"eastern europe","pl-pl":"eastern europe","pt-pt":"europe other","qa-en":"middle east","ro-en":"eastern europe","ru-ru":"eastern europe","sa-en":"middle east","se-en":"nordics","se-sv":"nordics","sg-en":"sceh","si-en":"europe other","sk-en":"eastern europe","th-en":"sceh","tr-en":"europe other","tr-tr":"europe other","tw-en":"scet","tw-zh_tw":"scet","ua-ru":"eastern europe","za-en":"africa"};
PDC.prod={"www.playstation.com":true,"playstation.com":true,"secure.us.playstation.com":true};
PDC.SC.get_rs=function(d,c){console.log(">> s_account = "+s_account);
var b=globalLocale.toLowerCase().replace(/_/,"-"),f=PDC.SC.rs[b],e="",a=PDC.SC.rs.scea.rs;
if(typeof d=="undefined"){d=document.location.host
}else{e="-test"
}if(typeof c=="undefined"){c="-dev"
}if(f){if(PDC.prod[d]){a=f.rs+e
}else{a=PDC.SC.rs[f.cat].rs+c
}pdclog(a)
}console.log("<< s_account ? "+a);
return a
};
PDC.SC.rs_mapper=(function(){var a={domains:{},paths:{}};
this.get_id=function(c,f){pdclog(["sc: rs_mapper.get_id",c,f]);
var d=c+f;
if(a.domains[c]){return a.domains[c]
}else{for(var b in a.domains){if(d.indexOf(b)==0){pdclog(["sc: rs_mapper.get_id: found domain+path: ",b]);
return a.domains[b]
}}}for(var e in a.paths){if(f.indexOf(e)==0){return a.paths[e]
}}};
this.add_mapping=function(b,e){pdclog(["sc: rs_mapper.add_mapping",b,e]);
for(var c=0;
c<e.length;
c++){var d=e[c];
if(d.indexOf("/")==0){a.paths[d]=b;
pdclog(["sc: rs_mapper.add_mapping path",b,d])
}else{a.domains[d]=b;
pdclog(["sc: rs_mapper.add_mapping domain",b,d])
}}};
return this
})();
PDC.SC.configure_rs=function(d){for(var c in d){if(c.indexOf("rs_")==0){var b=d[c].split(",");
var a=b.shift();
PDC.SC.rs_mapper.add_mapping(a.replace(/&/,","),b)
}}var a=PDC.SC.rs_mapper.get_id(document.location.host,document.location.pathname);
if(a!=null){s_account=d.un=a;
pdclog("sc: configure_rs: got rsid of "+a)
}else{if(typeof d._host!="undefined"||typeof d.dev_suffix!="undefined"){s_account=d.un=PDC.SC.get_rs(d._host,d.dev_suffix)
}}};
PDC.SC.click_hdr=function(b,a){return PDC.SC.click("navigation",b,null,{link_prefix:a})
};
PDC.SC.open=function(f,a,n,o,m,k){pdclog("sc.open");
pdclog(arguments);
if(f&&!k){k=$(f).attr("target");
if(k==""){k=null
}}else{if(n){k="_blank"
}}var h=PDC.SC.vars.cidLast;
try{o.call(f)
}catch(l){pdclog("open: "+l)
}var g=PDC.SC.vars.cidLast;
var d=m||g||h;
if(d===null&&typeof s!=="undefined"){d=s.campaignId
}try{var b=a.match(/smcid=([^&]+)/);
if(b){if(d!=s.campaignId||(d==s.campaign)){var c=PDC.SC.smcid_normalize(b[1],d);
pdclog(["smcid: o=",b[1],"norm=",c]);
a=a.replace(/smcid=([^&]+)/,"smcid="+c)
}else{pdclog(["smcid: not injecting. cid=",d,"s.campaignId=",s.campaignId,"s.campaign=",s.campaign])
}}else{if(d){a=a+(a.indexOf("?")>-1?"&":"?")+"cid="+d
}}}catch(l){pdclog("open: while processing cid: "+l)
}if(k&&k!=""){window.open(a,k)
}else{window.location=a
}};
PDC.SC.click=function(n,d,l,m){if(n==""||n==null){console.log("WARNING: sc: context empty!")
}pdclog(["sc: click: starting args",arguments]);
m=m||{};
m.vars=m.vars||{};
m.events=m.events||[];
var h=null;
PDC.SC.vars.cidLast=null;
try{var v="null";
var u="text";
if(m.linktitle_src){v=m.linktitle_src.split("/").pop()
}pdclog([l,v,"typeof(link)="+typeof(d)]);
if(typeof(d)!="string"){PDC.SC.find_sc_provider(d,m);
var p=PDC.SC.getHref(d,m);
if(typeof p!=="undefined"&&p!==null&&p!==""&&!m.vars.prop56&&!m.vars.eVar56){var q=PDC.SC.getPartnerRetailers(p);
if(q){m.vars.prop56=m.vars.eVar56=q[1];
m.events.push("event54")
}}var w=$(d).prop("tagName");
if(w=="A"){h=d
}pdclog(["entity=",l,"tag=",w,"ele=",h]);
if(l=="image"&&w!="IMG"){d=$(d).find("img");
w=d.prop("tagName");
pdclog(["entity=",l,"tag=",w,"|round2"])
}if(w=="IMG"){if(v=="null"){v=$(d).attr("alt");
u="image";
if(!v&&d.attr("src")){v=PDC.SC.get_material_id(d.attr("src"))
}}}else{if(w=="A"){if(v=="null"){v=$(d).text();
pdclog("sc: click: A.linktitle="+v)
}var b=$(d).attr("class");
if(b&&b.indexOf("link-btn")>-1){u="button"
}}}}else{v=d
}if(u=="button"){PDC.SC.click_process_button(d,m)
}if(!l){l=u
}m._ctx=n;
m._linktitle=v;
m._entity=l;
if(m.entity_pos!=null){l+="-"+m.entity_pos
}if(m.link_prefix){pdclog("prefix="+m.link_prefix.esc_sc()+" ; title="+v);
v=m.link_prefix.esc_sc()+v
}if(m.material_id_array&&m.material_id_pos!=null){m.material_id=m.material_id_array[m.material_id_pos].toLowerCase();
pdclog("sc.click: got material_id from array")
}if(m.material_id){var k=PDC.SC.get_material_id(m.material_id);
var t=k;
if(m.material_name&&m.material_name!=k){t+=":"+m.material_name.esc_sc()
}m.material_name=t;
if(m.type!="impression"&&!m.vars.prop41){m.vars.prop41=m.vars.eVar41=k
}PDC.SC.vars.cidLast=k
}if(m.callback){try{m.callback(m)
}catch(r){pdclog("callback fail: "+r)
}}if(m.linktitle_override){pdclog("linktitle: ",m);
if(m[m.linktitle_override]){v=m[m.linktitle_override]
}}var c=[l,v.esc_sc(),n,s.pageName.replace(/:/g,"-")].join(":");
pdclog("[entity, opts, linktitle, eng]");
pdclog([l,m,v,c]);
if(m.link_section_name){c=[l,v.esc_sc(),m.link_section_name.esc_sc(),n,s.pageName.replace(/:/g,"-")].join(":");
pdclog("[entity, opts, linktitle, eng, link_section_name]");
pdclog([l,m,v,c,m.link_section_name])
}m["$pagename"]=s?s.pageName.esc_sc():"";
for(var o=0;
o<c.length;
o++){c[o]=PDC.SC.fillPlaceholders(c[o],m)
}pdclog(["eng placeholders filled",c]);
s.linkTrackVars="events";
s.linkTrackEvents="";
if(m.type!="impression"){s.linkTrackVars="eVar49,prop49,events";
s.linkTrackEvents="event66";
s.prop49=c;
s.events="event66"
}else{s.events=""
}if(PDC.SC.vars.sku){s.linkTrackVars+=",eVar20,prop20"
}if(m.events){var f={};
for(var o=0;
o<m.events.length;
o++){if(f[m.events[o]]){continue
}f[m.events[o]]=true;
s.events+=","+m.events[o];
s.linkTrackEvents+=","+m.events[o];
if(m.vars[m.events[o]]){s.events+="="+m.vars[m.events[o]]
}}}m.vars=m.vars||{};
if(m.game_title&&!m.vars.prop20){m.vars.prop20=m.vars.eVar20=m.game_title.esc_sc().replace(/\s+/g,"-");
if(m.retail_id){m.vars.prop20+=":"+m.retail_id==""?"null":m.retail_id;
m.vars.eVar20=m.vars.prop20
}}if(m.vars){for(var g in m.vars){s.linkTrackVars+=","+g;
s[g]=m.vars[g]
}}pdclog("linkTrackEvents=",s.linkTrackEvents,"; linkTrackVars=",s.linkTrackVars,"; products=",s.products);
PDC.SC.apply_dynamics(s);
if(m.cid&&h&&m.material_id&&!m.open){pdclog("sc.click: injecting cid to url");
var p=$(h).attr("href");
var a=p.split("#",2);
p=a[0];
p+=p.match(/\?/)?"&cid="+m.material_name:"?cid="+m.material_name;
if(a.length>1){p+="#"+a[1]
}$(h).attr("href",p)
}if(h){PDC.SC.fillURLPlaceholders(h,m)
}if(m.open){m.open=PDC.SC.fillPlaceholders(m.open,m);
if(m.newWindow){PDC.SC.open(h,m.open,m.newWindow,null,m.cid?PDC.SC.get_material_id(m.material_id):null,m.openTarget);
s.tl(true,m.linkType||"o",n);
pdclog("sc: fired tracking")
}else{s.tl(true,m.linkType||"o",n);
pdclog("sc: fired tracking");
PDC.SC.open(h,m.open,m.newWindow,null,m.cid?PDC.SC.get_material_id(m.material_id):null,m.openTarget)
}pdclog("sc: fired tracking");
s.linkTrackVars="None";
s.linkTrackEvents="None";
return false
}else{s.tl(true,m.linkType||"o",n);
pdclog("sc: fired tracking");
s.linkTrackVars="None";
s.linkTrackEvents="None"
}}catch(r){pdclog("click: error");
pdclog(r)
}return PDC.SC.click_return
};
PDC.SC.fillURLPlaceholders=function(c,b){try{var a=$(c).attr("href");
if(a.indexOf("psmedia")>-1){pdclog(["href is scene7, not filling in placeholders: ",a]);
return
}pdclog(["sc: attempting placeholder replacement",a]);
a=PDC.SC.fillPlaceholders(a,b);
pdclog(["sc: new href",a]);
$(c).attr("href",a)
}catch(d){console.log("sc: error with placeholders",d)
}};
PDC.SC.fillPlaceholders=function(e,b){var f=e.match(/\$([a-zA-Z0-9]+)/g);
if(f==null){return e
}for(var d=0;
d<f.length;
d++){var a=f[d];
var c=b[a];
if(!c){c=""
}else{c=c.esc_sc().replace(/ /g,"-")
}e=e.replace(a,c)
}return e
};
PDC.SC.click_login=function(a,e,c,d){d=d||{};
d.events=d.events||[];
d.vars=d.vars||{};
var b=$(e).attr("href");
return PDC.SC.click(a,e,c,d)
};
PDC.SC.get_material_id=function(a){try{var b=a.toLowerCase().replace(/\$[^$]+\$/,"").split("/").pop().split(/\?/)[0].split(/\./);
if(b.length==1){return b[0]
}else{b.pop();
return b.join(".")
}}catch(c){return null
}};
PDC.SC.click_extract_embedded_xmap=function(g,e){if(!g){return null
}g=g.replace(/\sx-/g,"\nx-");
var e=e||{};
var d=g.match(/x-([^-]+)-([^#&\n]+)/g);
for(var c=0;
d!=null&&c<d.length;
c++){var a=d[c].replace(/^x-/,"");
var b=a.substr(0,a.indexOf("-"));
var f=a.substr(a.indexOf("-")+1);
e[b]=f
}return d
};
PDC.SC.click_process_button=function(k,b){pdclog("button processing");
b.vars=b.vars||{};
b.events=b.events||[];
try{var p=$(k).attr("class");
var d=$(k).attr("href");
if($(k).data("href")){d=$(k).data("href")
}if(!p.match(/(manual|auto)-(download|retail|ecom)/)){return
}var l=!d.match(/(en-us|en-ca|fr-ca)/);
if(l){if(d.match(/[a-z]+-es/)&&!d.match(/es-es/)){l=false
}}if(l&&d.match(/\.retailers/)){return
}var c={};
var h=PDC.SC.click_extract_embedded_xmap(p,c);
var a=$(k);
if(a.data("product-sku")){c.sku=a.data("product-sku")
}if(a.data("product-title")){c.title=a.data("product-title")
}if(!c.psnid){var f=d?d.match(/cid=([^&?]+)/):null;
if(f&&(d.indexOf("store.sony")>0||d.indexOf("store.playstation")>0)){c.psnid=f[1]
}}pdclog(["sc: process button: href=",d,"cls=",p,"attribs=",c]);
c.download=p.match(/-download/)!=null;
c.manualEcom=p.match(/-ecommerce/)!=null;
c.auto=p.match(/auto-/)!=null;
c.smcid=d.match(/smcid=([^&]+)/);
if(c.smcid){c.smcid=c.smcid[1]
}if(!c.auto&&!c.download){PDC.SC.click_extract_embedded_xmap($(k).attr("href"),c)
}pdclog(["-- sc: process buttons: final extracted values",c]);
if(c.download){b.linkType="e";
b.events.push("event54");
if(c.preorder){b.events.push("event51")
}else{b.events.push("event32")
}var o=c.title;
if(c.smcid){var g=c.smcid.split(":");
if(!c.psnid){c.psnid=g[2]
}if(!o){g=g[1].split("-");
g.pop();
o=g.join("-")
}}b.vars.eVar20=b.vars.prop20=o.esc_sc_ns()+":"+c.psnid;
b.vars.eVar56=b.vars.prop56="snestore"
}else{if(c.manualEcom){b.events.push("event61")
}else{b.events.push("event54");
if(c.preorder){b.events.push("event51")
}else{b.events.push("event32")
}var n=PDC.SC.vars.sku;
if(!n){n=c.sku?c.sku:c.upc
}b.vars.eVar20=b.vars.prop20=c.title.esc_sc().replace(/\s+/g,"-")+":"+n
}}}catch(m){pdclog("process_button: "+m)
}};
PDC.SC.getHref=function(c,b){var a=$(c).attr("href");
if(b.open){a=b.open
}else{if(typeof $(c).data("href")=="string"){a=$(c).data("href")
}}return a
};
PDC.SC.PARTNER_RETAILERS={"blog.us.playstation.com":"playstation.blog","community.us.playstation.com":"playstation.forum","support.us.playstation.com":"playstation.support","greatnessawaits.playstation.com":"greatnessawaits","amazon.com":"partner retailers","bestbuy.com":"partner retailers","walmart.com":"partner retailers","target.com":"partner retailers","gamestop.com":"partner retailers","www.sony.com":"sony","www.sonyrewards.com":"sony rewards","gear.playstation.com":"playstation.gear","store.playstation.com":"snestore","store.sonyentertainmentnetwork.com":"snestore","psns:browse?":"snestore","auth.api.sonyentertainmentnetwork.com/login.jsp":"sen.account","www.playstationnetwork.com":"sen",};
PDC.SC.getPartnerRetailers=function(a){for(var b in PDC.SC.PARTNER_RETAILERS){if(a.match(b)){return[b,PDC.SC.PARTNER_RETAILERS[b]]
}}return null
};
PDC.SC.click_return=true;
PDC.SC.plugins_apply=function(b){for(var a in PDC.SC.plugins){console.log(a,PDC.SC.plugins[a]);
if(!b[a]){a[b]=PDC.SC.plugins[a]
}}};
PDC.SC.plugins_init=function(){try{s.getVisitStart=new Function("c","var s=this,v=1,t=new Date;t.setTime(t.getTime()+1800000);if(s.c_r(c)){v=0}if(!s.c_w(c,1,t)){s.c_w(c,1,0)}if(!s.c_r(c)){v=0}return v;");
s.crossVisitParticipation=new Function("v","cn","ex","ct","dl","ev","var s=this;var ay=s.split(ev,',');for(var u=0;u<ay.length;u++){if(s.events&&s.events.indexOf(ay[u])!=-1){s.c_w(cn,'');return '';}}if(!v||v=='')return '';var arry=new Array();var a=new Array();var c=s.c_r(cn);var g=0;var h=new Array();if(c&&c!='') arry=eval(c);var e=new Date();e.setFullYear(e.getFullYear()+5);if(arry.length>0&&arry[arry.length-1][0]==v)arry[arry.length-1]=[v, new Date().getTime()];else arry[arry.length]=[v, new Date().getTime()];var data=s.join(arry,{delim:',',front:'[',back:']',wrap:'\\''});var start=arry.length-ct < 0?0:arry.length-ct;s.c_w(cn,data,e);for(var x=start;x<arry.length;x++){var diff=Math.round(new Date()-new Date(parseInt(arry[x][1])))/86400000;if(diff<ex){h[g]=arry[x][0];a[g++]=arry[x];}}var r=s.join(h,{delim:dl});return r;");
s.getQueryParam=new Function("p","d","u","var s=this,v='',i,t;d=d?d:'';u=u?u:(s.pageURL?s.pageURL:s.wd.location);if(u=='f')u=s.gtfs().location;while(p){i=p.indexOf(',');i=i<0?p.length:i;t=s.p_gpv(p.substring(0,i),u+'');if(t)v+=v?d+t:t;p=p.substring(i==p.length?i:i+1)}return v");
s.p_gpv=new Function("k","u","var s=this,v='',i=u.indexOf('?'),q;if(k&&i>-1){q=u.substring(i+1);v=s.pt(q,'&','p_gvf',k)}return v");
s.p_gvf=new Function("t","k","if(t){var s=this,i=t.indexOf('='),p=i<0?t:t.substring(0,i),v=i<0?'True':t.substring(i+1);if(p.toLowerCase()==k.toLowerCase())return s.epa(v)}return ''");
s.getNewRepeat=new Function("d","var s=this,e=new Date(),cval,sval,ct=e.getTime();e.setTime(ct+d*24*60*60*1000);cval=s.c_r('s_nr');if(cval.length==0){s.c_w('s_nr',ct+'-New',e);return 'New';}sval=cval.split('-');if(ct-sval[0]<30*60*1000&&sval[1]=='New'){s.c_w('s_nr',ct+'-New',e);return 'New';}else {s.c_w('s_nr',ct+'-Repeat',e);return 'Repeat';}");
s.getValOnce=new Function("v","c","e","var s=this,k=s.c_r(c),a=new Date;e=e?e:0;if(v){a.setTime(a.getTime()+e*86400000);s.c_w(c,v,e?a:0);}return v==k?'':v");
s.getPreviousValue=new Function("v","c","el","var s=this,t=new Date,i,j,r='';t.setTime(t.getTime()+1800000);if(el){if(s.events){i=s.split(el,',');j=s.split(s.events,',');for(x in i){for(y in j){if(i[x]==j[y]){if(s.c_r(c)) r=s.c_r(c);v?s.c_w(c,v,t):s.c_w(c,'no value',t);return r}}}}}else{if(s.c_r(c)) r=s.c_r(c);v?s.c_w(c,v,t):s.c_w(c,'no value',t);return r}");
s.getTimeParting=new Function("t","z","y","dc=new Date('1/1/2000');f=15;ne=8;if(dc.getDay()!=6||dc.getMonth()!=0){return'Data Not Available'}else{;z=parseInt(z);if(y=='2009'){f=8;ne=1};gmar=new Date('3/1/'+y);dsts=f-gmar.getDay();gnov=new Date('11/1/'+y);dste=ne-gnov.getDay();spr=new Date('3/'+dsts+'/'+y);fl=new Date('11/'+dste+'/'+y);cd=new Date();if(cd>spr&&cd<fl){z=z+1}else{z=z};utc=cd.getTime()+(cd.getTimezoneOffset()*60000);tz=new Date(utc + (3600000*z));thisy=tz.getFullYear();var days=['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];if(thisy!=y){return'Data Not Available'}else{;thish=tz.getHours();thismin=tz.getMinutes();thisd=tz.getDay();var dow=days[thisd];var ap='AM';var dt='Weekday';var mint='00';if(thismin>30){mint='30'}if(thish>=12){ap='PM';thish=thish-12};if (thish==0){thish=12};if(thisd==6||thisd==0){dt='Weekend'};var timestring=thish+':'+mint+ap;var daystring=dow;var endstring=dt;if(t=='h'){return timestring}if(t=='d'){return daystring};if(t=='w'){return endstring}}};");
s.linkHandler=new Function("p","t","var s=this,h=s.p_gh(),i,l;t=t?t:'o';if(!h||(s.linkType&&(h||s.linkName)))return '';i=h.indexOf('?');h=s.linkLeaveQueryString||i<0?h:h.substring(0,i);l=s.pt(p,'|','p_gn',h.toLowerCase());if(l){s.linkName=l=='[['?'':l;s.linkType=t;return h;}return '';");
s.p_gn=new Function("t","h","var i=t?t.indexOf('~'):-1,n,x;if(t&&h){n=i<0?'':t.substring(0,i);x=t.substring(i+1);if(h.indexOf(x.toLowerCase())>-1)return n?n:'[[';}return 0;");
s.p_gh=new Function("var s=this;if(!s.eo&&!s.lnk)return '';var o=s.eo?s.eo:s.lnk,y=s.ot(o),n=s.oid(o),x=o.s_oidt;if(s.eo&&o==s.eo){while(o&&!n&&y!='BODY'){o=o.parentElement?o.parentElement:o.parentNode;if(!o)return '';y=s.ot(o);n=s.oid(o);x=o.s_oidt}}return o.href?o.href:'';");
s.downloadLinkHandler=new Function("p","var s=this,h=s.p_gh(),n='linkDownloadFileTypes',i,t;if(!h||(s.linkType&&(h||s.linkName)))return '';i=h.indexOf('?');t=s[n];s[n]=p?p:t;if(s.lt(h)=='d')s.linkType='d';else h='';s[n]=t;return h;");
s.exitLinkHandler=new Function("p","var s=this,h=s.p_gh(),n='linkInternalFilters',i,t;if(!h||(s.linkType&&(h||s.linkName)))return '';i=h.indexOf('?');t=s[n];s[n]=p?p:t;h=s.linkLeaveQueryString||i<0?h:h.substring(0,i);if(s.lt(h)=='e')s.linkType='e';else h='';s[n]=t;return h;");
s.split=new Function("l","d","var i,x=0,a=new Array;while(l){i=l.indexOf(d);i=i>-1?i:l.length;a[x++]=l.substring(0,i);l=l.substring(i+d.length);}return a");
s.apl=new Function("L","v","d","u","var s=this,m=0;if(!L)L='';if(u){var i,n,a=s.split(L,d);for(i=0;i<a.length;i++){n=a[i];m=m||(u==1?(n==v):(n.toLowerCase()==v.toLowerCase()));}}if(!m)L=L?L+d+v:v;return L");
s.getAndPersistValue=new Function("v","c","e","var s=this,a=new Date;e=e?e:0;a.setTime(a.getTime()+e*86400000);if(v)s.c_w(c,v,e?a:0);return s.c_r(c);");
s.join=new Function("v","p","var s = this;var f,b,d,w;if(p){f=p.front?p.front:'';b=p.back?p.back:'';d=p.delim?p.delim:'';w=p.wrap?p.wrap:'';}var str='';for(var x=0;x<v.length;x++){if(typeof(v[x])=='object' )str+=s.join( v[x],p);else str+=w+v[x]+w;if(x<v.length-1)str+=d;}return f+str+b;");
s.c_rr=s.c_r;
s.c_r=new Function("k","var s=this,d=new Date,v=s.c_rr(k),c=s.c_rr('s_pers'),i,m,e;if(v)return v;k=s.ape(k);i=c.indexOf(' '+k+'=');c=i<0?s.c_rr('s_sess'):c;i=c.indexOf(' '+k+'=');m=i<0?i:c.indexOf('|',i);e=i<0?i:c.indexOf(';',i);m=m>0?m:e;v=i<0?'':s.epa(c.substring(i+2+k.length,m<0?c.length:m));if(m>0&&m!=e)if(parseInt(c.substring(m+1,e<0?c.length:e))<d.getTime()){d.setTime(d.getTime()-60000);s.c_w(s.epa(k),'',d);v='';}return v;");
s.c_wr=s.c_w;
s.c_w=new Function("k","v","e","var s=this,d=new Date,ht=0,pn='s_pers',sn='s_sess',pc=0,sc=0,pv,sv,c,i,t;d.setTime(d.getTime()-60000);if(s.c_rr(k)) s.c_wr(k,'',d);k=s.ape(k);pv=s.c_rr(pn);i=pv.indexOf(' '+k+'=');if(i>-1){pv=pv.substring(0,i)+pv.substring(pv.indexOf(';',i)+1);pc=1;}sv=s.c_rr(sn);i=sv.indexOf(' '+k+'=');if(i>-1){sv=sv.substring(0,i)+sv.substring(sv.indexOf(';',i)+1);sc=1;}d=new Date;if(e){if(e.getTime()>d.getTime()){pv+=' '+k+'='+s.ape(v)+'|'+e.getTime()+';';pc=1;}}else{sv+=' '+k+'='+s.ape(v)+';';sc=1;}if(sc) s.c_wr(sn,sv,0);if(pc){t=pv;while(t&&t.indexOf(';')!=-1){var t1=parseInt(t.substring(t.indexOf('|')+1,t.indexOf(';')));t=t.substring(t.indexOf(';')+1);ht=ht<t1?t1:ht;}d.setTime(ht);s.c_wr(pn,pv,d);}return v==s.c_r(s.epa(k));");
s.setupFormAnalysis=new Function("var s=this;if(!s.fa){s.fa=new Object;var f=s.fa;f.ol=s.wd.onload;s.wd.onload=s.faol;f.uc=s.useCommerce;f.vu=s.varUsed;f.vl=f.uc?s.eventList:'';f.tfl=s.trackFormList;f.fl=s.formList;f.va=new Array('','','','')}");
s.sendFormEvent=new Function("t","pn","fn","en","var s=this,f=s.fa;t=t=='s'?t:'e';f.va[0]=pn;f.va[1]=fn;f.va[3]=t=='s'?'Success':en;s.fasl(t);f.va[1]='';f.va[3]='';");
s.faol=new Function("e","var s=s_c_il["+s._in+"],f=s.fa,r=true,fo,fn,i,en,t,tf;if(!e)e=s.wd.event;f.os=new Array;if(f.ol)r=f.ol(e);if(s.d.forms&&s.d.forms.length>0){for(i=s.d.forms.length-1;i>=0;i--){fo=s.d.forms[i];fn=fo.name;tf=f.tfl&&s.pt(f.fl,',','ee',fn)||!f.tfl&&!s.pt(f.fl,',','ee',fn);if(tf){f.os[fn]=fo.onsubmit;fo.onsubmit=s.faos;f.va[1]=fn;f.va[3]='No Data Entered';for(en=0;en<fo.elements.length;en++){el=fo.elements[en];t=el.type;if(t&&t.toUpperCase){t=t.toUpperCase();var md=el.onmousedown,kd=el.onkeydown,omd=md?md.toString():'',okd=kd?kd.toString():'';if(omd.indexOf('.fam(')<0&&okd.indexOf('.fam(')<0){el.s_famd=md;el.s_fakd=kd;el.onmousedown=s.fam;el.onkeydown=s.fam}}}}}f.ul=s.wd.onunload;s.wd.onunload=s.fasl;}return r;");
s.faos=new Function("e","var s=s_c_il["+s._in+"],f=s.fa,su;if(!e)e=s.wd.event;if(f.vu){s[f.vu]='';f.va[1]='';f.va[3]='';}su=f.os[this.name];return su?su(e):true;");
s.fasl=new Function("e","var s=s_c_il["+s._in+"],f=s.fa,a=f.va,l=s.wd.location,ip=s.trackPageName,p=s.pageName;if(a[1]!=''&&a[3]!=''){a[0]=!p&&ip?l.host+l.pathname:a[0]?a[0]:p;if(!f.uc&&a[3]!='No Data Entered'){if(e=='e')a[2]='Error';else if(e=='s')a[2]='Success';else a[2]='Abandon'}else a[2]='';var tp=ip?a[0]+':':'',t3=e!='s'?':('+a[3]+')':'',ym=!f.uc&&a[3]!='No Data Entered'?tp+a[1]+':'+a[2]+t3:tp+a[1]+t3,ltv=s.linkTrackVars,lte=s.linkTrackEvents,up=s.usePlugins;if(f.uc){s.linkTrackVars=ltv=='None'?f.vu+',events':ltv+',events,'+f.vu;s.linkTrackEvents=lte=='None'?f.vl:lte+','+f.vl;f.cnt=-1;if(e=='e')s.events=s.pt(f.vl,',','fage',2);else if(e=='s')s.events=s.pt(f.vl,',','fage',1);else s.events=s.pt(f.vl,',','fage',0)}else{s.linkTrackVars=ltv=='None'?f.vu:ltv+','+f.vu}s[f.vu]=ym;s.usePlugins=false;s.tl(true,'o','Form Analysis');s[f.vu]='';s.usePlugins=up}return f.ul&&e!='e'&&e!='s'?f.ul(e):true;");
s.fam=new Function("e","var s=s_c_il["+s._in+"],f=s.fa;if(!e) e=s.wd.event;var o=s.trackLastChanged,et=e.type.toUpperCase(),t=this.type.toUpperCase(),fn=this.form.name,en=this.name,sc=false;if(document.layers){kp=e.which;b=e.which}else{kp=e.keyCode;b=e.button}et=et=='MOUSEDOWN'?1:et=='KEYDOWN'?2:et;if(f.ce!=en||f.cf!=fn){if(et==1&&b!=2&&'BUTTONSUBMITRESETIMAGERADIOCHECKBOXSELECT-ONEFILE'.indexOf(t)>-1){f.va[1]=fn;f.va[3]=en;sc=true}else if(et==1&&b==2&&'TEXTAREAPASSWORDFILE'.indexOf(t)>-1){f.va[1]=fn;f.va[3]=en;sc=true}else if(et==2&&kp!=9&&kp!=13){f.va[1]=fn;f.va[3]=en;sc=true}if(sc){nface=en;nfacf=fn}}if(et==1&&this.s_famd)return this.s_famd(e);if(et==2&&this.s_fakd)return this.s_fakd(e);");
s.ee=new Function("e","n","return n&&n.toLowerCase?e.toLowerCase()==n.toLowerCase():false;");
s.fage=new Function("e","a","var s=this,f=s.fa,x=f.cnt;x=x?x+1:1;f.cnt=x;return x==a?e:'';");
s.getPageName=new Function("u","var s=this,v=u?u:''+s.wd.location,x=v.indexOf(':'),y=v.indexOf('/',x+4),z=v.indexOf('?'),c=s.pathConcatDelim,e=s.pathExcludeDelim,g=s.queryVarsList,d=s.siteID,n=d?d:'',q=z<0?'':v.substring(z+1),p=v.substring(y+1,q?z:v.length);z=p.indexOf('#');p=z<0?p:s.fl(p,z);x=e?p.indexOf(e):-1;p=x<0?p:s.fl(p,x);p+=!p||p.charAt(p.length-1)=='/'?s.defaultPage:'';y=c?c:'/';while(p){x=p.indexOf('/');x=x<0?p.length:x;z=s.fl(p,x);if(!s.pt(s.pathExcludeList,',','p_c',z))n+=n?y+z:z;p=p.substring(x+1)}y=c?c:'?';while(g){x=g.indexOf(',');x=x<0?g.length:x;z=s.fl(g,x);z=s.pt(q,'&','p_c',z);if(z){n+=n?y+z:z;y=c?c:'&'}g=g.substring(x+1)}return n");
s.p_c=new Function("v","c","var x=v.indexOf('=');return c.toLowerCase()==v.substring(0,x<0?v.length:x).toLowerCase()?v:0");
s.channelExtract=new Function("d","p","u","pv","var s=this,v='';u=u?u:(s.pageURL?s.pageURL:s.wd.location);if(u=='f')u=s.gtfs().location;u=u+'';li=u.lastIndexOf(d);if(li>0){u=u.substring(0,li);var i,n,a=s.split(u,d),al=a.length;if(al<p){if(pv==1) p=al;else return '';}for(i=0;i<p;i++){n=a[i];v=v+n+d;}return v}return '';");
s.getPercentPageViewed=new Function("","var s=this;if(typeof(s.linkType)=='undefined'||s.linkType=='e'){var v=s.c_r('s_ppv');s.c_w('s_ppv',0);return v;}");
s.getPPVCalc=new Function("","var s=s_c_il["+s._in+"],dh=Math.max(Math.max(s.d.body.scrollHeight,s.d.documentElement.scrollHeight),Math.max(s.d.body.offsetHeight,s.d.documentElement.offsetHeight),Math.max(s.d.body.clientHeight,s.d.documentElement.clientHeight)),vph=s.wd.innerHeight||(s.d.documentElement.clientHeight||s.d.body.clientHeight),st=s.wd.pageYOffset||(s.wd.document.documentElement.scrollTop||s.wd.document.body.scrollTop),vh=st+vph,pv=Math.round(vh/dh*100),cp=s.c_r('s_ppv');if(pv>100){s.c_w('s_ppv','');}else if(pv>cp){s.c_w('s_ppv',pv);}");
s.getPPVSetup=new Function("","var s=this;if(s.wd.addEventListener){s.wd.addEventListener('load',s.getPPVCalc,false);s.wd.addEventListener('scroll',s.getPPVCalc,false);s.wd.addEventListener('resize',s.getPPVCalc,false);}else if(s.wd.attachEvent){s.wd.attachEvent('onload',s.getPPVCalc);s.wd.attachEvent('onscroll',s.getPPVCalc);s.wd.attachEvent('onresize',s.getPPVCalc);}");
s.getPPVSetup();
s.dc="122";
s.loadModule("Media");
s.Media.autoTrack=false;
s.Media.trackMilestones="25,50,75,100";
s.Media.trackEvents="event55,event56,event57,event58";
s.Media.trackVars="events,eVar70,eVar62,prop70,prop62,prop63";
s.Media.trackUsingContextData=true;
s.Media.segmentByMilestones=true;
s.Media.playerName="Scene7 Player";
s.Media.contextDataMapping={"a.media.name":"eVar70,prop70","a.media.segment":"eVar62,prop62","a.contentType":"eVar63,prop63","a.media.timePlayed":"event55","a.media.view":"event56","a.media.segmentView":"event58","a.media.complete":"event57"};
s.m_Media_c="var m=s.m_i('Media');if(m.completeByCloseOffset==undefined)m.completeByCloseOffset=1;if(m.completeCloseOffsetThreshold==undefined)m.completeCloseOffsetThreshold=1;m.cn=function(n){var m=this;return m.s.rep(m.s.rep(m.s.rep(n,\"\\n\",''),\"\\r\",''),'--**--','')};m.open=function(n,l,p,b){var m=this,i=new Object,tm=new Date,a='',x;n=m.cn(n);if(!l)l=-1;if(n&&p){if(!m.l)m.l=new Object;if(m.l[n])m.close(n);if(b&&b.id)a=b.id;if(a)for (x in m.l)if(m.l[x]&&m.l[x].a==a)m.close(m.l[x].n);i.n=n;i.l=l;i.o=0;i.x=0;i.p=m.cn(m.playerName?m.playerName:p);i.a=a;i.t=0;i.ts=0;i.s=Math.floor(tm.getTime()/1000);i.lx=0;i.lt=i.s;i.lo=0;i.e='';i.to=-1;i.tc=0;i.fel=new Object;i.vt=0;i.sn=0;i.sx=\"\";i.sl=0;i.sg=0;i.sc=0;i.us=0;i.co=0;i.cot=0;i.lm=0;i.lom=0;m.l[n]=i}};m._delete=function(n){var m=this,i;n=m.cn(n);i=m.l[n];m.l[n]=0;if(i&&i.m)clearTimeout(i.m.i)};m.close=function(n){this.e(n,0,-1)};m.play=function(n,o,sn,sx,sl){var m=this,i;i=m.e(n,1,o,sn,sx,sl);if(i&&!i.m){i.m=new Object;i.m.m=new Function('var m=s_c_il['+m._in+'],i;if(m.l){i=m.l[\"'+m.s.rep(i.n,'\"','\\\\\"')+'\"];if(i){if(i.lx==1)m.e(i.n,3,-1);i.m.i=setTimeout(i.m.m,1000)}}');i.m.m()}};m.complete=function(n,o){this.e(n,5,o)};m.stop=function(n,o){this.e(n,2,o)};m.track=function(n){this.e(n,4,-1)};m.bcd=function(vo,i){var m=this,ns='a.media.',v=vo.linkTrackVars,e=vo.linkTrackEvents,pe='m_i',pev3,c=vo.contextData,x;c['a.contentType']='video';c[ns+'name']=i.n;c[ns+'playerName']=i.p;if(i.l>0){c[ns+'length']=i.l;}c[ns+'timePlayed']=Math.floor(i.ts);if(!i.vt){c[ns+'view']=true;pe='m_s';i.vt=1}if(i.sx){c[ns+'segmentNum']=i.sn;c[ns+'segment']=i.sx;if(i.sl>0)c[ns+'segmentLength']=i.sl;if(i.sc&&i.ts>0)c[ns+'segmentView']=true}if(!i.cot&&i.co){c[ns+\"complete\"]=true;i.cot=1}if(i.lm>0)c[ns+'milestone']=i.lm;if(i.lom>0)c[ns+'offsetMilestone']=i.lom;if(v)for(x in c)v+=',contextData.'+x;pev3='video';vo.pe=pe;vo.pev3=pev3;var d=m.contextDataMapping,y,a,l,n;if(d){vo.events2='';if(v)v+=',events';for(x in d){if(x.substring(0,ns.length)==ns)y=x.substring(ns.length);else y=\"\";a=d[x];if(typeof(a)=='string'){l=m.s.sp(a,',');for(n=0;n<l.length;n++){a=l[n];if(x==\"a.contentType\"){if(v)v+=','+a;vo[a]=c[x]}else if(y){if(y=='view'||y=='segmentView'||y=='complete'||y=='timePlayed'){if(e)e+=','+a;if(c[x]){if(y=='timePlayed'){if(c[x])vo.events2+=(vo.events2?',':'')+a+'='+c[x];}else if(c[x])vo.events2+=(vo.events2?',':'')+a}}else if(y=='segment'&&c[x+'Num']){if(v)v+=','+a;vo[a]=c[x+'Num']+':'+c[x]}else{if(v)v+=','+a;vo[a]=c[x]}}}}else if(y=='milestones'||y=='offsetMilestones'){x=x.substring(0,x.length-1);if(c[x]&&d[x+'s'][c[x]]){if(e)e+=','+d[x+'s'][c[x]];vo.events2+=(vo.events2?',':'')+d[x+'s'][c[x]]}}}vo.contextData=0}vo.linkTrackVars=v;vo.linkTrackEvents=e};m.bpe=function(vo,i,x,o){var m=this,pe='m_o',pev3,d='--**--';pe='m_o';if(!i.vt){pe='m_s';i.vt=1}else if(x==4)pe='m_i';pev3=m.s.ape(i.n)+d+Math.floor(i.l>0?i.l:1)+d+m.s.ape(i.p)+d+Math.floor(i.t)+d+i.s+d+(i.to>=0?'L'+Math.floor(i.to):'')+i.e+(x!=0&&x!=2?'L'+Math.floor(o):'');vo.pe=pe;vo.pev3=pev3};m.e=function(n,x,o,sn,sx,sl,pd){var m=this,i,tm=new Date,ts=Math.floor(tm.getTime()/1000),c,l,v=m.trackVars,e=m.trackEvents,ti=m.trackSeconds,tp=m.trackMilestones,to=m.trackOffsetMilestones,sm=m.segmentByMilestones,so=m.segmentByOffsetMilestones,z=new Array,j,t=1,w=new Object,x,ek,tc,vo=new Object;n=m.cn(n);i=n&&m.l&&m.l[n]?m.l[n]:0;if(i){if(o<0){if(i.lx==1&&i.lt>0)o=(ts-i.lt)+i.lo;else o=i.lo}if(i.l>0)o=o<i.l?o:i.l;if(o<0)o=0;i.o=o;if(i.l>0){i.x=(i.o/i.l)*100;i.x=i.x>100?100:i.x}if(i.lo<0)i.lo=o;tc=i.tc;w.name=n;w.length=i.l;w.openTime=new Date;w.openTime.setTime(i.s*1000);w.offset=i.o;w.percent=i.x;w.playerName=i.p;if(i.to<0)w.mediaEvent=w.event='OPEN';else w.mediaEvent=w.event=(x==1?'PLAY':(x==2?'STOP':(x==3?'MONITOR':(x==4?'TRACK':(x==5?'COMPLETE':('CLOSE'))))));if(!pd){if(i.pd)pd=i.pd}else i.pd=pd;w.player=pd;if(x>2||(x!=i.lx&&(x!=2||i.lx==1))) {if(!sx){sn=i.sn;sx=i.sx;sl=i.sl}if(x){if(x==1)i.lo=o;if((x<=3||x==5)&&i.to>=0){t=0;v=e=\"None\";if(i.to!=o){l=i.to;if(l>o){l=i.lo;if(l>o)l=o}z=tp?m.s.sp(tp,','):0;if(i.l>0&&z&&o>=l)for(j=0;j<z.length;j++){c=z[j]?parseFloat(''+z[j]):0;if(c&&(l/i.l)*100<c&&i.x>=c){t=1;j=z.length;w.mediaEvent=w.event='MILESTONE';i.lm=w.milestone=c}}z=to?m.s.sp(to,','):0;if(z&&o>=l)for(j=0;j<z.length;j++){c=z[j]?parseFloat(''+z[j]):0;if(c&&l<c&&o>=c){t=1;j=z.length;w.mediaEvent=w.event='OFFSET_MILESTONE';i.lom=w.offsetMilestone=c}}}}if(i.sg||!sx){if(sm&&tp&&i.l>0){z=m.s.sp(tp,',');if(z){z[z.length]='100';l=0;for(j=0;j<z.length;j++){c=z[j]?parseFloat(''+z[j]):0;if(c){if(i.x<c){sn=j+1;sx='M:'+l+'-'+c;j=z.length}l=c}}}}else if(so&&to){z=m.s.sp(to,',');if(z){z[z.length]=''+(i.l>0?i.l:'E');l=0;for(j=0;j<z.length;j++){c=z[j]?parseFloat(''+z[j]):0;if(c||z[j]=='E'){if(o<c||z[j]=='E'){sn=j+1;sx='O:'+l+'-'+c;j=z.length}l=c}}}}if(sx)i.sg=1}if((sx||i.sx)&&sx!=i.sx){i.us=1;if(!i.sx){i.sn=sn;i.sx=sx}if(i.to>=0)t=1}if(x>=2&&i.lo<o){i.t+=o-i.lo;i.ts+=o-i.lo}if(x<=2||(x==3&&!i.lx)){i.e+=(x==1||x==3?'S':'E')+Math.floor(o);i.lx=(x==3?1:x)}if(!t&&i.to>=0&&x<=3){ti=ti?ti:0;if(ti&&i.ts>=ti){t=1;w.mediaEvent=w.event='SECONDS'}}i.lt=ts;i.lo=o}if(!x||i.x>=100){x=0;m.e(n,2,-1,0,0,-1,pd);v=e=\"None\";w.mediaEvent=w.event=\"CLOSE\"}if(x==5||(m.completeByCloseOffset&&(!x||i.x>=100)&&i.l>0&&o>=i.l-m.completeCloseOffsetThreshold)){w.complete=i.co=1;t=1}ek=w.mediaEvent;if(ek=='MILESTONE')ek+='_'+w.milestone;else if(ek=='OFFSET_MILESTONE')ek+='_'+w.offsetMilestone;if(!i.fel[ek]) {w.eventFirstTime=true;i.fel[ek]=1}else w.eventFirstTime=false;w.timePlayed=i.t;w.segmentNum=i.sn;w.segment=i.sx;w.segmentLength=i.sl;if(m.monitor&&x!=4)m.monitor(m.s,w);if(x==0)m._delete(n);if(t&&i.tc==tc){vo=new Object;vo.contextData=new Object;vo.linkTrackVars=v;vo.linkTrackEvents=e;if(!vo.linkTrackVars)vo.linkTrackVars='';if(!vo.linkTrackEvents)vo.linkTrackEvents='';if(m.trackUsingContextData)m.bcd(vo,i);else m.bpe(vo,i,x,o);m.s.t(vo);if(i.us){i.sn=sn;i.sx=sx;i.sc=1;i.us=0}else if(i.ts>0)i.sc=0;i.e=\"\";i.lm=i.lom=0;i.ts-=Math.floor(i.ts);i.to=o;i.tc++}}}return i};m.ae=function(n,l,p,x,o,sn,sx,sl,pd,b){var m=this,r=0;if(n&&(!m.autoTrackMediaLengthRequired||(length&&length>0)) &&p){if(!m.l||!m.l[n]){if(x==1||x==3){m.open(n,l,p,b);r=1}}else r=1;if(r)m.e(n,x,o,sn,sx,sl,pd)}};m.a=function(o,t){var m=this,i=o.id?o.id:o.name,n=o.name,p=0,v,c,c1,c2,xc=m.s.h,x,e,f1,f2='s_media_'+m._in+'_oc',f3='s_media_'+m._in+'_t',f4='s_media_'+m._in+'_s',f5='s_media_'+m._in+'_l',f6='s_media_'+m._in+'_m',f7='s_media_'+m._in+'_c',tcf,w;if(!i){if(!m.c)m.c=0;i='s_media_'+m._in+'_'+m.c;m.c++}if(!o.id)o.id=i;if(!o.name)o.name=n=i;if(!m.ol)m.ol=new Object;if(m.ol[i])return;m.ol[i]=o;if(!xc)xc=m.s.b;tcf=new Function('o','var e,p=0;try{if(o.versionInfo&&o.currentMedia&&o.controls)p=1}catch(e){p=0}return p');p=tcf(o);if(!p){tcf=new Function('o','var e,p=0,t;try{t=o.GetQuickTimeVersion();if(t)p=2}catch(e){p=0}return p');p=tcf(o);if(!p){tcf=new Function('o','var e,p=0,t;try{t=o.GetVersionInfo();if(t)p=3}catch(e){p=0}return p');p=tcf(o)}}v=\"var m=s_c_il[\"+m._in+\"],o=m.ol['\"+i+\"']\";if(p==1){p='Windows Media Player '+o.versionInfo;c1=v+',n,p,l,x=-1,cm,c,mn;if(o){cm=o.currentMedia;c=o.controls;if(cm&&c){mn=cm.name?cm.name:c.URL;l=cm.duration;p=c.currentPosition;n=o.playState;if(n){if(n==8)x=0;if(n==3)x=1;if(n==1||n==2||n==4||n==5||n==6)x=2;}';c2='if(x>=0)m.ae(mn,l,\"'+p+'\",x,x!=2?p:-1,0,\"\",0,0,o)}}';c=c1+c2;if(m.s.isie&&xc){x=m.s.d.createElement('script');x.language='jscript';x.type='text/javascript';x.htmlFor=i;x.event='PlayStateChange(NewState)';x.defer=true;x.text=c;xc.appendChild(x);o[f6]=new Function(c1+'if(n==3){x=3;'+c2+'}setTimeout(o.'+f6+',5000)');o[f6]()}}if(p==2){p='QuickTime Player '+(o.GetIsQuickTimeRegistered()?'Pro ':'')+o.GetQuickTimeVersion();f1=f2;c=v+',n,x,t,l,p,p2,mn;if(o){mn=o.GetMovieName()?o.GetMovieName():o.GetURL();n=o.GetRate();t=o.GetTimeScale();l=o.GetDuration()/t;p=o.GetTime()/t;p2=o.'+f5+';if(n!=o.'+f4+'||p<p2||p-p2>5){x=2;if(n!=0)x=1;else if(p>=l)x=0;if(p<p2||p-p2>5)m.ae(mn,l,\"'+p+'\",2,p2,0,\"\",0,0,o);m.ae(mn,l,\"'+p+'\",x,x!=2?p:-1,0,\"\",0,0,o)}if(n>0&&o.'+f7+'>=10){m.ae(mn,l,\"'+p+'\",3,p,0,\"\",0,0,o);o.'+f7+'=0}o.'+f7+'++;o.'+f4+'=n;o.'+f5+'=p;setTimeout(\"'+v+';o.'+f2+'(0,0)\",500)}';o[f1]=new Function('a','b',c);o[f4]=-1;o[f7]=0;o[f1](0,0)}if(p==3){p='RealPlayer '+o.GetVersionInfo();f1=n+'_OnPlayStateChange';c1=v+',n,x=-1,l,p,mn;if(o){mn=o.GetTitle()?o.GetTitle():o.GetSource();n=o.GetPlayState();l=o.GetLength()/1000;p=o.GetPosition()/1000;if(n!=o.'+f4+'){if(n==3)x=1;if(n==0||n==2||n==4||n==5)x=2;if(n==0&&(p>=l||p==0))x=0;if(x>=0)m.ae(mn,l,\"'+p+'\",x,x!=2?p:-1,0,\"\",0,0,o)}if(n==3&&(o.'+f7+'>=10||!o.'+f3+')){m.ae(mn,l,\"'+p+'\",3,p,0,\"\",0,0,o);o.'+f7+'=0}o.'+f7+'++;o.'+f4+'=n;';c2='if(o.'+f2+')o.'+f2+'(o,n)}';if(m.s.wd[f1])o[f2]=m.s.wd[f1];m.s.wd[f1]=new Function('a','b',c1+c2);o[f1]=new Function('a','b',c1+'setTimeout(\"'+v+';o.'+f1+'(0,0)\",o.'+f3+'?500:5000);'+c2);o[f4]=-1;if(m.s.isie)o[f3]=1;o[f7]=0;o[f1](0,0)}};m.as=new Function('e','var m=s_c_il['+m._in+'],l,n;if(m.autoTrack&&m.s.d.getElementsByTagName){l=m.s.d.getElementsByTagName(m.s.isie?\"OBJECT\":\"EMBED\");if(l)for(n=0;n<l.length;n++)m.a(l[n]);}');if(s.wd.attachEvent)s.wd.attachEvent('onload',m.as);else if(s.wd.addEventListener)s.wd.addEventListener('load',m.as,false);if(m.onLoad)m.onLoad(s,m)";
s.m_i("Media")
}catch(a){console.log("plugins_init: "+a)
}};
$(document).ready(function(){var a=[".copy-block .richtext a","section .richtext .section-sub-text a",".CM168-text a"];
if(typeof s!=="undefined"){$(a.toString()).on("click",function(){return PDC.SC.click("link",this,"text",null)
})
}});
(function(d,f,g,b){var e="signOut",c={};
function h(m,l){this.element=m;
this.$element=d(this.element);
this.options=d.extend({},c,l);
this._defaults=c;
this._name=e;
this.init()
}h.prototype.init=function(){var m=PDC.Profile.isLoggedIn();
var l=PDC.Region.getRegion();
if(l&&m){k();
a()
}};
function k(){if(PDC.Profile){var m=PDC.Profile;
var o=m.getOnlineID();
if(o!=null&&o){var l=d("#user-info");
var n=l.text();
l.empty().append(d("<h2>").text(n)).append(d("<h3>").text(o))
}}}function a(){if(PDC.Profile){var m=PDC.Profile;
var n=m.getMediumAvatar();
var q=m.getSmallAvatar();
var p=m.getOnlineID();
var u=m.getPsPlus();
var t=d("#avatar-block");
var r=d('.nav-link a[xHref*="/my"]');
var o=r.find("span");
if(u=="true"){t.empty().append(d("<img>").addClass("psp-logo").attr("alt","Playstation Plus Logo").attr("src","/etc/designs/pdc/clientlibs_base/images/nav/psp_logo.png"))
}if(n){var l=t.find("img.psp-logo");
t.empty().append(d("<img>").addClass("avatar").attr("alt","Avatar").attr("src",n));
if(l.length>0){t.append(l)
}}if(p){pSpans=o.each(function(){d(this).text(p)
})
}if(q){r.parent("li").removeClass("avatar").addClass("avatar");
r.empty().append(d("<div>").addClass("avatar-image").append(d("<img>").attr("alt","Avatar Small").attr("src",q))).append(pSpans)
}}}d.fn[e]=function(l){return this.each(function(){if(!d.data(this,"plugin_"+e)){d.data(this,"plugin_"+e,new h(this,l))
}})
}
})(jQuery,window,document);
(function(e,c,a,g){var d="competeMenu",f={delay:4000};
function b(k,h){this.element=k;
this.$element=e(this.element);
this.options=e.extend({},f,h);
this._defaults=f;
this._name=d;
this.init()
}b.prototype.init=function(){var l=this,n=this.options,h=0,k=this.$element.find("#compete-menu-carousel ul li");
k.eq(h).fadeIn();
c.setTimeout(m,n.delay);
function m(){k.eq(h).fadeOut(500,function(){if(h+1>=k.length){h=0
}else{h=h+1
}k.eq(h).fadeIn(500);
c.setTimeout(m,n.delay)
})
}};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))
}})
}
})(jQuery,window,document);
(function(f,d,b,h){var e="signIn",g={};
function c(l,k){this.element=l;
this.$element=f(this.element);
this.options=f.extend({},g,k);
this._defaults=g;
this._name=e;
this.init()
}c.prototype.init=function(){a()
};
function a(){var m=PDC.Profile;
var p=m.isLoggedIn();
var n=PDC.Region.getRegion();
if(n&&p){var l=b.getElementById("sign-in");
l.setAttribute("style","display:none")
}else{var k=b.getElementById("sign-out-row");
k.setAttribute("style","display:none");
var o=b.getElementById("shortcut-dashboard-row");
o.setAttribute("style","display:none")
}}f.fn[e]=function(k){return this.each(function(){if(!f.data(this,"plugin_"+e)){f.data(this,"plugin_"+e,new c(this,k))
}})
}
})(jQuery,window,document);
(function(e,c,a,g){var d="cookieMessage",f={resizeDelay:250};
function b(k,h){this.element=k;
this.$element=e(this.element);
this.options=e.extend({},f,h);
this._defaults=f;
this._name=d;
this.init()
}b.prototype.init=function(){var h=e(a.getElementById("main-header")).find(".secondary-nav-container");
if(h.length!=0){return
}var k=a.cookie.split("DisableCookieAlert=");
if(k.length!==2||k.pop().split(";").shift()!=="YES"){this.nCurrentCookieMessageHeight=e("#main-header").find(".alert-bar").length>0?0:this.$element.outerHeight();
this.$pageContentContainer=e(a.getElementById("page-content"));
this.nPageContentPadding=this.$pageContentContainer.css("padding-top").split("px")[0];
this.nNewPageContentPadding=parseInt(this.nPageContentPadding)+parseInt(this.nCurrentCookieMessageHeight);
this.$pageContentContainer.css("padding-top",this.nNewPageContentPadding+"px");
this.addClickHandler();
this.initResizeHandler()
}};
b.prototype.addClickHandler=function(){var h=this;
this.$element.on("click",".close",function(k){k.preventDefault();
h.$element.remove();
e(".alert-bar").show();
if(e("#main-header").find(".alert-bar").length===0){h.$pageContentContainer.css("padding-top",h.nPageContentPadding+"px")
}clearTimeout(h.timeoutId);
e(c).unbind("resize."+h.element.id)
})
};
b.prototype.updateContentPadding=function(){var h=this.$element.outerHeight();
if(h!=this.nCurrentCookieMessageHeight){this.nCurrentCookieMessageHeight=h;
this.nNewPageContentPadding=parseInt(this.nPageContentPadding)+parseInt(this.nCurrentCookieMessageHeight);
this.$pageContentContainer.css("padding-top",this.nNewPageContentPadding+"px")
}};
b.prototype.initResizeHandler=function(){var h=this;
e(c).bind("resize."+h.element.id,function(){if(typeof h.timeoutId!="undefined"){clearTimeout(h.timeoutId)
}h.timeoutId=setTimeout(function(){h.updateContentPadding()
},h.options.resizeDelay)
})
};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))
}})
}
})(jQuery,window,document);
(function(e,c,a,g){var d="contextualNav",f={navHeight:"64",hidden:false,excludedBrowsers:[{os:"android",devices:"all"},{os:"ios",devices:["iphone"]}],resizeDelay:250};
function b(k,h){this.element=k;
this.$element=e(k);
this.$navigation=this.$element.find("nav");
this.$levelOneNav=this.$element.find(".header-nav");
this.$sonyBar=this.$element.find("#sony-header-bar");
this.$responsiveList=this.$element.find(".secondary-nav.responsive");
this.$contextualNavControl=this.$element.find(".top-volume");
this.$topTopControl=this.$element.find(".top-volume .nav-link-top ");
this.$volumeControl=this.$element.find(".top-volume .nav-volume ");
this.$audio=this.$element.find("audio");
this.$window=e(c);
this.$pageContainer=e(a.getElementById("page-content"));
if(this.$pageContainer.length==0){this.$pageContainer=e(a.getElementsByTagName("section")[0])
}this.pageContainerPadding=this.$levelOneNav.outerHeight(true)+this.$sonyBar.outerHeight();
this.totalPadding=this.pageContainerPadding;
this.$alertBar=e(a.getElementById("main-header")).find(".alert-bar");
this.$cookieMsgBar=e(a.getElementById("main-header")).find(".cookie-message");
this.options=e.extend({},f,h);
this.init()
}b.prototype.init=function(){var t=this,u=t.options,m=t.$audio.length>0,q=20,n=false,v=e("html"),C=PDC.Browser.isSupportedBrowser(u.excludedBrowsers),D,h,p=e(".secondary-nav-container").outerHeight(true);
if(typeof ScrollControl==="undefined"){ScrollControl=new ScrollrControllr()
}var x=getCookie("DisableAlertBar");
var B=getCookie("DisableCookieAlert");
function y(o){var I=o.cookieMsgBarOffset||o.alertBarOffset;
var K=o.cookieMsgBarOffset?o.$cookieMsgBar.outerHeight():o.$alertBar.outerHeight(),J=e(c).scrollTop();
if(K!=I){o.alertBarOffset=K;
o.totalPadding=o.pageContainerPadding+o.alertBarOffset;
o.$pageContainer.css("padding-top",o.totalPadding+"px")
}if(C&&!Modernizr.touch){if(J>=o.totalPadding){o.$navigation.stop().css("top",(o.totalPadding*-1)+"px");
o.$pageContainer.stop().css("paddingTop","0px")
}}}if((t.$cookieMsgBar.length>0)&&(B===null||B!=="YES")){var k=true;
t.cookieMsgBarOffset=t.$cookieMsgBar.outerHeight();
t.$cookieMsgBar.on("click",".close",function(o){o.preventDefault();
t.$cookieMsgBar.remove();
k=false;
t.cookieMsgBarOffset=0;
e(".alert-bar").show();
t.alertBarOffset=t.alertBarOffset||0;
t.totalPadding=t.pageContainerPadding+t.alertBarOffset;
t.$pageContainer.css("padding-top",t.totalPadding+"px");
if(PDC.isUserConsentedCookie()){setCookie("DisableCookieAlert","YES")
}});
ScrollControl.registerResizeListener(function(){if(k){y(t)
}});
t.$window.load(function(){y(t)
})
}else{t.cookieMsgBarOffset=0
}if((t.$alertBar.length>0)&&(x===null||x!=="YES")){var l=true;
t.alertBarOffset=t.$alertBar.outerHeight()-22;
t.$alertBar.on("click",".close",function(o){o.preventDefault();
t.$alertBar.remove();
l=false;
t.alertBarOffset=0;
t.cookieMsgBarOffset=t.cookieMsgBarOffset||0;
t.totalPadding=t.pageContainerPadding+t.cookieMsgBarOffset;
t.$pageContainer.css("padding-top",t.totalPadding+"px");
if(PDC.isUserConsentedCookie()){setCookie("DisableAlertBar","YES")
}});
if(t.cookieMsgBarOffset===0){ScrollControl.registerResizeListener(function(){if(l){y(t)
}});
t.$window.load(function(){y(t)
})
}}else{t.alertBarOffset=0
}var z=t.cookieMsgBarOffset||t.alertBarOffset;
t.totalPadding=t.pageContainerPadding+z;
t.$pageContainer.css("padding-top",t.totalPadding+"px");
e(".secondary-nav").each(function(){q+=e(this).outerWidth(true)
});
q+=t.$contextualNavControl.outerWidth(true);
if(C){if(!Modernizr.touch){ScrollControl.registerScrollListener(function(){var K=arguments[0];
if(K<t.totalPadding){var I=K*-1,o=t.totalPadding-K;
t.$navigation.hidden=false;
t.$navigation.stop().css("top",I+"px");
t.$pageContainer.stop().css("paddingTop",o+"px")
}else{if(t.$navigation.hidden==false){t.$navigation.hidden=true;
var J=t.totalPadding*-1;
if(t.$navigation.offset().top!==J){t.$navigation.stop().css("top",J+"px");
t.$pageContainer.stop().css("paddingTop","0px")
}}}v.trigger("scrollslider")
},t.$navigation)
}else{if(Modernizr.csstransitions){t.$navigation.css({"-webkit-transition":"top .3s linear .5s","-moz-transition":"top .3s linear .5s","-ms-transition":"top .3s linear .5s","-o-transition":"top .3s linear .5s",transition:"top .3s linear .5s"})
}var G=true,r;
e(a).bind("touchmove",function(){if(r){c.clearTimeout(r)
}r=c.setTimeout(function(){var I=e(c).scrollTop(),o=t.totalPadding*-1;
if(I>=t.totalPadding&&G){if(Modernizr.csstransitions){t.$navigation.stop().css({top:o+"px"})
}else{t.$navigation.stop().animate({top:o+"px"},600)
}G=false
}if(I<t.totalPadding&&!G){if(Modernizr.csstransitions){t.$navigation.stop().css({top:"0px"})
}else{t.$navigation.stop().animate({top:"0px"},600)
}G=true
}},300)
})
}}if(C){t.bWindowLoadNotTriggered=true;
var F=function(o){var I=e(c).scrollTop();
if(I==0){return
}else{t.bWindowLoadNotTriggered=false
}if(I>=o.totalPadding){o.$navigation.stop().animate({top:(o.totalPadding*-1)+"px"},800);
o.$pageContainer.stop().animate({paddingTop:"0px"},800)
}};
e(c).load(function(){if(t.bWindowLoadNotTriggered){F(t)
}else{return
}});
e(c).one("scroll",function(){if(t.bWindowLoadNotTriggered){F(t)
}else{return
}})
}if(Modernizr.audio&&m){if(e("html").hasClass("mobile")){t.$volumeControl.removeClass("vol-on")
}t.$volumeControl.css({display:"table-cell"}).click(function(){var o=e(this);
if(o.hasClass("vol-on")){t.$audio[0].pause();
o.removeClass("vol-on")
}else{t.$audio[0].play();
o.addClass("vol-on")
}return false
});
q+=t.$volumeControl.outerWidth(true)
}e(".responsive").on("click",".selector",function(o){o.preventDefault();
if(n===true){A()
}else{w()
}});
if(e(c).width()<=q){E()
}this.$responsiveList.removeClass("width-calulation");
ScrollControl.registerResizeListener(function(){if(t.$window.width()<=q||H){E()
}else{if(t.$responsiveList.hasClass("reduced")){n=false;
t.$responsiveList.removeClass("reduced").removeAttr("style")
}if(t.$responsiveList.hasClass("reduced-ecommerce")){n=false;
t.$responsiveList.removeClass("reduced-ecommerce").removeAttr("style")
}}});
function E(){var I=e(".selector span"),o=e(".secondary-nav .nav-link.selected a span");
if(!o.text()){t.$responsiveList.addClass("reduced-ecommerce")
}else{t.$responsiveList.addClass("reduced")
}D=t.$responsiveList.css({height:"auto"}).height();
t.$responsiveList.css({height:p+"px"});
I.text(o.text()).width(o.width());
if(!o.text()){I.text("Overview")
}}function w(){e(".selector").addClass("expand");
t.$responsiveList.animate({height:D+"px"},400,function(){n=true;
v.bind("click",function(){A()
});
v.bind("scrollslider",function(o){A()
});
v.bind("touchmove",function(o){A()
})
})
}function A(){if(n===true){e(".selector").removeClass("expand");
t.$responsiveList.animate({height:p+"px"},400);
n=false;
v.unbind("click");
v.unbind("touchmove");
v.unbind("scrollslider")
}}var H=e(".secondary-nav .nav-link",this.element).not(".selector").length>9;
if(H){E()
}};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))
}})
}
})(jQuery,window,document);
(function(e,c,a,g){var d="CC023_contentTile",f={};
function b(k,h){this.element=k;
this.$element=e(this.element);
this.options=e.extend({},f,h);
this._defaults=f;
this._name=d;
this.init()
}b.prototype.init=function(){var h=this.$element;
var k=h.find(".text-container").find(":header");
var l=h.find(".text-container").find("p");
var m=h.find(".img-holder").find(".title");
if(m.length>0){m.html(m.html().replace(/(\w),(\w)/g,"$1, $2"))
}if(k.height()>50){k.addClass("ellipsis")
}if(l.height()>70){l.addClass("ellipsis")
}};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))
}})
}
})(jQuery,window,document);
function ContentTile(a){this.image=a.image;
this.url=a.url;
this.platform=a.platform;
this.title=a.title;
this.description=a.description;
this.onclick=a.onclick
}ContentTile.prototype.appendTo=function(a){$(a).append(this.show())
};
ContentTile.prototype.show=function(){return ContentTile.template.replace(/@image/g,this.image).replace(/@url/g,this.url).replace(/@platform/,this.platform).replace(/@title/,this.title).replace(/@onclick/,this.onclick).replace(/@description/,this.description)
};
ContentTile.template='<div class="item">    <!-- CC023_Content Tile -->    <div class="CC023-Content-Tile">        <a 	onclick="@onclick" class="tile-link" href="@url">            <div class="img-holder">                <img src="@image" class="standard">                <span class="title">@platform</span>            </div>            <div class="text-container">                <div class="header-wrap">                    <h3>@title</h3>                 </div>                <div class="text-wrap">                     <p>@description</p>                 </div>            </div>        </a>    </div>    <!-- END CC023_Content Tile --></div>';
(function(e,c,a,g){var d="alertBar",f={resizeDelay:250};
function b(k,h){this.element=k;
this.$element=e(this.element);
this.options=e.extend({},f,h);
this._defaults=f;
this._name=d;
this.init()
}b.prototype.init=function(){var h=e(a.getElementById("main-header")).find(".secondary-nav-container");
if(h.length!=0){return
}var k=a.cookie.split("DisableAlertBar=");
if(k.length!==2||k.pop().split(";").shift()!=="YES"){this.nCurrentCookieMessageHeight=this.$element.outerHeight();
this.$pageContentContainer=e(a.getElementById("page-content"));
this.nPageContentPadding=this.$pageContentContainer.css("padding-top").split("px")[0];
this.nNewPageContentPadding=parseInt(this.nPageContentPadding)+parseInt(this.nCurrentCookieMessageHeight)-22;
this.$pageContentContainer.css("padding-top",this.nNewPageContentPadding+"px");
this.addClickHandler()
}};
b.prototype.addClickHandler=function(){var h=this;
this.$element.on("click",".close",function(k){k.preventDefault();
h.$element.remove();
if(PDC.isUserConsentedCookie()){setCookie("DisableAlertBar","YES")
}h.$pageContentContainer.css("padding-top",h.nPageContentPadding+"px");
clearTimeout(h.timeoutId);
e(c).unbind("resize."+h.element.id)
})
};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))
}})
}
})(jQuery,window,document);
(function(e,c,a,g){var d="waysToBuyPreOrder",f={hiddenSection:"div.hidden-wrap"};
function b(k,h){console.log("waysToBuyPreOrder");
this.element=k;
this.parent=k.parentNode;
this.elementHeight=0;
this.timeoutId=0;
this.wasVisible=null;
this.isNowVisible=false;
this.options=e.extend({},f,h);
this._defaults=f;
this._name=d;
this._isExcludedBrowser=e(".lt-ie8").length>0;
this.init()
}b.prototype.init=function(){var l=this,n=e(this.element),m=n.find(this.options.elementSelector);
n.find("div.hidden-wrap").css("aria-expanded","false");
var k=this.options.hiddenSection;
var h=function(){n.find(".box.additional-box.expandable").each(function(){var o=e(this);
id=o.parents(".game").attr("id");
if(o.attr("aria-expanded")=="true"){b.hideAll("#"+id+" div.hidden-wrap");
o.removeClass("up");
o.attr("aria-expanded","false").find("span")
}else{b.revealAll("#"+id+" div.hidden-wrap");
o.addClass("up");
o.attr("aria-expanded","true").find("span")
}})
};
n.find(".box.additional-box.expandable").on("click",function(o){o.preventDefault();
h()
});
b.hideAll("div.hidden-wrap");
if(n.find("div").length==0&&this.options.hide){n.hideSingleComponentSection()
}};
b.hideAll=function(h){e(h).slideUp()
};
b.revealAll=function(h){e(h).slideDown()
};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))
}})
}
})(jQuery,window,document);
(function(c,b,a,d){c.visitList=function(h,f){var l={breakWidth:944};
var k=this;
k.settings={};
var e=c(h),h=h;
k.init=function(){k.settings=c.extend({},l,f);
var u=k.settings;
var t=e.find("ul");
var p=e.find("ul").children();
var n=e.find("ul").find(".hideThin");
var r=e.find("ul").find(".hideWide");
var v=e.find("ul").find(".showThin");
var q=e.find("ul").find(".showWide");
var m=e.find("div.more-link");
c(b).resize(function(){g(t,n,r,v,q,m,u.breakWidth)
});
k.resizeTiles();
m.attr("aria-expanded","false").click(function(w){w.preventDefault();
var o=c(this);
if(o.attr("aria-expanded")=="true"){k.hideAll(t,p,u.breakWidth);
o.attr("aria-expanded","false").find("span").removeClass("showLess").html("MORE")
}else{k.revealAll(t,p,u.breakWidth);
o.attr("aria-expanded","true").find("span").addClass("showLess").html("LESS")
}});
k.hideAll(t,p,u.breakWidth)
};
k.resizeTiles=function(){var n=122;
var m=e.clone();
m.css({display:"block",visibility:"hidden"}).appendTo("body").find(".wrapper ul li > a").each(function(){var o=c(this);
o.parent().css("display","");
n=o.height()>n?o.height():n
});
m.remove();
e.find(".wrapper ul li > a").css("minHeight",n)
};
function g(q,n,t,o,m,r,u){var v=r.attr("aria-expanded");
var p=c(b).width();
if(v=="false"){if(p<=u){n.hide();
o.show()
}else{t.hide();
m.show()
}}}k.hideAll=function(q,o,n){var m=Modernizr.touch;
var r=true;
var p=c(b).width();
if(p<=n){r=false
}c.each(o,function(t,u){if(r){if(c(this).hasClass("hideWide")==true){if(m){this.style.display="none"
}else{c(this).slideUp()
}}}else{if(c(this).hasClass("hideThin")==true){if(m){this.style.display="none"
}else{c(this).slideUp()
}}}})
};
k.revealAll=function(q,o,n){var m=Modernizr.touch;
var r=true;
var p=c(b).width();
if(p<=n){r=false
}c.each(o,function(t,u){if(r){if(c(this).hasClass("hideWide")==true){if(m){this.style.display="block"
}else{c(this).slideDown()
}}}else{if(c(this).hasClass("hideThin")==true){if(m){this.style.display="block"
}else{c(this).slideDown()
}}}})
};
k.init()
};
c.fn.visitList=function(e){return this.each(function(){if(d==c(this).data("visitList")){var f=new c.visitList(this,e);
c(this).data("visitList",f)
}})
}
})(jQuery,window,document);
/*!
 * jQuery lightweight plugin boilerplate
 * Original author: @ajpiano
 * Further changes, comments: @addyosmani
 * Licensed under the MIT license
 * Original code (with comments) can be found at:
 * http://coding.smashingmagazine.com/2011/10/11/essential-jquery-plugin-patterns/
 */
(function(e,c,a,g){var d="twoColumnExpandable",f={textContainerSelector:".content-block",toggleButtonSelector:".expand-button",openClassName:"content-open",closedClassName:"content-closed",imgClassName:".image-bck-background",contentClassName:".copy-block-expandableDIv"};
function b(k,h){this.element=k;
this.parent=k.parentNode;
this.options=e.extend({},f,h);
this._defaults=f;
this._name=d;
this.$thisElement=e(this.element);
this.$additionalTextContainer=null;
this.$imgClassName=this.options.imgClassName;
this.$contentClassName=this.options.contentClassName;
this._isExcludedBrowser=e(".lt-ie8").length>0;
this.$contentHeight=e(".copy-block-expandableDIv").outerHeight();
this.init()
}b.prototype.init=function(){var m=this,k=this.$thisElement.find(this.options.textContainerSelector),l=this.$imgClassName,h=this.$contentClassName;
if(k.length!=2){return
}this.$additionalTextContainer=k.eq(1).hide();
if(!this._isExcludedBrowser){this.$thisElement.addClass(this.options.closedClassName);
this.$thisElement.on("click",this.options.toggleButtonSelector,function(){m.$additionalTextContainer.slideToggle("fast",function(){var r=e(this),o=m.options.openClassName,p=m.options.closedClassName,n=e(m.$thisElement.parent().find("img")).outerHeight(true);
l=m.$imgClassName;
var q=m.$thisElement.parent().find(h);
if(r.is(":visible")){m.$thisElement.removeClass(p);
m.$thisElement.addClass(o);
e(m.$thisElement.parent().find(l)).css("height",n)
}else{m.$thisElement.removeClass(o);
m.$thisElement.addClass(p);
e(m.$thisElement.parent().find(l)).css("height",q.height())
}})
});
this.setHeightHandler()
}else{return
}};
b.prototype.setHeightHandler=function(){var l=this;
$contentClassName=l.$contentClassName;
$imgClassName=l.$imgClassName;
var k=l.$thisElement.parent().find($contentClassName).outerHeight(true);
var h=e(".expand-button").outerHeight(true);
e(l.$thisElement.parent().find($imgClassName)).css({overflow:"hidden",height:k})
};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))
}})
}
})(jQuery,window,document);
(function(f,c,a,h){var e="twinComparison",g={scrollTime:500,videoIndex:0,mediaType:"",mediaId:""};
function b(l,k){this.element=l;
this.parent=l.parentNode;
this.options=f.extend({},g,k);
this._defaults=g;
this._name=e;
this.element=f(this.element);
this.init()
}function d(m){for(var l=0;
l<m.link.length;
l++){if(m.link[l].rel=="related"){var k=m.link[l].href;
return k.replace(/.*\//,"").replace(/\?.*$/,"")
}}return"unknown"
}b.prototype.init=function(){var p=this.options,n=this.element,l=n.find(".twinComp"),m=l.parent("a").attr("data-playlist-id");
function k(o){f.getJSON("//www.googleapis.com/youtube/v3/playlistItems?part=snippet&maxResults=50&playlistId="+m+"&key=AIzaSyAKRzl4h3hhO1X3imjDNBNFkgqmiBhzk_U&alt=json&callback=?",function(r){var q=r.items[p.videoIndex];
ytJSON=true;
pdclog("loadPlaylist");
pdclog(q);
o.each(function(){o=f(this);
var v=q.snippet.resourceId.videoId,u="//www.youtube.com/watch?v="+v;
var t="no";
if(f(q).isVideoItemAgeGated){if(f(q).isVideoItemAgeGated()){t="yes"
}}o.find(".button").parent().append('<img src="//img.youtube.com/vi/'+v+'/hqdefault.jpg" class="ytImage" />');
o.parent("a").attr("href",u).addClass("lb_youtube").attr("data-agegating",t).removeClass("lb_ytPlaylist");
if(f.fn.pdcLightbox){o.parent("a").pdcLightbox()
}})
})
}if(m!=h){k(l)
}};
f.fn[e]=function(k){return this.each(function(){if(!f.data(this,"plugin_"+e)){f.data(this,"plugin_"+e,new b(this,k))
}})
}
})(jQuery,window,document);
(function(a){a.statList=function(d,c){var f={};
var e=this;
e.settings={};
var b=a(d),d=d;
e.init=function(){e.settings=a.extend({},f,c);
var h=e.settings;
var g=b.find("ul.listWrapToggleView");
if(g.length==0){b.find(".more").hide();
return
}b.find("div.more").attr("aria-expanded","false").on("click",function(l){l.preventDefault();
var k=a(this);
if(k.attr("aria-expanded")=="true"){e.hideAll(g,h);
k.attr("aria-expanded","false").find("span").removeClass("showLess").html("MORE")
}else{e.revealAll(g,h);
k.attr("aria-expanded","true").find("span").addClass("showLess").html("LESS")
}});
e.hideAll(g,h)
};
e.hideAll=function(g,h){g.slideUp()
};
e.revealAll=function(g,h){g.slideDown()
};
e.init()
};
a.fn.statList=function(b){return this.each(function(){if(undefined==a(this).data("statList")){var c=new a.statList(this,b);
a(this).data("statList",c)
}})
}
})(jQuery);
/*!
 * jQuery lightweight plugin boilerplate
 * Original author: @ajpiano
 * Further changes, comments: @addyosmani
 * Licensed under the MIT license
 * Original code (with comments) can be found at:
 * http://coding.smashingmagazine.com/2011/10/11/essential-jquery-plugin-patterns/
 */
(function(e,c,a,f){var d="thumbnailTabs";
function b(h,g){this.$element=e(h);
this.lock=false;
this.init()
}b.prototype.init=function(){var g=this;
g.$element.find(".tabs .tab").on("click",function(l){l.preventDefault();
if(!g.lock){g.lock=true;
var k=e(this);
var h=k.data("tab-id");
if(h){g.$element.find(".selected-tab").removeClass("selected-tab");
k.addClass("selected-tab");
g.$element.find(".selected").fadeOut("fast",function(){e(this).removeClass("selected");
g.$element.find("."+h).fadeIn("slow",function(){e(this).addClass("selected");
g.lock=false
})
})
}}})
};
e.fn[d]=function(g){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,g))
}})
}
})(jQuery,window,document);
(function(e,c,a,g){var d="threeStepBanner",f={};
function b(l,k){this.element=l;
this.$element=e(this.element);
this.options=e.extend({},f,k);
this.elmId=e(this.element).attr("id");
this._defaults=f;
this._name=d;
var h=this;
h.init()
}b.prototype.init=function(){var l=this;
var h=l.options.imagePath;
var k=new Image;
k.onload=function(){var m=k.height;
console.log(m);
if(m>725){l.$element.addClass("parallaxer");
l.$element.find(".wide div").css({height:m});
l.$element.parallaxer()
}};
k.src=l.$element.find(".wide div").css("backgroundImage").replace(/url\(\"?|\"?\)$/ig,"")
};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))
}})
}
})(jQuery,window,document);
(function(d,c,a,f){var e={enabledClassName:"parallaxer",wideImageParentSelector:".wide div",wideImageSelector:".wide"},b={init:function(g){var h=d.extend(e,g);
return this.each(function(){var q=d(this);
if(!Modernizr.touch&&q.hasClass(h.enabledClassName)){if(typeof ScrollControl==="undefined"){ScrollControl=new ScrollrControllr()
}var r=q.find(h.wideImageParentSelector),l=q.find(h.wideImageSelector).outerHeight(),p=r.outerHeight(),k=d(c).height(),o=q.offset().top-(k),t=o+k+l,m=t-o,n=(p-l);
r.css("top",-n);
ScrollControl.registerScrollListener(function(){if(r.is(":visible")){r.css("top",-n+(n/m)*(arguments[0]-o))
}else{}},q)
}else{}})
}};
d.fn.parallaxer=function(g){return b.init.apply(this,arguments)
}
})(jQuery,window,document);
(function(e,c,a,g){var d="socialPodPlugin",f={slideInTimeout:500,lockupSection:"section.page-section:eq(1)",lockPoint:165};
function b(k,h){this.element=k;
this.$element=e(this.element);
this.options=e.extend({},f,h);
this._defaults=f;
this._name=d;
this.init()
}b.prototype.init=function(){e(".socialpod").eq(0).replaceWith(this.$element);
var l=this,q=l.options,p=l.$element,m=p.find(".social-pod"),h=p.find(".social-pod ul"),n=e(q.lockupSection).offset().top;
n+=100;
if(Modernizr.touch){n=n>500?n:500;
n+=110
}p.css({top:n});
e(c).bind("bannerBlockerClosed",function(o){n=e(q.lockupSection).offset().top;
p.css({top:n})
});
if(!Modernizr.touch){var k;
h.hover(function(){c.clearTimeout(k);
m.css("overflow","visible");
h.stop().animate({right:0})
},function(){k=c.setTimeout(function(){h.stop().animate({right:-155},function(){m.css("overflow","hidden")
})
},q.slideInTimeout)
});
if(typeof ScrollControl==="undefined"){ScrollControl=new ScrollrControllr()
}ScrollControl.registerScrollListener(function(){if(n-q.lockPoint<arguments[0]){p.css({top:q.lockPoint});
if(!p.hasClass("fixed")){p.addClass("fixed")
}}else{p.css({top:n});
if(p.hasClass("fixed")){p.removeClass("fixed")
}}},e("body"))
}else{m.css("overflow","visible");
h.bind("touchstart",function(o){h.stop().animate({right:0},function(){e("body").bind("touchmove",function(r){e("body").unbind("touchmove");
h.stop().animate({right:-155})
})
})
})
}e(q.sFeedBack).on("click",function(o){o.preventDefault();
e(".feedback").colorbox({iframe:true,innerWidth:600,innerHeight:400})
});
(function(u,o,v){var t,r=u.getElementsByTagName(o)[0];
if(u.getElementById(v)){return
}t=u.createElement(o);
e(".fb-like").each(function(){if(a.location.href.indexOf("?")>0){e(this).attr("data-href",a.location.href.substr(0,a.location.href.indexOf("?")))
}});
t.id=v;
t.src="//connect.facebook.net/en_US/all.js#xfbml=1&appId=5437122869";
r.parentNode.insertBefore(t,r)
}(a,"script","facebook-jssdk"));
c.fbAsyncInit=function(){FB.Event.subscribe("edge.create",function(o){var r=e("#fakeTarget")[0];
callSC.bind(r)("facebook",true)
})
};
c.twttr=(function(w,r,x){var o,v,u=w.getElementsByTagName(r)[0];
if(w.getElementById(x)){return
}v=w.createElement(r);
v.id=x;
v.src="https://platform.twitter.com/widgets.js";
u.parentNode.insertBefore(v,u);
return c.twttr||(o={_e:[],ready:function(t){o._e.push(t)
}})
}(a,"script","twitter-wjs"));
twttr.ready(function(o){o.events.bind("tweet",function r(){var t=e("#fakeTarget")[0];
callSC.bind(t)("twitter",true)
})
});
c.___gcfg={lang:q.locale};
(function(){var o=a.createElement("script");
o.type="text/javascript";
o.async=true;
o.src="https://apis.google.com/js/plusone.js";
var r=a.getElementsByTagName("script")[0];
r.parentNode.insertBefore(o,r)
})();
(function(t){var o=t.getElementsByTagName("SCRIPT")[0],r=t.createElement("SCRIPT");
r.type="text/javascript";
r.async=true;
r.src="//assets.pinterest.com/js/pinit.js";
o.parentNode.insertBefore(r,o)
}(a))
};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))
}})
};
e(a).ready(function(){c.setTimeout(function(){var h={ref:null,type:null};
e(".social-pod li").each(function(){var k=this;
e(this).find("iframe").mouseenter(function(){h.type=e(k).attr("class");
pdclog("enter: "+h.type);
e(c).focus()
}).mouseleave(function(){pdclog("leave: "+h.type);
h.type=null
})
});
e(c).blur(function(){if(h.type){var k=h.type.split("x-")[1];
callSC(k)
}})
},1500)
})
})(jQuery,window,document);
(function(e,c,a,g){var d="ajaxService";
var f={fakeTimeDelay:1000};
function b(k,h){this.$element=e(k);
this.options=e.extend({},f,h);
this.methodMap={"games_&_products":function(m,n,l){n.gameProduct(l)
},helps:function(m,n,l){n.html('<div style="width:900px"><h2>Not Implemented</h2></div>')
},others:function(m,n,l){n.otherTab(l)
}};
this.init()
}b.prototype.init=function(){var h=this;
e(c).on("query",function(m,l,n,o){if(l){l=h.generateQueryURL(l)
}l=l||h.generateQueryURL(h.options.url);
n==n|false;
var k=h.options;
c.clearTimeout(c.fakeContentTimeout);
console.log(l);
e.ajax({url:l,cache:n,success:function(p){if(typeof o=="function"){o.call(o.caller,p)
}},fail:function(q,p,r){console.log(p);
if(typeof o=="function"){o.call(o.caller,data)
}},error:function(q,p,r){console.log(p)
}})
});
e(c).on("single_tab_query",function(n,m,q,r,p,o,l){var k=m;
e(c).trigger("query",[k,r,function(v){console.log("action after single_tab_query");
if(!v||!v.results||!v.results.length){h.setCount(p,0);
p.removeClass("selected").addClass("type-disabled").next().click()
}else{var t=v.resultcount;
if(t){p.removeClass("type-disabled");
h.setCount(p,t.total)
}}q.find(".ajax-loader").remove();
if(l){q.addClass("active").siblings().removeClass("active")
}var u=p.attr("data-type");
var w=h.methodMap[u];
if(typeof w==="function"){if(v){w(v,q,m)
}}q.trigger("newData",[v,m])
}])
});
if(h.getQuery()){e(c).trigger("query",[h.initialQuery(),false,function(l){if(!l||!l.results||!l.results.length){h.showNoResult();
console.log("no search result,send siteCatalyst event19");
var k="button:search:"+e(".siteSearchResourcePath").val()+":"+e(".siteSearchPageName").val();
CQ_Analytics.record({event:"event19",values:{searchterm:l.searchSuggestions["executed"],searchtype:"pdc",entitytype:k},collect:false,options:{obj:this,defaultLinkType:"o"},componentPath:e(".siteSearchComponentPath").val()});
console.log("entitytype "+k);
console.log("searchtype pdc");
console.log("searchterm in ajaxService "+l.searchSuggestions["executed"]);
console.log("no result for initialQuery");
e(c).trigger("afterInitialQuery",l)
}else{if(l.searchSuggestions["original"].length!=0&&l.searchSuggestions["executed"]!=l.searchSuggestions["original"]){console.log("no original search result,send siteCatalyst event19");
var k="button:search:"+e(".siteSearchResourcePath").val()+":"+e(".siteSearchPageName").val();
CQ_Analytics.record({event:"event19",values:{searchterm:l.searchSuggestions["original"],searchtype:"pdc",entitytype:k},collect:false,options:{obj:this,defaultLinkType:"o"},componentPath:e(".siteSearchComponentPath").val()});
console.log("entitytype "+k);
console.log("searchtype pdc");
console.log("searchterm in ajaxService "+l.searchSuggestions["executed"])
}e(c).trigger("afterInitialQuery",l)
}}])
}};
b.prototype.setCount=function(k,h){var l=k.text();
k.text(l.replace(/\(\d+\)$/,"("+h+")"))
};
b.prototype.getQuery=function(){var h=e.fn.getURLVar("q");
if(!h){h=g
}return h
};
b.prototype.initialQuery=function(){var h=this.options.url;
h=this.appendQuery(h,"count","1");
return h
};
b.prototype.generateQueryURL=function(k){var l=this.getQuery();
var h=k;
if(l){l=escape(l);
h=this.appendQuery(h,"q",l)
}return h
};
b.prototype.appendQuery=function(h,k,l){var m=h;
if(!m){return m
}if(m.indexOf(k+"=")!=-1){return h
}if(m.indexOf("?")!=-1){m=m+"&"+k+"="+l
}else{m=m+"?"+k+"="+l
}return m
};
b.prototype.showNoResult=function(){this.$element.find(".wrapper").hide();
this.$element.find(".no_result_page").show()
};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))
}})
}
})(jQuery,window,document);
(function(d,c,a,e){PDC.SiteSearch=PDC.SiteSearch||{};
PDC.SiteSearch.Tab=PDC.SiteSearch.Tab||b;
function b(f,g){this.element=d(f);
this.url="";
this.init()
}b.prototype.init=function(){var f=this;
this.element.on("click touchend","a.more-link",function(g){var h=d(this).attr("data-next-page");
if(h){d.getJSON(h,function(k){f.append(k)
})
}});
d(f.element).on("newData",function(h,k,g){f.url=g;
f.create(k)
})
};
b.prototype.getMoreLink=function(){return'<a class="more-link" data-next-page="@link" href="javascript:void(0)"><span class="more">More</span></a>'
};
b.prototype.getMoreLinksParentSelector=function(){};
b.prototype.getChildClass=function(){};
b.prototype.getTemplate=function(){};
b.prototype.getCollectionSelector=function(){};
b.prototype.empty=function(){d(this.getCollectionSelector(),this.element).empty()
};
b.prototype.create=function(f){this.addProductGrid();
this.empty();
this.append(f)
};
b.prototype.addProductGrid=function(){this.element.html(this.getTemplate())
};
b.prototype.append=function(f){this.appendTiles(f.results,f.searchSuggestions);
this.setMoreLink(f.pagination["next"])
};
b.prototype.appendTiles=function(k,f){for(var g=0;
g<k.length;
g++){var m=k[g];
this.addSiteCatlystEvent(m,f);
var l=this.getChildClass();
var h=new l(m);
this.appendTile(h)
}};
b.prototype.addSiteCatlystEvent=function(k,f){var g=k.title+":"+d(this.colletionSelector).children().size();
var h="";
if(f.original.length!=0&&f.executed!=f.original){h=g
}k.onclick="CQ_Analytics.record({event: 'event18', values: { searchterm: '"+f.executed+"',searchitem:'"+g+"',predictiveitem:'"+h+"',searchtype:'pdc',entitytype:'button:search:"+d(".siteSearchResourcePath").val()+":"+d(".siteSearchPageName").val()+"' }, collect:  false, options: { obj: this, defaultLinkType: 'd' },componentPath: '"+d(".siteSearchComponentPath").val()+"'})"
};
b.prototype.appendTile=function(f){f.appendTo(d(this.getCollectionSelector(),this.element))
};
b.prototype.setMoreLink=function(f){if(f){f=this.mergeLink(f)
}var g=this.getMoreLinksParentSelector();
var h=d(g+" a.more-link",this.element);
if(f){if(h.length==0){d(g,this.element).append(this.getMoreLink().replace(/@link/g,f))
}h.show();
h.attr("data-next-page",f)
}else{h.hide()
}};
b.prototype.mergeLink=function(g){var h=g;
if(this.url){var f=this.url.indexOf("?");
if(f!=-1){h=this.url.substring(0,f)+g
}else{h=this.url+g
}}return h
};
PDC.SiteSearch.extend=function(m,h,k){for(var g in h){m[g]=h[g]
}for(var f in k){m[f]=k[g]
}var l=function(){this.constructor=m
};
l.prototype=h.prototype;
m.prototype=new l
}
})(jQuery,window,document);
(function(e,c,a,f){var d="gameProduct";
function b(g,h){this.element=e(g);
this.url="";
this.init();
this.template=b.template
}PDC.SiteSearch.extend(b,PDC.SiteSearch.Tab,{});
b.prototype.getChildClass=function(){return ContentTile
};
b.prototype.getTemplate=function(){return b.template
};
b.prototype.getCollectionSelector=function(){return".items"
};
b.prototype.getMoreLinksParentSelector=function(){return".wrapper"
};
b.template='<div id="137701609334472" class="CM102-accessory-grid">    <div class="wrapper">        <div class="items">         </div>    </div></div>';
e.fn[d]=function(g){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,g))
}})
}
})(jQuery,window,document);
(function(f,d,a,g){var e="helpTab";
function c(h,k){this.element=f(h);
this.init()
}c.prototype.getMoreLink=function(){};
c.prototype.getMoreLinksParentSelector=function(){return".CM146-resultlist"
};
c.prototype.getChildClass=function(){return b
};
c.prototype.getTemplate=function(){return'<div id="ResultList13776920648247" class="CM146-resultlist"><table class="results clearfix"><tbody></tbody></tble></div>'
};
c.prototype.getCollectionSelector=function(){return"tbody"
};
PDC.SiteSearch.extend(c,PDC.SiteSearch.Tab,{});
b.LightboxTempalte='<a href="@video" class="lb_youtube cboxElement" style="background: url(\'@image\') no-repeat"><img src="etc/designs/pdc/clientlibs_base/images/CM109_mediaCarousel/vid-icon-small.png" alt=""></a> ';
b.INDEXS=["odd","even"];
function b(h){this.url=h.url;
this.type="Article";
this.title=h.title;
this.description=h.description;
this.rate="85%";
this.rate_type="Helpful";
this.lightbox="";
this.videoUrl="";
this.imageUrl="";
this.setLightbox();
this.truncateDecription()
}b.prototype.setLightbox=function(){if(this.imageUrl&&this.videoUrl){this.lightbox=LightboxTempalte.replace(/@video/g,this.videoUrl).replace(/@image/g,this.imageUrl)
}};
b.prototype.truncateDecription=function(){if(this.lightbox&&this.description.length>142){this.description=this.description.substring(0,142)+"..."
}else{if(this.description.length>190){this.description=this.description.substring(0,190)+"..."
}}};
b.prototype.appendTo=function(h){this.setIndex(h);
f(h).append(this.show())
};
b.prototype.setIndex=function(h){this.index=b.INDEXS[f(">tr",h).length%2]
};
b.prototype.show=function(){return b.template.replace(/@index/g,this.index).replace(/@url/g,this.url).replace(/@type/,this.type).replace(/@title/,this.title).replace(/@rate/,this.rate).replace(/@rate_type/,this.rate_type).replace(/@lightbox/,this.lightbox).replace(/@description/,this.description)
};
b.template='<tr class="@index" onclick="document.location=\'@url\'"> <td class="main">  <div>  <p>@type</p><strong>@title</strong> <span>@description </span> </div>@lightbox </td>  <td class="center blue"> <strong>@rate</strong> <span>@rate_type</span> </td>  </tr>';
f.fn[e]=function(h){return this.each(function(){if(!f.data(this,"plugin_"+e)){f.data(this,"plugin_"+e,new c(this,h))
}})
}
})(jQuery,window,document);
(function(f,d,a,g){var e="otherTab";
function c(h,k){this.element=f(h);
this.init()
}PDC.SiteSearch.extend(c,PDC.SiteSearch.Tab,{});
c.prototype.getChildClass=function(){return b
};
c.prototype.getTemplate=function(){return'<div id="ResultList1377692064822247" class="CM146-resultlist CM146-resultlist_Other"><table class="results clearfix"><tbody></tbody></tble></div>'
};
c.prototype.getCollectionSelector=function(){return"tbody"
};
c.prototype.getMoreLinksParentSelector=function(){return".CM146-resultlist_Other"
};
b.INDEXS=["odd","even"];
function b(h){this.url=h.url;
this.type=h.content_type;
this.title=h.title;
this.description=h.description;
this.truncateDecription()
}b.prototype.truncateDecription=function(){if(this.description.length>333){this.description=this.description.substring(0,333)+"..."
}};
b.prototype.appendTo=function(h){this.setIndex(h);
f(h).append(this.show())
};
b.prototype.setIndex=function(h){this.index=b.INDEXS[f(">tr",h).length%2]
};
b.prototype.show=function(){return b.template.replace(/@index/g,this.index).replace(/@url/g,this.url).replace(/@type/,this.type).replace(/@title/,this.title).replace(/@description/,this.description)
};
b.template='<tr class="@index" onclick="document.location=\'@url\'"> <td class="main"><p>@type</p><strong>@title</strong><span>@description </span> </td>  </tr>';
f.fn[e]=function(h){return this.each(function(){if(!f.data(this,"plugin_"+e)){f.data(this,"plugin_"+e,new c(this,h))
}})
}
})(jQuery,window,document);
(function(e,c,a,g){var d="searchResults",f={defaultPath:"/etc/designs/pdc/clientlibs_search/images/icon-default.jpg"};
function b(k,h){this.element=k;
this.$element=e(this.element);
this.$key=e(this.element).attr("id");
this.options=e.extend({},f,h);
this._defaults=f;
this._name=d;
this.init()
}b.prototype.init=function(){var k=e(".result-desc");
k.dotdotdot();
e(c).resize(function(){k.dotdotdot()
});
var l=e(".result-image"),h=this.options.defaultPath;
l.each(function(){var n=this.style.backgroundImage.replace(/"/g,"").replace(/url\(|\)$/ig,""),o=h,m=this.dataset.index-1,p=new Image();
p.onerror=function(){l[this.dataset.index].style.backgroundImage="url("+o+")"
};
p.src=n;
p.dataset.index=m
})
};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))
}})
}
})(jQuery,window,document);
(function(e,c,a,g){var d="searchBox",f={formUrl:null,queryParameter:null,autoComplete:false,acFooterText:null,acCharacterLimit:null,acEnablePreloader:true,acServiceUrl:null};
function b(k,h){this.element=k;
this.$element=e(this.element);
this.$key=e(this.element).attr("id");
this.options=e.extend({},f,h);
this._defaults=f;
this._name=d;
this.init()
}b.prototype.init=function(){this.setupFormSubmission();
if(this.options.autoComplete&&this.options.acServiceUrl){this.setupAutoComplete()
}};
b.prototype.setupFormSubmission=function(){var k=this.options.formUrl,m=this.options.queryParameter,h=this.$element.find('input[type="text"]'),l=this.$element.find('input[type="submit"]');
h.on("keypress",function(o){var n=(o.keyCode?o.keyCode:o.which);
if(n==13){l.trigger("click")
}});
l.on("click",function(p){p.preventDefault();
var o=h.val(),n=k+"?"+m+"="+o;
PDC.SC.click("gsasearch","search-banner","button",{events:["event17"],vars:{eVar17:o,prop17:o}});
if(o!=""){c.location.href=n
}})
};
b.prototype.setupAutoComplete=function(){if(typeof YAHOO.widget.AutoComplete=="undefined"){return false
}var m=this.$element,u=this.$element.find(".search-autocomplete")[0],v=this.$element.closest(".header-search"),p=this.$element.find('input[type="text"]')[0],l=this.options.acFooterText,n=this.options.acCharacterLimit,t=this.$element.find('input[type="submit"]');
var q=(a.getElementById("sp_staged")?a.getElementById("sp_staged").value:0),x=(a.location.protocol=="https:"?"https:":"http:"),r=(q?"-stage/":"/"),w=new YAHOO.util.ScriptNodeDataSource((x+"//"+this.options.acServiceUrl+r));
w.asyncMode="ignoreStaleResponses";
w.maxCacheEntries=1000;
w.responseSchema={resultsList:"ResultSet.Result",fields:["phrase"]};
var k=new YAHOO.widget.AutoComplete(p,u,w);
k.queryDelay=0.5;
k.useShadow=false;
k.autoHighlight=false;
k.minQueryLength=1;
k.maxResultsDisplayed=6;
k.animVert=false;
k.queryQuestionMark=true;
k.resultTypeList=false;
k.alwaysShowContainer=false;
k.autoSnapContainer=false;
k.typeAhead=true;
k.highlightClassName="hover";
k.formatResult=function(A,C,z){if(n&&(z.length>n)){z=z.substring(0,n)+"..."
}var B=z.replace(new RegExp(C,"gi"),function y(D){return"<b>"+D+"</b>"
});
return B
};
if(l){var o="<span>"+l+"</span>";
k.setFooter(o)
}k.generateRequest=function(y){return"?query="+y+"&max_results="+k.maxResultsDisplayed
};
var h=function(){a.searchform.submit()
};
k.itemSelectEvent.subscribe(h);
if(v){k.containerExpandEvent.subscribe(function(z,y){v.addClass("autocomplete-open")
});
k.containerCollapseEvent.subscribe(function(z,y){v.removeClass("autocomplete-open")
})
}k.itemSelectEvent.subscribe(function(z,y){t.trigger("click")
});
if(this.options.acEnablePreloader){k.dataRequestEvent.subscribe(function(z,y){m.addClass("loading")
});
k.dataReturnEvent.subscribe(function(z,y){m.removeClass("loading")
})
}m.find(".yui-ac-ft").on("click",function(y){y.stopPropagation();
t.trigger("click")
})
};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))
}})
}
})(jQuery,window,document);
(function(c,b,a,d){jQuery.fn.ninetile=function(e){var f=c(this);
if(c.fn.pdcLightbox){c.each(f.find("li.tile a.lb_iframe_rtg"),function(g,h){c(h).pdcLightbox()
})
}c.each(f.find("li.tile"),function(g,h){c(h).on("click",function(k){if(c(this).find("a.lb_iframe_rtg").length>=0){c(this).find("a.lb_iframe_rtg")[0].click()
}})
})
}
})(jQuery,window,document);
(function(c,b,a,d){jQuery.fn.player_stories=function(o){(function(t,p,u){var r,q=t.getElementsByTagName(p)[0];
if(t.getElementById(u)){return
}r=t.createElement(p);
c(".fb-like").each(function(){if(a.location.href.indexOf("?")>0){c(this).attr("data-href",a.location.href.substr(0,a.location.href.indexOf("?")))
}});
r.id=u;
r.src="//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3&appId=5437122869";
q.parentNode.insertBefore(r,q)
}(a,"script","facebook-jssdk"));
b.twttr=(function(v,q,w){var p,u,r=v.getElementsByTagName(q)[0];
if(v.getElementById(w)){return
}u=v.createElement(q);
u.id=w;
u.src="https://platform.twitter.com/widgets.js";
r.parentNode.insertBefore(u,r);
return b.twttr||(p={_e:[],ready:function(t){p._e.push(t)
}})
}(a,"script","twitter-wjs"));
var f=c(this);
f.find("a.more-link").on("click",function(p){p.preventDefault();
e()
});
var k=10;
if(o.pageSize){k=o.pageSize
}f.find("li.filter").on("click",function(p){p.preventDefault();
m(c(this).data("st"))
});
c(b).on("filterChange",function(p,q){m(q.state)
});
var h=f.find("a.more-link");
var g=f.find("ul.storylist");
var n=g.children("li").last();
c("ul.storylist li:last-child").css({"padding-bottom":0});
var m=function(p){h.attr("data-page","1");
h.attr("data-state",p);
g.empty();
e()
};
var e=function(){var v=h.attr("data-page");
var u=h.attr("data-state");
if(v==d||v<1){v=1
}var r=(v*k)-(k-1);
var p=(v*k);
var t=1;
if(u&&u!="ALL"){for(var q=r-1;
q<p&&q<o.stories[u].length;
q++){l((o.stories[u])[q])
}FB.XFBML.parse();
twttr.widgets.load();
if(p>=o.stories[u].length){h.hide()
}else{h.show()
}}else{c.each(o.stories,function(w,x){c.each(x,function(y,z){if(t>=r&&t<=p){l(z)
}t++;
if(t>p){return
}});
if(t>p){return
}});
FB.XFBML.parse();
twttr.widgets.load();
if(p>=o.storiesCount){h.hide()
}else{h.show()
}}h.attr("data-page",parseInt(v)+1)
};
var l=function(u){var p="lb_image";
var t=u.image;
var x=u.image;
if(u.iconClass=="video"){p="lb_youtube";
t="//www.youtube.com/watch?v="+u.videoRef;
x="//img.youtube.com/vi/"+u.videoRef+"/maxresdefault.jpg"
}var r=c("<a>").addClass(p).attr("target","_blank").attr("href",t).append(c("<p>").addClass(u.iconClass)).append(c("<img>").addClass("main").attr("src",x));
r.pdcLightbox();
var v=encodeURI(c("#"+u.shareUrlKey).data("href"));
var q=c("<div>").addClass("social").append(c("<div>").addClass("fbwrapper").append(c("<div>").addClass("fb-like").attr("data-href",v).attr("data-layout","button_count").attr("data-action","like").attr("data-show-faces","false").attr("data-share","false"))).append(c("<div>").addClass("twitterwrapper").append(c("<a>").addClass("twitter-share-button").attr("href","https://twitter.com/share").attr("data-url",v).text("Tweet")));
var w=c("<li>").addClass("story").append(r).append(c("<p>").addClass("location").text(u.city+", "+u.stateDisplayName)).append(c("<p>").addClass("name").text(u.name)).append(c("<p>").addClass("description").text(u.description)).append(q);
g.append(w)
};
e()
}
})(jQuery,window,document);
(function(e,c,a,g){var d="player_viewall_filter",f={};
function b(k,h){this.element=k;
this.$element=e(this.element);
this.$key=e(this.element).attr("id");
this.options=e.extend({},f,h);
this._defaults=f;
this._name=d;
this.init()
}b.prototype.init=function(){this.$element.find("select.filters").selectbox({effect:"fade",speed:400,onChange:function(n,k){var m={},l=e(this).attr("data-filter-key");
m[l]=n;
e(c).trigger("filterChange",m)
}});
var h=this;
e(c).on("newfacets",function(o,q){h.clearAllCounts();
if(q&&q.release_cat){for(var k=0,n=q.release_cat.length;
k<n;
k++){var m=q.release_cat[k];
var p=m.value;
var l=m.count;
h.setFacets(p,l)
}}})
};
b.prototype.clearAllCounts=function(){for(var h=0;
h<this.options.facetCountType.length;
h++){var k=this.options.facetCountType[h];
this.setFacets(k,0)
}};
b.prototype.setFacets=function(h,l){var k=e('#filter-tab-container .grouping a[data-filter-value="'+h+'"]');
l=(l+"").replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,");
var m=k.text();
if(m){k.text(m.replace(/[\d,]+/g,l))
}};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))
}})
}
})(jQuery,window,document);
(function(c,b,a,d){jQuery.fn.playerstory=function(e){var f=c(this);
(function(l,g,m){var k,h=l.getElementsByTagName(g)[0];
if(l.getElementById(m)){return
}k=l.createElement(g);
c(".fb-like").each(function(){if(a.location.href.indexOf("?")>0){c(this).attr("data-href",a.location.href.substr(0,a.location.href.indexOf("?")))
}});
k.id=m;
k.src="//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3&appId=5437122869";
h.parentNode.insertBefore(k,h)
}(a,"script","facebook-jssdk"));
b.twttr=(function(m,h,n){var g,l,k=m.getElementsByTagName(h)[0];
if(m.getElementById(n)){return
}l=m.createElement(h);
l.id=n;
l.src="https://platform.twitter.com/widgets.js";
k.parentNode.insertBefore(l,k);
return b.twttr||(g={_e:[],ready:function(o){g._e.push(o)
}})
}(a,"script","twitter-wjs"))
}
})(jQuery,window,document);
(function(e,c,a,g){var d="rtgInteractiveMap",f={};
function b(k,h){this.element=k;
this.$element=e(this.element);
this.$key=e(this.element).attr("id");
this.options=e.extend({},f,h);
this._defaults=f;
this._name=d;
this.init()
}b.prototype.init=function(){var p;
var n=(new Date).getTime();
var h=n;
e(".rtgcircle").each(function(){var t=Date.parse(e(this).attr("data-startdate"));
var q=Date.parse(e(this).attr("data-enddate"));
var r=t+86400000;
if(n>=t&&n<=q){h=0;
p=e(this)
}else{if(n>t&&n<r){h=0;
p=e(this)
}else{if(n<=t&&((t-n)<h)){h=t-n;
p=e(this)
}}}e(this).hover(function(){var u=e(this).parent().siblings(".rtginfo");
k(u,e(this))
},function(){var u=e(this).parent().siblings(".rtginfo");
m(u)
});
e(this).on("click",function(){if(!e(this).hasClass("selected")){e(this).closest(".rtgmap").find(".selected").each(function(){e(this).removeClass("selected")
});
e(this).addClass("selected");
var u=e(this).parent().siblings(".rtginfo");
k(u,e(this))
}})
});
p.addClass("default selected").removeClass("rtgcircle");
p.css("left",(parseInt(p.css("left"))-21)+"px");
l(p.closest(".mapwrapper"));
e(".rtgInteractiveMap").each(function(){e(this).mouseup(function(r){var q=e(".rtgimage");
if(q.is(r.target)){e(this).find(".selected").removeClass("selected");
l(e(this))
}})
});
e(".rtgclosebutton").on("click",function(){e(this).closest(".rtginfo").siblings(".rtgmap").find(".rtgTruck").each(function(){e(this).remove()
});
l(e(this).closest(".rtginfo"))
});
function k(u,x){var v=u.find(".rtgcity");
v.attr("data-previousCity",v.text());
var t=u.children(".rtgdate");
var q=t.children(".startdate");
t.attr("data-previousStartDate",q.text());
var r=t.children(".enddate");
t.attr("data-previousEndDate",r.text());
var w=u.children(".rtgdescription");
w.attr("data-previousDescription",w.text());
u.children(".rtgcity").text(x.attr("data-city"));
u.children(".rtgdate").empty();
var z=x.attr("data-displayStartDate");
var y=x.attr("data-displayEndDate");
if(y){u.children(".rtgdate").append("<span class='startdate'>"+z+"</span> - <span class='enddate'>"+y+"</span>")
}else{u.children(".rtgdate").append("<span class='startdate'>"+z+"</span>")
}u.children(".rtgdescription").text(x.attr("data-description"))
}function m(t){$rtgCity=t.children(".rtgcity");
$rtgCity.text($rtgCity.attr("data-previousCity"));
$rtgDate=t.children(".rtgdate");
$rtgDate.empty();
var q=$rtgDate.attr("data-previousStartDate");
var r=$rtgDate.attr("data-previousEndDate");
if(r){t.children(".rtgdate").append("<span class='startdate'>"+q+"</span> - <span class='enddate'>"+r+"</span>")
}else{t.children(".rtgdate").append("<span class='startdate'>"+q+"</span>")
}$rtgDescription=t.children(".rtgdescription");
$rtgDescription.text($rtgDescription.attr("data-previousDescription"))
}function o(t){$rtgDate=$infoDiv.children(".rtgdate");
$rtgDate.empty();
var q=$rtgDate.attr("data-previousStartDate");
var r=$rtgDate.attr("data-previousEndDate");
if(r){$infoDiv.children(".rtgdate").append("<span class='startdate'>"+q+"</span> - <span class='enddate'>"+r+"</span>")
}else{$infoDiv.children(".rtgdate").append("<span class='startdate'>"+q+"</span>")
}}function l(t){var u=t.find(".default");
u.addClass("selected");
var v=t.find(".rtginfo");
v.children(".rtgcity").text(u.attr("data-city"));
v.children(".rtgStartDate").text(u.attr("data-displayStartDate"));
v.children(".rtgEndDate").text(u.attr("data-endDate"));
v.children(".rtgdate").empty();
var r=u.attr("data-displayStartDate");
var q=u.attr("data-displayEndDate");
if(q){v.children(".rtgdate").append("<span class='startdate'>"+r+"</span> - <span class='enddate'>"+q+"</span>")
}else{v.children(".rtgdate").append("<span class='startdate'>"+r+"</span>")
}v.children(".rtgdescription").text(u.attr("data-description"))
}};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))
}})
}
})(jQuery,window,document);
(function(c,b,a,d){c.fn.charCount=function(e){var g=c(this).find(".comment");
var h={allowed:300,warning:25,css:"counter",counterElement:"span",cssWarning:"warning",cssExceeded:"exceeded",counterText:""};
var e=c.extend(h,e);
function f(m){var k=c(m).val().length;
var l=e.allowed-k;
if(l<=e.warning&&l>=0){c(m).next().addClass(e.cssWarning)
}else{c(m).next().removeClass(e.cssWarning)
}if(l<0){c(m).next().addClass(e.cssExceeded)
}else{c(m).next().removeClass(e.cssExceeded)
}c(m).next().html(l+" "+e.counterText)
}g.each(function(){c(this).after("<"+e.counterElement+' class="'+e.css+'">'+e.counterText+"</"+e.counterElement+">");
f(this);
c(this).keyup(function(){f(this)
});
c(this).change(function(){f(this)
})
})
}
})(jQuery,window,document);
(function(c,b,a,d){jQuery.fn.reviews_ratings=function(x){var h=c(this);
h.find("a.more-link").on("click",function(y){y.preventDefault();
f()
});
var n=PDC.Profile.getOnlineID();
if(!n){var u=h.find("div.reviewsratings-my-rating");
if(u.find("a")[0]){c(u.find("div.btn")).text(x.signInText)
}}var k=h.find("a.more-link");
var o=h.find("div.total");
var l=h.find("ul.reviews");
var m=l.children("li").last();
c(o).hide();
c(k).hide();
c(l).hide();
c("ul.reviews li:last-child").css({"padding-bottom":0});
var g=h.find(".sort select").selectbox({effect:"fade",speed:400,onChange:function(z,y){r(z)
}});
var r=function(y){k.attr("data-page","1");
k.attr("data-state","reset");
if(y){k.attr("data-sort",y)
}f(false)
};
var p=function(z){var B=z+"=";
var y=a.cookie.split(";");
for(var A=0;
A<y.length;
A++){var C=y[A];
while(C.charAt(0)==" "){C=C.substring(1,C.length)
}if(C.indexOf(B)==0){return C.substring(B.length,C.length)
}}return null
};
var f=function(y){var B=k.attr("data-page");
var z=g.val();
var A=k.attr("data-state");
if(B==d||B<1){B=1
}PDC.ReviewsRatings.getFeedback(x.reviewsServiceUrl,x.gameId,B,z,y,function(H){if(H.gameReviews>0){c(o).show();
c(k).show();
c(l).show();
var L=h.find("div.total h3");
var K=h.find("p.reviewsratings-rating-caption");
var C=K.attr("data-optional-rating-caption");
if(A=="initial"||A=="reset"){L.text(H.gameReviews+" "+L.attr("data-text"));
K.text(C.replace("#",H.gameReviews));
if(n&&n==H.list[0].authorId){var J=h.find("h3.reviewsratings-review-title");
J.text(J.attr("data-optional-review-title"));
var M=h.find("p.reviewsratings-review-caption");
M.text(M.attr("data-optional-review-caption"));
var I=M.attr("data-review-caption-link");
var N=h.find("div.reviewsratings-my-rating");
if(N.find("a")[0]){var E=N.find("a").attr("href");
N.find("a").remove();
N.append(c("<span>").addClass("stars"+H.list[0].reviewRating));
N.append(c("<h3>").text(N.attr("data-my-score-label")));
M.parent().append(c("<a>").attr("href",E).attr("data-review-text",H.list[0].reviewText).attr("data-review-rating",H.list[0].reviewRating).attr("data-review-title",H.list[0].reviewTitle).addClass("reviewsratings-review-edit").text(I).on("click",function(O){q(O,this,{comment:c(this).attr("data-review-text"),rating:c(this).attr("data-review-rating"),title:c(this).attr("data-review-title")})
}))
}else{var D=N.find("span")[0];
if(D){c(D).removeClass();
c(D).addClass("stars"+H.list[0].reviewRating)
}var G=M.parent().find("a")[0];
if(G){c(G).attr("data-review-text",H.list[0].reviewText).attr("data-review-rating",H.list[0].reviewRating).attr("data-review-title",H.list[0].reviewTitle)
}}}}if(A=="initial"){var F=h.find("h3.reviewsratings-rating-title");
F.text(F.attr("data-optional-rating-title"))
}else{if(A=="reset"){c("ul.reviews").empty()
}}c.each(H.list,function(T,X){if(!(B>1&&(n&&n==X.authorId))){var R=c("<p>").addClass("starRating").append(c("<span>").addClass("stars"+X.reviewRating)).append(c("<a>").attr("href","javascript:void(0);").text(X.authorId)).append(" "+x.ratedThisOnText+" "+X.updatedDate);
var S=c("<a>").attr("title",x.reportText).text(x.reportText).attr("href","javascript:void(0);").on("click",function(aa){var Z=c(h.find("ul.reviews")).attr("data-url");
w(aa,Z,X.authorId)
});
var Y=c("<div>").addClass("HeadingAndUserRating").append(c("<h3>").text(X.reviewTitle));
if(n&&!(n==X.authorId)){c(Y).append(c("<span>").append(S))
}c(Y).append(c("<br>").addClass("clear")).append(R);
var P=c("<div>").addClass("clear").append(c("<p>").text(X.reviewText));
var Q=c("<div>").addClass("commentsDetails").append(Y).append(P);
var W=c("<a>").append(c("<span>").addClass("classLike").text(x.likeText)).append(c("<span>").addClass("counter").text(X.reviewHelpFullVotes));
if(n&&n==X.authorId){c(W).css("cursor","default").addClass("commentsRatingsClicked")
}else{if(n){c(W).addClass("commentsRatings").attr("href","javascript:void(0);").on("click",function(aa){var Z={action:"updateReviewVote",gameId:x.gameId,author:X.authorId,userVote:"helpful"};
if(p("userinfo")){Z.userInfoCookie=p("userinfo")
}c.ajax({url:x.reviewsServiceUrl,type:"POST",dataType:"json",async:true,crossDomain:true,cache:false,data:Z,success:U})
})
}else{c(W).addClass("commentsRatingsNoClick")
}}var U=function(ab){c(W).off("click");
c(W).css("cursor","default");
c(W).removeClass().addClass("commentsRatingsClicked");
var Z=c(W).find("span.counter");
var aa=c(W).find("span.counter").text();
c(W).find("span.counter").text(parseInt(aa)+1)
};
var V=c("<img>").attr("width",60).attr("height",60).attr("alt",X.authorId);
var O=c("<li>").addClass("user").append(V).append(Q).append(W);
O.find("img").wrap('<div class="avatar" />');
O.children().last().wrap('<div class="ratings-wrap" />');
c("ul.reviews").append(O);
e(X.authorId,V)
}});
if(H.gameReviews>(parseInt(B)*5)){h.find("a.more-link").attr("data-page",parseInt(B)+1);
h.find("a.more-link").show()
}else{h.find("a.more-link").hide();
c("ul.reviews li:last-child").css({"padding-bottom":0})
}}else{c(o).hide();
c(k).hide();
c(l).hide();
c("ul.reviews li:last-child").css({"padding-bottom":0})
}})
};
var t=function(){var y=h.find("a.more-link");
PDC.ReviewsRatings.getRating(x.reviewsServiceUrl,x.gameId,function(A){if(A.averageGameRating>=0){var z=h.find("span.averagerating");
z.removeClass();
z.addClass("averagerating stars"+A.averageGameRating)
}})
};
var e=function(z,y){c.ajax({url:x.avatarServiceUrl+"/"+z,type:"GET",dataType:"json",success:function(A){y.attr("src",A.avatarUrl)
}})
};
var w=function(A,z,y){A.preventDefault();
c.colorbox({href:z,scrolling:true,overlayClose:true,photo:false,onOpen:function(){c("#colorbox").addClass("visible-ajax")
},onComplete:function(){var B=c("#colorbox");
var D=c("#rr");
var F=B.find("textarea");
var C=B.find('select[name="type"]');
var G=B.find("div.name h3");
var I=B.find(".errorBox");
var J=B.find("div.avtarHolder");
var H=B.find('form[name="report-abuse"]');
var E=PDC.Profile.getOnlineID();
b.addEventListener("resize",function(){if(c("#cboxOverlay").is(":visible")){c.colorbox.resize()
}},false);
D.find(".comment").focusin(function(){var K=c(this);
K.css("background","#fff").removeClass("red");
if(K.hasClass("comment")){if(K.val().indexOf("Write your comments")>-1){K.val("");
c.colorbox.resize()
}}}).focusout(function(){var K=c(this);
if(K.val()==""){if(K.hasClass("comment")){K.val("Write your comments here...")
}}});
F.on("click",function(){F.removeClass("error")
});
B.find("a.cancel").on("click",function(K){c.colorbox.close()
});
B.find("a.submit").on("click",function(N){N.preventDefault();
var M=true;
var L=F.val();
var O=C.val();
if(L===""||L===x.writeYourCommentsText){F.addClass("error");
I.show();
M=false
}if(M){var K={action:"reportAbuse",author:y,gameId:x.gameId,comment:L,option:O};
if(p("userinfo")){K.userInfoCookie=p("userinfo")
}c.ajax({url:H.attr("action"),type:"POST",dataType:"json",async:true,crossDomain:true,cache:false,data:K,success:function(P){c("#rr .write-form-wrapper").remove();
c("#rr .write-form-message").css({display:"table-cell"});
c("#wc div.module-wrap").show()
}})
}})
}})
};
var q=function(z,y,A){z.preventDefault();
if(!PDC.Profile.isLoggedIn()){b.location.href=c(y).attr("data-psn-signin");
return false
}c.ajax({type:"GET",url:c(y).attr("href"),async:true,crossDomain:true,cache:false,dataType:"html"}).done(function(D){pdclog("reviews-ratings: GET#success()");
c("#cr div.module-wrap").hide();
c(D).insertAfter(".reviewsratings div.headingWrapper");
var C=c("#wc");
var F=C.find("textarea");
var B=C.find(".st_rating");
var H=C.find(".rating-info");
var L=C.find("input.subject");
var N=C.find(".terms-checkbox");
var K=C.find(".checkTerms");
var J=C.find(".errorBox");
var I=C.find('form[name="write-comment"]');
var G=C.find("div.name h3");
var M=C.find("div.avtarHolder");
var E=PDC.Profile.getOnlineID();
C.find(".comment,.subject").focusin(function(){var O=c(this);
O.css("background","#fff").removeClass("red");
if(O.hasClass("comment")){if(O.val().indexOf("Write your review")>-1){O.val("");
c.colorbox.resize()
}}if(O.hasClass("subject")){if(O.val()=="Write your review subject here..."){O.val("");
c.colorbox.resize()
}}}).focusout(function(){var O=c(this);
if(O.val()==""){if(O.hasClass("comment")){O.val("Write your review here...")
}if(O.hasClass("subject")){O.val("Write your review subject here...")
}}});
if(E){G.text(E);
M.append(c("<img>").attr("src",PDC.Profile.getSmallAvatar()).attr("alt",E))
}if(A){if(A.comment){F.val(A.comment)
}if(A.rating&&A.rating>=1){c(B.find(".rating").children()[A.rating-1]).trigger("click")
}if(A.title){L.val(A.title)
}N.prop("checked",true)
}F.on("click",function(){F.removeClass("error")
});
B.on("click",function(){B.find("h3").removeClass("error")
});
L.on("click",function(){L.removeClass("error")
});
N.on("click",function(){K.find("label").removeClass("error")
});
C.find("a.cancel").on("click",function(O){c("#wc").remove();
c("#cr div.module-wrap").show()
});
C.find("a.submit").on("click",function(T){T.preventDefault();
var S=true;
var P=F.val();
var R=H.val();
var Q=L.val();
if(P===""||P===x.writeReviewText){F.addClass("error");
J.show();
S=false
}if(Q===""||Q===x.writeReviewSubject){L.addClass("error");
J.show();
S=false
}if(R===""){B.find("h3").addClass("error");
J.show();
S=false
}if(!N.is(":checked")){K.find("label").addClass("error");
J.show();
S=false
}if(S){var O={action:"updateReview",gameId:x.gameId,title:Q,comment:P,rating:R};
if(p("userinfo")){O.userInfoCookie=p("userinfo")
}pdclog("reviews-ratings: post review");
c.ajax({url:I.attr("action"),type:"POST",dataType:"json",async:true,crossDomain:true,cache:false,data:O,success:function(U){pdclog("reviews-ratings: post#success()");
PDC.SC.click("reviewsratings","submit","button",{events:["event33","event34"],vars:{event34:R}});
c("#cr div.module-wrap").show();
r();
c("#wc").remove()
}})
}});
c.fn.autoresize=function(P){var R=c.extend({debug:false},P),S=["font-family","font-size","font-weight","font-style","letter-spacing","text-transform","word-spacing","text-indent","line-height","padding-top","padding-bottom"],O={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};
function T(V){var U="<br />";
return(V+"<br />~").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1"+U+"$2")
}function Q(U){return U.replace(/[&<>"'\/]/g,function(V){return O[V]
})
}return this.each(function(){var V=c(this),U=c("<div></div>");
V.css("overflow","hidden");
c.each(S,function(W,X){U.css(X,V.css(X))
});
U.css({"word-wrap":"break-word",position:"absolute",height:"auto",width:V.width()});
if(R.debug===false){U.css({top:"-999em",left:"-999em"})
}else{U.css({top:"10px",left:"10px"})
}U.html(T(Q(V.val())));
c("body").append(U);
V.height(U.height());
V.bind("textchange",function(){U.html(T(Q(V.val())));
V.height(U.height())
})
})
};
c.event.special.textchange={setup:function(P,O){c(this).data("lastValue",this.contentEditable==="true"?c(this).html():c(this).val());
c(this).bind("keyup.textchange",c.event.special.textchange.handler);
c(this).bind("cut.textchange paste.textchange input.textchange",c.event.special.textchange.delayedHandler)
},teardown:function(O){c(this).unbind(".textchange")
},handler:function(O){c.event.special.textchange.triggerIfChanged(c(this))
},delayedHandler:function(P){var O=c(this);
setTimeout(function(){c.event.special.textchange.triggerIfChanged(O)
},25)
},triggerIfChanged:function(O){var P=O[0].contentEditable==="true"?O.html():O.val();
if(P!==O.data("lastValue")){O.trigger("textchange",[O.data("lastValue")]);
O.data("lastValue",P)
}}};
F.autoresize()
}).fail(function(){console.log("Document call fail")
})
};
f(true);
t();
var v=h.find(".createReview");
v.on("click",function(y){q(y,this)
})
}
})(jQuery,window,document);
(function(c,b,a,d){jQuery.fn.ratings=function(e,g){var f=this;
return this.each(function(){if(!g){g=0
}var o=this;
var h=jQuery(this);
var k=Array();
o.rating=g;
h.css("overflow","auto");
for(var n=0;
n<e;
n++){var m=a.createElement("div");
var l=jQuery(m);
m.rating=n+1;
l.addClass("jquery-ratings-star");
if(n<g){l.addClass("jquery-ratings-full")
}h.append(l);
k.push(l);
l.click(function(){f.triggerHandler("ratingchanged",{rating:this.rating});
o.rating=this.rating
});
l.click(function(){for(var p=0;
p<this.rating;
p++){k[p].addClass("jquery-ratings-full")
}for(var p=this.rating;
p<e;
p++){k[p].removeClass("jquery-ratings-full")
}});
h.mouseleave(function(){for(var p=0;
p<o.rating;
p++){k[p].addClass("jquery-ratings-full")
}for(var p=o.rating;
p<e;
p++){k[p].removeClass("jquery-ratings-full")
}})
}})
};
c.fn.starrating=function(f){var g=c(this);
var h={stars:5,starsSelector:".rating",starsValSelector:".rating-info"};
var f=c.extend(h,f);
var e=function(){g.find(f.starsSelector).ratings(f.stars).bind("ratingchanged",function(k,l){g.find(f.starsValSelector).val(l.rating)
})
};
return this.each(e)
}
})(jQuery,window,document);
(function(e,c,a,g){var d="sortBy",f={fakeTimeDelay:1000,loadingClassName:"loading",ajaxPath:"/ajax/",ajaxPrefix:"sort_",ajaxSeparator:"_",ajaxSuffix:".html"};
function b(k,h){this.element=k;
this.$element=e(this.element);
this.parentId=e(this.element).attr("id");
this.options=e.extend({},f,h);
this._defaults=f;
this._name=d;
this.init()
}b.prototype.init=function(){var l=this;
var h=this.$element.attr("data-target-id");
if(typeof h!="undefined"){l.sTargetId=h
}else{return
}var m=this.$element.attr("data-ajax-url");
if(typeof m!="undefined"){l.sAjaxUrl=m
}else{return
}c.PDC.SortByRequest=c.PDC.SortByAjaxRequest||{};
l.sLoadingContainerId=="";
var k=this.$element.attr("data-loading-container-id");
if(typeof k!="undefined"){l.sLoadingContainerId=k
}l.bReplaceContent=true;
var n=this.$element.attr("data-replace-content");
if(typeof n!="undefined"){l.bReplaceContent=(n=="true"?true:false)
}this.$element.find(".sort select").selectbox({effect:"fade",speed:400,onChange:function(q,p){var o="sortBy="+q;
l.updateResults(o)
}})
};
b.prototype.updateResults=function(k){var l=this,m=e(a.getElementById(l.sTargetId)),h=m,n=l.parentId;
if(l.sLoadingContainerId!=""){h=e(a.getElementById(l.sLoadingContainerId))
}if(typeof(c.PDC.SortByRequest[n])!="undefined"){c.PDC.SortByRequest[n].abort()
}c.clearTimeout(c.fakeContentTimeout);
h.addClass(l.options.loadingClassName);
c.PDC.SortByRequest[n]=e.ajax({url:l.sAjaxUrl+"?"+k,success:function(o){c.fakeContentTimeout=c.setTimeout(function(){var p=e(o);
if(l.bReplaceContent){m.html(p)
}else{m.append(p)
}e(c).trigger("filterChange");
h.removeClass(l.options.loadingClassName)
},l.options.fakeTimeDelay)
},error:function(o){}})
};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))
}})
}
})(jQuery,window,document);
(function(e,c,a,g){var d="selectDropdown",f={currentItemValue:"current"};
function b(k,h){this.element=k;
this.$element=e(this.element);
this.parentId=e(this.element).attr("id");
this.options=e.extend({},f,h);
this._defaults=f;
this._name=d;
this.init()
}b.prototype.init=function(){var h=this;
this.$element.find("select").selectbox({effect:"fade",speed:400,onChange:function(l,k){}})
};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))
}})
}
})(jQuery,window,document);
/*!
 * jQuery lightweight plugin boilerplate
 * Original author: @ajpiano
 * Further changes, comments: @addyosmani
 * Licensed under the MIT license
 * Original code (with comments) can be found at:
 * http://coding.smashingmagazine.com/2011/10/11/essential-jquery-plugin-patterns/
 */
(function(e,c,a,g){var d="reviewHighlight",f={displayTime:3000,fadeTime:500,quoteContainerSelector:".review-quotes",quoteActiveAreaSelector:".review-hover",activeClassName:"active",elementSelector:"section"};
function b(k,h){this.element=k;
this.parent=k.parentNode;
this.elementHeight=0;
this.timeoutId=0;
this.wasVisible=null;
this.isNowVisible=false;
this.options=e.extend({},f,h);
this._defaults=f;
this._name=d;
var l=e("html");
this.init()
}b.prototype.init=function(){var h=this,l=e(this.element),k=l.find(this.options.elementSelector);
if(k.length==1){return
}else{k.eq(0).addClass(h.options.activeClassName)
}this.updateDimensions();
e(c).on("scroll",function(){h.checkVisibility()
});
this.checkVisibility();
l.on({mouseenter:function(){h.pause()
},mouseleave:function(){h.queueNext(true)
},click:function(){h.queueNext()
}},this.options.quoteActiveAreaSelector)
};
b.prototype.updateDimensions=function(){var k=this.options.activeClassName,h=e(this.element),l=0;
h.find(this.options.elementSelector).each(function(m){var n=e(this);
n.show().css("display","block");
l=(n.height()>l)?n.height():l;
n.css("display","table-cell");
if(!n.hasClass(k)){n.hide()
}});
l+=6;
h.find(this.options.quoteContainerSelector).css("height",l+"px");
this.elementHeight=l
};
b.prototype.checkVisibility=function(){var h=e(this.element.parentNode).isVisible();
if((this.wasVisible!=h)||this.wasVisible==null){if(h){this.queueNext()
}else{this.pause()
}this.wasVisible=h
}};
b.prototype.pause=function(){c.clearTimeout(this.timeoutId);
var m=e(this.element),k=this.options.fadeTime,h=this.options.activeClassName,l=m.find("."+h).first();
l.stop(true,false).attr("style","").css("display","table-cell").siblings().hide()
};
b.prototype.next=function(){var n=this,o=e(this.element),l=this.options.fadeTime,k=this.options.activeClassName,m=o.find("."+k).first(),h=m.next().length?m.next():o.find(this.options.elementSelector).eq(0);
m.fadeOut(l,function(){m.removeClass(k).siblings().hide();
h.addClass(k).fadeIn(l,function(){n.queueNext()
})
})
};
b.prototype.queueNext=function(k){var h=this;
c.clearTimeout(this.timeoutId);
if(k){h.next()
}else{this.timeoutId=c.setTimeout(function(){h.next()
},this.options.displayTime)
}};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))
}})
}
})(jQuery,window,document);
(function(e,c,a,g){var d="productGrid",f={rowsPerPage:3};
function b(k,h){this.element=k;
this.$element=e(this.element);
this.$key=e(this.element).attr("id");
this.options=e.extend({},f,h);
this._defaults=f;
this._name=d;
this.init()
}b.prototype.init=function(){var h=this;
this.$element.find("a.more-link").on("click touchend",function(n){n.preventDefault();
var k=h.$element.find("div.items");
var m=h.$element.find("a.more-link");
var l=m.attr("data-next-page");
m.hide(0);
if(l){h.$ajaxLoader=e("<div>").attr({"class":"ajax-loader"}).appendTo(h.$element.find(".wrapper")).css({position:"relative",backgroundPosition:"top center",width:"100%",height:"40px","float":"left"});
e.ajax({url:l,type:"get",dataType:"html",success:function(p){h.$ajaxLoader.remove();
var o=e(p).find("a.more-link");
var q=o.attr("data-next-page");
m.attr("data-next-page",q);
e(p).find("div.item").appendTo(k).slideUp(0).slideDown(300);
if(e.browser.msie&&e.browser.version<9){e("body").append("<div />")
}m.show(0);
if(!o.attr("data-next-page")){h.initLessMore()
}},error:function(q,o,p){if(console){console.log(p)
}h.$ajaxLoader.remove()
}})
}});
e(".CM090-inlineTabs .wrapper .items").find(".item").setAllToMinGridHeight()
};
b.prototype.initLessMore=function(){var k=this;
var h=this.$element.find("a.more-link");
var l=k.$element.find(".item");
k.curPage=1;
h.find(".more").text("Less").css("backgroundPosition","right 3px");
h.off().on("click touchend",function(m){var n=k.options.rowsPerPage*k.curPage;
if(k.curPage<=1){l.slice(n,l.length).slideUp(300);
h.find(".more").text("More").css("backgroundPosition","")
}else{l.slice(0,n).slideDown(300)
}k.curPage++;
if(n>=l.length){k.initLessMore()
}})
};
e.fn.setAllToMinGridHeight=function(){return this.css("minHeight",Math.max.apply(this,e.map(this,function(h){return e(h).height()
})))
};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))
}})
}
})(jQuery,window,document);
(function(e,c,a,g){var d="productGridAjax",f={};
function b(k,h){this.element=k;
this.$element=e(this.element);
this.count=h.count;
this.param=h.param;
this.type=h.type;
this.url=h.url;
this.rawURL=c.location.href;
this.results=[];
this.$key=e(this.element).attr("id");
this.$wrapper=e(".wrapper",this.$element);
this.colletionRootSelector=".items";
this.size=50;
this.morelinkSelector="a.more-link";
this.options=e.extend({},f,h);
this._defaults=f;
this._name=d;
this.morelinkTemplate='<a class="more-link" index="@index"  href="javascript:void(0)"><span class="more">More</span></a>';
this.init()
}b.prototype.init=function(){this.setRawURL();
this.sendQuery()
};
b.prototype.setRawURL=function(){var k=c.location.pathname.length;
var h=this.rawURL.indexOf(c.location.pathname);
if(h>-1){this.rawURL=this.rawURL.substring(0,h+k)
}};
b.prototype.sendQuery=function(){var k=this.generateQuery();
var h=this;
this.searchPromoteInstance=PDC.searchBuffer.get({baseUrl:k,maxCount:50,filter:this.filter,filterContext:this,debugMode:false});
this.searchPromoteInstance.requestData(this.count,function(l,m,n){if(l&&l.length>0){h.addCollectionRoot();
h.addTiles(l);
h.createMoreLink(m)
}},function(m,l){})
};
b.prototype.filter=function(h){if(this.isAddOn()){if(h.url!==this.rawURL){return true
}else{return false
}}else{return true
}};
b.prototype.generateQuery=function(){var k=this.url;
if(this.url){var h=this.size;
if(this.isAddOn()){h=h+1
}k=k+"?count="+h;
if(this.param){k=k+"&"+this.param
}k=k+"&callback=?"
}return k
};
b.prototype.isAddOn=function(){if(this.type==="addon"){return true
}return false
};
b.prototype.addCollectionRoot=function(){this.$wrapper.append('<div class="items"></div>')
};
b.prototype.addTiles=function(k){for(var h=0;
h<k.length;
h++){var m=k[h];
var l=new ContentTile(m);
l.appendTo(e(this.colletionRootSelector,this.$wrapper))
}};
b.prototype.createMoreLink=function(k){if(!k){this.$wrapper.append(this.morelinkTemplate);
var h=this;
this.$element.on("click touchend",this.morelinkSelector,function(m){var l=this;
h.searchPromoteInstance.requestData(h.count,function(n,o,p){if(o){e(l).hide()
}if(n&&n.length>0){h.addTiles(n)
}},function(o,n){e(l).hide()
})
})
}};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))
}})
}
})(jQuery,window,document);
(function(e,c,a,g){var d="personalizedSection",f={};
function b(k,h){this.element=k;
this.$element=e(this.element);
this.options=e.extend({},f,h);
this._defaults=f;
this._name=d;
this.init()
}b.prototype.init=function(){var h=this;
var k=h.$element.data("show-state");
if((k==="notuser"&&PDC.Profile.isLoggedIn()===false)||(k==="notsubscriber"&&PDC.Profile.isLoggedIn()===true&&PDC.Profile.getPsPlus()==="false")||(k==="subscriber"&&PDC.Profile.isLoggedIn()===true&&PDC.Profile.getPsPlus()==="true")){h.$element.removeClass("hide")
}};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))
}})
}
})(jQuery,window,document);
(function(e,h,l,c){var p='    <div class="hover">';
p+='        <div class="tab">Video</div>';
p+='        <div class="tab-content">';
p+="            <p></p>";
p+="        </div>";
p+="    </div>";
var b='            <div class="button video">&nbsp;</div>';
var o='    <div class="primary media">';
o+='        <a href="" class="clearfix lb_youtube">';
o+=b;
o+=p;
o+="        </a>";
o+="    </div>";
var f='        <div class="media">';
f+='            <a href="" class="lb_youtube">';
f+=b;
f+=p;
f+="            </a>";
f+="        </div>";
var k='    <div class="secondary">';
k+=f;
k+=f;
k+="    </div>";
var n="<li>";
n+=o;
n+=k;
n+="</li> ";
var g="mediaCarousel",d={largeWidth:939,largeHeight:352,smallWidth:622,smallHeight:529,breakPoint:959};
function m(r,q){this.element=r;
this.$key=e(this.element).attr("id");
this.options=e.extend({},d,q);
this._defaults=d;
this._name=g;
this.init()
}function a(u,q){var r=false,t='<div class="media empty-media">&nbsp;</div>';
e(u).find("li .media.mediaItem:not(:has(a))").remove();
e(u).find("li").each(function(){var y=e(this),x=y.find(".media:not(.empty-media)"),w=x.size();
if(w==0){y.remove();
r=true
}else{if(w<3){var v=y.find(".secondary");
if(w==1){if(v.size()>0){v.remove()
}x.addClass("center")
}else{if(w==2){x.removeClass("center");
if(y.find(".media").size()==2){v.append(t)
}}}}else{x.removeClass("center")
}}});
if(r&&typeof q!="undefined"){q()
}}m.prototype.init=function(){var B=this.options,D=this,q=e(this.element),A,t,x=false,E,J,H=true,K=e(h).width(),G=this,v,w=0,u,F;
q.find(".next").addClass("mcnext"+this.$key);
q.find(".prev").addClass("mcprev"+this.$key);
q.find(".pages").addClass("mcpages"+this.$key);
A=q.find("ul");
A.find("li").last().each(function(){var L=e(this);
if(L.find("div.secondary").length===0){L.find("div.primary").addClass("center")
}});
function C(){A.carouFredSel({width:B.largeWidth,height:B.largeHeight,next:".mcnext"+D.$key,prev:".mcprev"+D.$key,pagination:".mcpages"+D.$key,infinite:false,circular:false,auto:false,scroll:1,items:{width:B.largeWidth,height:B.largeHeight},mousewheel:false})
}a(A);
C();
A.swipe({fingers:"all",swipeLeft:r,swipeRight:I,allowPageScroll:"auto",excludedElements:"button, input, select, textarea"});
function r(M,O,P,N,L){A.trigger("next",1)
}function I(M,O,P,N,L){A.trigger("prev",1)
}if(K<=B.breakPoint&&!x){x=true;
q.find("ul").trigger("configuration",{width:B.smallWidth,height:B.smallHeight,swipe:{onMouse:true,onTouch:true},items:{width:B.smallWidth,height:B.smallHeight}});
if(q.find("ul li").length<=1){q.css({})
}q.addClass("resize")
}console.log("ITEMS !!!! "+q.find("ul li").length);
if(q.find("ul li").length<1){q.find(".control-panel").remove()
}e(h).bind("resize",function(){var L=e(this).width();
if(L<=B.breakPoint&&!x){x=true;
q.find("ul").trigger("configuration",{width:B.smallWidth,height:B.smallHeight,swipe:{onMouse:true,onTouch:true},items:{width:B.smallWidth,height:B.smallHeight}});
if(q.find("ul li").length<=1){q.css({height:"529px"})
}q.addClass("resize")
}if(L>B.breakPoint&&x){x=false;
q.find("ul").trigger("configuration",{width:B.largeWidth,height:B.largeHeight,swipe:{onMouse:true,onTouch:true},items:{width:B.largeWidth,height:B.largeHeight}});
if(q.find("ul li").length<1){q.css({height:"353px"})
}q.removeClass("resize")
}});
if(e(".lt-ie8").length>0){var z=q.find(".control-panel").width()/2;
q.find(".control-panel").css({marginLeft:-z+"px"})
}var y=A.find("li a").map(function(L,M){var O=e(this),N=false;
w++;
if(u==c){u=O.attr("rel")
}if(O.hasClass("lb_ytPlaylist")){B.insertAt=w;
return G.processPlaylist(O,u,B.insertAt,A,C)
}});
e.when.apply(null,y.get()).then(function(){A.find("li a").each(function(){var P=e(this),O=false;
P.focus(function(V){var W=e(this),Y=W.parents("li"),R,U,S,Q=A.find("li"),T=Math.ceil(Q.length/N.length);
if(O){O=false;
t=null
}else{V.preventDefault();
O=true;
R=Q.index(Y);
U=Math.ceil((R+1)/N.length)-1;
S=A.triggerHandler("currentPage");
var X=(S+U);
if(X>T){X=X-T
}if(X===S){t=null;
W.focus()
}else{A.triggerHandler("slideToPage",X);
t=W
}}})
});
var N=A.triggerHandler("currentVisible"),M=A.find("a").first(),L=A.find("a").last();
a(A,C);
q.bind("keydown",function(S){var R=S.keyCode||S.which;
if(R==9){if(!S.shiftKey){var T=e(l.activeElement),P=T.parents("li"),Q=P.find("a").index(T);
S.preventDefault();
if(Q<2){var O=P.find("a:eq("+(Q+1)+")");
if(O.length){O.focus()
}else{q.find(".prev").focus()
}}else{var O=P.next("li").find("a:eq(0)");
if(O.length){O.focus()
}else{q.find(".prev").focus()
}}}else{if(M===e(l.activeElement)){M.blur()
}}}})
})
};
m.prototype.getYoutubeVideoID=function(t){for(var r=0;
r<t.link.length;
r++){if(t.link[r].rel=="related"){var q=t.link[r].href;
return q.replace(/.*\//,"").replace(/\?.*$/,"")
}}};
m.prototype.processPlaylist=function(v,C,t,u,A){var B=new jQuery.Deferred(),x=this,r=v.attr("data-playlist-id"),y=v.attr("data-playlist-startfrom"),q=v.attr("data-agethreshold"),w=(v.attr("data-playlist-hover")==="true");
if(!y){y=0
}else{if(y>0){y--
}}t--;
var z=false;
e.getJSON("//www.googleapis.com/youtube/v3/playlistItems?part=snippet&maxResults=50&playlistId="+r+"&key=AIzaSyAKRzl4h3hhO1X3imjDNBNFkgqmiBhzk_U&alt=json&callback=?",function(F){z=true;
var K=e(".CM106-lead-product-info").filter(function(){$a=e(this).find(".overlay").parent("a");
return $a.hasClass("lb_ytPlaylist")&&$a.attr("data-playlist-id")==r
});
if(K.length>0){K={overlay:K.find(".overlay"),startFrom:K.find(".overlay").parent("a").attr("data-playlist-startfrom")}
}var L=u.find("div.media").slice(t+1).not(".empty-media");
var D=L.clone();
L.find("img").remove();
L.first().parents("li").nextAll().each(function(){u.trigger("removeItem",e(this))
});
var E=u.find("li").index(L.first().parents("li")),G=u.find("li:eq("+E+")"),J,H=true,I=F.items.length-1;
if(E<0){E=0;
G=u.find("li:eq(0)")
}u.find("li .secondary a img").click(function(){PDC.SC.click("imagecarousel",this,"image")
});
u.find("li .secondary a img").click(function(){PDC.SC.click("imagecarousel",this,"image")
});
e.each(F.items,function(R,U){var Q="no";
if(e(U).isVideoItemAgeGated){if(e(U).isVideoItemAgeGated()){Q="yes"
}}var N=U.snippet.title,M=U.snippet.resourceId.videoId,O="//www.youtube.com/watch?v="+M,P;
if(K.overlay&&R==0){K.overlay.getProductInfoVideoFromYTFeed(U,e(K.overlay).parent("a").attr("data-playlist-hover"))
}if(R>=y){J=(t+R-y)%3;
if(J==0&&!H){u.trigger("insertItem",[e(n),"end"]);
E++;
G=u.find("li:eq("+E+")")
}H=false;
P=G.find("div.media:eq("+J+")").find("a");
if(P.length===0){if(J===1){G.append(k);
G.find(".primary").removeClass("center")
}if(J===2){G.find(".secondary").append(f)
}P=G.find("div.media:eq("+J+")").find("a")
}else{var S=P.parent();
S.html("<a>"+b+"</a>");
P=S.find("a")
}P.attr("href",O).addClass("lb_youtube").removeClass("lb_ytPlaylist").attr("rel",C).attr("data-agegating",Q).attr("data-agethreshold",q).append('<img src="//img.youtube.com/vi/'+M+'/hqdefault.jpg" class="ytImage" />');
if(w){if(P.find(".hover").length==0){P.append(p)
}P.attr("href",O).find(".hover .tab-content p").text(N).parent().find(".tab").text("VIDEO")
}else{P.attr("href",O).find(".hover").remove()
}if(e.fn.pdcLightbox){P.pdcLightbox()
}}if(I==R){var T=J;
I=D.length-1;
D.each(function(V,W){J=(1+V+T)%3;
if(J==0){u.trigger("insertItem",[e(n),"end"]);
E++;
G=u.find("li:eq("+E+")")
}G.find("div.media:eq("+J+")").find("a").replaceWith(e(W).find("a"))
});
if(J==0){G.find(".secondary").remove();
G.find(".primary").addClass("center")
}if(J==1){G.find(".secondary .media:eq(1)").empty().addClass("empty-media")
}if(e.fn.pdcLightbox){u.find("li .media a").pdcLightbox()
}if(PDC.updateTilePreset){PDC.updateTilePreset(u.find("li .primary a img"),true);
PDC.updateTilePreset(u.find("li .secondary a img"),false)
}B.resolve()
}})
});
setTimeout(function(){if(!z){var D=jQuery.inArray(e("a[data-playlist-id='"+r+"']")[0],u.find("a"));
u.find("a").slice(D).each(function(E){if(u.find("a").slice(D).size()+1==E){e(u.find("a")[(E)]).remove()
}else{var F=e(u.find("a")[(E+D+1)]).clone(true);
e(u.find("a")[(E+D)]).replaceWith(F)
}});
a(u,A)
}},5000);
return B.promise()
};
e.fn[g]=function(q){return this.each(function(){if(!e.data(this,"plugin_"+g)){e.data(this,"plugin_"+g,new m(this,q))
}})
}
})(jQuery,window,document);
(function(f,c,a,h){var e="leadProductInfo",g={scrollTime:500,videoIndex:0};
function b(l,k){this.element=l;
this.parent=l.parentNode;
this.options=f.extend({},g,k);
this._defaults=g;
this._name=e;
this.element=f(this.element);
this.init()
}function d(m){for(var l=0;
l<m.link.length;
l++){if(m.link[l].rel=="related"){var k=m.link[l].href;
return k.replace(/.*\//,"").replace(/\?.*$/,"")
}}return"unknown"
}f.fn.getProductInfoVideoFromYTFeed=function(l,k){pdclog("-- getProductInfoVideoFromYTFeed");
this.each(function(){$overlay=f(this);
var o=l.snippet.resourceId.videoId,n="//www.youtube.com/watch?v="+o;
var m="no";
if(f(l).isVideoItemAgeGated){if(f(l).isVideoItemAgeGated()){m="yes"
}}if(k==="true"){if($overlay.find(".hover").length==0){$overlay.append('<div class="hover"><div class="tab">VIDEO</div><div class="content"><p></p></div></div>')
}$overlay.find(".hover .content p").html(l.snippet.title)
}else{}$overlay.find(".button").parent().append('<img src="//img.youtube.com/vi/'+o+'/hqdefault.jpg" class="ytImage" />');
$overlay.parent("a").attr("href",n).addClass("lb_youtube").attr("data-agegating",m).removeClass("lb_ytPlaylist");
if(f.fn.pdcLightbox){$overlay.parent("a").pdcLightbox()
}})
};
b.prototype.init=function(){var t=this.options,z=this.element,p=z.find(".overlay"),E=f("div.prod-media > a.more-link",z),x=t.scrollTime,y=p.parent("a").attr("data-playlist-id"),D=p.parent("a").attr("data-playlist-hover"),r=false,n=f("div.prod-media");
function B(){f.getJSON("//www.googleapis.com/youtube/v3/playlistItems?part=snippet&maxResults=50&playlistId="+y+"&key=AIzaSyAKRzl4h3hhO1X3imjDNBNFkgqmiBhzk_U&alt=json&callback=?",function(F){var o=F.items[t.videoIndex];
r=true;
p.getProductInfoVideoFromYTFeed(o,D)
})
}if(y!=h){var k=f(".cm109-mediaCarousel li .media a"),C=this,q=k.length;
if(q>0){k.each(function(){var o=f(this);
if(o.attr("data-playlist-id")==y){r=true;
return
}q--;
if(!q){B()
}})
}else{B()
}setTimeout(function(){if(!p.hasClass("donothide")&&!r){z.find(".prod-media").remove()
}},10000)
}if(E.length){var v=f(".cm109-mediaCarousel");
var w=f(".cm109-mediaCarousel").closest("section");
var l=f("#sony-header-bar")?f("#sony-header-bar").outerHeight():0;
var A=f(".toplevelnav")?f(".toplevelnav").outerHeight():0;
var u=f(".contextualnav ")?f(".contextualnav ").outerHeight():0;
if(v.length){var m=parseInt(v.css("paddingTop"),10);
E.show();
E.on("click",function(o){o.preventDefault();
f("html, body").animate({scrollTop:parseInt(w.offset().top,10)-(l+A+u)},x)
}).addClass("visible")
}}else{}if(!n.length){f(".CM106-lead-product-info .prod-meta ul").addClass("release-info-no-lb")
}};
f.fn[e]=function(k){return this.each(function(){if(!f.data(this,"plugin_"+e)){f.data(this,"plugin_"+e,new b(this,k))
}})
}
})(jQuery,window,document);
/*!
 * jQuery lightweight plugin boilerplate
 * Original author: @ajpiano
 * Further changes, comments: @addyosmani
 * Licensed under the MIT license
 * Original code (with comments) can be found at:
 * http://coding.smashingmagazine.com/2011/10/11/essential-jquery-plugin-patterns/
 */
(function(e,c,a,g){var d="gotWantOne",f={wantSelector:".want-one",gotSelector:".got-one",iconSelector:".icon",textSelector:"h4",dataType:"jsonp",jsonpCallback:"functionCall",initialisedClassName:"initialised",activeClassName:"active",selectedClassName:"selected",disabledClassName:"disabled",itemUUIDQueryStringKey:"uuid",returnUrlQueryStringKey:"postSignInUrl",wantStatusQueryStringKey:"userWant"};
function b(k,h){this.element=k;
this.$element=e(k);
this.parent=k.parentNode;
this.options=e.extend({},f,h);
this._defaults=f;
this._name=d;
this._intialised=false;
this._toggleLock=false;
this._want=false;
this._got=false;
this._returnUrl=encodeURI(c.location.href.split("?")[0]);
this.init()
}b.prototype.init=function(){var h=this.options;
this.$got=this.$element.find(h.gotSelector);
this.$want=this.$element.find(h.wantSelector);
this.$wantIcon=this.$want.find(h.iconSelector);
this.$wantText=this.$want.find(h.textSelector);
this.itemUUID=this.$wantIcon.data("uuid");
this.signInUrl=this.$wantIcon.data("sign-in-url");
this.ajaxUrl=this.$wantIcon.data("ajax-url");
if(this.isSignedIn()==true){this.getCurrentStatusFromServer()
}else{this.updateUI();
this.initialiseComplete()
}};
b.prototype.getCurrentStatusFromServer=function(){var h=this,k=h.options,l={};
if(typeof(h._xhr)!="undefined"){h._xhr.abort()
}l[k.itemUUIDQueryStringKey]=h.itemUUID;
h._xhr=e.ajax({dataType:k.dataType,jsonpCallback:k.jsonpCallback,url:h.ajaxUrl,xhrFields:{withCredentials:true},data:l,success:function(m){h.processServerResponse(m);
h.initialiseComplete();
h.processPendingUserAction()
},error:function(m,o,n){},complete:function(m,n){}})
};
b.prototype.processServerResponse=function(h){if(h.error){}else{if(String(h.user.got)=="true"){this.setGot(h.user.got,true)
}else{this.setGot(h.user.got,false);
this.setWant(h.user.want,false)
}}};
b.prototype.processPendingUserAction=function(){if(this.hasGot()){return
}if(c.location.search.length==0){return
}var q=this.options,m=c.location.search.substring(1).split("&"),h="",k="";
var l=m.length;
while(l--){var n=m[l].split("="),p=n[0];
if(p==q.itemUUIDQueryStringKey){k=decodeURIComponent(n[1]);
if(k!=this.itemUUID){return
}}if(p==q.wantStatusQueryStringKey){h=n[1]
}}if(h!=""&&k!=""){this.setWant(h,true)
}};
b.prototype.updateUI=function(){var h=this.options;
if(this.isInitialised()==false){if(this.hasGot()){if(this.$want.length!=0){this.$want.remove()
}return
}else{if(this.$got.length!=0){this.$got.remove();
this.attachClickHandler()
}}}if(this.doesWant()){this.$wantIcon.addClass(h.activeClassName);
this.$wantText.html(this.$wantText.data("active-text"))
}else{this.$wantIcon.removeClass(h.activeClassName);
this.$wantText.html(this.$wantText.data("inactive-text"))
}};
b.prototype.attachClickHandler=function(){var h=this,k=h.options;
h.$element.on("click",k.iconSelector,function(l){l.preventDefault();
h.toggleButton(this)
})
};
b.prototype.updateCurrentStatusOnServer=function(){var h=this,k=h.options,l={};
if(h.isSignedIn()){l[k.itemUUIDQueryStringKey]=this.itemUUID;
l[k.wantStatusQueryStringKey]=this.doesWant();
if(typeof(h._xhr)!="undefined"){h._xhr.abort()
}h._xhr=e.ajax({dataType:"jsonp",jsonpCallback:k.jsonpCallback,url:h.ajaxUrl,xhrFields:{withCredentials:true},data:l,success:function(m){if(typeof(h._timeout)!="undefined"){c.clearTimeout(h._timeout)
}h._timeout=c.setTimeout(function(){},2000)
},error:function(m,o,n){},complete:function(m,n){}})
}else{this.logUserIn()
}};
b.prototype.logUserIn=function(){var k=this.options;
var h=this.signInUrl+"?";
h+=k.returnUrlQueryStringKey+"="+this._returnUrl+"&";
h+=k.itemUUIDQueryStringKey+"="+this.itemUUID+"&";
h+=k.wantStatusQueryStringKey+"="+this.doesWant();
c.location.href=h
};
b.prototype.toggleButton=function(h){if(!this.isToggleLocked()){this.lockToggle();
var k=e(h),l=k.data("toggle-type");
this.toggleWant();
this.updateUI();
this.unlockToggle()
}};
b.prototype.isSignedIn=function(){return this.$wantIcon.data("signed-in")
};
b.prototype.initialiseComplete=function(){this._intialised=true;
this.$element.addClass(this.options.initialisedClassName)
};
b.prototype.isInitialised=function(){return this._intialised
};
b.prototype.toggleWant=function(){this._want=!this._want;
this.updateCurrentStatusOnServer()
};
b.prototype.returnBoolean=function(k,h){if(typeof(k)!="undefined"){switch(String(k)){case"true":return(true);
case"false":return(false);
default:return(h)
}}else{return h
}};
b.prototype.setWant=function(l,k){var h=this.doesWant(),m=this.returnBoolean(l,h);
if(m!=h){this._want=m;
if(k){this.updateCurrentStatusOnServer()
}}this.updateUI()
};
b.prototype.setGot=function(k,h){this._got=this.returnBoolean(k,this._got);
if(h){this.updateUI()
}};
b.prototype.doesWant=function(){return this._want
};
b.prototype.hasGot=function(){return this._got
};
b.prototype.lockToggle=function(){this._toggleLock=true
};
b.prototype.unlockToggle=function(){this._toggleLock=false
};
b.prototype.isToggleLocked=function(){return this._toggleLock
};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))
}})
}
})(jQuery,window,document);
(function(d,f,k,b){var e="leadProductInfo-reviewsRatingsWishlist",c={dataType:"json"};
function l(n,m){var o=m||{};
this.sku=o.sku;
this.showReviewsRatings=m.showReviewsRatings;
this.showScore=m.showScore;
this.reviewsRatingsUrl=m.reviewsRatingsUrl;
this.wishlistServiceUrl=m.wishlistServiceUrl;
this.signinUrl=m.signinUrl;
this.signinUrl=this.signinUrl.replace(/postSignInURL=[^&]+/,"postSignInURL="+encodeURI(k.location.href+"#signin-complete"));
this.$score=d(n).find(".item.score");
this.$ratings=d(n).find(".item.user-rating");
this.$wantgot=d(n).find(".item.want");
this.userinfo=d.cookie("userinfo");
this.init()
}var a={init:function(o){if(o.$score.length==1){o.$score.show()
}else{if(o.$score.length>1){var n=o.$score.length;
var m=Math.round(Math.random()*n);
if(m==n){m--
}console.log("INDEX: "+m);
d(o.$score.get(m)).show()
}}}};
var h={init:function(m){pdclog("ratings: init");
PDC.ReviewsRatings.getRating(m.reviewsRatingsUrl,m.sku,function(n){pdclog("leadproduct: rating count");
pdclog(n);
if(n.averageGameRating>=0){m.$ratings.find(".value div").removeClass("count-0").addClass("count-"+n.averageGameRating)
}});
PDC.ReviewsRatings.getFeedback(m.reviewsRatingsUrl,m.sku,null,"dateReviewed",true,function(n){pdclog("xx leadproduct: review count");
pdclog(n);
m.$ratings.find(".info .review-count").text(n.gameReviews)
})
}};
var g={wantAction:function(m){PDC.SC.click("leadproductinfo","want it","image",{events:["event52"]});
d.ajax({url:m.wishlistServiceUrl,type:"POST",data:{gameId:m.sku,action:"addToWishList",userInfoCookie:m.userinfo},dataType:"json",success:function(n){pdclog("wishlist save");
pdclog(n);
if(n.status==1){m.$wantgot.find("div.want-one").hide();
m.$wantgot.find("div.got-one").show()
}else{pdclog("wantAction: ");
pdclog(n)
}},error:function(p,o,n){pdclog("wishlist error #2: "+o);
pdclog(n)
}})
},init:function(m){if(!m.wishlistServiceUrl){pdclog("no url defined")
}else{if(m.userinfo){pdclog("checking wishlist");
d.ajax({url:m.wishlistServiceUrl,type:"POST",data:{gameId:m.sku,action:"isGameInWishList",userInfoCookie:m.userinfo},dataType:"json",success:function(n){pdclog("wishlist check");
pdclog(n);
if(n.status==1){m.$wantgot.find("div.want-one").hide();
m.$wantgot.find("div.got-one").show();
m.$wantgot.find("a.want-icon").off("click")
}else{pdclog("wishlist: not saved")
}},error:function(p,o,n){pdclog("wishlist error: "+o);
pdclog(n)
},failure:function(n){pdclog("failure: "+n)
}});
m.$wantgot.find("a.want-icon").click(function(){pdclog("wishlist: clicked auth");
g.wantAction(m)
})
}else{pdclog("wishlist: not logged in");
m.$wantgot.find("a.want-icon").click(function(){pdclog("wishlist: clicked anon");
PDC.SC.click("leadproductinfo","want it","image",{events:["event52"]});
k.location=m.signinUrl
})
}}}};
l.prototype.init=function(){pdclog("RRW init");
g.init(this);
a.init(this);
if(this.showReviewsRatings=="true"){h.init(this)
}};
d.fn[e]=function(m){pdclog(e,m);
return this.each(function(){if(!d.data(this,"plugin_"+e)){d.data(this,"plugin_"+e,new l(this,m))
}})
}
})(jQuery,window,document);
(function(e,c,a,g){var d="inlineTabs",f={fakeTimeDelay:1000,selectedClassName:"selected",loadingClassName:"loading",activeClassName:"active",contentContainerSelectorPrefix:".content-",disabledClassName:"type-disabled",tabSelector:".in-line-tab-item",headerTabSelector:".tab-heading",activeSelector:".active",wrapperSelector:".wrapper",initialTab:".tab-1",tabIndexClassPrefix:"tab-"};
function b(k,h){this.element=k;
this.$element=e(this.element);
this.options=e.extend({},f,h);
this._defaults=f;
this._name=d;
this.init();
if(!CQ||!CQ.WCM||(CQ&&CQ.WCM&&CQ.WCM.getMode()!=null&&CQ.WCM.getMode()!="edit")){this.hideEmptyTab()
}}b.prototype.init=function(){var h=this;
if(e.fn.getURLVar("q")){e(this.options.tabSelector+this.options.initialTab,this.$element).each(function(){e(this).removeClass(h.options.disabledClassName).addClass(h.options.selectedClassName).siblings().removeClass(h.options.selectedClassName)
});
e(".in-line-tab-item",this.$element).each(function(){h.triggerQuery(e(this))
})
}this.$element.on("click",this.options.tabSelector,function(k){k.preventDefault();
var m=e(this),l=h.$element;
if(m.hasClass(h.options.disabledClassName)){return false
}if(typeof m.attr("data-next-page")=="undefined"){m.addClass(h.options.selectedClassName).siblings().removeClass(h.options.selectedClassName);
l.find(h.options.activeSelector).removeClass(h.options.activeClassName);
l.find(h.options.headerTabSelector+"."+m.attr("header-class")).addClass(h.options.activeClassName).siblings().removeClass(h.options.activeClassName);
e(a.getElementById(m.attr("data-content-id"))).addClass(h.options.activeClassName)
}else{h.triggerQuery(m,true)
}})
};
b.prototype.triggerQuery=function(l,p){var m=e(l);
var k=m.attr("data-next-page"),o=m.attr("data-content-id"),n=m.attr("data-ajax-cache");
var h=(this.$element.find(this.options.wrapperSelector).css("display")=="none");
if(h){return
}if(k&&o){$targetContainer=e(a.getElementById(o));
sCount=$targetContainer.attr("count");
if(sCount){if(k.indexOf("?")!=-1){k=k+"&count="+sCount
}else{k=k+"?count="+sCount
}}if(p){m.addClass(this.options.selectedClassName).siblings().removeClass(this.options.selectedClassName)
}this.$element.find(this.options.activeSelector).prepend("<div class='ajax-loader'> </div>");
e(c).trigger("single_tab_query",[k,$targetContainer,n,m,this.options.fakeTimeDelay,p])
}};
b.prototype.hideEmptyTab=function(){this.$element.find(".content").each(function(){var m=e(this);
var n=null;
var o=m.text();
if(o&&o.replace(/\s+/g,"")==""){n=m.find(".wrapper");
pdclog(["inlinetabs: evaluated text is empty! ",m])
}else{pdclog("inlinetabs: not empty: ",m)
}if(n!=null){m.hide();
m.siblings().each(function(){if(e(this).css("display")!="none"){e(this).addClass("active")
}});
var k=n.find(">.content").index(m);
var l=".tab-wrapper .tabs a:eq("+k+")";
var h=n.find(l);
if(h){h.hide();
h.siblings().each(function(){if(e(this).css("display")!="none"){e(this).addClass("active");
e(this).addClass("selected")
}})
}}})
};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))
}})
}
})(jQuery,window,document);
(function(c,f,h,a){var e="imageCarWheel",b={};
function k(n,m){this.element=n;
this.$element=c(this.element);
this.options=c.extend({},b,m);
this._defaults=b;
this._name=e;
var l=this;
var o;
c(f).bind("resize orientationchange",function(){clearTimeout(o);
o=setTimeout(function(){l.$element.find("ul").trigger("destroy");
l.init()
},300)
});
l.init()
}var d=function(){function m(t,p,w,A,q,z,y){var x=t.parentNode,v=2;
if(9===x.nodeType){return true
}if("0"===l(t,"opacity")||"none"===l(t,"display")||"hidden"===l(t,"visibility")){return false
}if("undefined"===typeof p||"undefined"===typeof w||"undefined"===typeof A||"undefined"===typeof q||"undefined"===typeof z||"undefined"===typeof y){p=t.offsetTop;
q=t.offsetLeft;
A=p+t.offsetHeight;
w=q+t.offsetWidth;
z=t.offsetWidth;
y=t.offsetHeight
}if(x){if(("hidden"===l(x,"overflow")||"scroll"===l(x,"overflow"))&&t.offsetParent===x){if(q+v>x.offsetWidth+x.scrollLeft||q+z-v<x.scrollLeft||p+v>x.offsetHeight+x.scrollTop||p+y-v<x.scrollTop){return false
}}if(t.offsetParent===x){q+=x.offsetLeft;
p+=x.offsetTop
}return m(x,p,w,A,q,z,y)
}return true
}function l(o,n){if(f.getComputedStyle){return h.defaultView.getComputedStyle(o)[n]
}if(o.currentStyle){return o.currentStyle[n]
}}return{getStyle:l,isVisible:m}
}();
var g=function(){var l=c(".imageWheelCarousel");
l.css("visibility","visible");
l.find(".container-block").remove();
for(j=0;
j<l.length;
j++){var m=0;
var n=c(".imageWheelCarousel:eq("+j+") ul li");
boxLength=Math.floor(n.length);
n.each(function(o,p){if(d.isVisible(this)){m++
}});
modulusBlock=boxLength%m;
if(modulusBlock!=0){for(i=0;
i<m;
i++){blockLength=(parseInt(boxLength)+parseInt(i));
if(blockLength%m!=0){c(".imageWheelCarousel:eq("+j+") ul").trigger("insertItem","<li class='container-block'><div></div></li>","end")
}else{i=m
}}}}};
k.prototype.init=function(){var p=this.$element.attr("id"),r=this.$element,o=r.find("ul"),l,m=this;
m.$carDom?o.html(m.$carDom.html()):m.$carDom=o.clone();
r.find(".next").addClass("bcnext"+p);
r.find(".prev").addClass("bcprev"+p);
r.find(".pages").addClass("bcpages"+p);
var n=r.find("ul").children("li:first").width();
var q=c(f).width()<=960?3:4;
o.carouFredSel({auto:false,circular:false,infinite:false,items:{width:n,height:"auto",visible:{max:q}},next:".bcnext"+p,prev:".bcprev"+p,pagination:".bcpages"+p,responsive:true,swipe:{onMouse:true,onTouch:true,options:{excludedElements:"button, input, select, textarea"}},width:null,height:200,scroll:{onAfter:function(u){if(l!=null){l.focus()
}}},onCreate:function(u){r.find("div.loader").hide();
o.show();
g()
}});
var t=o.triggerHandler("currentVisible");
o.find("li a").each(function(){var v=c(this);
var u=false;
v.focus(function(B){var C=c(this),E=C.parents("li"),x,A,y,w=o.find("li"),z=Math.ceil(w.length/t.length);
if(u){u=false;
l=null
}else{B.preventDefault();
u=true;
x=w.index(E);
A=Math.ceil((x+1)/t.length)-1;
y=o.triggerHandler("currentPage");
var D=(y+A);
if(D>z){D=D-z
}if(D===y){l=null;
C.focus()
}else{o.triggerHandler("slideToPage",D);
l=C
}}})
});
r.bind("keydown",function(w){var v=w.keyCode||w.which;
if(v==9){var x=o.triggerHandler("currentVisible"),y=c(h.activeElement),u=y.parents("li");
if(w.shiftKey){if(y.is(".bcnext"+p)){w.preventDefault();
x.last().find("a").focus()
}}else{if(x.index(u)===x.length-1){w.preventDefault();
c(".bcnext"+p).focus()
}}}});
if(typeof c.fn.pdcLightbox==="function"){c(".lb_imageWheel").pdcLightbox()
}};
c.fn[e]=function(l){return this.each(function(){if(!c.data(this,"plugin_"+e)){c.data(this,"plugin_"+e,new k(this,l))
}})
}
})(jQuery,window,document);
(function(e,c,a,g){var d="hugeHeroBanner",f={sectionOffset:0,moveNextSection:true,pullUpClassNames:["headingWrapper","moduleComponent"],scriptBlocker:true,videoIncluded:true};
function b(k,h){this.element=k;
this.$element=e(k);
this.parent=k.parentNode;
this.$banner=e(k).find(".banner-wrapper");
this.$animatelayers=e(k).find(".layer:visible");
this.$movingLayers=e(k).find(".wiggle");
this.$background=e(k).find("#huge-hero-banner-bg");
this.useVideo=e("html").hasClass("video");
this.options=e.extend({},f,h);
this._defaults=f;
this._name=d;
this.init()
}b.prototype.init=function(){var w=this,q=false,x=e(w.element),u=x.parents("section"),C=u.next("section"),m=w.$banner,r=m.find(".load-layer"),B=r.length,o=1,D=false;
blockerClosed=true,$loader=x.find(".loader-wrapper"),$canvas=e(".progress-bar"),startBannerFlag=false,$video=e(w.element).find(".intro-video"),videoObject=$video[0],$ageValidated=e(".age-validated").length>0;
this.$element.find(".content-wrap .title-award-left").css({top:this.$element.find(".layer-heading .text-lock-up").outerHeight(true)+54});
if($ageValidated){blockerClosed=true
}$loader.show();
if(w.useVideo&&videoObject){function k(){o=0
}videoObject.oncanplaythrough=k();
if(w.options.videoIncluded&&w.useVideo){var n=$canvas.get(0),z=1,y=n.getContext("2d");
y.fillStyle="gray";
if(videoObject.buffered){videoBuffer=c.setInterval(function(){var F=videoObject.buffered;
if(F){for(var G=0;
G<F.length;
G++){var H=F.start(G)/videoObject.duration*n.width,E=F.end(G)/videoObject.duration*n.width;
y.fillRect(H+z,z,Math.max(z*2,E-H-z*2),n.height-z*2);
if(!o||videoObject.readyState==4){D=true;
c.clearInterval(videoBuffer);
v()
}}}},500)
}}else{$canvas.remove();
o=0
}}else{v()
}function v(){r.each(function(){var F=e(this);
var E=F.attr("data-background")+"?nocache="+new Date().getTime();
e("<img/>").attr("src",E).load(function(){B--;
if(!B){if(!w.useVideo){startBannerFlag=true;
h()
}else{if(w.options.scriptBlocker){if(blockerClosed&&D){startBannerFlag=true;
h()
}}else{if(D){startBannerFlag=true;
h()
}}}}})
})
}if(this.options.scriptBlocker&&!$ageValidated){blockerClosed=false;
e(c).bind("bannerBlockerClosed",function(E){blockerClosed=true;
if(!B&&D||!w.useVideo){h()
}})
}if(/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent)){q=true
}if(w.options.moveNextSection){C.css({position:"relative",top:w.options.sectionOffset+"px"});
var t=C.children("div"),p=false;
t.each(function(){var E=e(this);
e.each(w.options.pullUpClassNames,function(F,G){if(E.hasClass(G)){p=true;
return false
}});
if(p){return false
}});
C.find("> :first-child")
}function h(){$loader.hide();
w.playVideo(q)
}var A=Modernizr.touch,l=e("html.lt-ie8").length>0;
if(!A&&!l){e(c).bind("scroll",function(){var H=e(c).scrollTop();
var F=e(c).height();
var E=(1-(H/F)*3);
var G=-3-((H/F)*30);
w.$element.find(".left-shapes").css("left",G+"%");
w.$element.find(".right-shapes").css("right",G+"%");
w.$element.find(".fadeItem").css({opacity:E})
})
}if(A){w.backgroundIn=true;
if(typeof ScrollControl==="undefined"){ScrollControl=new ScrollrControllr()
}ScrollControl.register({trigger:w.$element,onScrollTo:function(){w.$background.show()
},onScrollFrom:function(){w.$background.hide()
}})
}e(c).resize(function(){w.relativePosition();
w.$movingLayers.each(function(){w.resetCss(this);
var E=w.setPosition(this)
})
})
};
b.prototype.initAnimate=function(m){var l=0;
var k=this;
var h=k.$animatelayers.length;
k.$animatelayers.on("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(n){l++;
if(l==h){k.$animatelayers.each(function(){e(this).removeClass("animate");
k.setPosition(this)
});
k.relativePosition();
if(!m){k.bindMouseMove()
}k.$animatelayers.off("webkitAnimationEnd oanimationend msAnimationEnd animationend")
}})
};
b.prototype.playVideo=function(o){var m=this;
var l=m.$banner;
var k=e(m.element).find(".intro-video");
var h=l.find(".layer");
if(o){k.remove();
n()
}else{if(k.length&&m.useVideo){l.hide();
k.fadeIn(100);
k.get(0).play();
h.removeClass("animate").hide();
if(Modernizr.video){k.bind("ended",function(){k.fadeOut("200",function(){n()
})
})
}else{k.hide();
n()
}}else{n()
}}function n(){l.fadeIn(1,function(){h.each(function(){var p=e(this);
if(p.parent().is(":visible")){e(this).addClass("animate")
}e(this).show()
});
m.$animatelayers=e(m.element).find(".layer:visible");
m.initAnimate(o)
});
return
}};
b.prototype.getWindowWidth=function(){var h=this;
if(e(c).width()>=1600){h.disableBkgMove=true
}else{h.disableBkgMove=false
}};
b.prototype.bindMouseMove=function(){var k=this,h=e(this);
e(k.element).bind("mousemove",l(function(o){var p=o.pageY,q=o.pageX;
var n=h.attr("windowCenterX");
var m=h.attr("windowCenterY");
k.$movingLayers.each(function(){var w=e(this);
var y=w.attr("data-distance");
var x=n-q;
var r=x/n;
var v=m-p;
var t=v/m;
var u=e(c).width()-(parseInt(w.attr("data-offset-right"))+(r*y));
k.animateLayer(w,u,y)
})
},20));
function l(n,m){var o=null;
return function(){var q=this,p=arguments;
clearTimeout(o);
o=setTimeout(function(){n.apply(q,p)
},m)
}
}};
b.prototype.animateLayer=function(k,h,l){k.animate({right:h},{queue:false,duration:1500+(l*10),easing:"easeOutSine"})
};
b.prototype.relativePosition=function(m){var o=this,n=e(this),h=e(m);
var l=Math.floor(e(o.element).width()/2);
var k=Math.floor(e(o.element).height()/2);
n.attr("windowCenterX",l);
n.attr("windowCenterY",k);
return
};
b.prototype.setPosition=function(m){var n=this,k=e(m);
var q=k.offset(),l=q.left,p=q.left+k.outerWidth(),h=q.top;
var o={layerX:p,layerY:h};
k.attr("data-offset-left",l);
k.attr("data-offset-right",p);
return(o)
};
b.prototype.resetCss=function(k){var l=this,h=e(k);
h.css({right:h.attr("data-right-pos"),left:""})
};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))
}})
}
})(jQuery,window,document);
(function(c,b,a,d){c(a).ready(function(){function e(){var B=c("#CM001_homeHero"),R=this,aC=c("div.foreground-container",B),D=c("div.background-container",B),ar=c("div.pagination-container",aC),n=c(".thumbnail",ar),aF=c("div.left-shapes",B),al=c("div.right-shapes",B),G=c(".slide",D),ad=c(".slide",aC),y="loading",x="slide-",p=false,F="stopped",o=0,ay="loaded",U="paused",N=c(".slide",D).length-1,am=-1,av=[],aB=1,P=1,w=0.5,aE="ease-in-out",u="<style type='text/css'>",T,g=false,aD=-1,W,E,ax=[],ah,v,aq,m,X,A=0.7,an,ak,aA,z,C,ag=false,ap=false,S=false,Q="undefined"!==typeof(b.innerHeight)?b.innerHeight:a.documentElement.offsetHeight,aw,V=false,ai=[],az=1024,aj=420,f=5000,L=10000,r;
var M={};
function ae(t){return"-webkit-transition: "+t+";\n-moz-transition: "+t+";\n-ms-transition: "+t+";\n-o-transition: "+t+";\ntransition: "+t+";\n"
}function ac(){pdclog("-- homeherobanner: transBlock");
g=true;
b.clearTimeout(aD);
aD=b.setTimeout(function(){g=false
},an)
}function aa(t){t.bVideo=false;
t.$bg.toggleClass("video image").find("video").remove()
}function H(aH,aG){if(Modernizr.video&&!Modernizr.touch){aH.bVideo=true;
aH.$video=c("video",aG);
aH.$video[0].volume=0;
aH.$video.on("ended",function(){if(aH.slide===o){this.setAttribute("currentTime",0);
this.play()
}});
ai.push(aH)
}else{aa(aH)
}}function au(){if(ax[o].bVideo){V=false;
ax[o].$video[0].pause()
}}function at(){if(ax[o].bVideo){var t=ax[o].$video[0];
V=true;
if(t.readyState>0){t.currentTime=0
}t.play()
}}function ab(){b.clearTimeout(am);
ar.addClass(U);
ap=true;
au()
}if(Modernizr.csstransitions){an=(w*2+aB)*1000;
W=function(){pdclog("-- homeherobanner: nextSlide");
ac();
var t=o;
do{o=++o<=N?o:0;
if(o===t){break
}}while(!ax[o].loaded);
B.attr("class",x+o);
at();
if(!p){X()
}};
E=function(){pdclog("-- homeherobanner: prevSlide");
ac();
var t=o;
do{o=--o>=0?o:N;
if(o===t){break
}}while(!ax[o].loaded);
B.attr("class",x+o);
at();
if(!p){X()
}};
ah=function(t){this.$thumb=t;
this.time=t.data("time");
this.slide=t.data("slide");
av.push((this.time+aB+w)*1000);
u+="#CM001_homeHero."+x+this.slide+" .pagination-container ."+x+this.slide+" .blue-timer{\n";
u+=ae("opacity "+w+"s "+aE+" "+w+"s, height "+this.time+"s linear "+(aB+w)+"s");
u+="}\n";
u+="#CM001_homeHero."+x+this.slide+" .pagination-container .narrow .pagination-"+this.slide+"{\n";
u+=ae("background-position "+this.time+"s linear "+(aB+w)+"s");
u+="}\n";
u+="#CM001_homeHero."+x+this.slide+" .pagination-container .portrait .pagination-"+this.slide+"{\n";
u+=ae("background-position "+this.time+"s linear "+(aB+w)+"s");
u+="}\n";
this.$bg=G.filter("."+x+this.slide);
this.image={wide:this.$bg.find("div.wide div"),narrow:this.$bg.find("div.narrow div"),portrait:this.$bg.find("div.portrait div")};
if(this.$bg.hasClass("video")){H(this,this.$bg)
}else{this.bVideo=false
}this.loaded=false
};
aq=function(){p=true;
B.attr("class",x+o+" "+F);
at()
};
X=function(){var t=o<=N?o:0;
if(typeof s!=="undefined"){var aG={type:"impression"};
PDC.SC.find_sc_provider(ax[t].$thumb[0],aG);
aG.events=["event5"];
aG.vars={list1:"pos"+t+":homeherobanner:"+(aG.material_name?aG.material_name.esc_sc():"null")+":"+s.pageName.esc_sc_ns()};
PDC.SC.click("homeherobanner","pos-"+t,"image",aG)
}b.clearTimeout(am);
am=b.setTimeout(function(){pdclog("-- homeherobanner: nextSlide");
W();
if(M[t]==null||M[t]<3){if(M[t]==null){M[t]=0
}M[t]++
}},av[t])
};
C=function(){var t=y+" loader";
B.removeClass(t);
if(ax[o].bVideo){at()
}if(!r){if(typeof s!=="undefined"&&(typeof CQ_Analytics.ClientContextMgr.areStoresInitialized==="undefined"||!CQ_Analytics.ClientContextMgr.areStoresInitialized)){c(a).on("sitecatalystAfterCollect",function(){X()
})
}else{X()
}}ag=true;
b.setTimeout(function(){aC.addClass(ay);
aF.addClass(ay);
al.addClass(ay);
S=true
},(w+P)*1000)
};
aw=function(){ap=false;
ar.removeClass(U);
at();
X()
}
}else{ak=c("div.narrow > div",aC);
w*=1000;
aB*=1000;
an=(w*2+aB)*1100;
aA=Modernizr.bgpositionxy?{"background-position-y":"126px"}:{backgroundPosition:"0 126"};
ah=function(t){this.$thumb=t;
this.time=t.data("time")*1000;
av.push(this.time+aB+w);
this.slide=t.data("slide");
this.$bg=G.filter("."+x+this.slide);
this.$fg=ad.filter("."+x+this.slide);
this.$timer=c("div.blue-timer",this.$thumb);
this.$thumbGreyBox=c("div.grey-overlay",this.$thumb);
this.$narrowTimer=ak.filter(".pagination-"+this.slide);
this.image={wide:this.$bg.find("div.wide div"),narrow:this.$bg.find("div.narrow div"),portrait:this.$bg.find("div.portrait div")};
if(this.$bg.hasClass("video")){H(this,this.$bg)
}else{this.bVideo=false
}this.loaded=false
};
m=function(){pdclog("homeherobanner: animateTimer");
ax[o].$timer.stop().css({opacity:1,height:"100%",display:"block"}).animate({height:"0px"},ax[o].time,"linear");
ax[o].$narrowTimer.stop().css({backgroundPosition:"0 0"}).animate(aA,ax[o].time,"linear")
};
v=function(t){pdclog("homeherobanner: transitionSlides");
if(t!==o){b.clearTimeout(aD);
g=true;
ax[t].$fg.animate({opacity:0},w,function(){ax[o].$bg.css("z-index","3").animate({top:"0%"},aB,function(){ax[o].$fg.css("top","0").animate({opacity:1},w,function(){if(!p){X();
m();
B.attr("class",x+o)
}else{B.attr("class",x+o+" "+F)
}g=false;
ax[t].$fg.removeAttr("style");
ax[o].$bg.removeAttr("style");
ax[o].$fg.removeAttr("style")
})
})
});
ax[t].$thumbGreyBox.animate({opacity:A},w+aB/2,function(){ax[o].$thumbGreyBox.animate({opacity:0},w+aB/2,function(){ax[t].$thumbGreyBox.removeAttr("style")
})
});
ax[t].$timer.animate({opacity:0},{duration:w+aB/2,complete:function(){pdclog("homeherobanner: transitionSlides.complete");
if(!p){ax[o].$timer.css({height:"100%",opacity:0,display:"block"}).animate({opacity:1},w+aB/2)
}},queue:false})
}};
W=function(){var t=o;
do{o=++o<=N?o:0;
if(o===t){break
}}while(!ax[o].loaded);
v(t,p);
at()
};
E=function(){var t=o;
do{o=--o>=0?o:N;
if(o===t){break
}}while(!ax[o].loaded);
v(t,p);
at()
};
aq=function(t){pdclog("homeherobanner: snapToSlide");
p=true;
v(t);
B.addClass(F);
at()
};
X=function(){b.clearTimeout(am);
am=b.setTimeout(function(){pdclog("homeherobanner: queueNext");
W()
},ax[o].time)
};
C=function(){pdclog("homeherobanner: start");
var t=y+" loader";
g=true;
if(Modernizr.generatedcontent){B.css({backgroundImage:"none"})
}aF.css({backgroundImage:"none"}).animate({height:"330px",bottom:"-10%",marginLeft:"0px",marginBottom:"0px",left:"0px"},{duration:w,step:function(aH,aI){if(aI.prop==="marginLeft"){var aG=(1-aH/aI.start)*30;
aF.css({"-ms-transform":"rotate(-"+aG+"deg)",transform:"rotate(-"+aG+"deg)"});
al.css({"-ms-transform":"rotate("+aG+"deg)",transform:"rotate("+aG+"deg)"})
}}});
al.animate({height:"330px",bottom:"-10%",marginRight:"0px",marginBottom:"0px",right:"0px"},w);
c(".shape",B).animate({maxWidth:"160px"},w);
D.animate({opacity:1},w,function(){aC.animate({opacity:1},w,function(){B.removeClass(t);
m();
g=false;
S=true;
ag=true;
if(ax[o].bVideo){at()
}X()
})
})
};
aw=function(){ap=false;
ar.removeClass(U);
at();
m()
}
}function h(){pdclog("-- homeherobanner: initParallax");
if(!Modernizr.touch){if("undefined"===typeof z){z=new ScrollrControllr()
}z.register({trigger:B,onScroll:function(t){var aG=(t/Q)*2;
if(S){aC.css({opacity:(1-aG),display:Math.floor(1-aG)<0?"none":"block"});
aF.css({left:-105*aG+"px"});
al.css({right:-105*aG+"px"})
}},onScrollFrom:function(){if(!ap){ab()
}},onScrollTo:function(){aw()
}})
}}function q(){ad.on("click",function(aJ){try{mboxTrack("mbox_conversion","action=marqueeClicked")
}catch(aJ){}pdclog("foreground click");
var aK=c(aJ.target).closest("a, .slide");
var aH=(aK.hasClass("slide"))?aK.data("href"):aK.attr("href");
var t=(aK.hasClass("slide"))?"image":(aK.parent().hasClass("info-video")?"video":"button");
if(t==="video"){return
}if(typeof aH!=="undefined"&&aH!==null&&aH!==""&&typeof s!=="undefined"){var aI={};
PDC.SC.find_sc_provider(this,aI);
console.log(aI);
var aG="pos"+o+":homeherobanner:"+(aI.material_name?aI.material_name.esc_sc():"null")+":"+s.pageName.esc_sc_ns();
PDC.SC.click("homeherobanner","pos-"+o,t,{events:["event6"],vars:{list1:aG,prop41:aG,eVar41:aG},open:aH,cid:true,material_id:aI.material_id,material_name:aI.material_name})
}else{if(aK.hasClass("slide")&&typeof aH!=="undefined"&&aH!==null&&aH!==""){b.location=aH
}}})
}function l(){n.on("click",function(){var aG=c(this).data("slide");
if(!g&&!B.hasClass(x+aG)&&ax[aG].loaded){if(typeof s!=="undefined"){var aI={type:"impression"};
PDC.SC.find_sc_provider(ax[aG].$thumb[0],aI);
aI.events=["event5","event66"];
var aH="thumbnail-pos"+aG+":"+(aI.material_name?aI.material_name.esc_sc():"null")+":homeherobanner:"+s.pageName.esc_sc_ns();
var t="pos"+aG+":homeherobanner:"+(aI.material_name?aI.material_name.esc_sc():"null")+":"+s.pageName.esc_sc_ns();
aI.vars={list1:t,prop49:aH,eVar49:aH};
PDC.SC.click("homeherobanner","null","thumbnail-pos"+aG,aI)
}var aJ=o;
o=aG;
b.clearTimeout(am);
aq(aJ);
ac()
}});
c(".narrow a.prev,.portrait a.prev",ar).on("click",function(t){t.preventDefault();
if(!g){b.clearTimeout(am);
p=true;
E();
ac();
B.addClass(F)
}});
c(".narrow a.next,.portrait a.next",ar).on("click",function(t){t.preventDefault();
if(!g){b.clearTimeout(am);
p=true;
W();
ac();
B.addClass(F)
}});
c(".CC027_heroActionPanel a.double-arrow-down").on("click",function(t){t.preventDefault();
c("html, body").animate({scrollTop:Q-300})
})
}function Y(){if("undefined"===typeof z){z=new ScrollrControllr()
}var t=ai.length;
z.register({onResize:function(){Q="undefined"!==typeof(b.innerHeight)?b.innerHeight:a.documentElement.offsetHeight;
B.height(Q);
if(t){var aH,aI=B.width(),aG=B.height();
for(aH=0;
aH<t;
aH+=1){ai[aH].$video.removeAttr("style");
var aJ=ai[aH].$video.height();
if(aJ>=aG){ai[aH].$video.css({top:"50%",marginTop:-aJ/2})
}else{ai[aH].$video.css({left:"50%",marginLeft:-ai[aH].$video.width()/2})
}}}}})
}function J(t,aG){if(ax[t].image[aG].length){ax[t].loaded=false;
var aH=new Image();
aH.index=t;
aH.onload=function(){ax[this.index].image[aG].css("background-image","url("+this.src+")");
ax[this.index].$thumb.removeClass(y);
ax[this.index].loaded=true;
if(!ag&&this.index===0){C()
}};
aH.src=ax[t].image[aG].attr("data-src")
}}function Z(t){var aG;
for(aG=0;
aG<=N;
aG+=1){J(aG,t)
}}function k(){var aG,t,aJ;
if(b.matchMedia===d){var aK=c(b),aI;
if(aK.width()<=az){Z("narrow");
aI="wide"
}else{if(aK.width()<=aj){Z("portrait");
aI="narrow"
}else{Z("wide");
aI="narrow"
}}aK.on("resize.lazyLoad",function(){if(t){b.clearTimeout(t)
}t=b.setTimeout(function(){Z(aI);
aK.off("resize.lazyLoad")
},400)
})
}else{aG=b.matchMedia("(max-width: "+az+"px)");
aJ=b.matchMedia("(min-device-width : 320px) and (max-device-width : 480px)");
if(aG.matches){if(aJ.matches){Z("portrait");
aG.addListener(function aH(){Z("narrow");
aG.removeListener(aH)
})
}else{Z("narrow");
aG.addListener(function aH(){Z("wide");
aG.removeListener(aH)
})
}}else{Z("wide");
aG.addListener(function aH(){Z("narrow");
aG.removeListener(aH)
})
}}}function K(t){var aG=t.$video[0];
if(!aG.buffered||!aG.buffered.end(0)){b.clearTimeout(aG.firstVideoSlideTimer);
b.clearTimeout(aG.nthVideoSlideTimer);
aa(t);
return false
}else{return true
}}function I(){var t=o;
if(K(ax[0])){do{o=++o<=N?o:0;
if(o===0){break
}}while(!ax[o].loaded)
}if(o){B.attr("class",x+o);
ac();
C()
}else{ax[0].$video[0].firstVideoSlideTimer=b.window.setTimeout(I(),f)
}}function ao(aG){var t=aG.$video[0];
aG.$thumb.removeClass(y);
aG.loaded=true;
b.clearTimeout(t.firstVideoSlideTimer);
b.clearTimeout(t.nthVideoSlideTimer);
if(!ag&&t.slideIndex===0){C()
}}function O(){var t,aG=ai.length-1;
for(t=0;
t<=aG;
t+=1){var aH=ai[t].$video[0];
aH.index=t;
aH.slideIndex=ai[t].slide;
ai[t].loaded=false;
aH.firstVideoSlideTimer;
aH.nthVideoSlideTimer;
if(aH.slideIndex===0){aH.firstVideoSlideTimer=b.window.setTimeout(I,f)
}else{aH.firstVideoSlideTimer=b.window.setTimeout(function(){K(ax[aH.slideIndex])
},f)
}aH.nthVideoSlideTimer=b.window.setTimeout(function(){aa(ax[aH.slideIndex])
},L);
ai[t].$video.oncanplaythrough=ao(ai[aH.index])
}}function af(){pdclog("-- homeherobanner: init");
if(n.length==1){B.addClass("single-slide loading");
r=true
}for(T=0;
T<n.length;
T+=1){ax[T]=new ah(n.eq(T))
}if(Modernizr.csstransitions){u+="</style>";
c(u).appendTo("head")
}if(r){Z("narrow");
Z("wide");
Z("portrait");
h();
q();
return
}else{k()
}O();
l();
Y();
h();
q()
}af()
}new e()
})
}(jQuery,window,document));
(function(f,c,a,h){var e="heroInfoBar",g={scrollTime:500,videoIndex:0,mediaType:"",mediaId:""};
function b(l,k){this.element=l;
this.parent=l.parentNode;
this.options=f.extend({},g,k);
this._defaults=g;
this._name=e;
this.element=f(this.element);
this.init()
}function d(m){for(var l=0;
l<m.link.length;
l++){if(m.link[l].rel=="related"){var k=m.link[l].href;
return k.replace(/.*\//,"").replace(/\?.*$/,"")
}}return"unknown"
}b.prototype.init=function(){var p=this.options,n=this.element,l=n.find(".vid-image"),m=l.parent("a").attr("data-playlist-id");
function k(){f.getJSON("//www.googleapis.com/youtube/v3/playlistItems?part=snippet&maxResults=50&playlistId="+m+"&key=AIzaSyAKRzl4h3hhO1X3imjDNBNFkgqmiBhzk_U&alt=json&callback=?",function(q){var o=q.items[p.videoIndex];
ytJSON=true;
pdclog("loadPlaylist");
pdclog(o);
l.each(function(){l=f(this);
var u=o.snippet.resourceId.videoId,t="//www.youtube.com/watch?v="+u;
var r="no";
if(f(o).isVideoItemAgeGated){if(f(o).isVideoItemAgeGated()){r="yes"
}}l.parent("a").attr("href",t).addClass("lb_youtube").attr("data-agegating",r).removeClass("lb_ytPlaylist");
if(f.fn.pdcLightbox){l.parent("a").pdcLightbox()
}})
})
}if(m!=h){k()
}};
f.fn[e]=function(k){return this.each(function(){if(!f.data(this,"plugin_"+e)){f.data(this,"plugin_"+e,new b(this,k))
}})
}
})(jQuery,window,document);
(function(e,c,a,g){var d="heroBanner",f={sectionOffset:0,contentOffset:-40,moveNextSection:true,pullUpClassNames:["headingWrapper","moduleComponent","moduleComponentOverflow"]};
function b(k,h){this.element=k;
this.$element=e(k);
this.parent=k.parentNode;
this.options=e.extend({},f,h);
this._defaults=f;
this._name=d;
this.init()
}b.prototype.init=function(){var n=Modernizr.touch,l=e(".lt-ie8").length>0,k=this.$element,r=this.options,h=k.parents(".bannerWrapper"),m=h.siblings(".content_par");
if(r.moveNextSection){m.css({position:"relative",top:r.sectionOffset+"px"});
if(!m.hasClass("pull-up")){m.addClass("pull-up")
}var p=m.find("section:first").children(".headingWrapper");
if(typeof(p)==="undefined"||p===null||p.length==0){p=m.find(".page-section-par:first")
}p.css({position:"relative",marginTop:r.contentOffset+"px"})
}if(typeof ScrollControl==="undefined"){ScrollControl=new ScrollrControllr()
}if(!n&&!l){ScrollControl.registerScrollListener(function(){q(arguments)
},k)
}function q(v){var w=v[0],t=e(c).height(),o=(1-(w/t)*3),u=-3-((w/t)*30);
k.find(".left-shapes").css("left",u+"%");
k.find(".right-shapes").css("right",u+"%");
k.find(".fadeItem").css({opacity:o})
}e(".image-wrap",this.$element).on("click",function(){var t=e(this).data("href");
var o=e(this).data("href-external");
if(typeof t!=="undefined"&&t!==null&&t!==""){if(typeof s!=="undefined"){PDC.SC.click("herobanner",this,"button",{linktitle_override:"textval",textval:"shop now"})
}if(o){c.open(t);
return false
}else{c.location.href=t
}}})
};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))
}})
}
})(jQuery,window,document);
(function(a){$gameFeatures=function(d,c){var f={};
var e=this;
e.settings={};
var b=a(d),d=d;
e.init=function(){e.settings=a.extend({},f,c);
var g=e.settings;
b.find(".feature-items").find("li").setAllToMaxHeight();
b.find(".feature-items").find(".text-wrap").setAllToMaxHeight()
};
e.init()
};
a.fn.setAllToMaxHeight=function(){return this.height(Math.max.apply(this,a.map(this,function(b){return a(b).height()
})))
};
a.fn.gameFeatures=function(b){return this.each(function(){if(undefined==a(this).data("gameFeatures")){var c=new $gameFeatures(this,b);
a(this).data("gameFeatures",c)
}})
}
})(jQuery);
(function(a){a.gameTileHover=function(e,d){var g={delay:500};
var b=a(e);
var h=a(".window",b);
var c=a(".content",b);
var k=true;
var f=this;
f.settings={};
f.init=function(){f.settings=a.extend({},g,d);
if(!Modernizr.touch){$gameTiles=a(".game-tile")
}};
f.init()
};
a.fn.gameTileHover=function(b){return this.each(function(){if(undefined==a(this).data("gameTileHover")){var c=new a.gameTileHover(this,b);
a(this).data("gameTileHover",c)
}})
}
})(jQuery);
(function(e,c,a,g){var d="CM091_gameTiles",f={};
function b(k,h){this.element=k;
this.$element=e(this.element);
this.options=e.extend({},f,h);
this._defaults=f;
this._name=d;
this.init()
}b.prototype.init=function(){var h=1000;
var k=this.$element;
k.find("li").each(function(){e(this).css({zIndex:h});
h-=10
});
var h=100;
e("section").slice(1).each(function(){e(this).css({zIndex:h});
h-=10
})
};
if(navigator.appVersion.indexOf("MSIE 7.")!=-1){e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))
}})
}
}else{e.fn[d]=function(){return false
}
}})(jQuery,window,document);
(function(d,g,h,b){var f="GameGrid_Auto",c={layout:"layout-type-1",smallImagePreset:"GameTile_Small",largeImagePreset:"GameTile_Large",ageRatingImagePreset:"GameTile_AgeRatingLogo",layoutLargIndex:["1","3","2"],initialTiles:4,showMoreTiles:4,morelinkTemplate:'<a class="more-link" href="javascript:void(0)"><span class="more">More</span></a>'};
function e(l){if(l=="layout-type-4"){return true
}}function a(m){try{var n={coming_soon:"coming_soon",just_released:"out_now",out_this_week:"out_this_week"};
var o=m.split(".query.");
queryType=o[1].replace(".json","");
m=m+"?x1=content_type&q1=Game&x2=release_cat&q2="+n[queryType]
}catch(l){console.log("error appending Query")
}return m
}function k(m,l){this.element=m;
this.$element=d(this.element);
this.$key=d(this.element).attr("id");
this.options=d.extend({},c,l);
this._defaults=c;
this._name=f;
this.$ul=d("ul",this.$element);
this.url=this.options.url;
this.morelinkSelector="a.more-link";
this.init()
}k.prototype.init=function(){var l=this;
this.searchPromoteInstance=PDC.searchBuffer.get({baseUrl:a(this.url),debugMode:false});
this.searchPromoteInstance.requestData(this.options.initialTiles,function(m,n,o){if(m&&m.length>0){l.showTab();
l.addTiles(m);
l.createMoreLink(n)
}else{l.hideTab()
}},function(n,m){l.hideTab()
})
};
k.prototype.createMoreLink=function(m){if(!m){this.$element.append(this.options.morelinkTemplate);
var l=this;
this.$element.on("click touchend",this.morelinkSelector,function(o){o.preventDefault();
var n=this;
l.searchPromoteInstance.requestData(l.options.showMoreTiles,function(p,q,r){if(q){d(n).hide()
}if(p&&p.length>0){l.addTiles(p)
}},function(q,p){d(n).hide()
})
})
}};
k.prototype.getNextIndex=function(){var l=this.$ul.find("li").length+1;
return"tile-"+l
};
k.prototype.addTiles=function(l){if(l){for(var n=0;
n<l.length;
n++){var q=l[n];
var p=new PDC.GameTileTemplate();
for(var m in q){p[m]=q[m]
}this.appendTile(p)
}}};
k.prototype.appendTile=function(n){var l=this.getNextIndex();
var m=this.options.layout;
if(l&&m&&typeof l==="string"&&typeof m==="string"){if(e()){n.addPreset(this.options.smallImagePreset)
}else{if(l=="tile-1"){n.addPreset(this.options.largeImagePreset)
}else{n.addPreset(this.options.smallImagePreset)
}}n.addAgeRatingPreset(this.options.ageRatingImagePreset)
}if(e()){this.$ul.addGameTile(n,l)
}else{this.$ul.addGameTile(n,m+" "+l)
}};
k.prototype.hideAndSetActive=function(l){if(l){l.hide();
l.siblings().each(function(){if(d(this).css("display")!="none"){d(this).addClass("active");
d(this).addClass("selected");
return false
}})
}};
k.prototype.hideTab=function(){var o=true;
if(CQ&&CQ.WCM&&CQ.WCM.getMode()=="edit"){o=false
}if(o){var p=this.$element.parent();
this.hideAndSetActive(p);
var m=p.parents().find(">.content").index(p);
var n=".tab-wrapper .tabs a:eq("+m+")";
var l=p.parents().find(n);
this.hideAndSetActive(l)
}};
k.prototype.showAndSetActive=function(l){if(l){l.show();
l.removeClass("active");
l.removeClass("selected")
}};
k.prototype.showTab=function(){var o=this.$element.parent();
o.show();
var m=o.parents().find(">.content").index(o);
var n=".tab-wrapper .tabs a:eq("+m+")";
var l=o.parents().find(n);
this.showAndSetActive(l)
};
d.fn[f]=function(l){return this.each(function(){if(!d.data(this,"plugin_"+f)){d.data(this,"plugin_"+f,new k(this,l))
}})
}
})(jQuery,window,document);
(function(e,c,a,g){var d="CM094_gameGrid",f={initialTiles:4,showMoreTiles:4};
function b(k,h){this.element=k;
this.$element=e(this.element);
this.$key=e(this.element).attr("id");
this.options=e.extend({},f,h);
this._defaults=f;
this._name=d;
this.init()
}b.prototype.init=function(){var l=this,r=l.options,n=l.$element.find("ul"),p=l.$element.find("a.more-link"),k=n.find("li").length,q=k,h=r.initialTiles;
for(var m=0;
m<r.initialTiles;
m++){n.find("li").eq(m).removeClass("hidden")
}if(k>r.initialTiles){p.removeClass("hidden")
}this.$element.find("a.more-link").on("click touchend",function(t){t.preventDefault();
if(h<k){for(var o=h;
o<(h+r.showMoreTiles);
o++){n.find("li").eq(o).removeClass("hidden")
}h+=r.showMoreTiles
}q=k-h;
if(q<=0){p.hide()
}})
};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))
}})
}
})(jQuery,window,document);
(function(d){var f={onlyType:["out_now","coming_soon"],fakeTimeDelay:1000,resultsParentSelector:"#results",resultsSelector:"#results-list",messageSelector:".error-server",defaultMessageSelector:"p.info",smallImagePreset:"GameTile_Small",largeImagePreset:"GameTile_Large",ageRatingImagePreset:"GameTile_AgeRatingLogo",layout:"largeTile"};
function a(h){if(c(h)){return 13
}else{return 16
}}function c(h){if(h=="largeTile"){return true
}}function b(h,m){var k=false;
if(h&&h.length&&m){for(var l=0;
l<h.length;
l++){if(m===h[l]){k=true;
break
}}}return k
}function g(k,o,h){for(var m in o){var p=o[m];
if(b(h,m)){for(var l=0;
l<h.length;
l++){var n=h[l];
if(k[n]){delete k[n]
}}}if(p=="all"){if(k[m]){delete k[m]
}}else{k[m]=p
}}}var e=function(){this.nCurrentDummyURLindex=0;
this.nCurrentPage=1;
this.template='<li class="$sequence $index "></li>';
this.aCurrentSearchQuery={content_type:"Game"};
this.SEQUENCE=["primary-highlights","cross-sell-highlights"];
this.isPublish=false;
if(typeof CQ.WCM=="undefined"){this.isPublish=true
}};
e.prototype.init=function(k){var h=this;
this.loaderHtml='<div class="more-loader"></div>';
this.defaults=d.extend(f,k);
this.$resultsParent=d(this.defaults.resultsParentSelector);
this.$resultsContainer=this.$resultsParent.find(this.defaults.resultsSelector);
this.$message=(d(this.defaults.messageSelector).find(".parsys").html().length>1)?this.$resultsParent.find(this.defaults.messageSelector):this.$resultsParent.find(this.defaults.defaultMessageSelector);
d(window).on("setFilter",function(l,m){h.setFilter(m)
});
d(window).on("filterChange",function(l,m){h.onFilterChange(l,m)
})
};
e.prototype.replaceResults=function(h){var l=this,k=this.$resultsParent.parents(".gameFinder").find(".game-finder-data-url");
if(l.isPublish){this.$message.hide()
}this.$resultsParent.addClass("loading");
this.$resultsContainer.html();
if(typeof this.searchPromoteInstance!="undefined"){this.searchPromoteInstance.terminate()
}this.searchPromoteInstance=PDC.searchBuffer.get({baseUrl:k.attr("data-href")+"?"+h,debugMode:false});
this.searchPromoteInstance.requestData(a(this.defaults.layout),function(m,n,o){l.onDataReady(m,n,o,true)
},function(n,m){l.$resultsParent.removeClass("loading");
l.$resultsContainer.siblings("a").remove();
l.$resultsContainer.empty();
l.$message.show()
})
};
e.prototype.updateResults=function(){var h=this;
if(h.isPublish){this.$message.hide()
}this.searchPromoteInstance.requestData(a("smallTile"),function(k,l,m){h.onDataReady(k,l,m,false)
},function(l,k){h.$resultsParent.removeClass("loading");
h.$resultsContainer.siblings("a").remove();
h.$resultsContainer.empty();
h.$message.show()
})
};
e.prototype.createMore=function(){var l=this,k=this.$resultsParent.find("#gamefinder-More").attr("value"),h=d('<a href="#" class="more-link "></a>').append('<span class="more">'+k+"</span>");
this.$resultsParent.append(h);
h.on("click",function(m){l.onMoreClick(this,m)
})
};
e.prototype.onDataReady=function(m,o,p,l){var n=this;
if(n.isPublish){var h=false;
var k=d(".error-no-results");
if(k.find(".parsys").html().length>1){h=true
}if(!m.length){if(h){k.removeClass("hide")
}else{d("p.info").show()
}}else{if(h){if(!k.hasClass("hide")){k.addClass("hide")
}}else{d("p.info").hide()
}}}if(l){n.$resultsParent.removeClass("loading");
n.nCurrentPage=1;
n.$resultsContainer.siblings("a").remove();
n.$resultsContainer.empty()
}d(window).trigger("newfacets",p);
n.$resultsParent.find(".more-loader").remove();
n.reloadTileList(m,l);
n.$resultsParent.find(".game-tile h2 a.title").dotdotdot({wrap:"letter"});
if(!o){n.createMore()
}};
e.prototype.onMoreClick=function(l,k){var h=this;
k.preventDefault();
if(typeof s!=="undefined"){PDC.SC.click("gamefinder",l,"text",null)
}d(l).remove();
d(h.defaults.resultsSelector).after(this.loaderHtml);
this.updateResults()
};
e.prototype.setFilter=function(h){if(typeof h!="undefined"){g(this.aCurrentSearchQuery,h,this.defaults.onlyType)
}};
e.prototype.onFilterChange=function(h,k){this.setFilter(k);
this.replaceResults(PDC.searchBuffer.getURLParams(this.aCurrentSearchQuery))
};
e.prototype.appendTile=function(k,h){var l=d(this.createLiTag());
if(c(this.defaults.layout)&&h){if(l.hasClass("tile-1")){k.addPreset(this.defaults.largeImagePreset)
}else{k.addPreset(this.defaults.smallImagePreset)
}}else{k.addPreset(this.defaults.smallImagePreset)
}k.addAgeRatingPreset(this.defaults.ageRatingImagePreset);
l.appendTo(this.$resultsContainer).addGameTile(k);
if(typeof s!=="undefined"){PDC.SC.smcid_creator(l)
}l.find(".lb_iframe").pdcLightbox()
};
e.prototype.createLiTag=function(){return this.template.replace("$sequence",this.getNextSequence()).replace("$index",this.getNextIndex())
};
e.prototype.getNextSequence=function(){if(c(this.defaults.layout)){var h=Math.floor(this.$resultsContainer.find("li").length/13)%2;
return this.SEQUENCE[h]
}else{return""
}};
e.prototype.getNextIndex=function(){var h=this.$resultsContainer.find("li").length+1;
return"tile-"+h
};
e.prototype.reloadTileList=function(m,h){if(m){for(var l=0;
l<m.length;
l++){var p=m[l];
var n=new PDC.GameTileTemplate();
for(var k in p){n[k]=p[k]
}this.appendTile(n,h)
}}};
PDC.gameFinder=new e()
})(jQuery);
(function(e,c,a,g){var d="groupingAndSorting",f={facetCountType:["out_now","coming_soon"]};
function b(k,h){this.element=k;
this.$element=e(this.element);
this.$key=e(this.element).attr("id");
this.options=e.extend({},f,h);
this._defaults=f;
this._name=d;
this.init()
}b.prototype.init=function(){var k=this.$element.find(".grouping a");
var h=this;
k.on("click",function(p){p.preventDefault();
var o=e(this),n={},m=o.attr("data-filter-key"),q=o.attr("data-filter-value"),l=o.attr("release_date");
k.removeClass("selected");
e(this).addClass("selected");
n[m]=q;
e(c).trigger("setFilter",n);
$releaseOption=e('option[value="'+l+'"]');
if($releaseOption){h.$element.find(".sort select").selectbox("change",$releaseOption.attr("value"),$releaseOption.text())
}});
this.$element.find(".sort select").selectbox({effect:"fade",speed:400,onChange:function(o,l){var n={},m=e(this).attr("data-filter-key");
n[m]=o;
e(c).trigger("filterChange",n)
}});
var h=this;
e(c).on("newfacets",function(p,r){h.clearAllCounts();
if(r&&r.release_cat){for(var l=0,o=r.release_cat.length;
l<o;
l++){var n=r.release_cat[l];
var q=n.value;
var m=n.count;
h.setFacets(q,m)
}}})
};
b.prototype.clearAllCounts=function(){for(var h=0;
h<this.options.facetCountType.length;
h++){var k=this.options.facetCountType[h];
this.setFacets(k,0)
}};
b.prototype.setFacets=function(h,l){var k=e('#filter-tab-container .grouping a[data-filter-value="'+h+'"]');
l=(l+"").replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,");
var m=k.text();
if(m){k.text(m.replace(/[\d,]+/g,l))
}};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))
}})
}
})(jQuery,window,document);
/*!
 * jQuery lightweight plugin boilerplate
 * Original author: @ajpiano
 * Further changes, comments: @addyosmani
 * Licensed under the MIT license
 * Original code (with comments) can be found at:
 * http://coding.smashingmagazine.com/2011/10/11/essential-jquery-plugin-patterns/

 This plug-in enables the game finder UI and attaches click handlers to the filters.
 Dependencies are that CM021_gameFinderLoader.js needs to be included and have run (to enable the custom event on $(window)).

 */
(function(d,f,g,a){var e="CM021_gameFilter",c={selectedClass:"selected",tabletBreak:"980px",fadeTime:0.3,slideTime:0.3,defaultKeyValue:"all",facetCountType:["genre","feature"]};
function h(m,l){this.$element=d(m);
this.options=d.extend({},c,l);
this._defaults=c;
this.$deviceFilters=d(".device-filters a",this.$element);
this.$tabButtons=d(".filter-tabs a",this.$element);
this.$tabContainer=d(".filter-tab-content",this.$element);
this.$tabs=d(".tab",this.$tabContainer);
this.$activeFilters=d(".active-filters li",this.$element);
if(typeof ScrollControl==="undefined"){ScrollControl=new ScrollrControllr()
}this.tabs={};
this.classList="";
this.init()
}function b(l,m){this.name=l;
this.$elem=m;
this.height=this.$elem.outerHeight();
this.$elem.addClass("tablet initialised");
this.tabletHeight=this.$elem.outerHeight();
this.$elem.removeClass("tablet");
this.$filters=this.$elem.find("a.filter");
this.$selectedFilter=null;
this.$activeFilter=null;
this.$button=null
}function k(l){return"-webkit-transition: "+l+";\n-moz-transition: "+l+";\n-ms-transition: "+l+";\n-o-transition: "+l+";\ntransition: "+l+";\n"
}h.prototype.init=function(){var m=this,p="<style>",l=0;
for(;
l<m.$tabs.length;
l+=1){var o=m.$tabs.eq(l),n=o.data("tab");
if(typeof m.tabs[n]==="undefined"){m.tabs[n]=new b(n,o);
m.tabs[n].$button=m.$tabButtons.filter("."+n);
m.tabs[n].$activeFilter=m.$activeFilters.filter("."+n);
m.classList+=n+" ";
totalTime=m.options.fadeTime+m.options.slideTime;
p+="#"+e+" .filter-wrap div.filter-tab-content."+n+"{height:"+m.tabs[n].height+"px;}\n";
p+="@media all and (max-width: "+m.options.tabletBreak+"){#"+e+" .filter-wrap div.filter-tab-content."+n+"{height:"+m.tabs[n].tabletHeight+"px;}}\n";
p+="#"+e+" .filter-wrap div."+n+">."+n+"{left:0;opacity:1;\n";
if(Modernizr.csstransitions){p+=k("opacity "+m.options.fadeTime+"s ease-in-out "+totalTime+"s, left 0s linear "+totalTime+"s")
}p+="}"
}}d(f).on("newfacets",function(u,v){if(v){m.clearAllCounts();
for(var q=0,t=m.options.facetCountType.length;
q<t;
q++){var r=m.options.facetCountType[q];
m.updateFacets(v,r)
}}});
d(p+"</style>").appendTo("head");
this.initTabs();
this.initFilters();
this.initShapeParallax()
};
h.prototype.initTabs=function(){var l=this;
l.$tabButtons.on("click",function(o){o.preventDefault();
var n=d(this),m=n.data("tab");
if(l.$tabContainer.hasClass(m)){n.removeClass(l.options.selectedClass);
l.$tabContainer.removeClass(m)
}else{l.$tabButtons.removeClass(l.options.selectedClass);
n.addClass(l.options.selectedClass);
l.$tabContainer.removeClass(l.classList);
l.$tabContainer.addClass(m)
}if(typeof s!=="undefined"){PDC.SC.click("gamefinder",this,"text",null)
}})
};
h.prototype.initFilters=function(){var l=this;
l.$tabContainer.on("click","a.filter",function(n){n.preventDefault();
var q=d(this),p={},o=q.attr("data-filter-key");
if(typeof l.tabs[o]!=="undefined"){if(q.hasClass(l.options.selectedClass)){l.tabs[o].$activeFilter.removeClass(l.options.selectedClass);
q.removeClass(l.options.selectedClass);
l.tabs[o].$selectedFilter=null;
var r=l.options.defaultKeyValue
}else{if(l.tabs[o].$selectedFilter!==null){l.tabs[o].$selectedFilter.removeClass(l.options.selectedClass)
}l.tabs[o].$selectedFilter=q.addClass(l.options.selectedClass);
l.tabs[o].$activeFilter.addClass(l.options.selectedClass).find(".name").text(q.find(".name").text());
l.$tabContainer.removeClass(l.classList);
l.$tabButtons.removeClass(l.options.selectedClass);
var r=q.attr("data-filter-value");
var m=[];
if(o=="rating"&&q.attr("data-filter-mappedRatings")!=""){m=q.attr("data-filter-mappedRatings").split(",")
}}if(o=="rating"){p[o]=[];
p[o].push(r);
for(i=0;
i<m.length;
i++){p[o].push(m[i])
}}else{p[o]=r
}d(f).trigger("filterChange",p);
if(typeof s!=="undefined"){if(o=="rating"){PDC.SC.click("gamefinder",this,"image",{link_section_name:o})
}else{PDC.SC.click("gamefinder",q.attr("data-filter-value"),"text",{link_section_name:o})
}}}});
if(d("#CM021_gameFilter .gameFinderFeaturedGames").length==1&&d("#CM021_gameFilter .gamefeatured .gamefeature-wrap[data-filter-label =all]").length==0){d(".caret").hide()
}l.$deviceFilters.on("click",function(p){p.preventDefault();
d("#CM021_gameFilter .gamefeatured").hide();
d("#CM021_gameFilter .device-filters .caret").hide();
var q=d(this),m=q.attr("class"),o={},v=q.attr("data-filter-key"),r=l.$deviceFilters.filter(".filter-all"),u=l.options.defaultKeyValue;
if(q[0]==r[0]){l.$deviceFilters.removeClass(l.options.selectedClass)
}else{r.removeClass(l.options.selectedClass)
}q.toggleClass(l.options.selectedClass);
if(!l.$deviceFilters.hasClass(l.options.selectedClass)){r.addClass(l.options.selectedClass)
}if(!r.hasClass(l.options.selectedClass)){u=l.$deviceFilters.filter(".selected").map(function(){return d(this).attr("data-filter-value")
}).get().join("|")
}var n=l.$deviceFilters.filter(".selected").length;
if(n==1){var t=l.$deviceFilters.filter(".selected").data("filter-value").toLowerCase();
if(d("#CM021_gameFilter .gamefeatured .gamefeature-wrap[data-filter-label='"+t+"']").length>0){d("#CM021_gameFilter .gamefeatured .gamefeature-wrap[data-filter-label='"+t+"']").closest(".gamefeatured").slideDown("slow");
l.$deviceFilters.filter(".selected").next("#CM021_gameFilter .caret").show("slow")
}}o[v]=u;
d(f).trigger("filterChange",o);
if(typeof s!=="undefined"){PDC.SC.click("gamefinder",this,"image",null)
}});
l.$activeFilters.find("a.close").on("click",function(p){p.preventDefault();
var o=d(this),n={},m=o.data("tab"),q=l.options.defaultKeyValue;
if(typeof l.tabs[m]!=="undefined"){l.tabs[m].$selectedFilter.removeClass(l.options.selectedClass);
l.tabs[m].$activeFilter.removeClass(l.options.selectedClass);
l.tabs[m].$selectedFilter=null;
n[m]=q;
d(f).trigger("filterChange",n)
}});
l.$tabContainer.find("div.hide-filter>a").on("click",function(m){m.preventDefault();
l.$tabContainer.removeClass(l.classList);
l.$tabButtons.removeClass(l.options.selectedClass)
})
};
h.prototype.triggerChange=function(m){var l=d(m),o={},n=l.data("tab"),p=this.options.defaultKeyValue;
if(typeof this.tabs[n]!=="undefined"){this.tabs[n].$selectedFilter.removeClass(this.options.selectedClass);
this.tabs[n].$activeFilter.removeClass(this.options.selectedClass);
this.tabs[n].$selectedFilter=null;
o[n]=p;
d(f).trigger("filterChange",o)
}};
h.prototype.initShapeParallax=function(){var m=d(".playstation-left-shapes",this.$element),l=d(".playstation-right-shapes",this.$element);
ScrollControl.registerScrollListener(function(){var q=arguments[0];
var o=d(f).height();
var n=(1-(q/o)*3);
var p=-3-((q/o)*30);
m.css("left",p+"%");
l.css("right",p+"%")
})
};
h.prototype.updateFacets=function(n,r){if(n&&n[r]){var l=d('.filter-tab-content a[data-filter-key="'+r+'"]');
for(var o=0,m=n[r].length;
o<m;
o++){var u=n[r][o];
var p=u.count;
var t=u.value;
if(p&&t){t=(t+"").replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,");
var q=l.filter('[data-filter-value="'+t+'"]');
d(" span.total",q).text("("+p+")");
q.removeClass("no-filter").addClass("filter")
}}}};
h.prototype.clearAllCounts=function(){var l=d('.filter-tab-content a[data-filter-key]:not([data-filter-key="rating"])');
l.removeClass("filter").addClass("no-filter");
d(" span.total",l).text("("+0+")")
};
d.fn[e]=function(l){return this.each(function(){if(!d.data(this,"plugin_"+e)){d.data(this,"plugin_"+e,new h(this,l))
}})
}
})(jQuery,window,document);
(function(b){var c={bufferSize:100,bufferThreshold:50,debugMode:false};
function d(t){var g="";
var k=1;
var n=t.platform;
if(typeof n=="undefined"){var f=a("console");
if(typeof f!=="undefined"&&f!==""&&f!=="all"){var r=b("a[data-filter-label='"+f.toLowerCase()+"']");
if(b(r).hasClass("selected")){t.platform=r.data("filter-value")
}}}for(var q in t){if(q!="count"&&q!="sort"){var o=false;
var l=k++;
var h="q"+l+"=";
var m="x"+l+"=";
g+=m+q+"&";
if((typeof t[q])==="object"){for(j=0;
j<t[q].length;
j++){sValue=t[q][j];
if(sValue==="all"){o=true;
break
}h+=sValue+"|"
}if(!o){h=h.substring(0,h.length-1);
g+=h+"&"
}}else{h+=t[q];
g+=h+"&"
}}else{var p=t[q];
g+=q+"="+p+"&"
}}g=g.replace(/ /g,"+");
if(g[g.length-1]=="&"){g=g.substring(0,g.length-1)
}g=(g=="")?this.baseUrl:g;
g+="&callback=?";
return g
}function a(k){k=k.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");
var l=new RegExp("[\\?&]"+k+"=([^&#]*)"),h=l.exec(location.search);
var f="";
if(h!=null){f=decodeURIComponent(h[1].replace(/\+/g," "));
var g=f.indexOf(".html");
if(g>-1){f=f.substring(0,g)
}}return f
}var e=function(f){this.options=b.extend(c,f);
this.totalRead=0;
this.totalRequest=0;
this.atEnd=false;
this.results=[];
this.nextUrl=this.options.baseUrl+(this.options.baseUrl.indexOf("&")>0?"&count=":"?count=")+this.options.bufferSize;
this.baseUrl=this.options.baseUrl.replace(/\?.*$/,"")
};
e.prototype.log=function(){if(this.options.debugMode){var f=Array.prototype.slice.call(arguments);
f.unshift("--SB: ");
console.log.apply(console,f)
}};
e.prototype.fillBuffer=function(){if(this.waitingAjax){return
}var f=this;
this.log("AJAX call to "+this.nextUrl);
this.waitingAjax=true;
b.ajax({type:"GET",dataType:"jsonp",data:{},url:this.nextUrl,success:function(g){f.onData(g)
},error:function(h,k,g){f.onDataError(k,g)
}})
};
e.prototype.needMore=function(){return(this.results.length<this.options.bufferThreshold)&&(!this.atEnd)
};
e.prototype.onDataError=function(g,f){this.hasError=true;
this.waitingAjax=false;
this.pendingFailFunc(g,f)
};
e.prototype.arrangeFacets=function(g){var h={};
for(var f=0;
f<g.length;
f++){if(g[f].name){h[g[f].name]=g[f].items
}}return h
};
e.prototype.onData=function(h){if(this.terminating){return
}if(typeof h.results=="undefined"||typeof h.pagination=="undefined"||typeof h.facets=="undefined"){onError("Invalid response.",null);
return
}var g=h.results[0].results,f=h.pagination[0].next;
this.waitingAjax=false;
this.totalResults=Number(h.resultcount.total);
this.results=this.results.concat(g);
this.filter();
this.totalRead+=g.length;
this.nextUrl=this.baseUrl+f;
this.facets=this.arrangeFacets(h.facets);
if(this.totalRead>=this.totalResults||f==""){this.atEnd=true;
this.nextUrl=null
}this.log("Got data: ",this.results.length,"results",this.totalRead,"read so far. ",(this.totalResults-this.totalRead)," unread.");
if(this.pending){if(this.results.length>=this.pendingCount||this.atEnd){this.provideData(this.pendingCount,this.pendingFunc)
}else{this.fillBuffer()
}}};
e.prototype.filter=function(){if(this.options.filter){if(typeof this.options.filter==="function"){this.results=_.filter(this.results,this.options.filter,this.options.filterContext)
}}};
e.prototype.provideData=function(k,l){var g=k;
var f,h=false;
if(this.options.maxCount){if(this.totalRequest<this.options.maxCount){if(this.totalRequest+k>this.options.maxCount){g=this.options.maxCount-this.totalRequest;
this.totalRequest+=g;
h=true
}else{this.totalRequest+=k
}f=this.results.splice(0,g);
if(f.length<g){h=true
}}else{h=true
}if(h){this.atEnd=h
}}else{f=this.results.splice(0,g),h=(this.results.length==0&&this.atEnd)
}this.pending=false;
if(this.needMore()){this.fillBuffer()
}this.log("Returning ",f.length," results. Reached end? ",h);
l(f,h,this.facets)
};
e.prototype.requestData=function(g,h,f){if(this.results.length>=g||this.atEnd){this.provideData(g,h)
}else{this.pending=true;
this.pendingFunc=h;
this.pendingFailFunc=f;
this.pendingCount=g;
this.fillBuffer()
}};
e.prototype.terminate=function(){this.terminating=true
};
PDC.searchBuffer={get:function(f){return new e(f)
},getURLParams:function(f){return d(f)
}}
})(jQuery);
PDC.searchBuffer.getTest=function(){return PDC.searchBuffer.get({baseUrl:$(".gameFinder .game-finder-data-url").attr("data-href")+".query.json",debugMode:true})
};
PDC.searchBuffer.testfunc=function(a){console.log("YEA, GOT "+a.length+" RESULTS!")
};
(function(f,d,a,h){var e="boxCarousel",g={showOverlayOnHover:false};
function b(m,l){this.element=m;
this.$element=f(this.element);
this.options=f.extend({},g,l);
this._defaults=g;
this._name=e;
this.init();
var k=this;
var n;
f(d).bind("resize orientationchange",function(){clearTimeout(n);
n=setTimeout(function(){k.init()
},300)
});
k.init()
}var c=function(){function l(q,m,v,z,p,y,x){var w=q.parentNode,t=2;
if(9===w.nodeType){return true
}if("0"===k(q,"opacity")||"none"===k(q,"display")||"hidden"===k(q,"visibility")){return false
}if("undefined"===typeof m||"undefined"===typeof v||"undefined"===typeof z||"undefined"===typeof p||"undefined"===typeof y||"undefined"===typeof x){m=q.offsetTop;
p=q.offsetLeft;
z=m+q.offsetHeight;
v=p+q.offsetWidth;
y=q.offsetWidth;
x=q.offsetHeight
}if(w){if(("hidden"===k(w,"overflow")||"scroll"===k(w,"overflow"))&&q.offsetParent===w){if(p+t>w.offsetWidth+w.scrollLeft||p+y-t<w.scrollLeft||m+t>w.offsetHeight+w.scrollTop||m+x-t<w.scrollTop){return false
}}if(q.offsetParent===w){p+=w.offsetLeft;
m+=w.offsetTop
}return l(w,m,v,z,p,y,x)
}return true
}function k(n,m){if(d.getComputedStyle){return a.defaultView.getComputedStyle(n)[m]
}if(n.currentStyle){return n.currentStyle[m]
}}return{getStyle:k,isVisible:l}
}();
b.prototype.init=function(){var n=this.$element.attr("id"),o=this.$element,m=o.find("ul"),k;
o.find(".next").addClass("bcnext"+n);
o.find(".prev").addClass("bcprev"+n);
o.find(".pages").addClass("bcpages"+n);
var l=o.find("ul").children("li:first").width();
m.carouFredSel({auto:false,circular:false,infinite:false,items:{width:l,visible:{max:f(d).width()<=960?3:4}},next:".bcnext"+n,prev:".bcprev"+n,pagination:".bcpages"+n,responsive:true,swipe:{onMouse:true,onTouch:true,options:{excludedElements:"button, input, select, textarea"}},width:"100%",height:230,scroll:{onAfter:function(q){if(k!=null){k.focus()
}}},onCreate:function(q){o.find("div.loader").hide();
m.show()
}});
var p=m.triggerHandler("currentVisible");
m.find("li a").each(function(){var r=f(this);
var q=false;
r.focus(function(y){var z=f(this),B=z.parents("li"),u,x,v,t=m.find("li"),w=Math.ceil(t.length/p.length);
if(q){q=false;
k=null
}else{y.preventDefault();
q=true;
u=t.index(B);
x=Math.ceil((u+1)/p.length)-1;
v=m.triggerHandler("currentPage");
var A=(v+x);
if(A>w){A=A-w
}if(A===v){k=null;
z.focus()
}else{m.triggerHandler("slideToPage",A);
k=z
}}})
});
o.bind("keydown",function(t){var r=t.keyCode||t.which;
if(r==9){var u=m.triggerHandler("currentVisible"),v=f(a.activeElement),q=v.parents("li");
if(t.shiftKey){if(v.is(".bcnext"+n)){t.preventDefault();
u.last().find("a").focus()
}}else{if(u.index(q)===u.length-1){t.preventDefault();
f(".bcnext"+n).focus()
}}}});
if(this.options.showOverlayOnHover&&f("html").hasClass("no-touch")){this.initShowOverlayOnHover()
}};
b.prototype.initShowOverlayOnHover=function(){var k=this;
var l=k.$element.find("ul li");
l.off("mouseenter");
f(".box-carousel-overlay").remove();
l.on("mouseenter",function(n){var p=f(this);
var m=p.children();
var o=p.offset();
p.css("visibility","hidden");
f("<div>").addClass("box-carousel-overlay").append(m.clone(true)).css({position:"absolute",top:o.top,left:o.left,zIndex:9}).appendTo(f("body")).on("mouseleave",function(){p.css("visibility","visible");
var q=f(this);
setTimeout(function(){q.remove()
},300)
})
});
k.$element.find(".prev, .next").on("click",function(){l.css("visibility","visible");
f(".box-carousel-overlay").remove()
})
};
f.fn[e]=function(k){return this.each(function(){if(!f.data(this,"plugin_"+e)){f.data(this,"plugin_"+e,new b(this,k))
}})
}
})(jQuery,window,document);
(function(e,c,a,f){var d="CM182_feedback";
function b(h,g){this.element=h;
this.init()
}b.prototype.init=function(){var g=e(this.element);
g.find("a").click(function(h){g.find(".btn").toggle();
g.find(".message").fadeIn();
PDC.SC.click("feedback",this,"button")
})
};
e.fn[d]=function(g){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,g))
}})
}
})(jQuery,window,document);
(function(a){a.letterbox=function(d,l){var o={pageWidth:977,margin:0,videoIndex:0};
var u=a(d);
var r=a(".window",u);
var m=a(".content",u);
var g=a(".lt-ie8").length>0;
var v=false;
var q=0;
var p=0;
var e=0;
var C=0;
var b=0;
var x=0;
var c;
var A;
var z="";
function t(F){for(var E=0;
E<F.link.length;
E++){if(F.link[E].rel=="related"){var D=F.link[E].href;
return D.replace(/.*\//,"").replace(/\?.*$/,"")
}}return"unknown"
}var k=true;
var h=this;
h.settings={};
h.init=function(){h.settings=a.extend({},o,l);
var G=a.extend({},o,l),F=u,E=u;
function D(H){a.getJSON("//www.googleapis.com/youtube/v3/playlistItems?part=snippet&maxResults=50&playlistId="+z+"&key=AIzaSyAKRzl4h3hhO1X3imjDNBNFkgqmiBhzk_U&alt=json&callback=?",function(M){var L=M.items[G.videoIndex];
ytJSON=true;
pdclog("loadPlaylist");
pdclog(L);
var K=L.snippet.resourceId.videoId,J="//www.youtube.com/watch?v="+K;
var I="no";
if(a(L).isVideoItemAgeGated){if(a(L).isVideoItemAgeGated()){I="yes"
}}H.find("a").attr("href",J).addClass("lb_youtube").attr("data-agegating",I).removeClass("lb_ytPlaylist");
if(a.fn.pdcLightbox){H.find("a").pdcLightbox()
}})
}E.find("a").each(function(){$this=a(this);
if($this.attr("data-playlist-id")){z=$this.attr("data-playlist-id");
D($this.parent())
}});
if(!Modernizr.touch&&!g){if(a(".lt-ie8").length>0){k=false;
r.css("top","-"+u.height()+"px")
}a(window).bind("scroll",function(){w()
})
}if(!g){a(window).resize(function(){y()
})
}q=n();
p=a(window).height();
e=q+p;
C=u.offset().top;
b=m.height();
x=C+b
};
function y(){if(!Modernizr.touch){B()
}f(function(){q=n();
p=a(window).height();
e=q+p;
C=u.offset().top;
b=m.height();
x=C+b
},500)
}function f(E,D){clearTimeout(c);
c=setTimeout(E,D)
}function w(){if(u.isVisible()){if(!v){requestAnimFrame(B);
v=true
}}else{if(r.hasClass("fixed")){r.removeClass("fixed");
r.removeAttr("style");
u.removeAttr("style")
}}}function B(){var J=n();
var H=J+p;
var E=u.offset().top;
var F=m.height();
var G=E+F;
if(k){if(E<H&&(G+h.settings.margin)>H){var D=(H-E)-h.settings.margin;
if(D<0){D=0
}u.height(F);
r.height(D);
r.addClass("fixed scrolling");
clearTimeout(A);
A=setTimeout(function(){r.removeClass("scrolling")
},500)
}else{if(r.hasClass("fixed")){r.removeClass("fixed");
r.removeAttr("style");
u.removeAttr("style")
}}}else{if(J>(E-p)&&H<(G+p)){var I=H-E-(F+h.settings.margin);
if(I<(-F)){I=-F
}else{if(I>0){I=0
}}r.css("top",I+"px")
}}v=false
}function n(){return(document.documentElement.scrollTop||document.body.scrollTop)
}h.init()
};
a.fn.letterbox=function(b){return this.each(function(){if(undefined==a(this).data("letterbox")){var c=new a.letterbox(this,b);
a(this).data("letterbox",c)
}})
}
})(jQuery);
(function(e,c,a,g){var d="faqExpand",f={};
function b(k,h){this.element=k;
this.$element=e(this.element);
this.$key=e(this.element).attr("id");
this.options=e.extend({},f,h);
this._defaults=f;
this._name=d;
this.init()
}b.prototype.init=function(){var h=this;
h.$element.on("click","a.toggleHeader",function(){var m=e(this);
if(h.$lastOpened&&h.$lastOpened.find("a").get(0)!==this){h.$lastOpened.removeClass("accordion-active");
h.$lastOpened.find(".accordion-section-container").slideUp(300)
}var l=h.$lastOpened=m.parent();
l.toggleClass("accordion-active");
var k=l.find(".accordion-section-container");
if(l.hasClass("accordion-active")){h.curOpenAccordHeight=k.outerHeight()?k.outerHeight():0;
k.slideDown(300)
}else{h.curOpenAccordHeight=0;
k.slideUp(300)
}h.showMoreFaqs()
});
h.$wrapper=h.$element.find(".wrapper");
h.$element.on("click",".more-links",function(){h.loadMoreFaqs(e(this).data())
});
h.showMoreFaqs();
e(c).on("resize",function(){h.showMoreFaqs()
});
e(c).on("orientationchange",function(){h.showMoreFaqs()
})
};
b.prototype.loadMoreFaqs=function(h){var k=this;
if(!k.$ajaxLoader){var l=k.$wrapper.find(".items > ul");
k.$element.find(".more-links").remove();
k.$ajaxLoader=e("<div>").attr({"class":"ajax-loader"}).appendTo(l).css({position:"relative",backgroundPosition:"top center",width:"100%",height:"50px",marginTop:"20px"});
e.ajax({url:h.nextPage,dataType:"html"}).done(function(n){var m=e(n);
if(m.length){l.css("height",l.outerHeight());
l.append(m);
k.showMoreFaqs()
}k.$ajaxLoader.remove();
k.$ajaxLoader=null
})
}};
b.prototype.showMoreFaqs=function(){var k=this;
var n=300;
var m=0;
var l=k.$wrapper.find(".items > ul").eq(0);
l.find(".item div > a").each(function(){m+=e(this).outerHeight()+2
});
var h=k.$element.find(".more-links");
m=m+(h.outerHeight()?h.outerHeight(true):0);
m=m+(k.curOpenAccordHeight||0);
l.eq(0).animate({height:m},n,function(){l.css("height","")
})
};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))
}})
}
})(jQuery,window,document);
(function(e,c,a,f){var d="setSelectedLocale";
function b(h,g){this.element=h;
var k=e(location).attr("href");
alert(k)
}e.fn[d]=function(g){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,g))
}})
}
})(jQuery,window,document);
(function(c,b,a,d){c.statList=function(g,f){var k={};
var h=this;
h.settings={};
var e=c(g),g=g;
h.init=function(){h.settings=c.extend({},k,f);
var m=h.settings;
var l=e.find(".hidden");
e.find("div.more").attr("aria-expanded","false").on("click",function(o){o.preventDefault();
var n=c(this);
if(n.attr("aria-expanded")=="true"){h.hideAll(l,m);
n.attr("aria-expanded","false").find("span").removeClass("showLess").html("MORE")
}else{h.revealAll(l,m);
n.attr("aria-expanded","true").find("span").addClass("showLess").html("LESS")
}});
h.hideAll(l,m)
};
h.hideAll=function(l,m){l.hide()
};
h.revealAll=function(l,m){l.show()
};
h.init()
};
c.fn.statList=function(e){return this.each(function(){if(d==c(this).data("statList")){var f=new c.statList(this,e);
c(this).data("statList",f)
}})
}
})(jQuery,window,document);
(function(e,c,a,g){var d="CM115_articleList",f={revealMore:5};
function b(k,h){this.element=k;
this.$element=e(k);
this.options=e.extend({},f,h);
this._defaults=f;
this._name=d;
this.moreButton=this.$element.find("div.more");
this.init();
this.articleTotal;
this.articleCount
}b.prototype.init=function(){var m=this;
var h=m.$element.find("ul.articles li.li-article-container"),l=h.length,k=0,n=m.options;
for(i=0;
i<=n.revealMore-1;
i++){k++;
e(h[i]).removeClass("hide");
e(h[i]).find("article").find("h3").dotdotdot();
e(h[i]).find("article").find("p").dotdotdot()
}if(l<=n.revealMore){m.moreButton.remove()
}m.articleCount=k;
this.showMore(h,l)
};
b.prototype.showMore=function(h,k){var l=this,n=l.options;
var m=l.articleCount+n.revealMore;
l.moreButton.on("click",function(o){for(i=l.articleCount;
i<=m-1;
i++){e(h[i]).removeClass("hide");
l.articleCount++
}m+=5;
if(l.articleCount>=k){l.moreButton.remove()
}})
};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))
}})
}
})(jQuery,window,document);
(function(e,c,a,g){var d="accessMash",f={mediaMatchMeasure:980,animateDelayMin:400,largerMashTile:5,smallerMashTile:3,rightOffset:1123,leftOffset:-500,fixedweb_layouts:[[{top:0,left:30},{top:0,left:502},{top:0,left:738},{top:354,left:266},{top:177,left:502}],[{top:0,left:30},{top:0,left:266},{top:0,left:502},{top:0,left:738},{top:177,left:266}],[{top:0,left:30},{top:0,left:266},{top:0,left:502},{top:354,left:266},{top:354,left:502}]],responsive_layouts:[[{top:0,left:7},{top:0,left:243},{top:0,left:479}],[{top:0,left:7},{top:0,left:243},{top:0,left:479}],[{top:0,left:7},{top:0,left:243},{top:0,left:479}]]};
function b(k,h){this.element=k;
this.$element=e(this.element);
this.$key=e(this.element).attr("id");
this.options=e.extend({},f,h);
this._defaults=f;
this._name=d;
this.authorMode=this.$element.find(".accessMash-author-mode").length,this.init();
var l=e(".access-view .type-facebook h2").html();
if((l.length>1)){e(".access-view .type-facebook h2").each(function(){var m=e(this).html();
if(m.length>143){m=m.substring(0,140)+"...";
e(this).html(m)
}})
}}b.prototype.init=function(){var u=this,y=0,v=-1,q=0,p=0,l=0,t=0,x=[],w=u.$element.find(".right"),h=u.$element.find(".left");
function n(){w.click(function(D){D.preventDefault();
if(v<t){if(v-1>=0){u.$element.find(".page-"+(v-1)).each(function(){m(this,u.options.leftOffset)
})
}u.$element.find(".page-"+v).each(function(){m(this,e(this).data("left"))
});
v++;
if(v>t){v=t
}}z()
});
h.click(function(D){D.preventDefault();
if(v>1){v--;
if(v<1){v=1
}u.$element.find(".page-"+v).each(function(){m(this,u.options.rightOffset)
});
u.$element.find(".page-"+(v-1)).each(function(){m(this,e(this).data("left"))
})
}z()
});
function z(){if(v==1){h.addClass("disabled")
}else{if(h.hasClass("disabled")){h.removeClass("disabled")
}}if(v==t){w.addClass("disabled")
}else{if(w.hasClass("disabled")){w.removeClass("disabled")
}}}var C=u.$element,B,A;
C.swipe({excludedElements:"button, input, select, textarea, .noSwipe",swipeLeft:function(F,H,I,G,D,E){w.click()
},swipeRight:function(F,H,I,G,D,E){h.click()
},tap:function(D,E){if(e(E).parents("ul").length>0){c.open(e(E).find("a").attr("href"),"_self")
}},threshold:50})
}function m(B,D){var z=e(B),C,A=(u.options.animateDelayMin+(Math.random()*u.options.animateDelayMin));
if(u.authorMode>0){C=z.parents(".tile-author-mode")
}if(u.authorMode>0){if(Modernizr.csstransforms3d){C.css({"-webkit-transition":"-webkit-transform "+A+"ms","-moz-transition":"-moz-transform "+A+"ms","-o-transition":"-o-transform "+A+"ms",transition:"transform "+A+"ms","-webkit-transform":"translate3d("+D+"px, 0, 0)","-moz-transform":"translate3d("+D+"px, 0, 0)","-o-transform":"translate3d("+D+"px, 0, 0)",transform:"translate3d("+D+"px, 0, 0)"})
}else{C.animate({left:+D+"px"},A)
}}else{if(Modernizr.csstransforms3d){z.css({"-webkit-transition":"-webkit-transform "+A+"ms","-moz-transition":"-moz-transform "+A+"ms","-o-transition":"-o-transform "+A+"ms",transition:"transform "+A+"ms","-webkit-transform":"translate3d("+D+"px, 0, 0)","-moz-transform":"translate3d("+D+"px, 0, 0)","-o-transform":"translate3d("+D+"px, 0, 0)",transform:"translate3d("+D+"px, 0, 0)"})
}else{z.animate({left:+D+"px"},A)
}}}e.when(n()).done(function(){if("matchMedia" in c){var A=c.matchMedia("(max-width: "+u.options.mediaMatchMeasure+"px)");
function C(D){if(D.matches){o()
}else{k()
}}if(A.addListener){A.addListener(C)
}else{if(A.attachEvent){A.attachEvent(C)
}}C(A)
}else{var z;
B();
e(c).resize(function(){if(z){clearTimeout(z)
}z=setTimeout(B,500)
});
function B(){if(e(c).width()<=u.options.mediaMatchMeasure){o()
}else{k()
}}}});
function k(){x=u.options.fixedweb_layouts;
u.$element.removeClass("responsive-layout").addClass("fixedweb-layout");
e.when(r(u.options.largerMashTile)).done(function(){y.swipe({swipeLeft:function(A,C,D,B,z){},swipeRight:function(A,C,D,B,z){}});
w.click()
})
}function o(){x=u.options.responsive_layouts;
u.$element.removeClass("fixedweb-layout").addClass("responsive-layout");
e.when(r(u.options.smallerMashTile)).done(function(){w.click()
})
}function r(z){u.$element.find(".placeholder").remove();
u.$element.find(".tile").removeClass().each(function(){var K=e(this),J=K.attr("data-type");
K.addClass("tile "+J)
});
y=u.$element.find(".tile");
v=0;
p=0;
l=0;
t=0;
q=z;
u.options.rightOffset=u.$element.width();
var B=y.length,H=y.length%q,G=0,A=u.options.rightOffset;
if(H>0){B=y.length+(q-H)
}for(var C=0;
C<B;
C++){var E=C%q,D=e(y[C]),I;
if(typeof D[0]!=="undefined"){if(u.authorMode>0){I=D.parents(".tile-author-mode")
}if(u.authorMode>0){I.css({top:x[p][E].top}).addClass("layout-"+p+" position-"+E+" page-"+G).data({left:x[p][E].left})
}D.css({top:x[p][E].top}).addClass("layout-"+p+" position-"+E+" page-"+G).data({left:x[p][E].left});
if(u.authorMode>0){if(Modernizr.csstransforms3d){I.css({"-webkit-transform":"translate3d("+A+"px, 0, 0)","-moz-transform":"translate3d("+A+"px, 0, 0)","-o-transform":"translate3d("+A+"px, 0, 0)",transform:"translate3d("+A+"px, 0, 0)"})
}else{I.css({left:+A+"px"})
}}else{if(Modernizr.csstransforms3d){D.css({"-webkit-transform":"translate3d("+A+"px, 0, 0)","-moz-transform":"translate3d("+A+"px, 0, 0)","-o-transform":"translate3d("+A+"px, 0, 0)",transform:"translate3d("+A+"px, 0, 0)"})
}else{D.css({left:+A+"px"})
}}}else{u.$element.append('<div class="tile placeholder-'+l+'"></div>');
var F=u.$element.find(".placeholder-"+l);
F.css({top:x[p][E].top}).addClass("layout-"+p+" position-"+E+" page-"+G+" placeholder-"+l+" placeholder").data({left:x[p][E].left});
if(Modernizr.csstransforms3d){F.css({"-webkit-transform":"translate3d("+A+"px, 0, 0)","-moz-transform":"translate3d("+A+"px, 0, 0)","-o-transform":"translate3d("+A+"px, 0, 0)",transform:"translate3d("+A+"px, 0, 0)"})
}else{F.css({left:+A+"px"})
}l++
}if(E==q-1){p++;
G++;
if(p>=x.length){p=0
}}}y=u.$element.find(".tile");
t=y.length/q
}};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))
}})
}
})(jQuery,window,document);
(function(e,c,a,g){var d="userSearch",f={};
function b(k,h){this.element=k;
this.$element=e(this.element);
this.options=e.extend({},f,h);
this._defaults=f;
this._name=d;
this.init()
}b.prototype.init=function(){var h=this;
h.$errorMessages=h.$element.find(".error-message");
h.$input=h.$element.find("input");
h.$input.on("focus",function(l){if(!h.$errorMessages.hasClass("hide")){h.$errorMessages.addClass("hide")
}var k=h.$errorMessages.find(".wrapper .msg");
e.each(k,function(m,o){var n=e(o);
if(!n.hasClass("hide")){n.addClass("hide")
}})
});
h.$input.on("keypress",function(n){if(!h.$errorMessages.hasClass("hide")){h.$errorMessages.addClass("hide")
}var m=h.$errorMessages.find(".wrapper .msg");
e.each(m,function(o,q){var p=e(q);
if(!p.hasClass("hide")){p.addClass("hide")
}});
var k=0;
if(n){k=n.which
}else{if(c.e){k=c.e.keyCode
}else{return false
}}if(k==13){var l=h.validate(e(this).siblings("a"));
if(l&&e(this).siblings("a").attr("href")!=="#"){c.location.href=e(this).siblings("a").attr("href")
}}});
h.$submitBtn=h.$element.find(".genericButtonRow a");
h.$submitBtn.on("click",function(l){var k=h.validate(e(this));
return k
})
};
b.prototype.validate=function(k){var h=this;
if(!h.$errorMessages.hasClass("hide")){h.$errorMessages.addClass("hide")
}var m=h.$errorMessages.find(".wrapper .msg");
e.each(m,function(n,p){var o=e(p);
if(!o.hasClass("hide")){o.addClass("hide")
}});
var l=e.trim(h.$input.val());
if(l===""||e.trim(h.$input.attr("placeholder"))===l){h.$errorMessages.removeClass("hide");
h.$errorMessages.find(".empty-error-msg").removeClass("hide");
h.$input.val("");
return false
}else{if(l.search(/^[a-zA-Z0-9-_]+$/)===-1){h.$errorMessages.removeClass("hide");
h.$errorMessages.find(".invalid-char-error-msg").removeClass("hide");
h.$input.val("");
return false
}else{if(l.length<3){h.$errorMessages.removeClass("hide");
h.$errorMessages.find(".too-short-error-msg").removeClass("hide");
h.$input.val("");
return false
}}}if(k.attr("href")==="#"){e(a).trigger("usersearch.search",[l]);
h.$input.val("");
e("html, body").animate({scrollTop:0},"slow")
}else{c.sessionStorage.publicTrophiesSearchId=l
}return true
};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))
}})
}
})(jQuery,window,document);
(function(e,c,a,g){var d="userNotificationWall",f={wallFeedDataUrl:"//my.playstation.com/playstation/psn/messagecenter/message/all",sharePostDataUrl:"//my.playstation.com/playstation/psn/messagecenter/message/share",likePostDataUrl:"//my.playstation.com/playstation/psn/messagecenter/message/like",unlikePostDataUrl:"//my.playstation.com/playstation/psn/messagecenter/message/unlike",reviewedMessageDataUrl:"//my.playstation.com/playstation/psn/messagecenter/message/review",unreadMessageNotificationDataUrl:"//my.playstation.com/playstation/psn/messagecenter/message/notifications",templateId:""};
function b(k,h){this.element=k;
this.$element=e(this.element);
this.options=e.extend({},f,h);
this._defaults=f;
this._name=d;
this.pageNum=1;
this.tilesPerPage=15;
this.$columnContainer=this.$element.find(".column-container");
this.$socialView=this.$element.find(".socialview");
this.$firstColumn=this.$element.find(".col-1");
this.$secondColumn=this.$element.find(".col-2");
this.$thirdColumn=this.$element.find(".col-3");
this.$loadingOverlay=this.$element.find(".loading-overlay");
this.$moreLink=this.$element.find(".more-link");
this.$errorMsg=this.$element.find(".errormsg");
this.types={all:0,facebook:1,twitter:2,newsletter:3,blogs:4};
this.newsletterLink=this.$element.find(".blue-bg-container").data("href");
this.init()
}b.prototype.init=function(){var h=this;
PDC.MyPlaystationProfile.getSignedUserData(function(l){if(l.handle){h.currentHandle=l.handle;
var k=h.getParameterByName("type");
if(typeof k!=="undefined"&&k!==null&&k!==""&&typeof h.types[k.toLowerCase()]!=="undefined"&&h.types[k.toLowerCase()]!==null&&h.types[k.toLowerCase()]!==""){h.type=h.types[k];
h.$socialView.find("li.selected").removeClass("selected");
h.$socialView.find('li[data-filter-key="'+k+'"]').addClass("selected")
}else{h.type=0
}h.loadData();
h.$moreLink.on("click",function(){if(typeof s!=="undefined"){PDC.SC.click("psnews",this,"text",null)
}h.showMore()
});
h.$socialView.find("li a").on("click",function(n){if(!e(this).parent().hasClass("selected")){if(typeof s!=="undefined"){PDC.SC.click("psnews",this,"text",null)
}h.$loadingOverlay.removeClass("hide");
h.pageNum=1;
h.$firstColumn.html("");
h.$secondColumn.html("");
h.$thirdColumn.html("");
var m=e(this).parent().data("filter-key");
h.type=h.types[m];
h.$socialView.find("li.selected").removeClass("selected");
e(this).parent().addClass("selected");
h.loadData()
}})
}else{PDC.MyPlaystationProfile.redirectToLogin()
}})
};
b.prototype.loadData=function(){var h=this;
var k={pageNum:h.pageNum,type:h.type,callback:"JSON_CALLBACK",userInfoCookie:e.cookie("userinfo")};
e.ajax({type:"get",async:true,crossDomain:true,data:k,url:h.options.wallFeedDataUrl,dataType:"json"}).done(function(l){h.totalPages=Math.ceil(l.totalCampaigns/h.tilesPerPage);
if(l.list.length>=1){h.$errorMsg.addClass("hide");
e.each(l.list,function(m,o){o.currHandle=h.currentHandle;
if(typeof h.newsletterLink!=="undefined"&&h.newsletterLink!==null&&h.newsletterLink!==""){o.newsletterLink=h.newsletterLink
}else{o.newsletterLink="javascript:void(0);"
}var n=(m+1)%3;
if(n==0){h.$thirdColumn.append(tmpl(h.options.templateId,o));
h.initClickHandlers(h.$thirdColumn.children().last())
}else{if(n==1){h.$firstColumn.append(tmpl(h.options.templateId,o));
h.initClickHandlers(h.$firstColumn.children().last())
}else{h.$secondColumn.append(tmpl(h.options.templateId,o));
h.initClickHandlers(h.$secondColumn.children().last())
}}});
if(h.pageNum===h.totalPages){h.$moreLink.addClass("hide")
}h.$loadingOverlay.addClass("hide");
h.addAnimations()
}else{h.$firstColumn.html("");
h.$secondColumn.html("");
h.$thirdColumn.html("");
h.$moreLink.addClass("hide");
h.$errorMsg.removeClass("hide");
h.$loadingOverlay.addClass("hide")
}}).fail(function(){h.$firstColumn.html("");
h.$secondColumn.html("");
h.$thirdColumn.html("");
h.$moreLink.addClass("hide");
h.$errorMsg.removeClass("hide");
h.$loadingOverlay.addClass("hide")
})
};
b.prototype.showMore=function(){var h=this;
h.pageNum+=1;
h.$loadingOverlay.removeClass("hide");
h.loadData()
};
b.prototype.addAnimations=function(){PDC.MyWallAnimation.init(this.element,{minDuration:0.4,maxDuration:0.7,viewportFactor:0.2})
};
b.prototype.initClickHandlers=function(l){var h=this;
var k=l.children("a");
k.on("click",function(p){h.reviewedPost(e(this));
if(e(this).hasClass("newsletter")&&e(this).data("href")!=="javascript:void(0);"){try{c.sessionStorage.newsletterCampaignID=e(this).data("campaign")
}catch(p){var m=e(this).data("href");
e(this).data("href",m+"?campaignId="+e(this).data("campaign"))
}}var n=e(this).closest(".notificationWall");
if(typeof s!=="undefined"&&e(this).data("href")!=="javascript:void(0);"){var o={linktitle_override:"_subject",_subject:e(this).find(".subject").text(),link_section_name:e(n).find(".socialview li.selected").data("filter-key"),vars:{prop56:e(n).find(".name .post-frm span").attr("class"),eVar56:e(n).find(".name .post-frm span").attr("class")}};
PDC.SC.click("psnews",this,"image",o)
}});
l.find(".post-like-box .like-img").on("click",function(){if(typeof s!=="undefined"){var o=e(this).parent().hasClass("no");
var p=o?"like":"unlike";
var n=e(this).closest(".grid");
var m=n.find(".subject").text();
PDC.SC.click("psnews",this,"image",{linktitle_override:"_subject",_subject:m,link_section_name:p})
}h.likedPost(e(this))
});
l.find(".post-share-box .share-img").on("click",function(){if(!e(this).hasClass("disabled-share")){if(typeof s!=="undefined"){var n=e(this).closest(".grid");
var m=n.find(".subject").text();
PDC.SC.click("psnews",this,"image",{linktitle_override:"_subject",_subject:m,link_section_name:"share"})
}h.sharedPost(e(this))
}})
};
b.prototype.reviewedPost=function(l){var h=this;
var k={campaignId:l.data("campaign"),userInfoCookie:e.cookie("userinfo")};
e.ajax({type:"POST",url:h.options.reviewedMessageDataUrl,data:k,dataType:"json"}).done(function(m){if(m.status=="success"){e.ajax({type:"GET",url:h.options.unreadMessageNotificationDataUrl,data:{userInfoCookie:e.cookie("userinfo")},type:"json"}).done(function(o){var n=o.totalCampaigns;
if(n>10){n="10+"
}if(n>0){e(".avatar .nav-content .notification-count").text(n)
}})
}});
l.parent().removeClass("no");
l.parent().addClass("yes");
l.attr("href",l.data("href"))
};
b.prototype.likedPost=function(l){var h=this;
h.$loadingOverlay.removeClass("hide");
var k=l.parent().hasClass("no");
var m=k?h.options.likePostDataUrl:h.options.unlikePostDataUrl;
e.ajax({type:"POST",url:m,data:{campaignId:l.data("campaign"),userInfoCookie:e.cookie("userinfo")},dataType:"json"}).done(function(o){h.$loadingOverlay.addClass("hide");
var n=o.LikeCount;
if(parseInt(n)<1){n=""
}else{if(parseInt(n)<2){n=n+" "+Adobe.I18n.get("Like")
}else{n=n+" "+Adobe.I18n.get("likes")
}}e("._item."+l.data("campaign")).each(function(){e("._item."+l.data("campaign")+" .post-box .count-box .like-count .likeCountText").html(n);
if(k){e(this).children(".post-box").children(".social-icon-box").children(".post-like-box").addClass("yes");
e(this).children(".post-box").children(".social-icon-box").children(".post-like-box").removeClass("no")
}else{e(this).children(".post-box").children(".social-icon-box").children(".post-like-box").addClass("no");
e(this).children(".post-box").children(".social-icon-box").children(".post-like-box").removeClass("yes")
}})
})
};
b.prototype.sharedPost=function(k){var h=this;
h.$loadingOverlay.removeClass("hide");
e.ajax({type:"POST",url:h.options.sharePostDataUrl,data:{campaignId:k.data("campaign"),userInfoCookie:e.cookie("userinfo")},dataType:"json"}).done(function(m){h.$loadingOverlay.addClass("hide");
var l=m.shareCount;
if(parseInt(l)<1){l=""
}else{if(parseInt(l)<2){l=l+" "+Adobe.I18n.get("share")
}else{l=l+" "+Adobe.I18n.get("shares")
}}e("._item."+k.data("campaign")).each(function(){e("."+k.data("campaign")+" .social-icon-box .post-share-box .share-img").addClass("disabled-share");
e("."+k.data("campaign")+" .count-box .share-count .shareCountText").html(l)
})
})
};
b.prototype.getParameterByName=function(l){l=l.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");
var m=new RegExp("[\\?&]"+l+"=([^&#]*)"),k=m.exec(location.search);
var h="";
if(k!=null){h=decodeURIComponent(k[1].replace(/\+/g," "))
}return h
};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))
}})
}
})(jQuery,window,document);
(function(e,c,a,g){var d="wishlistGrid",f={wantItTabCall:"/candc/psn/profile/collection/want",removeFromWish:"/playstation/psn/fortknox/update/games",ecommerceBtnCall:"/ps-products/ProductBuyStatus",groupType:"want",wantitData:null,curPage:0,showMoreLink:true,tilesPerPage:16,onSamePage:"false",wishListCache:false,wishListToolTip:""};
function b(l,k){var h=this;
h.element=l;
h.$element=e(h.element);
h.$elementParent=h.$element.parent();
h.$key=h.$element.attr("id");
h.options=e.extend({},f,k);
h._defaults=f;
h._name=d;
h.$gridContainer=h.$element.find(".wishlistgrid");
PDC.MyPlaystationProfile.getSignedUserData(function(m){if(m.handle){h.init()
}else{PDC.MyPlaystationProfile.redirectToLogin()
}})
}b.prototype.init=function(){var h=c.location.href;
var k=this;
var m=k.options;
if(h.indexOf("collectionType=My_Games")!=-1&&m.onSamePage!=="true"){m.onSamePage="true"
}var n=1000;
var o=k.$element;
var l=e(c).width()<940?3:4;
m.tilesPerPage=m.tilesPerPage-(m.tilesPerPage%l);
k.$ajaxPreloader=e("<div>").attr({"class":"ajax-loader"}).appendTo(k.$gridContainer);
k.$gridContainer.css({height:"270px",position:"relative",});
if(k.curAjax){k.curAjax.abort()
}if(!m.wishListCache&&m.groupType==="want"){k.dataUrl=m.wantItTabCall;
k.fetchData().done(function(p){m.wishListCache=true;
k.listData=m.wantitData=p;
k.buildDom()
}).fail(function(r,q,p){k.wantitData=null;
k.buildDom()
})
}else{k.listData=m.wantitData;
k.buildDom()
}};
b.prototype.buildDom=function(){var h=this;
var l=h.options;
var m=h.listData;
var o=0;
var k=h.$tilesHolderUl=e("<ul>").attr({"class":"clearfix"}).appendTo(h.$gridContainer);
if(m&&m.list){o=m.list.length;
h.totalPage=Math.ceil(o/l.tilesPerPage);
c.sessionStorage.competeMyTiles=o;
if(h.$ajaxPreloader){h.$ajaxPreloader.remove();
h.$gridContainer.css({height:"",position:""})
}if(o>0){h.$gridContainer.removeClass("CM159_noOverviewResults");
var n=h.$gridContainer.find("a.more-link");
if(l.showMoreLink&&h.totalPage>1&&l.curPage<h.totalPage-1){n.removeClass("hide");
e("a.more-link").on("click",function(){if(typeof s!=="undefined"){PDC.SC.click("wishlist",this,"text",null)
}l.curPage++;
if(l.curPage>=h.totalPage-1){e(this).css({display:"none"});
l.curPage=h.totalPage-1
}h.buildTileList()
}).appendTo(h.$gridContainer)
}}else{h.$gridContainer.addClass("CM159_noOverviewResults");
h.showNoListDom(true)
}}else{h.showNoListDom(false)
}h.buildTileList()
};
b.prototype.buildTileList=function(){var v=this;
var r=v.options;
var k=v.listData.list.length;
var u=r.curPage*r.tilesPerPage;
var n=u+r.tilesPerPage;
var h=v.$tilesHolderUl;
n=n>=k?k:n;
var l=h.find(".tile").length;
if(l<u){u=l
}var q=v.listData.list.slice(u,n);
var p=function(){e(this).find(".game-tile-hover").addClass("hoverGameTiles")
};
var m=function(){e(this).find(".game-tile-hover").removeClass("hoverGameTiles")
};
v.removedWishGameCount=0;
var t=function(){if(typeof s!=="undefined"){PDC.SC.click("wishlist",this,"image",null)
}var z=e(this);
var x=z.data();
var w=h.find("li");
var y=w.eq(parseInt(e(this).parent().parent().parent().parent().parent().index()));
e("<div>").attr({"class":"ajax-loader"}).appendTo(y);
e.ajax({url:r.removeFromWish,type:"POST",cache:false,data:{actionType:"delete",gameId:z.attr("data-game-id"),userInfoCookie:e.cookie("userinfo")}}).done(function(B){if(B.status==="success"){y.css({display:"none"});
r.wishListCache=false;
var C=y.parent("ul").find(".tile-1").not(":hidden").length;
var A=c.sessionStorage.competeMyTiles=(c.sessionStorage.competeMyTiles-1)
}v.removedWishGameCount++;
if(w.length===v.removedWishGameCount){if(!(e("div#wishlistGridbox").find("a").hasClass("more-link"))){v.$element.addClass("CM159_noOverviewResults");
v.showNoListDom(true)
}else{e("div#wishlistGridbox").find("a.more-link").trigger("click")
}}})
};
e(q).each(function(R,V){var P=V.gameId;
var T=V.title;
var L=/<(\w+)[^>]*>.*<\/\1>/gi;
var D=T.replace(L,"&reg;");
var M="http://us.playstation.com/";
var Z=V.platform?V.platform.split(","):[];
e(Z).each(function(ab,ac){if(ac.match(/ps3/i)){Z[ab]="PS3"
}else{if(ac.match(/vita/i)){Z[ab]="PS VITA"
}else{if(ac.match(/ps2/i)){Z[ab]="PS2"
}else{if(ac.match(/psp/i)){Z[ab]="PSP"
}else{if(ac.match(/ps4/i)){Z[ab]="PS4"
}}}}}});
var y=V.gameLink;
var A=V.gameLink===""?"javascript:void(0);":M+V.gameLink+".html";
T=T.length>45?T.slice(0,45)+"...":T;
V.platform=Z.join(", ");
var K=V.platform;
var E=K.replace(/\s/g,"");
E=E.split(",");
var N="";
for(var R=0;
R<E.length;
R++){N+="<span class='titleLogo"+E[R]+"'></span>"
}var x=V.imgUrl;
var G="";
if(r.groupType==="want"){G=V.imgUrl
}else{G=V.imgUrl||"";
if(!V.imgUrl.match(/http/)){G=G.slice(G.lastIndexOf("/")+1,G.length)
}}var F=e("<li>").attr({"class":"layout-type-2 tile-1"}).appendTo(h);
var w=e("<div>").attr({"class":"game-tile"}).appendTo(F).on("mouseenter",p).on("mouseleave",m);
var Q=e("<div>").attr({"class":"tile clearfix"}).appendTo(w);
var U=V.title;
var C=U.replace(" ","-");
var B=e("<a>").attr({"class":"game-tile-image",href:y}).appendTo(Q).addClass(r.groupType);
var aa=e("<div>").html(D).html();
var J=e("<img>").attr({src:x,alt:aa,title:aa,}).appendTo(B);
var Y=e("<div>").attr({"class":"game-tile-details"}).html(N).appendTo(Q);
var H=e("<div>").attr({"class":"possession"}).appendTo(Y);
e();
if(r.groupType==="want"){e("<a>").attr({"class":"want-it",rel:P,title:r.wishListToolTip,"data-game-id":P,"data-li-index":R,href:"javascript:void(0);"}).html("<span>&nbsp;</span").on("click",t).appendTo(H)
}var S=e("<h2>").html("<a class='title'>"+T+"</a>").appendTo(Y);
if(typeof parseEComBtnData==="function"){var z=parseEComBtnData(V.eComBtn);
if(z.name){var X="eventVal="+z.trackEvent+",secName="+z.trackName+":game,platform="+z.platform+",contentId="+z.contentId+",skuId="+z.skuId;
var W=e("<div>").attr({"class":""}).appendTo(Q);
var I=e("<div>").attr({"class":"hover-button-right"}).appendTo(W);
var O=e("<a>").attr({"class":"link-btn prchse-btn orange-btn",onclick:z.clickFunc,href:z.link,target:z.target}).appendTo(I);
e("<div>").attr({"class":"btn"}).html(z.name).appendTo(O)
}}});
l=h.find(".tile-1").not(":hidden").length;
var o=v.$elementParent.parent().parent().find(".count-label");
if(l>0){o.css({visibility:"visible"}).html((o.html()).replace("{COUNT}","<strong>"+l+"</strong>").replace("{TOTALCOUNT}","<strong>"+c.sessionStorage.competeMyTiles+"</strong>"));
e(".count-label").html(o.html()).parent(".module-sub-text").show()
}else{o.css({visibility:"hidden"});
e("a.shareItem").hide()
}};
b.prototype.showNoListDom=function(l){var h=this;
h.$element.find(".module-sub-text > a").addClass("hide");
var k=h.options;
if(h.$ajaxPreloader){h.$ajaxPreloader.remove();
h.$gridContainer.css({height:"",position:""})
}if(l){h.$gridContainer.find(".no-data .wishlist").removeClass("hide")
}else{h.$gridContainer.find(".ajax-fail .wishlist").removeClass("hide")
}};
b.prototype.fetchData=function(){var h=this;
h.curAjax=e.ajax({url:h.dataUrl,dataType:"json",data:{userInfoCookie:e.cookie("userinfo")},cache:false});
return h.curAjax
};
if(navigator.appVersion.indexOf("MSIE 7.")!=-1){e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))
}})
}
}else{e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))
}})
}
}})(jQuery,window,document);
(function(e,c,a,g){var d="recentlyPlayedTrophies",f={userDataUrl:"//my.playstation.com/playstation/psn/profile/user/titles",tilesPerPage:4,curPage:0,userTrophiesData:null,filter:"recentlyPlayed",pageType:"private",compareTrophyPageLink:""};
function b(l,k){var h=this;
h.element=l;
h.$element=e(h.element);
h.$elementParent=h.$element.parent();
h.$key=h.$element.attr("id");
h.options=e.extend({},f,k);
h._defaults=f;
h._name=d;
h.$gridContainer=h.$element.find(".CM157_trophiesTileGrid");
h.$tilesHolderUl=h.$gridContainer.find("ul.tile-grid-trophies");
h.options.compareTrophyPageLink=h.$gridContainer.data("href");
h.$moreLink=h.$gridContainer.find("a.more-link");
h.$sortByDiv=h.$gridContainer.parent().find(".CC034-sortBy");
h.$headingWrapper=h.$element.find(".headingWrapper");
if(h.options.pageType==="public"){h.init()
}else{PDC.MyPlaystationProfile.getSignedUserData(function(m){if(m.handle){h.init()
}else{PDC.MyPlaystationProfile.redirectToLogin()
}})
}}b.prototype.init=function(){var k=this;
var m=k.options;
var l=e(a).width()<900?3:4;
if(m.tilesPerPage==0||m.tilesPerPage===3){m.tilesPerPage=l
}m.tilesPerPage=m.tilesPerPage-(m.tilesPerPage%l);
k.destroy();
k.$element.find(".sort select").selectbox({effect:"fade",speed:400,onChange:function(q,o){if(typeof s!=="undefined"){var p=e(this).find('option[value="'+q+'"]').text();
PDC.SC.click("trophyfinder",p,"text",null)
}e(this).closest(".trophyFinderModule").find(".CM157_trophiesTileGrid").trigger("filterChange",q)
}});
if(!m.userTrophiesData){var h;
if(m.pageType==="public"){var n=k.getParameterByName("onlineId");
if(typeof n!=="undefined"&&n!==null&&n!==""){h={onlineId:n}
}else{if(typeof c.sessionStorage.publicTrophiesSearchId!=="undefined"&&c.sessionStorage.publicTrophiesSearchId!==null&&c.sessionStorage.publicTrophiesSearchId!==""){PDC.MyPlaystationProfile.getPublicSearchId()
}}}else{h={userInfoCookie:e.cookie("userinfo")}
}if(typeof h!=="undefined"&&h!==null){k.fetchData(h)
}if(m.pageType==="public"){e(a).on("usersearch.search",function(p,o){k.$element.find(".sectionContainer").removeClass("hide");
k.$tilesHolderUl.html("");
k.fetchData({onlineId:o})
})
}}else{k.trophiesData=m.userTrophiesData;
k.buildDom()
}if(k.filterChangeHandler){e(k.$gridContainer).off("filterChange",k.filterChangeHandler)
}k.filterChangeHandler=function(p,o){m.filter=o;
k.filterList();
k.$tilesHolderUl.html("");
k.buildTileList()
};
e(k.$gridContainer).on("filterChange",k.filterChangeHandler)
};
b.prototype.destroy=function(){var h=this;
if(h.userTrophiesAjax){h.userTrophiesAjax.abort()
}};
b.prototype.fetchData=function(l){var h=this;
var k=h.options;
h.$ajaxPreloader=e("<div>").attr({"class":"ajax-loader"}).appendTo(h.$gridContainer);
h.$gridContainer.css({height:"290px",position:"relative"});
h.userTrophiesAjax=e.ajax({url:k.userDataUrl,dataType:"json",data:l,cache:false}).done(function(m){h.trophiesData=k.userTrophiesData=m;
h.buildDom();
h.bindPublicCompareGamesBtn(l)
}).fail(function(o,n,m){h.trophiesData=null;
h.buildDom();
h.bindPublicCompareGamesBtn(l)
})
};
b.prototype.buildDom=function(){var h=this;
var l=h.options;
var n=h.trophiesData;
var m=0;
l.curPage=0;
var k=h.$tilesHolderUl;
k.html("");
h.$gridContainer.find(".no-results-main").addClass("hide");
h.$gridContainer.removeClass("CM159_noOverviewResults");
h.$moreLink.addClass("hide");
h.$moreLink.off("click");
if(n&&n.list){m=n.list.length;
h.totalPage=Math.ceil(m/l.tilesPerPage);
if(h.$ajaxPreloader){h.$ajaxPreloader.remove();
h.$gridContainer.css({height:"",position:""})
}if(m>0){if(l.pageType==="public"){h.$headingWrapper.removeClass("hide")
}h.$sortByDiv.removeClass("hide");
if(h.$moreLink.length>0&&h.totalPage>1){h.$moreLink.removeClass("hide");
h.$moreLink.on("click",function(){if(typeof s!=="undefined"){PDC.SC.click("trophyfinder",this,"text",null)
}l.curPage++;
if(l.curPage>=h.totalPage-1){e(this).addClass("hide");
l.curPage=h.totalPage-1
}h.buildTileList()
})
}}else{h.showErrorMsg(true)
}}else{if(l.pageType==="public"&&!n.list){h.showErrorMsg(true)
}else{h.showErrorMsg(false)
}}if(m>0){h.filterList();
h.buildTileList()
}};
b.prototype.showErrorMsg=function(l){var h=this;
var k=h.options;
if(h.$ajaxPreloader){h.$ajaxPreloader.remove();
h.$gridContainer.css({height:"",position:""})
}if(k.pageType==="public"){h.$headingWrapper.addClass("hide")
}else{h.$element.find(".module-sub-text").addClass("hide")
}h.$gridContainer.addClass("CM159_noOverviewResults");
if(l){h.$gridContainer.find(".no-data").removeClass("hide")
}else{h.$gridContainer.find(".ajax-fail").removeClass("hide")
}};
b.prototype.filterList=function(){var h=this;
var k=h.options;
var m=h.trophiesData;
var l=false;
h.curList=m.list.slice(0);
if(k.filter==="aToZ"){h.curList.sort(function(o,n){o=o.title.toLowerCase();
n=n.title.toLowerCase();
if(o<n){return -1
}else{if(o>n){return 1
}else{return 0
}}})
}else{if(k.filter==="zToA"){h.curList.sort(function(o,n){o=o.title.toLowerCase();
n=n.title.toLowerCase();
if(o<n){return 1
}else{if(o>n){return -1
}else{return 0
}}})
}else{if(k.filter==="trophies"){h.curList.sort(function(o,n){var p=o.trophies;
o=parseInt(p.bronze)+parseInt(p.silver)+parseInt(p.gold)+parseInt(p.platinum);
p=n.trophies;
n=parseInt(p.bronze)+parseInt(p.silver)+parseInt(p.gold)+parseInt(p.platinum);
if((o!==0||n!==0)&&!l){l=true
}return n-o
})
}else{if(k.filter==="progress"){h.curList.sort(function(o,n){o=parseInt(o.progress);
n=parseInt(n.progress);
if((o!==0||n!==0)&&!l){l=true
}return n-o
})
}}}}h.isFilteringOccured=l
};
b.prototype.buildTileList=function(){var v=this;
var q=v.options;
var l=v.curList.length;
var t=q.curPage*q.tilesPerPage;
var o=t+q.tilesPerPage;
var k=v.$tilesHolderUl;
o=o>=l?l:o;
var m=k.find(".tile").length;
if(m<t){t=m
}var p=v.curList.slice(t,o);
var r=function(){if(typeof s!=="undefined"){var y=e(this).find("h2.title").text();
var w=e(this).find(".btn").text();
PDC.SC.click("trophyfinder",w,"text",{link_section_name:y})
}var x=e(this).data();
v.setDataInSession(this,x.gameid,x.handle)
};
e(p).each(function(M,N){var G=e("<li>").attr({"class":"tile"}).appendTo(k);
var y=e("<div>").attr({"class":"compete-tile CC030-game-trophies-tile"}).appendTo(G);
var O=v.trophiesData.handle;
var R=e("<div>").html(N.title).html();
var A=e("<a>").attr({"class":"tile-link clearfix","data-gameid":N.gameId,"data-handle":O,href:"javascript:void(0);"}).appendTo(y);
A.on("click",r);
e("<div>").attr({"class":"trophy-image"}).html('<img style="width:220px;" src="'+N.imgUrl+'" alt="'+R+'" title= "'+R+'">').appendTo(A);
var B=e("<div>").attr({"class":"compete-tile-details"}).appendTo(A);
var Q=N.platform?N.platform.split(","):[];
e(Q).each(function(S,T){if(T.match(/ps3/i)){Q[S]="PS3"
}else{if(T.match(/vita/i)){Q[S]="PS VITA"
}else{if(T.match(/ps2/i)){Q[S]="PS2"
}else{if(T.match(/psp/i)){Q[S]="PSP"
}else{if(T.match(/ps4/i)){Q[S]="PS4"
}}}}}});
N.platform=Q.join(", ");
var H=N.platform;
var K=N.platform;
var x=Adobe.I18n.get("View & Compare");
var F=K.replace(/\s/g,"");
F=F.split(",");
var I="";
for(var M=0;
M<F.length;
M++){I+="<span class='titleLogo"+F[M]+"'>"+H+"</span>"
}var z=e("<div>").attr({"class":"fixed-container"}).html(I).appendTo(B);
e("<h2>").attr({"class":"clearfix title"}).html(R).appendTo(z);
var C=N.trophies;
var D=e("<ul>").attr({"class":"trophies clearfix"}).appendTo(B);
e("<li>").attr({"class":"bronze"}).html(C.bronze).appendTo(D);
e("<li>").attr({"class":"silver"}).html(C.silver).appendTo(D);
e("<li>").attr({"class":"gold"}).html(C.gold).appendTo(D);
e("<li>").attr({"class":"platinum"}).html(C.platinum).appendTo(D);
var E=e("<div>").attr({"class":"progress clearfix"}).appendTo(B);
var L=e("<div>").attr({"class":"bar"}).appendTo(E);
e("<div>").attr({"class":"slider"}).css({width:N.progress+"%"}).appendTo(L);
e("<span>").html(N.progress+"%").appendTo(E);
if(c.navigator.userAgent.toString().indexOf("PLAYSTATION 3")===-1){var J=e("<div>").attr({"class":"button-row"}).appendTo(A);
var w=e("<div>").attr({"class":"link-btn blue-btn small-btn"}).appendTo(J);
var P=e("<div>").attr({"class":"btn"}).html(x).appendTo(w)
}});
m=k.find(".tile").length;
var h=v.$gridContainer.parent().find(".count-label");
var n=h.find("strong");
if(n.length>0){if(q.pageType==="public"){n.text(m)
}else{e(n[0]).text(m);
if(n>1){e(n[1]).text(l)
}}}else{var u=h.text();
if(q.pageType==="public"){h.html(u.replace("{COUNT}","<strong>"+m+"</strong>"))
}else{h.html(u.replace("{COUNT}","<strong>"+m+"</strong>").replace("{TOTALCOUNT}","<strong>"+l+"</strong>"))
}}if(m>0){h.parent().removeClass("hide")
}else{h.parent().addClass("hide")
}};
b.prototype.setDataInSession=function(o,l,n){var h=this;
var k=h.options;
var m="";
if(k.pageType==="public"){m="&compare="+h.encodeUrlVars(k.userDataUrl).onlineId
}if(c.navigator.userAgent.toString().indexOf("PLAYSTATION 3")===-1){c.sessionStorage.compareTrophiesVars="gid="+l+m;
c.location=k.compareTrophyPageLink
}};
b.prototype.encodeUrlVars=function(k){k=k||"";
var h={};
k.replace(/([^#&=?]+)=([^&=]+)/gi,function(m,l,o,n){h[l]=o
});
return h
};
b.prototype.getParameterByName=function(l){l=l.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");
var m=new RegExp("[\\?&]"+l+"=([^&#]*)"),k=m.exec(location.search);
var h="";
if(k!=null){h=decodeURIComponent(k[1].replace(/\+/g," "))
}return h
};
b.prototype.bindPublicCompareGamesBtn=function(m){var h=this;
var k=h.options;
if(k.pageType==="public"){var l=h.$sortByDiv.find(".compare-game-btn");
if(l.length>0){l.off("click");
l.on("click",function(n){c.location.href=e(this).data("href")
})
}}};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){var k=new b(this,h);
e.fn[d].refArray.push(k);
e.data(this,"plugin_"+d,k)
}})
}
})(jQuery,window,document);
(function(e,c,a,g){var d="recentlyPlayedTrophyGrid",f={friendsDataUrl:"//my.playstation.com/playstation/psn/profile/user/friends/recent/titles",userDataUrl:"//my.playstation.com/playstation/psn/profile/user/recent/titles",groupType:"you",tilesPerPage:4,curPage:0,userTrophiesData:null,friendsTrophiesData:null,compareTrophyPageLink:""};
function b(l,k){var h=this;
h.element=l;
h.$element=e(h.element);
h.$elementParent=h.$element.parent();
h.$key=h.$element.attr("id");
h.options=e.extend({},f,k);
h._defaults=f;
h._name=d;
h.$gridContainer=h.$element.find(".recentlyPlayedGrid");
h.options.compareTrophyPageLink=h.$gridContainer.data("href");
PDC.MyPlaystationProfile.getSignedUserData(function(m){if(m.handle){h.initTabs();
h.init()
}else{PDC.MyPlaystationProfile.redirectToLogin()
}})
}b.prototype.init=function(){var h=this;
var l=h.options;
var k=e(a).width()<900?3:4;
if(l.tilesPerPage==0||l.tilesPerPage===3){l.tilesPerPage=k
}l.tilesPerPage=l.tilesPerPage-(l.tilesPerPage%k);
h.destroy();
h.$ajaxPreloader=e("<div>").attr({"class":"ajax-loader"}).appendTo(h.$gridContainer);
h.$gridContainer.css({height:"290px",position:"relative"});
if(!l.userTrophiesData&&l.groupType==="you"){h.userTrophiesAjax=e.ajax({url:l.userDataUrl,dataType:"json",data:{userInfoCookie:e.cookie("userinfo")},cache:false}).done(function(m){h.trophiesData=l.userTrophiesData=m;
h.buildDom()
}).fail(function(o,n,m){h.trophiesData=null;
h.buildDom()
})
}else{if(!l.friendsTrophiesData&&l.groupType==="friends"){if(e.cookie("ps_auth")){h.friendsTrophiesAjax=e.ajax({url:l.friendsDataUrl,dataType:"json",data:{ps_auth:e.cookie("ps_auth")},cache:false}).done(function(m){h.trophiesData=l.friendsTrophiesData=m;
h.buildDom()
}).fail(function(o,n,m){h.trophiesData=null;
h.buildDom()
})
}else{PDC.MyPlaystationProfile.redirectToLogin()
}}else{h.trophiesData=l.groupType==="you"?l.userTrophiesData:l.friendsTrophiesData;
h.buildDom()
}}};
b.prototype.destroy=function(){var h=this;
if(h.userTrophiesAjax){h.userTrophiesAjax.abort()
}if(h.friendsTrophiesAjax){h.friendsTrophiesAjax.abort()
}h.$element.find(".module-sub-text > a").addClass("hide");
h.$gridContainer.find("ul.tile-grid-trophies").html("");
h.$gridContainer.find("ul.tile-grid-trophies").hide();
h.$gridContainer.removeClass("CM159_noOverviewResults");
h.$gridContainer.find(".recentlyPlayedByYou").addClass("hide")
};
b.prototype.initTabs=function(){var h=this;
var k=h.options;
var l=this.$element.find(".toggle-tabs a");
l.on("click",function(n){n.preventDefault();
var m=e(this),o=m.attr("data-filter-value");
if(m.hasClass("selected")){return 0
}else{l.removeClass("selected");
e(this).addClass("selected");
if(typeof s!=="undefined"){PDC.SC.click("recentlyplayedgames",this,"text",null)
}e(this).closest(".recentlyPlayedModule").find(".recentlyPlayedGrid").trigger("filterChange",o)
}});
if(h.filterChangeHandler){h.$gridContainer.off("filterChange",h.filterChangeHandler)
}h.filterChangeHandler=function(n,m){k.groupType=m;
h.init()
};
h.$gridContainer.on("filterChange",h.filterChangeHandler)
};
b.prototype.buildDom=function(){var h=this;
var l=h.options;
var n=h.trophiesData;
var m=0;
if(n&&n.list){m=n.list.length;
h.totalPage=Math.ceil(m/l.tilesPerPage);
if(h.$ajaxPreloader){h.$ajaxPreloader.remove();
h.$gridContainer.css({height:"",position:""})
}var k=h.$tilesHolderUl=h.$gridContainer.find("ul.tile-grid-trophies");
if(m>0){h.$element.find('.module-sub-text > a[data-filter-value="'+l.groupType+'"]').removeClass("hide");
h.$tilesHolderUl.show()
}else{h.showErrorMsg(true)
}}else{h.showErrorMsg(false)
}if(m>0){h.filterList();
h.buildTileList()
}};
b.prototype.showErrorMsg=function(l){var h=this;
h.$element.find(".module-sub-text > a").addClass("hide");
var k=h.options;
if(h.$ajaxPreloader){h.$ajaxPreloader.remove();
h.$gridContainer.css({height:"",position:""})
}h.$gridContainer.addClass("CM159_noOverviewResults");
if(l){h.$gridContainer.find('.no-data > .recentlyPlayedByYou[data-filter-value="'+k.groupType+'"]').removeClass("hide")
}else{h.$gridContainer.find('.ajax-fail > .recentlyPlayedByYou[data-filter-value="'+k.groupType+'"]').removeClass("hide")
}};
b.prototype.filterList=function(){var h=this;
var k=h.options;
var m=h.trophiesData;
var l=false;
h.curList=m.list.slice(0)
};
b.prototype.buildTileList=function(){var r=this;
var o=r.options;
var k=r.curList.length;
var q=o.curPage*o.tilesPerPage;
var m=q+o.tilesPerPage;
var h=r.$tilesHolderUl;
m=m>=k?k:m;
var l=h.find(".tile").length;
if(l<q){q=l
}var n=r.curList.slice(q,m);
var p=function(){if(typeof s!=="undefined"){var v=e(this).find("h2.title").text();
var t=e(this).find(".btn").text();
PDC.SC.click("recentlyplayedgames",t,"image",{link_section_name:v})
}var u=e(this).data();
r.setDataInSession(this,u.gameid,u.handle)
};
e(n).each(function(J,K){var D=e("<li>").attr({"class":"tile"}).appendTo(h);
var v=e("<div>").attr({"class":"compete-tile CC030-game-trophies-tile"}).appendTo(D);
var L=o.groupType==="you"?r.trophiesData.handle:K.handle;
var O=e("<div>").html(K.title).html();
var x=e("<a>").attr({"class":"tile-link clearfix","data-gameid":K.gameId,"data-handle":L,href:"javascript:void(0);"}).appendTo(v);
x.on("click",p);
e("<div>").attr({"class":"trophy-image"}).html('<img style="width:220px;" src="'+K.imgUrl+'" alt="'+O+'" title= "'+O+'">').appendTo(x);
var y=e("<div>").attr({"class":"compete-tile-details"}).appendTo(x);
var N=K.platform?K.platform.split(","):[];
e(N).each(function(P,Q){if(Q.match(/ps3/i)){N[P]="PS3"
}else{if(Q.match(/vita/i)){N[P]="PS VITA"
}else{if(Q.match(/ps2/i)){N[P]="PS2"
}else{if(Q.match(/psp/i)){N[P]="PSP"
}else{if(Q.match(/ps4/i)){N[P]="PS4"
}}}}}});
K.platform=N.join(", ");
var E=o.groupType==="friends"?K.handle:K.platform;
var H=o.groupType==="friends"?K.handle:K.platform;
var u=o.groupType==="friends"?Adobe.I18n.get("Compare"):Adobe.I18n.get("View & Compare");
var C=H.replace(/\s/g,"");
C=C.split(",");
var F="";
for(var J=0;
J<C.length;
J++){F+="<span class='titleLogo"+C[J]+"'>"+E+"</span>"
}var w=e("<div>").attr({"class":"fixed-container"}).html(F).appendTo(y);
e("<h2>").attr({"class":"clearfix title"}).html(O).appendTo(w);
var z=K.trophies;
var A=e("<ul>").attr({"class":"trophies clearfix"}).appendTo(y);
e("<li>").attr({"class":"bronze"}).html(z.bronze).appendTo(A);
e("<li>").attr({"class":"silver"}).html(z.silver).appendTo(A);
e("<li>").attr({"class":"gold"}).html(z.gold).appendTo(A);
e("<li>").attr({"class":"platinum"}).html(z.platinum).appendTo(A);
var B=e("<div>").attr({"class":"progress clearfix"}).appendTo(y);
var I=e("<div>").attr({"class":"bar"}).appendTo(B);
e("<div>").attr({"class":"slider"}).css({width:K.progress+"%"}).appendTo(I);
e("<span>").html(K.progress+"%").appendTo(B);
if(c.navigator.userAgent.toString().indexOf("PLAYSTATION 3")===-1){var G=e("<div>").attr({"class":"button-row"}).appendTo(x);
var t=e("<div>").attr({"class":"link-btn blue-btn small-btn"}).appendTo(G);
var M=e("<div>").attr({"class":"btn"}).html(u).appendTo(t)
}})
};
b.prototype.setDataInSession=function(o,l,n){var h=this;
var k=h.options;
var m="";
if(k.groupType==="friends"){m="&compare="+n
}if(c.navigator.userAgent.toString().indexOf("PLAYSTATION 3")===-1){c.sessionStorage.compareTrophiesVars="gid="+l+m;
c.location=k.compareTrophyPageLink
}};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){var k=new b(this,h);
e.fn[d].refArray.push(k);
e.data(this,"plugin_"+d,k)
}})
}
})(jQuery,window,document);
(function(e,c,a,g){var d="recentTrophyGrid",f={friendsDataUrl:"static/trophiDataServer/recentTrophiesOfFriends.json?"+Math.random(),userDataUrl:"static/trophiDataServer/recentTrophiesOfUser.json?"+Math.random(),groupType:"you",userTrophiesData:null,friendsTrophiesData:null,templateId:""};
function b(l,k){var h=this;
h.element=l;
h.$element=e(h.element);
h.$elementParent=h.$element.parent();
h.$key=h.$element.attr("id");
h.options=e.extend({},f,k);
h._defaults=f;
h._name=d;
h.$gridContainer=h.$element.find(".recentTrophiesGrid");
PDC.MyPlaystationProfile.getSignedUserData(function(m){if(m.handle){h.initTabs();
h.init()
}else{PDC.MyPlaystationProfile.redirectToLogin()
}})
}b.prototype.init=function(){var h=this;
var k=h.options;
h.destroy();
h.$ajaxPreloader=e("<div>").attr({"class":"ajax-loader"}).appendTo(h.$gridContainer);
h.$gridContainer.css({height:"290px",position:"relative"});
if(!k.userTrophiesData&&k.groupType==="you"){h.dataUrl=k.userDataUrl;
h.userTrophiesAjax=h.fetchData().done(function(l){h.trophiesData=k.userTrophiesData=l;
h.buildDom()
}).fail(function(n,m,l){h.trophiesData=null;
h.buildDom()
})
}else{if(!k.friendsTrophiesData&&k.groupType==="friends"){if(e.cookie("ps_auth")){h.friendsTrophiesAjax=e.ajax({url:k.friendsDataUrl,dataType:"json",data:{ps_auth:e.cookie("ps_auth")},cache:false}).done(function(l){h.trophiesData=k.friendsTrophiesData=l;
h.buildDom()
}).fail(function(n,m,l){h.trophiesData=null;
h.buildDom()
})
}else{PDC.MyPlaystationProfile.redirectToLogin()
}}else{h.trophiesData=k.groupType==="you"?k.userTrophiesData:k.friendsTrophiesData;
h.buildDom()
}}};
b.prototype.destroy=function(){var h=this;
if(h.userTrophiesAjax){h.userTrophiesAjax.abort()
}if(h.friendsTrophiesAjax){h.friendsTrophiesAjax.abort()
}h.$element.find(".module-sub-text > a").addClass("hide");
h.$gridContainer.find("ul.tile-grid-trophies").html("");
h.$gridContainer.find("ul.tile-grid-trophies").hide()
};
b.prototype.initTabs=function(){var h=this;
var k=h.options;
var l=this.$element.find(".toggle-tabs a");
l.on("click",function(n){n.preventDefault();
h.$gridContainer.find(".recentTrophies").addClass("hide");
var m=e(this),o=m.attr("data-filter-value");
k.groupType=o;
if(m.hasClass("selected")){return 0
}else{l.removeClass("selected");
h.$gridContainer.find("li.tile").addClass("hide");
e(this).addClass("selected");
if(typeof s!=="undefined"){PDC.SC.click("recenttrophy",this,"text",null)
}e(this).closest(".recentTrophyModule").find(".recentTrophiesGrid").trigger("filterChange",o)
}});
if(h.filterChangeHandler){h.$gridContainer.off("filterChange",h.filterChangeHandler)
}h.filterChangeHandler=function(n,m){k.groupType=m;
h.init()
};
h.$gridContainer.on("filterChange",h.filterChangeHandler)
};
b.prototype.buildDom=function(){var h=this;
var l=h.options;
var n=h.trophiesData;
var m=0;
var k=h.$tilesHolderUl=h.$gridContainer.find("ul.tile-grid-trophies");
if(n&&n.list){m=n.list.length;
if(h.$ajaxPreloader){h.$ajaxPreloader.remove();
h.$gridContainer.css({height:"",position:""})
}if(m>0){h.$element.find(".module-sub-text a").addClass("hide");
h.$element.find('.module-sub-text > a[data-filter-value="'+l.groupType+'"]').removeClass("hide");
h.$tilesHolderUl.show()
}else{h.showErrorMsg(true)
}}else{h.showErrorMsg(false)
}if(m>0){n.list=n.list.slice(0,4);
if(l.groupType!="you"){e(n.list).each(function(o,p){n.list[o].gameName=n.list[o].handle
})
}h.$tilesHolderUl.html(tmpl(h.options.templateId,n))
}};
b.prototype.showErrorMsg=function(l){var h=this;
h.$element.find(".module-sub-text > a").addClass("hide");
var k=h.options;
if(h.$ajaxPreloader){h.$ajaxPreloader.remove();
h.$gridContainer.css({height:"",position:""})
}if(l){h.$gridContainer.find('.no-data > .recentTrophies[data-filter-value="'+k.groupType+'"]').removeClass("hide")
}else{h.$gridContainer.find('.ajax-fail > .recentTrophies[data-filter-value="'+k.groupType+'"]').removeClass("hide")
}};
b.prototype.fetchData=function(){var h=this;
h.curAjax=e.ajax({url:h.dataUrl,dataType:"json",data:{userInfoCookie:e.cookie("userinfo")},cache:false});
return h.curAjax
};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){var k=new b(this,h);
e.fn[d].refArray.push(k);
e.data(this,"plugin_"+d,k)
}})
}
})(jQuery,window,document);
(function(e,c,a,h){var g="";
var d="friendsTileGrid",f={friendsDataUrl:"//my.playstation.com/playstation/psn/profile/friends?"+Math.random(),userDataUrl:"//my.playstation.com/playstation/psn/profile/getFavFriends?"+Math.random(),favouriteCall:"//my.playstation.com/playstation/psn/profile/saveFavourites",lastseenCall:"//my.playstation.com/playstation/psn/profile/lastseen/",gamePlayingCall:"//my.playstation.com/playstation/psn/profile/user/game/playing/",tilesPerPage:4,curPage:0,userTrophiesData:null,friendsTrophiesData:null,filter:"onlineFriends",refreshFavChanges:false,useUrlVars:false,favFriendsCountMsg:Adobe.I18n.get("Showing {COUNT} out of {TOTALCOUNT} friends.")};
function b(n,m){var k=this;
k.element=n;
k.$element=e(k.element);
k.$elementParent=k.$element.parent();
k.$key=k.$element.attr("id");
k.options=e.extend({},f,m);
k._defaults=f;
k._name=d;
var l=k.options;
e(c).scroll(function(){if((l.curPage<=k.totalPage-1)&&(e(c).scrollTop()+e(c).height())>=(e(a).height()-350)){l.curPage++;
k.buildTileList()
}});
PDC.MyPlaystationProfile.getSignedUserData(function(o){if(o.handle){k.loginUserId=o.handle;
k.init();
k.addGameListChangeEvent()
}else{PDC.MyPlaystationProfile.redirectToLogin()
}})
}b.prototype.addGameListChangeEvent=function(){var k=this;
var l=k.options;
e(c).on("gameListChange",function(p,o){var m=l.friendsDataUrl;
var n=m.indexOf("?")!=-1?m.indexOf("?"):m.length;
l.friendsDataUrl=m.slice(0,n)+"?gameId="+o;
l.friendsTrophiesData=null;
k.init()
})
};
b.prototype.init=function(){var l=this;
var n=l.options;
var p=l.encodeUrlVars(c.sessionStorage.compareTrophiesVars);
if(n.componentCtx==="gamespecificfriend"){if(!p.gid){p=encodeUrlVars(c.location.href)
}if(p.gid){var k=n.friendsDataUrl;
var o=k.indexOf("?")!=-1?k.indexOf("?"):k.length;
n.friendsDataUrl=k.slice(0,o)+"?gameId="+p.gid
}}var m=e(c).width()<940?3:4;
n.tilesPerPage=n.tilesPerPage-(n.tilesPerPage%m);
l.dataVars=l.dataVars||{};
if(PDC.MyPlaystationProfile.isFriendsAuthExist(false)){l.dataVars.ps_auth=e.cookie("ps_auth")
}if(e.cookie("userinfo")){l.dataVars.userInfoCookie=e.cookie("userinfo")
}l.dataVars.userIds=l.loginUserId;
l.$element.html("");
l.$element.find(".show-label").off("click");
l.$ajaxPreloader=e("<div>").attr({"class":"ajax-loader"}).appendTo(l.$element);
l.$element.css({height:"270px",position:"relative"});
if(l.curAjax){l.curAjax.abort()
}if(!n.userTrophiesData&&n.groupType==="you"){l.dataUrl=n.userDataUrl;
l.fetchData().done(function(q){l.trophiesData=n.userTrophiesData=q;
l.buildDom();
e(c).trigger("friendsTileGridLoaded",q)
}).fail(function(t,r,q){l.$element.prev(".headingWrapper").addClass("hide");
l.$element.addClass("hide");
l.trophiesData=null;
l.buildDom()
})
}else{if(!n.friendsTrophiesData&&n.groupType==="friends"){l.dataUrl=n.friendsDataUrl;
if(n.componentCtx==="gamespecificfriend"){l.$element.closest("section").find(".CM160-friends-tile-grid-messages-wrapper").addClass("hide");
l.$element.closest("section").find('.CM160-friends-tile-grid-messages-wrapper .no-data > .recentlyPlayedByYou[data-filter-value="'+n.groupType+'"]').addClass("hide");
l.$element.closest("section").find('.CM160-friends-tile-grid-messages-wrapper .ajax-fail > .recentlyPlayedByYou[data-filter-value="'+n.groupType+'"]').addClass("hide");
l.$element.closest("section").find(".err-msg > .message-box-online").addClass("hide");
l.$element.addClass("ajax-loader")
}l.fetchData().done(function(q){l.trophiesData=n.friendsTrophiesData=q;
l.buildDom();
e(c).trigger("friendsTileGridLoaded",q)
}).fail(function(t,r,q){l.$element.prev(".headingWrapper").addClass("hide");
l.$element.addClass("hide");
l.trophiesData=null;
l.buildDom()
})
}else{l.trophiesData=n.groupType==="you"?n.userTrophiesData:n.friendsTrophiesData;
l.buildDom()
}}if(l.filterChangeHandler){e(c).off("filterChange",l.filterChangeHandler)
}l.filterChangeHandler=function(q,r){if(r.CM160_sortType){n.filter=r.CM160_sortType;
l.filterList();
l.$tilesHolderUl.html("");
l.buildTileList()
}else{if(r.CM160_groupType){n.groupType=r.CM160_groupType;
l.init()
}}};
e(c).on("filterChange",l.filterChangeHandler)
};
b.prototype.buildDom=function(){var k=this;
var m=k.options;
var o=k.trophiesData;
var n=0;
if(o&&o.list){n=o.list.length;
k.totalPage=Math.ceil(n/m.tilesPerPage);
if(k.$ajaxPreloader){k.$ajaxPreloader.remove();
k.$element.css({height:"",position:""})
}var l=k.$tilesHolderUl=e("<ul>").attr({"class":"tile-grid-friends"}).appendTo(k.$element);
if(n>0){k.$element.removeClass("CM159_noOverviewResults").removeClass("hide");
if(m.componentCtx==="gamespecificfriend"){this.$element.siblings(".CM160-friends-tile-grid-messages-wrapper").addClass("hide");
this.$element.siblings(".CM160-friends-tile-grid-messages-wrapper").find('.no-data > .recentlyPlayedByYou[data-filter-value="'+m.groupType+'"]').addClass("hide")
}k.$element.addClass("moduleComponent clearfix CM160_friendsTileGrid");
k.$element.removeClass("ajax-loader");
k.$elementParent.find(".CC034-sortBy").removeClass("hide")
}else{k.$element.removeClass("moduleComponent clearfix CM160_friendsTileGrid").removeClass("ajax-loader");
k.$element.addClass("CM159_noOverviewResults");
k.$element.html("");
if(m.componentCtx==="gamespecificfriend"){k.$element.closest("section").find(".err-msg > .message-box-online").addClass("hide")
}if(m.groupType=="you"){this.$element.siblings(".CM160-friends-tile-grid-messages-wrapper").removeClass("hide");
this.$element.siblings(".CM160-friends-tile-grid-messages-wrapper").find('.no-user > .recentlyPlayedByYou[data-filter-value="'+m.groupType+'"]').removeClass("hide")
}else{this.$element.siblings(".CM160-friends-tile-grid-messages-wrapper").removeClass("hide");
this.$element.siblings(".CM160-friends-tile-grid-messages-wrapper").find('.no-data > .recentlyPlayedByYou[data-filter-value="'+m.groupType+'"]').removeClass("hide")
}k.$element.prev(".headingWrapper").addClass("hide");
k.$element.addClass("hide")
}}else{k.$element.addClass("hide");
k.$element.html("");
k.$element.removeClass("moduleComponent clearfix CM160_friendsTileGrid");
k.$element.removeClass("ajax-loader");
this.$element.siblings(".CM160-friends-tile-grid-messages-wrapper").removeClass("hide");
this.$element.siblings(".CM160-friends-tile-grid-messages-wrapper").find('.ajax-fail > .recentlyPlayedByYou[data-filter-value="'+m.groupType+'"]').removeClass("hide");
k.$element.prev(".headingWrapper").addClass("hide");
k.$element.addClass("hide")
}if(n>1){if(k.$element.closest("section").find(".sort, .filterText").hasClass("hide")){k.$element.closest("section").find(".sort, .filterText").removeClass("hide")
}}else{if(!k.$element.closest("section").find(".sort, .filterText").hasClass("hide")){if(!(m.componentCtx==="gamespecificfriend")){k.$element.closest("section").find(".sort, .filterText").addClass("hide")
}}}if(n>0){k.filterList();
k.buildTileList()
}};
b.prototype.filterList=function(){var k=this;
var l=k.options;
var n=k.trophiesData;
var m=false;
k.curList=n.list.slice(0);
if(l.filter==="aToZ"){k.curList.sort(function(p,o){p=p.handle.toLowerCase();
o=o.handle.toLowerCase();
if(p<o){return -1
}else{if(p>o){return 1
}else{return 0
}}})
}else{if(l.filter==="zToA"){k.curList.sort(function(p,o){p=p.handle.toLowerCase();
o=o.handle.toLowerCase();
if(p<o){return 1
}else{if(p>o){return -1
}else{return 0
}}})
}else{if(l.filter==="trophies"){k.curList.sort(function(p,o){var q=p.trophies;
p=parseInt(q.bronze)+parseInt(q.silver)+parseInt(q.gold)+parseInt(q.platinum);
q=o.trophies;
o=parseInt(q.bronze)+parseInt(q.silver)+parseInt(q.gold)+parseInt(q.platinum);
if((p!==0||o!==0)&&!m){m=true
}return o-p
})
}else{if(l.filter==="favourites"){k.curList.sort(function(p,o){p=parseInt(p.isFavourite);
o=parseInt(o.isFavourite);
if((p!==0||o!==0)&&!m){m=true
}return o-p
})
}else{if(l.filter==="onlineFriends"){k.curList.sort(function(p,o){p=parseInt(p.isOnline);
o=parseInt(o.isOnline);
if((p!==0||o!==0)&&!m){m=true
}return o-p
})
}}}}}k.isFilteringOccured=m
};
b.prototype.showFilterMsg=function(){var k=this;
var l=k.options;
if(!(k.$element.closest("section").find(".err-msg > .message-box-favorite").hasClass("hide"))){k.$element.closest("section").find(".err-msg > .message-box-favorite").addClass("hide")
}if(!(k.$element.closest("section").find(".err-msg > .message-box-online").hasClass("hide"))){k.$element.closest("section").find(".err-msg > .message-box-online").addClass("hide")
}if(!k.isFilteringOccured){if(l.filter==="favourites"){k.$element.closest("section").find(".err-msg > .message-box-favorite").removeClass("hide")
}else{if(l.filter==="onlineFriends"){if(c.location.href.indexOf(k.$element.closest("section").find(".profilePageLink").data("href"))==-1){k.$element.closest("section").find(".err-msg > .message-box-online").removeClass("hide")
}}}}};
b.prototype.buildTileList=function(){var v=this;
var r=v.options;
var l=v.curList.length;
var u=r.curPage*r.tilesPerPage;
var o=u+r.tilesPerPage;
var k=v.$tilesHolderUl;
if(PDC.MyPlaystationProfile.isFriendsAuthExist(false)){v.dataVars.ps_auth=e.cookie("ps_auth")
}if(e.cookie("userinfo")){v.dataVars.userInfoCookie=e.cookie("userinfo")
}o=o>=l?l:o;
v.showFilterMsg();
var m=k.find(".tile").length;
if(m<u){u=m
}var q=v.curList.slice(u,o);
var t=function(){var w=e(this).data();
if(typeof s!=="undefined"){PDC.SC.click(r.componentCtx,"compare","button",null)
}if(w.gameId){c.sessionStorage.compareTrophiesVars="gid="+w.gameId+"&compare="+w.handle
}else{c.sessionStorage.compareGamesVars="compare="+w.handle
}c.location=v.$element.closest("section").find(".compareLink").data("href")
};
e(q).each(function(M,O){var G=e("<li>").attr({"class":"tile","data-isonline":O.isOnline,"data-handle":O.handle}).appendTo(k);
var x=e("<div>").attr({"class":"compete-tile CC032-friend-trophies-tile"}).appendTo(G);
var z=e("<a>").attr({"class":"tile-link clearfix"}).appendTo(x);
if("isFavourite" in O){if(parseInt(O.isFavourite)===1){z.addClass("favourite");
g=Adobe.I18n.get("Favorite")
}else{g=Adobe.I18n.get("Favorite")
}}else{z.addClass("favourite");
g="favourite"
}var S=e("<div>").attr({"class":"friend clearfix"}).appendTo(z);
if(O.isPlusUser==="1"||O.isPlusUser==="true"){e("<div>").attr({"class":"ps-plus"}).html("&nbsp;").appendTo(S)
}e("<div>").attr({"class":"avatar","data-handle":O.handle}).html('<img width="100" height="100" alt="'+O.handle+'" title="'+O.handle+'" src="'+O.avatarUrl+'"/>').css({cursor:"pointer"}).appendTo(S).on("click",function(){if(c.navigator.userAgent.toString().indexOf("PLAYSTATION 3")>-1){}else{c.sessionStorage.publicTrophiesSearchId=e(this).data().handle;
c.location=v.$element.closest("section").find(".publicTrophiesPageLink").data("href")
}});
e("<div>").attr({"class":"level"}).html("<p>"+Adobe.I18n.get("Level")+"</p><span>"+O.curLevel+"</span>").appendTo(S);
var A=e("<div>").attr({"class":"compete-tile-details"}).appendTo(z);
var H=r.groupType==="friends"?O.friendId:O.platform;
var y=e("<div>").attr({"class":"fixed-container"}).appendTo(A);
e("<h2>").attr({"class":"clearfix title","data-handle":O.handle}).html(O.handle).appendTo(y).css({cursor:"pointer"}).on("click",function(){if(c.navigator.userAgent.toString().indexOf("PLAYSTATION 3")>-1){}else{c.sessionStorage.publicTrophiesSearchId=e(this).data().handle;
c.location=v.$element.closest("section").find(".publicTrophiesPageLink").data("href")
}});
if(parseInt(O.isOnline)){var J=e("<h3>").attr({"class":"clearfix friend-online",id:O.handle}).html(Adobe.I18n.get("Online")).appendTo(y);
var I=e("<h4>").attr({"class":"clearfix ajax-loader-lastseen",id:"gamePlaying"+O.handle}).appendTo(y);
v.dataUrl=r.gamePlayingCall;
v.dataVars.userIds=O.handle;
v.fetchData().done(function(T){if(typeof(T.playing)=="undefined"||T.playing==null){I.remove()
}else{if(T.playing){I.attr("title",T.playing).html(T.playing).removeClass("ajax-loader-lastseen").addClass("lastPlaying")
}else{I.remove()
}}})
}else{var J=e("<h3>").attr({"class":"clearfix friend-offline",id:O.handle}).html(Adobe.I18n.get("Offline")).appendTo(y);
var L=e("<h4>").attr({"class":"clearfix ajax-loader-lastseen",id:"gamePlaying"+O.handle}).appendTo(y);
v.dataUrl=r.lastseenCall;
v.dataVars.userIds=O.handle;
v.fetchData().done(function(T){if(typeof(T.lastSeen)=="undefined"||T.lastSeen==null){L.remove()
}else{L.html(Adobe.I18n.get("Last Seen")+" "+T.lastSeen).removeClass("ajax-loader-lastseen").addClass("lastseen")
}})
}var D=O.trophies;
var F=e("<ul>").attr({"class":"trophies clearfix"}).appendTo(A);
e("<li>").attr({"class":"bronze"}).html(D.bronze).appendTo(F);
e("<li>").attr({"class":"silver"}).html(D.silver).appendTo(F);
e("<li>").attr({"class":"gold"}).html(D.gold).appendTo(F);
e("<li>").attr({"class":"platinum"}).html(D.platinum).appendTo(F);
var B=parseInt(D.bronze)+parseInt(D.silver)+parseInt(D.gold)+parseInt(D.platinum);
e("<li>").attr({"class":"all"}).html(B).appendTo(F);
var K=e("<div>").attr({"class":"button-row"}).appendTo(z);
var P="eventVal=event66,secName=button:compare:usr-"+O.handle.replace(/\s/g,"-").toLowerCase();
var N=e("<div>").attr({href:"javascript:void(0);","class":"comparebutton","data-handle":O.handle,"data-game-id":v.trophiesData.gameId}).appendTo(K);
if(r.useUrlVars){N.attr({href:r.compareLink+"#compare="+O.handle})
}else{N.on("click",t)
}if(c.navigator.userAgent.toString().indexOf("PLAYSTATION 3")>-1){}else{var w=e("<a>").attr({"class":"link-btn blue-btn small-btn"}).appendTo(N);
var Q=e("<div>").attr({"class":"btn"}).html(Adobe.I18n.get("Compare")).appendTo(w);
var E="eventVal=event66,secName=button:favourite:usr-"+O.handle.replace(/\s/g,"-").toLowerCase();
var R=e("<a>").attr({href:"javascript:void(0);","data-handle":O.handle,"class":"starButton",title:g}).appendTo(K).on("click",function(){v.setFavourite(e(this))
});
var C=e("<div>").attr({"class":"link-btn blue-btn starbtn"}).appendTo(R);
var Q=e("<div>").attr({"class":"btn"}).html("").appendTo(C)
}});
m=k.find(".tile").length;
var p=v.$elementParent.find(".count-label");
var n=r.favFriendsCountMsg;
n=n.replace("{COUNT}","<strong>"+m+"</strong>");
n=n.replace("{TOTALCOUNT}","<strong>"+l+"</strong>");
if(m>0){p.css({visibility:"visible"}).html(n)
}else{p.css({visibility:"hidden"})
}if(m<3){k.find(".tile").eq(m-1).css({display:"block"})
}};
b.prototype.fetchData=function(){var k=this;
k.curAjax=e.ajax({url:k.dataUrl,dataType:"json",cache:false,data:k.dataVars});
return k.curAjax
};
b.prototype.setFavourite=function(q){var l=this;
var o=l.options;
var n=q.parent().parent();
var k=q.attr("data-handle");
if(o.refreshFavChanges){e("<div>").attr({"class":"ajax-loader"}).appendTo(l.$tilesHolderUl).css({height:"365px"})
}else{e("<div>").attr({"class":"ajax-loader"}).appendTo(n).css({height:"350px"})
}l.curFavTargets=l.curFavTargets||{};
l.curFavTargets[k]=n;
var m;
if(PDC.MyPlaystationProfile.isFriendsAuthExist(false)){m=e.cookie("ps_auth")
}var p;
if(e.cookie("userinfo")){p=e.cookie("userinfo")
}if(!n.hasClass("favourite")){if(typeof s!=="undefined"){PDC.SC.click(o.componentCtx,"favorite","button",null)
}}else{if(typeof s!=="undefined"){PDC.SC.click(o.componentCtx,"un-favorite","button",null)
}}e.ajax({url:o.favouriteCall,type:"post",data:{userId:k,operation:!n.hasClass("favourite")?"1":"0",ps_auth:m,userInfoCookie:p},cache:false,dataType:"json"}).always(function(u){if(o.refreshFavChanges){if(u.status==="success"){o.userTrophiesData=null;
l.init()
}else{l.$tilesHolderUl.find(".ajax-loader").remove()
}}else{var t=l.curFavTargets[l.encodeUrlVars(this.data).userId];
if(u.status==="success"){t.toggleClass("favourite")
}t.find(".ajax-loader").remove();
var v=t.find(".starButton").data("handle");
var r=t.hasClass("favourite")?"1":"0";
e(l.trophiesData.list).each(function(w,x){if(x.handle===v){x.isFavourite=r
}})
}})
};
b.prototype.encodeUrlVars=function(l){l=l||"";
var k={};
l.replace(/([^#&=?]+)=([^&=]+)/gi,function(n,m,p,o){k[m]=p
});
return k
};
e.fn[d]=function(k){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,k))
}})
}
})(jQuery,window,document);
(function(e,c,a,g){var d="friendsGridSorting",f={};
function b(k,h){this.element=k;
this.$element=e(this.element);
this.$key=e(this.element).attr("id");
this.options=e.extend({},f,h);
this._defaults=f;
this._name=d;
this.init()
}b.prototype.init=function(){this.$element.find(".sort select").selectbox({effect:"fade",speed:400,onChange:function(m,h){if(typeof s!=="undefined"){PDC.SC.click("myfriends",m,"text",null)
}var l={},k=e(this).attr("data-filter-key");
l[k]=m;
e(c).trigger("filterChange",l)
}})
};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))
}})
}
})(jQuery,window,document);
(function(e,c,a,g){var d="newsletter",f={newsletterDataUrl:"//my.playstation.complaystation/psn/messagecenter/message/response",reviewedMessageDataUrl:"//my.playstation.com/playstation/psn/messagecenter/message/review"};
function b(k,h){this.element=k;
this.$element=e(this.element);
this.options=e.extend({},f,h);
this._defaults=f;
this._name=d;
this.init()
}b.prototype.init=function(){var h=this;
h.setCampaignID();
h.loadNewsletter();
if(e.cookie("userinfo")){h.reviewedPost()
}};
b.prototype.setCampaignID=function(){var h=this;
var l=h.getParameterByName("campaignId");
if(l!==""){h.campaignID=l
}else{try{h.campaignID=c.sessionStorage.newsletterCampaignID
}catch(k){h.campaignID=""
}}};
b.prototype.loadNewsletter=function(){var h=this;
if(typeof h.campaignID!=="undefined"&&h.campaignID!==null&&h.campaignID!==""){var k={campaignId:h.campaignID};
e.ajax({type:"GET",url:h.options.newsletterDataUrl,data:k,dataType:"html"}).done(function(l){h.$element.find(".detailPage").html(l);
h.$element.find('.detailPage a[target="_blank"]').each(function(){var m=e(this).attr("href");
e(this).data("href",m);
e(this).attr("href","javascript:void(0);")
});
h.$element.find('.detailPage a[target="_blank"]').on("click",function(m){m.preventDefault();
if(typeof s!=="undefined"){PDC.SC.click("newsletter",h.campaignID,"text",{open:e(this).data("href"),newWindow:true})
}else{c.open(e(this).data("href"))
}})
})
}};
b.prototype.reviewedPost=function(){var h=this;
if(typeof h.campaignID!=="undefined"&&h.campaignID!==null&&h.campaignID!==""){var k={campaignId:h.campaignID,userInfoCookie:e.cookie("userinfo")};
e.ajax({type:"POST",url:h.options.reviewedMessageDataUrl,data:k,dataType:"json"})
}};
b.prototype.getParameterByName=function(l){l=l.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");
var m=new RegExp("[\\?&]"+l+"=([^&#]*)"),k=m.exec(location.search);
var h="";
if(k!=null){h=decodeURIComponent(k[1].replace(/\+/g," "))
}return h
};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))
}})
}
})(jQuery,window,document);
(function(e,c,a,g){var d="myWall",f={wallFeedDataUrl:"//my.playstation.com/playstation/psn/messagecenter/message/wallfeeds",wallFeedDetailsDataUrl:"//my.playstation.com/playstation/psn/messagecenter/message/wallpostdetails",sharePostDataUrl:"//my.playstation.com/playstation/psn/messagecenter/message/share",likePostDataUrl:"//my.playstation.com/playstation/psn/messagecenter/message/like",unlikePostDataUrl:"//my.playstation.com/playstation/psn/messagecenter/message/unlike",avatarDataUrl:"//my.playstation.com/playstation/psn/profile/avatar/",reviewedMessageDataUrl:"//my.playstation.com/playstation/psn/messagecenter/message/review",unreadMessageNotificationDataUrl:"//my.playstation.com/playstation/psn/messagecenter/message/notifications",templateId:""};
function b(k,h){this.element=k;
this.$element=e(this.element);
this.options=e.extend({},f,h);
this._defaults=f;
this._name=d;
this.pageNum=1;
this.tilesPerPage=15;
this.$columnContainer=this.$element.find(".column-container");
this.$firstColumn=this.$element.find(".col-1");
this.$secondColumn=this.$element.find(".col-2");
this.$thirdColumn=this.$element.find(".col-3");
this.$loadingOverlay=this.$element.find(".loading-overlay");
this.$moreLink=this.$element.find(".more-link");
this.$errorMsg=this.$element.find(".errormsg");
this.avatarHandles={};
this.newsletterLink=this.$columnContainer.data("href");
this.init()
}b.prototype.init=function(){var h=this;
PDC.MyPlaystationProfile.getSignedUserData(function(k){if(k.handle){h.loadData();
h.$columnContainer.on("mywall.dataloaded",function(){h.lazyLoadAvatars();
h.addAnimations()
});
h.$moreLink.on("click",function(){if(typeof s!=="undefined"){PDC.SC.click("mywall",this,"text",null)
}h.showMore()
})
}else{PDC.MyPlaystationProfile.redirectToLogin()
}})
};
b.prototype.loadData=function(){var h=this;
var m=h.options.wallFeedDataUrl;
var k=h.options.wallFeedDetailsDataUrl;
var l={pageNum:h.pageNum,type:0,callback:"JSON_CALLBACK",userInfoCookie:e.cookie("userinfo")};
e.when(e.ajax({type:"get",async:true,crossDomain:true,data:l,url:m,dataType:"json"}),e.ajax({type:"get",async:true,crossDomain:true,data:l,url:k,dataType:"json"})).done(function(o,n){var p=e.extend(true,{},o[0],n[0]);
h.currentHandle=p.handle;
h.totalPages=Math.ceil(p.totalCampaigns/h.tilesPerPage);
if(p.Status==="No Record Found"||e.isEmptyObject(p)){h.$loadingOverlay.addClass("hide");
h.$moreLink.addClass("hide");
h.$errorMsg.removeClass("hide")
}else{if(p.list.length>=1){e.each(p.list,function(q,t){t.currHandle=h.currentHandle;
if(typeof h.newsletterLink!=="undefined"&&h.newsletterLink!==null&&h.newsletterLink!==""){t.newsletterLink=h.newsletterLink
}else{t.newsletterLink="javascript:void(0);"
}var r=(q+1)%3;
if(r==0){h.$thirdColumn.append(tmpl(h.options.templateId,t));
h.initClickHandlers(h.$thirdColumn.children().last())
}else{if(r==1){h.$firstColumn.append(tmpl(h.options.templateId,t));
h.initClickHandlers(h.$firstColumn.children().last())
}else{h.$secondColumn.append(tmpl(h.options.templateId,t));
h.initClickHandlers(h.$secondColumn.children().last())
}}});
if(h.pageNum===h.totalPages){h.$moreLink.addClass("hide")
}h.$loadingOverlay.addClass("hide");
h.$columnContainer.trigger("mywall.dataloaded")
}}}).fail(function(){h.$loadingOverlay.addClass("hide");
h.$moreLink.addClass("hide");
h.$errorMsg.removeClass("hide")
})
};
b.prototype.showMore=function(){var h=this;
h.pageNum+=1;
h.$loadingOverlay.removeClass("hide");
h.loadData()
};
b.prototype.lazyLoadAvatars=function(){var h=this;
h.$columnContainer.find("img.notDone").each(function(k){var l=e(this);
var m=l.data("img-src");
if(h.avatarHandles[m]){l.attr("src",h.avatarHandles[m]);
l.removeClass("notDone");
l.addClass("done")
}else{e.ajax({type:"GET",url:h.options.avatarDataUrl+m,dataType:"json"}).done(function(n){h.avatarHandles[m]=n.avatarUrl;
l.attr("src",n.avatarUrl);
l.removeClass("notDone");
l.addClass("done")
})
}})
};
b.prototype.addAnimations=function(){PDC.MyWallAnimation.init(this.element,{minDuration:0.4,maxDuration:0.7,viewportFactor:0.2})
};
b.prototype.initClickHandlers=function(l){var h=this;
var k=l.children("a");
if(!k.hasClass("trophy")){k.on("click",function(){h.reviewedPost(e(this));
if(e(this).hasClass("newsletter")&&e(this).data("href")!=="javascript:void(0);"){try{c.sessionStorage.newsletterCampaignID=e(this).data("campaign")
}catch(n){var m=e(this).data("href");
e(this).data("href",m+"?campaignId="+e(this).data("campaign"))
}}if(typeof s!=="undefined"&&e(this).data("href")!=="javascript:void(0);"){PDC.SC.click("mywall",this,"image",{linktitle_override:"_subject",_subject:e(this).find(".subject").text(),vars:{prop56:e(this).find(".name .post-frm span").attr("class"),eVar56:e(this).find(".name .post-frm span").attr("class")}})
}})
}l.find(".post-like-box .like-img").on("click",function(){if(typeof s!=="undefined"){var o=e(this).parent().hasClass("no");
var p=o?"like":"unlike";
var n=e(this).closest(".grid");
var m=n.find(".subject").text();
PDC.SC.click("mywall",this,"image",{linktitle_override:"_subject",_subject:m,link_section_name:p})
}h.likedPost(e(this))
});
l.find(".post-share-box .share-img").on("click",function(){if(!e(this).hasClass("disabled-share")){if(typeof s!=="undefined"){var n=e(this).closest(".grid");
var m=n.find(".subject").text();
PDC.SC.click("mywall",this,"image",{linktitle_override:"_subject",_subject:m,link_section_name:"share"})
}h.sharedPost(e(this))
}})
};
b.prototype.reviewedPost=function(l){var h=this;
var k={campaignId:l.data("campaign"),userInfoCookie:e.cookie("userinfo")};
e.ajax({type:"POST",url:h.options.reviewedMessageDataUrl,data:k,dataType:"json"}).done(function(m){if(m.status=="success"){e.ajax({type:"GET",url:h.options.unreadMessageNotificationDataUrl,data:{userInfoCookie:e.cookie("userinfo")},type:"json"}).done(function(o){var n=o.totalCampaigns;
if(n>10){n="10+"
}if(n>0){e(".avatar .nav-content .notification-count").text(n)
}})
}});
l.parent().removeClass("no");
l.parent().addClass("yes");
l.attr("href",l.data("href"))
};
b.prototype.likedPost=function(r){var q=this;
q.$loadingOverlay.removeClass("hide");
var h=r.parent().hasClass("no");
var l=h?q.options.likePostDataUrl:q.options.unlikePostDataUrl;
var k=r.closest(".grid");
var o=k.find(".shared-detail .likes span").data("likenum")||0;
var m=k.find(".shared-detail span").data("sharenum")||0;
var n=k.find(".earnedby").data("gamername");
var p=k.find(".shared-detail .likes span").data("firstLikeUser");
e.ajax({type:"POST",url:l,data:{campaignId:r.data("campaign"),userInfoCookie:e.cookie("userinfo")},dataType:"json"}).done(function(v){q.$loadingOverlay.addClass("hide");
var t=v.LikeCount;
if(parseInt(t)<1){t="";
if(!h){if(m<1){k.find(".shared-detail p.likes").addClass("hide");
k.find(".shared-detail .likes span").html("");
o=parseInt(o)-1;
k.find(".shared-detail .likes span").data("likenum",o);
k.find(".trophy .shared-detail p").removeClass("hide");
k.find(".trophy .shared-detail .likes span").append('<img src=""/>');
q.setImageHandle(k.find(".trophy .shared-detail .likes span img"),k.find(".earnedby").data("gamername"));
k.find(".trophy .shared-detail .likes span").append("<span><strong>"+n+"</strong> earned</span>");
k.find(".trophy .earnedby").addClass("hide")
}else{if(m>0){o=parseInt(o)-1;
k.find(".shared-detail .likes span").data("likenum",o)
}}}}else{if(parseInt(t)<2){t=t+" Like";
if(h){if(m<1){k.find(".shared-detail .likes span").html("");
k.find(".shared-detail p").removeClass("hide");
k.find(".shared-detail .likes span").append('<img src=""/>');
q.setImageHandle(k.find(".shared-detail .likes span img"),q.currentHandle);
k.find(".shared-detail .likes span").append("<span><strong>You</strong> liked it</span>");
o=parseInt(o)+1;
k.find(".shared-detail .likes span").data("likenum",o);
k.find(".earnedby").removeClass("hide")
}else{if(m>0){o=parseInt(o)+1;
k.find(".shared-detail .likes span").data("likenum",o);
k.find(".earnedby").removeClass("hide")
}}}else{if(o==1){if(m<1){k.find(".shared-detail .likes span").html("");
o=parseInt(o)-1;
k.find(".shared-detail .likes span").data("likenum",o)
}else{if(m>0){o=parseInt(o)-1;
k.find(".shared-detail .likes span").data("likenum",o)
}}}else{if(o==2){if(m<1){q.setImageHandle(k.find(".shared-detail span img"),k.find(".post-det .shared-detail img").data("img-src-next"));
k.find(".shared-detail .likes span span").html("<strong>"+p+"</strong> likes this.");
o=parseInt(o)-1;
k.find(".shared-detail .likes span").data("likenum",o)
}else{if(m>0){o=parseInt(o)-1;
k.find(".shared-detail .likes span").data("likenum",o)
}}}}}}else{t=t+" Likes";
if(h){if(m<1){q.setImageHandle(k.find(".shared-detail span img"),q.currentHandle);
k.find(".shared-detail .likes span span").html("<strong>You</strong> liked it");
o=parseInt(o)+1;
k.find(".shared-detail .likes span").data("likenum",o);
k.find(".earnedby").removeClass("hide")
}else{if(m>0){o=parseInt(o)+1;
k.find(".shared-detail .likes span").data("likenum",o);
k.find(".earnedby").removeClass("hide")
}}}else{if(o==1){if(m<1){k.find(".shared-detail .likes span").html("");
o=0;
k.find(".shared-detail .likes span").data("likenum",o)
}else{if(m>0){o=0;
k.find(".shared-detail .likes span").data("likenum",o)
}}}else{if(m<1){q.setImageHandle(k.find(".shared-detail span img"),k.find(".post-det .shared-detail img").data("img-src-next"));
k.find(".shared-detail .likes span span").html("<strong>"+p+"</strong> likes this.");
o=parseInt(o)-1;
k.find("shared-detail .likes span").data("likenum",o)
}else{if(m>0){o=parseInt(o)-1;
k.find(".shared-detail .likes span").data("likenum",o)
}}}}}}e("._item."+r.data("campaign")).each(function(){e("._item."+r.data("campaign")+" .post-box .count-box .like-count .likeCountText").html(t);
if(h){e(this).children(".post-box").children(".social-icon-box").children(".post-like-box").addClass("yes");
e(this).children(".post-box").children(".social-icon-box").children(".post-like-box").removeClass("no")
}else{e(this).children(".post-box").children(".social-icon-box").children(".post-like-box").addClass("no");
e(this).children(".post-box").children(".social-icon-box").children(".post-like-box").removeClass("yes")
}});
var u=v.totalCampaigns;
if(u>0){e(".avatar .nav-content .notification-count").text(u)
}})
};
b.prototype.sharedPost=function(n){var h=this;
var l=n.closest(".grid");
var m=l.find(".shared-detail span").data("sharenum")||0;
var k=l.find(".earnedby").data("gamername");
h.$loadingOverlay.removeClass("hide");
e.ajax({type:"POST",url:h.options.sharePostDataUrl,data:{campaignId:n.data("campaign"),userInfoCookie:e.cookie("userinfo")},dataType:"json"}).done(function(p){h.$loadingOverlay.addClass("hide");
var o=p.shareCount;
if(parseInt(o)<1){o=""
}else{if(parseInt(o)<2){o=o+" Share";
l.find(".shared-detail .likes span").html("");
l.find(".shared-detail p").removeClass("hide");
l.find(".shared-detail .likes span").append('<img src=""/>');
h.setImageHandle(l.find(".shared-detail .likes span img"),h.currentHandle);
l.find(".shared-detail .likes span").append("<span><strong>You</strong> shared this</span>");
m=parseInt(m)+1;
l.find(".shared-detail .likes span").data("sharenum",m);
l.find(".earnedby").removeClass("hide")
}else{o=o+" Shares";
l.find(".shared-detail .likes span span").html("<strong>You</strong> shared this");
h.setImageHandle(l.find(".shared-detail .likes span img"),h.currentHandle);
l.find(".shared-detail .shares span span").html("<strong>You</strong> shared this");
h.setImageHandle(l.find(".shared-detail .shares span img"),h.currentHandle);
m=parseInt(m)+1;
l.find(".shared-detail .shares span").data("sharenum",m);
l.find(".earnedby").removeClass("hide")
}}e("._item."+n.data("campaign")).each(function(){e("."+n.data("campaign")+" .social-icon-box .post-share-box .share-img").addClass("disabled-share");
e("."+n.data("campaign")+" .count-box .share-count .shareCountText").html(o)
})
})
};
b.prototype.setImageHandle=function(l,k){var h=this;
if(l.length>0&&typeof k!=="undefined"&&k!==null&&k!==""){if(h.avatarHandles[k]){l.attr("src",h.avatarHandles[k])
}else{e.ajax({type:"GET",url:h.options.avatarDataUrl+k,dataType:"json"}).done(function(m){h.avatarHandles[k]=m.avatarUrl;
$img.attr("src",m.avatarUrl);
$img.addClass("done")
})
}}};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))
}})
}
})(jQuery,window,document);
(function(c,b,a,d){PDC.MyWallAnimation=PDC.MyWallAnimation||{};
PDC.MyWallAnimation.init=function(f,e){this.element=f;
this.$element=c(this.element);
var g={minDuration:0,maxDuration:0,viewportFactor:0};
this.options=c.extend({},g,e);
this.didScroll=false;
this.itemsRenderedCount=0;
this.items=this.$element.find(".grid");
this.totalItems=this.items.length;
if(Modernizr.cssanimations){c.each(this.items,function(){if(PDC.MyWallAnimation.inViewport(this)){PDC.MyWallAnimation.checkTotalRendered();
c(this).addClass("shown")
}});
b.addEventListener("scroll",function(){PDC.MyWallAnimation.onScrollFn()
},false);
b.addEventListener("resize",function(){PDC.MyWallAnimation.resizeHandler()
},false)
}};
PDC.MyWallAnimation.inViewport=function(n,m){var l=n.offsetHeight,k=PDC.MyWallAnimation.scrollY(),f=k+PDC.MyWallAnimation.getViewportHeight(),e=PDC.MyWallAnimation.getOffset(n).top,g=e+l,m=m||0;
return(e+l*m)<=f&&(g-l*m)>=k
};
PDC.MyWallAnimation.getViewportHeight=function(){var e=b.document.documentElement.clientHeight,f=b.innerHeight;
if(e<f){return f
}else{return e
}};
PDC.MyWallAnimation.scrollY=function(){return b.pageYOffset||b.document.documentElement.scrollTop
};
PDC.MyWallAnimation.getOffset=function(f){var e=0,g=0;
do{if(!isNaN(f.offsetTop)){e+=f.offsetTop
}if(!isNaN(f.offsetLeft)){g+=f.offsetLeft
}}while(f=f.offsetParent);
return{top:e,left:g}
};
PDC.MyWallAnimation.onScrollFn=function(){if(!this.didScroll){this.didScroll=true;
setTimeout(function(){PDC.MyWallAnimation.scrollPage()
},60)
}};
PDC.MyWallAnimation.scrollPage=function(){var e=this;
c.each(this.items,function(){if(!c(this).hasClass("shown")&&!c(this).hasClass("animate")&&PDC.MyWallAnimation.inViewport(this,e.options.viewportFactor)){var f=c(this);
setTimeout(function(){var g=PDC.MyWallAnimation.scrollY()+PDC.MyWallAnimation.getViewportHeight()/2;
f.css("-webkit-perspective-origin","50% "+g+"px");
f.css("-moz-perspective-origin","50% "+g+"px");
f.css("perspective-origin","50% "+g+"px");
PDC.MyWallAnimation.checkTotalRendered();
if(e.options.minDuration&&e.options.maxDuration){var h=(Math.random()*(e.options.maxDuration-e.options.minDuration)+e.options.minDuration)+"s";
f.css("-webkit-animation-duration",h);
f.css("-moz-animation-duration",h);
f.css("animation-duration",h)
}f.addClass("animate")
},25)
}});
e.didScroll=false
};
PDC.MyWallAnimation.resizeHandler=function(){var e=this;
function f(){PDC.MyWallAnimation.scrollPage();
e.resizeTimeout=null
}if(this.resizeTimeout){clearTimeout(this.resizeTimeout)
}this.resizeTimeout=setTimeout(f,1000)
};
PDC.MyWallAnimation.checkTotalRendered=function(){++this.itemsRenderedCount;
if(this.itemsRenderedCount===this.itemsCount){b.removeEventListener("scroll",this._onScrollFn)
}}
})(jQuery,window,document);
(function(e,c,a,g){var d="competeConnectPortableId",f={pidUrl:"//my.playstation.com/playstation/psn/profile/pid/get_pid",generatePidUrl:"//my.playstation.com/playstation/psn/profile/generate_pid"};
function b(l,k){var h=this;
h.element=l;
h.$element=e(h.element);
h.options=e.extend({},f,k);
h._defaults=f;
h._name=d;
h.init()
}b.prototype.init=function(){var h=this;
var k=h.options;
var l=h.$element.find(".pidImage");
l.parent().append('<div class="ajax-loader" style="width: 100%; height: 155px;"></div>');
PDC.portableId.getPidData(function(n){if(typeof n.pidUrl!=="undefined"&&n.pidUrl!==null&&n.pidUrl!==""){l.siblings(".ajax-loader").remove();
l.removeClass("cq-image-placeholder");
l.attr("src",n.pidUrl);
l.attr("title",n.handle);
l.attr("alt",n.handle);
h.$element.closest("section").find(".pidRefresh > a").on("click",function(o){h.refreshButton()
})
}else{l.siblings(".ajax-loader").remove();
l.removeClass("cq-image-placeholder");
l.attr("src","/etc/designs/pdc/clientlibs_base/images/mypdc/portable_id_cnc.png");
l.attr("title",n.handle);
l.attr("alt",n.handle);
h.$element.closest("section").find(".pidGenerate > a").on("click",function(o){h.pidGenerate()
});
if(!e("body").hasClass("cq-wcm-edit")){h.$element.closest("section").find(".portable-id-exist").addClass("hide");
h.$element.closest("section").find(".no-portable-id-exist").removeClass("hide")
}else{h.$element.closest("section").find(".no-portable-id-exist").removeClass("hide")
}var m=h.$element.closest("section").find(".no-portable-id-exist").find(".richtext");
m.prepend(e("<p>").html(n.handle+", "+Adobe.I18n.get("get your own PSN Portable ID!")))
}},k.pidUrl)
};
b.prototype.refreshButton=function(){var h=this;
var k=h.options;
var l=h.$element.find(".pidImage");
e.each(l,function(n,m){e(this).parent().append('<div class="ajax-loader" style="width: 100%; height: 155px;"></div>')
});
PDC.portableId.generatePid(function(m){if(typeof m.pidUrl!=="undefined"&&m.pidUrl!==null&&m.pidUrl!==""){e.each(l,function(o,n){e(this).siblings(".ajax-loader").remove();
e(this).removeClass("cq-image-placeholder");
e(this).attr("src",m.pidUrl);
e(this).attr("title",m.handle);
e(this).attr("alt",m.handle)
})
}else{e.each(l,function(o,n){e(this).siblings(".ajax-loader").remove()
})
}},k.generatePidUrl)
};
b.prototype.pidGenerate=function(){var h=this;
var k=h.options;
h.$element.closest("section").find(".portable-id-exist").removeClass("hide");
h.$element.closest("section").find(".no-portable-id-exist").addClass("hide");
var l=h.$element.find(".pidImage");
e.each(l,function(n,m){e(this).parent().append('<div class="ajax-loader" style="width: 100%; height: 155px;"></div>')
});
PDC.portableId.generatePid(function(m){if(typeof m.pidUrl!=="undefined"&&m.pidUrl!==null&&m.pidUrl!==""){e.each(l,function(o,n){e(this).siblings(".ajax-loader").remove();
e(this).removeClass("cq-image-placeholder");
e(this).attr("src",m.pidUrl);
e(this).attr("title",m.handle);
e(this).attr("alt",m.handle)
})
}else{e.each(l,function(o,n){e(this).siblings(".ajax-loader").remove();
if(!e("body").hasClass("cq-wcm-edit")){e(this).parent().parent().addClass("hide")
}})
}},k.generatePidUrl)
};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){var k=new b(this,h);
e.fn[d].refArray.push(k);
e.data(this,"plugin_"+d,k)
}})
}
})(jQuery,window,document);
(function(e,c,a,g){var d="competeConnectBanner",f={level_percentage:0,respondWidth:970,userInfoDataUrl:"//my.playstation.com/userinfo.json",onlineFriendsDataUrl:"//my.playstation.com/onlinefriends.json",playstationPlusDataUrl:"//my.playstation.com/playstation/psn/plus/info",onlineFriendsData:null,userInfoData:null,pspLogoUrl:"/etc/designs/pdc/clientlibs_base/images/CM156_CompeteConnectHeroBanner/psp_logo.png",pageType:"private",sonyRewardPointLink:"//my.playstation.com/psnevent/sonyrewards",lastPlayedCall:"//my.playstation.com/playstation/psn/profile/last/played/"};
function b(m,l){var h=this;
h.element=m;
h.$element=e(h.element);
h.options=e.extend({},f,l);
h._defaults=f;
h._name=d;
h.$contentWrap=h.$element.find(".content-wrap");
var k=h.options;
h.defaultUserInfoData={handle:"",avatarUrl:"/etc/designs/pdc/clientlibs_base/images/CM156_CompeteConnectHeroBanner/defaultavatar.png",isPlusUser:"0",platform:"",imgUrl:"",playing:"",curLevel:"0",progress:"0",trophies:{bronze:"0",gold:"0",platinum:"0",silver:"0"},totalLevel:""};
if(k.pageType!=="public"){PDC.MyPlaystationProfile.getSignedUserData(function(n){if(n.handle){h.profileInfo=n;
c.sessionStorage.competeLoggedInHandle=n.handle;
h.init();
e(c).trigger("competeUserLoggedIn",n)
}else{PDC.MyPlaystationProfile.redirectToLogin()
}})
}else{h.init()
}}b.prototype.init=function(){var u=this;
var q=u.options;
e(c).load(function(){u.isWindowLoaded=true
});
u.$contextualDiv=u.$contentWrap.find(".with-contextual-nav.copy");
u.destroy();
if(!q.onlineFriendsData&&q.pageType!=="public"&&c.navigator.userAgent.toString().indexOf("PLAYSTATION 3")<0&&u.$contextualDiv.find(".friends").length>0){if(PDC.MyPlaystationProfile.isFriendsAuthExist(true)){var l=function(){if(!u.onlineFriendsAjax){u.onlineFriendsAjax=e.ajax({url:q.onlineFriendsDataUrl,data:{ps_auth:e.cookie("ps_auth")},dataType:"json",cache:false}).done(function(v){u.onlineFriendsAjax=null;
q.onlineFriendsData=v;
u.buildOnlineFriendDom();
u.initFriendList()
})
}};
l()
}else{var h=u.$contextualDiv.find(".friends");
var p=h.data("href");
var r=h.find(".icon-block");
if(p!==""){r.on("click",function(){c.location=p
})
}r.css({width:"236px"});
r.find(".icon").css({width:"180px"});
h.removeClass("hide")
}}if(q.pageType!=="public"){u.buildProfileInfoDom(u.profileInfo)
}if(u.$userInfoLoader){u.$userInfoLoader.remove()
}var t=function(){var v=q.userInfoData;
if(q.pageType==="public"&&v){u.buildProfileInfoDom(v);
u.buildUserInfoDom();
u.initUserInfo()
}else{if(q.pageType!=="public"){u.buildUserInfoDom();
u.buildSonyRewardDom();
u.buildLastPlayedDom();
u.initUserInfo()
}}u.setUserInfoSessionData()
};
if(Modernizr.sessionstorage&&c.sessionStorage.connectBannerUserInfoData&&q.pageType!=="public"){var n=JSON.parse(c.sessionStorage.connectBannerUserInfoData);
if(n.expireTime>new Date().getTime()&&n.handle===u.profileInfo.handle){q.userInfoData=n
}else{q.userInfoData=null;
c.sessionStorage.removeItem("connectBannerUserInfoData")
}}var m=function(){e(a).on("usersearch.search",function(w,v){u.$userInfoLoader=e("<div>").attr({"class":"ajax-loader"}).css({"background-color":"transparent","background-position":"10% 105%",top:"25px",width:"50%"}).appendTo(u.$contextualDiv);
u.userInfoAjax=e.ajax({url:q.userInfoDataUrl,data:{onlineId:v},dataType:"json",cache:false}).done(function(x){u.$userInfoLoader.remove();
if(!x.avatarUrl){delete x.avatarUrl
}q.userInfoData=x.handle?e.extend({},u.defaultUserInfoData,x):x;
t()
})
})
};
if(!q.userInfoData){var k;
if(q.pageType==="public"){var o=u.getParameterByName("onlineId");
if(typeof o!=="undefined"&&o!==null&&o!==""){k={onlineId:o}
}else{if(typeof c.sessionStorage.publicTrophiesSearchId!=="undefined"&&c.sessionStorage.publicTrophiesSearchId!==null&&c.sessionStorage.publicTrophiesSearchId!==""){PDC.MyPlaystationProfile.getPublicSearchId()
}}}else{k={userInfoCookie:e.cookie("userinfo")}
}if(typeof k!=="undefined"&&k!==null){u.$userInfoLoader=e("<div>").attr({"class":"ajax-loader"}).css({"background-color":"transparent","background-position":"10% 105%",top:"25px",width:"50%"}).appendTo(u.$contextualDiv);
u.userInfoAjax=e.ajax({url:q.userInfoDataUrl,data:k,dataType:"json",cache:false}).done(function(v){u.$userInfoLoader.remove();
if(!v.avatarUrl){delete v.avatarUrl
}q.userInfoData=v.handle?e.extend({},u.defaultUserInfoData,v):v;
t()
});
if(q.pageType==="public"){m()
}}else{if(q.pageType==="public"){m()
}}}else{t()
}};
b.prototype.getParameterByName=function(l){l=l.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");
var m=new RegExp("[\\?&]"+l+"=([^&#]*)"),k=m.exec(location.search);
var h="";
if(k!=null){h=decodeURIComponent(k[1].replace(/\+/g," "))
}return h
};
b.prototype.setUserInfoSessionData=function(){var k=this;
var h=k.options;
var l=h.userInfoData;
if(h.pageType!=="public"&&typeof JSON==="object"&&typeof JSON.stringify==="function"&&Modernizr.sessionstorage&&!c.sessionStorage.connectBannerUserInfoData){l.expireTime=new Date().getTime()+360000;
l.handle=k.profileInfo.handle;
c.sessionStorage.connectBannerUserInfoData=JSON.stringify(l)
}};
b.prototype.buildSonyRewardDom=function(){var k=this;
var h=k.options;
if(k.$contextualDiv.find(".bannerSonyRewards").length>0){e.ajax({url:h.sonyRewardPointLink,data:{userInfoCookie:e.cookie("userinfo")},dataType:"xml"}).done(function(p){var n=e(p);
var m=n.find("PointsAvailable").text();
var l=k.$contextualDiv.find(".bannerSonyRewards");
if(m){var o=l.find(".has-points");
o.find(".points").text(m);
o.removeClass("hide")
}else{l.find(".earn-points").removeClass("hide")
}l.removeClass("hide")
})
}};
b.prototype.destroy=function(){var h=this;
if(h.onlineFriendsAjax){h.onlineFriendsAjax.abort()
}if(h.userInfoAjax){h.userInfoAjax.abort()
}};
b.prototype.buildProfileInfoDom=function(l){var h=this;
var k=h.options;
if(k.pageType==="public"){h.$contextualDiv.find(".avatar-block img").remove();
h.$contextualDiv.find("div.user-info h2").text("")
}if(!l.handle){return 0
}h.$avatarBlock=e(".avatar-block",h.$contextualDiv);
e("<img>").attr({"class":"avatar",alt:l.handle,title:l.handle,src:decodeURIComponent(l.avatarUrl)}).appendTo(h.$avatarBlock);
l.isPlusUser=parseInt(l.isPlusUser,10);
if(l.isPlusUser){e("<img>").attr({"class":"psp-logo",alt:"Playstation Plus logo",src:k.pspLogoUrl}).appendTo(h.$avatarBlock)
}h.$contextualDiv.find("div.user-info h2").text(l.handle);
h.buildPlusExpDom(l)
};
b.prototype.buildPlusExpDom=function(m){var h=this;
var l=h.options;
if(!m.handle){return 0
}var k=l.playstationPlusDataUrl;
if(h.$contextualDiv.find(".plus-exp").length>0){e.ajax({url:k,cache:false,data:{userInfoCookie:e.cookie("userinfo")},dataType:"json"}).done(function(u){sessionStorage.setItem("_userExists",u.userExists);
sessionStorage.setItem("_daysToExpire",u.daysToExpire);
sessionStorage.setItem("_plusExpiry",u.plusExpiry);
sessionStorage.setItem("_autoRenew",u.autoRenew);
var r=u.plusExpiry;
var n=u.daysToExpire,t="",q=u.autoRenew;
var o=h.$contextualDiv.find(".plus-exp");
if(m.isPlusUser){if(n<1){o.find('.plus-exp-day[data-renew="'+q+'"]').removeClass("hide")
}else{if(n<=7&&n>=1){var p=o.find('.plus-exp-week[data-renew="'+q+'"]');
p.find("span").text(r);
p.removeClass("hide")
}else{if(n>7){var p=o.find(".plus-exp-month");
p.find("span").text(r);
p.removeClass("hide")
}}}}else{o.find(".join-plus").removeClass("hide")
}o.removeClass("hide")
}).fail(function(n){})
}};
b.prototype.buildLastPlayedDom=function(){var l=this;
var h=l.options;
var n=h.userInfoData;
if(l.$contextualDiv.find(".lastPlayed").length>0){if("lastPlayedGame" in n){if(n.lastPlayedGame){var k=l.$contextualDiv.find(".lastPlayed");
k.find("span").text(n.lastPlayedGame);
k.removeClass("hide")
}}else{var m=e("<div>").attr({"class":"ajax-loader"}).css({"background-color":"transparent","background-position":"10% 105%",top:"25px",width:"50%",}).appendTo(l.$contextualDiv);
e.ajax({url:h.lastPlayedCall,data:{userInfoCookie:e.cookie("userinfo")},dataType:"json",cache:false}).done(function(p){m.remove();
n.lastPlayedGame=(p&&p.lastPlayed)||"";
if(n.lastPlayedGame){var o=l.$contextualDiv.find(".lastPlayed");
o.find("span").text(n.lastPlayedGame);
o.removeClass("hide")
}c.sessionStorage.removeItem("connectBannerUserInfoData");
l.setUserInfoSessionData()
}).fail(function(){m.remove()
})
}}};
b.prototype.buildUserInfoDom=function(){var k=this;
var l=k.options;
var o=l.userInfoData;
var n=k.$contentWrap.find(".info-bar");
if(n.length>0&&o.trophies){if(l.pageType==="public"){k.$element.find(".image-wrap").removeClass("short-banner")
}var h=function(t,r){n.find(r).html(t)
};
var p=o.trophies;
var q=parseInt(p.bronze)+parseInt(p.silver)+parseInt(p.gold)+parseInt(p.platinum);
h(o.curLevel,".level-num");
h(q,".trophy-num");
h(p.bronze,".bronze-trophy");
h(p.silver,".silver-trophy");
h(p.gold,".gold-trophy");
h(p.platinum,".platinum-trophy");
var m=n.find(".level");
m.find(".current span + span").text(o.curLevel);
m.find(".level-guage span").html(o.progress);
n.find(".level-percentage span:first-child").html(o.progress);
n.removeClass("hide")
}else{if(l.pageType==="public"&&(!k.$element.find(".image-wrap").hasClass("short-banner"))){k.$element.find(".image-wrap").addClass("short-banner")
}if(!n.hasClass("hide")){n.addClass("hide")
}}};
b.prototype.buildOnlineFriendDom=function(){var l=this;
var m=l.options;
var h=m.onlineFriendsData;
if(!h.list){h.list=[];
h.totalOnline=0
}if(l.$friendsWrap){l.$friendsWrap=null;
l.$iconBlock.off()
}l.$friendsWrap=l.$contextualDiv.find(".friends");
l.$iconBlock=l.$friendsWrap.find(".icon-block");
l.$iconBlock.find(".icon").html(h.totalOnline);
l.$iconBlock.find(".arrow").removeClass("hide");
l.$reveal=l.$friendsWrap.find(".reveal");
if(h.totalOnline>0){l.$onlineInfo=l.$reveal.find("h3 span");
l.$onlineInfo.text(h.totalOnline);
l.$onlineInfo.parent().removeClass("hide")
}var n=l.$friendsList=l.$reveal.find("ul");
var p=function(q){q.preventDefault();
if(typeof s!=="undefined"){PDC.SC.click("competeconnectherobanner","username","text",null)
}c.location=e(this).attr("href")
};
var o=l.$friendsWrap.data("href");
e(h.list).each(function(q,r){var u=e("<li>").appendTo(n);
var t=e("<a>").attr({href:o}).appendTo(u).on("click",p);
e("<img>").attr({alt:r.handle,title:r.handle,src:r.avatarUrl}).appendTo(t);
e("<span>").html(r.handle).appendTo(t);
if(parseInt(r.isPlusUser)===1){e("<span>").attr({"class":"psp-logo-small"}).appendTo(t)
}});
var k=e("<li>").attr({"class":"see-all"}).appendTo(n);
if(h.totalOnline<=0){e("<a>").html(Adobe.I18n.get("You have no online friends")).appendTo(k)
}else{if(h.totalOnline>h.list.length){e("<a>").attr({href:o}).html(Adobe.I18n.get("See all online friends")).appendTo(k).on("click",p)
}}l.$friendsWrap.removeClass("hide")
};
b.prototype.initFriendList=function(){var k=this;
k.revealHeight=k.$reveal.height();
var l=k.$iconBlock.find(".arrow");
var n=k.$reveal.height();
k.$reveal.css("height",0);
function m(){k.$iconBlock.attr("data-toggled","on");
k.$iconBlock.addClass("on");
l.addClass("on");
k.$reveal.animate({height:n},300);
k.$element.find(".content-wrap").css({zIndex:1000});
e(a).bind("click.onlineFriends, scroll.onlineFriends",function(){h()
})
}function h(){k.$iconBlock.attr("data-toggled","off");
k.$iconBlock.removeClass("on");
l.removeClass("on");
k.$reveal.animate({height:0},300,function(){k.$element.find(".content-wrap").css({zIndex:"auto"})
});
e(a).unbind("click.onlineFriends, scroll.onlineFriends")
}k.$iconBlock.on("click",function(p){p.stopPropagation();
var o=e(this);
if(!o.attr("data-toggled")||o.attr("data-toggled")=="off"){m();
k.isMenuIsOpen=true
}else{if(o.attr("data-toggled")=="on"){h();
k.isMenuIsOpen=false
}}});
if(k.isMenuIsOpen){m()
}};
b.prototype.initUserInfo=function(){var n=this;
var o=n.options;
var p=o.userInfoData;
o.level_percentage=p.progress;
e(c).load(function(){n.growLevel()
});
if(n.isWindowLoaded){n.growLevel()
}if("matchMedia" in c){function l(q){n.growLevel()
}var k=c.matchMedia("(max-width: "+n.options.respondWidth+"px)");
l(k);
k.addListener(l)
}else{var h;
n.growLevel();
e(c).resize(function(){if(h){clearTimeout(h)
}h=setTimeout(m,500)
});
function m(){n.growLevel()
}}};
b.prototype.growLevel=function(){var k=this;
var h=k.$element.find(".level-guage").width();
var l=h*(k.options.level_percentage/100);
var m=k.$element.find(".level-guage").find(".highlight");
m.stop().animate({width:l},{duration:2000,easing:"swing"})
};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){var k=new b(this,h);
e.fn[d].refArray.push(k);
e.data(this,"plugin_"+d,k)
}})
}
})(jQuery,window,document);
(function(f,d,a,h){var e="compareGameTrophies",g={friendListData:{},compareData:{},sortOptions:[{title:Adobe.I18n.get("Order of game"),value:"gameOrder"},{title:Adobe.I18n.get("Trophy Type"),value:"trophyType"},{title:Adobe.I18n.get("Trophies Owned"),value:"trophiesOwned"}],curSort:"gameOrder",tableColms:5,curPage:1,tilesPerPage:16,showMoreLink:true,useUrlVars:false,colorBoxProps:{initialWidth:400,initialHeight:300,scrolling:true,width:"760px",height:"500px",maxWidth:"760px",maxHeight:"695px",overlayClose:true,photo:false},exploreGamesLink:"/en-us/explore/games/newreleases/",myTrophiesPageLink:"//my.playstation.com/logged-in/trophies/"};
function c(l,k){this.element=l;
this.$element=f(this.element);
this.$elementParent=this.$element.parent();
this.$key=f(this.element).attr("id");
this.options=f.extend(true,{},g,k);
this._defaults=g;
this._name=e;
this.options.exploreGamesLink=this.$element.find(".exploreGamesLink").data("href");
this.options.myTrophiesPageLink=this.$element.find(".myTrophiesPageLink").data("href");
this.init()
}c.prototype.init=function(){var k=this;
f(d).on("gameListChange",function(l,m){k.curGameId=m;
k.updateHash()
});
PDC.MyPlaystationProfile.getSignedUserData(function(l){if(l.handle){k.loginUserId=l.handle;
k.initTrophiesCompare()
}else{PDC.MyPlaystationProfile.redirectToLogin()
}})
};
c.prototype.addHashEvent=function(){var k=this;
if(!k.hashEventAdded){if(!Modernizr.hashchange){var l=d.location.href;
setInterval(function(){var m=d.location.href;
if(l!==m){l=m;
k.initTrophiesCompare()
}},100)
}else{if(d.addEventListener){d.addEventListener("hashchange",function(){k.initTrophiesCompare()
},false)
}else{if(d.attachEvent){d.attachEvent("onhashchange",function(){k.initTrophiesCompare()
})
}}}k.hashEventAdded=true
}};
c.prototype.updateHash=function(){var k=this;
var l=k.options;
var m="#gid="+k.curGameId+"&compare="+k.curCompareIds.join(",");
if(l.useUrlVars){d.location.replace(m)
}else{d.sessionStorage.compareTrophiesVars=m;
k.initTrophiesCompare()
}};
c.prototype.initTrophiesCompare=function(){var k=this;
var l=k.options;
if(l.useUrlVars){k.compareVars=k.encodeUrlVars(d.location.href);
k.addHashEvent()
}else{k.compareVars=k.encodeUrlVars(d.sessionStorage.compareTrophiesVars)
}k.curCompareIds=k.compareVars.compare?k.compareVars.compare.split(","):[];
k.curGameId=k.compareVars.gid;
l.curSort=k.compareVars.sort||l.curSort;
k.curCompareIds=k.curCompareIds||[];
k.curGameId=k.curGameId||"";
var p=f.inArray(k.loginUserId,k.curCompareIds);
if(p!==-1){k.curCompareIds.splice(p,1)
}var q=[];
f.each(k.curCompareIds,function(r,t){if(t&&f.inArray(t,q)===-1){q.push(t)
}});
if(k.curCompareIds.length>q.length){k.curCompareIds=q;
if(l.useUrlVars){k.updateHash()
}}k.curGameListIndex=k.curGameListIndex||0;
l.compareData=l.compareData||{};
l.compareData[k.curGameId]=l.compareData[k.curGameId]||{};
var o=[];
if(k.loginUserId&&!l.compareData[k.curGameId][k.loginUserId]){o.push(k.loginUserId)
}f(k.curCompareIds).each(function(r,t){if(!l.compareData[k.curGameId][t]){o.push(t)
}});
k.$tableWrapper=k.$tableWrapper||f("<div>").attr({"class":"table-overflow-wrapper clearfix"}).appendTo(k.$element).css({height:"250px"});
k.$element.find(".CM162_loader").remove();
if(k.trophyAjax){k.trophyAjax.abort()
}if(!l.compareData[k.curGameId].gameId||o.length>0){var n=f("<div>").attr({"class":"ajax-loader CM162_loader"}).css({"z-index":"999",top:"65px"});
k.$element.append(n);
var m={};
if(k.curGameId){m.gameId=k.curGameId
}if(o.length>0){m.userIds=o.join(",")
}if(f.cookie("userinfo")){m.userInfoCookie=f.cookie("userinfo")
}m.callback="JSON_CALLBACK";
k.trophyAjax=f.ajax({url:l.trophiesDataUrl,dataType:"json",cache:false,async:true,crossDomain:true,data:m}).done(function(r){if(r.gameId){k.$element.find(".CM162_loader").remove();
if(k.parseTrohpiesData(r)){k.buildCurTableData();
k.buildCurTableDom()
}}k.trophyAjax=null;
f(d).trigger("compareGameTrophiesLoaded",r)
})
}else{k.buildCurTableData();
k.buildCurTableDom()
}};
c.prototype.buildCurTableDom=function(){var l=this;
var n=l.options;
l.$tableWrapper.css("height","");
l.$tableWrapper.html("");
l.$tBody=null;
l.$table=null;
l.$tHead=null;
var m=l.$table=f("<table>").html("").appendTo(l.$tableWrapper).html("<colgroup> <col> <col> <col> <col> <col> </colgroup>");
var k=l.$tHead=f("<thead>").appendTo(m);
var o=l.curTableData.head;
l.$elementParent.find(".module-sub-heading.left").html(o[0][0].gameTitle);
f(o).each(function(p,r){var q=f("<tr>").appendTo(k);
f(r).each(function(H,w){var G=f("<th>").appendTo(q);
if(p===0&&H===0){var B=f("<div>").attr({"class":"game-image"}).appendTo(G);
f("<img>").attr({src:w.gameImgUrl,alt:f("<div>").html(w.gameTitle).html(),title:f("<div>").html(w.gameTitle).html()}).appendTo(B)
}else{if(p===0&&H>0){if("handle" in w){var C=f("<div>").attr({"class":"compare-trophies-avatar currentUserProfile"}).appendTo(G);
var x=f("<div>").attr({"class":"absolute-position-wrapper"}).appendTo(C);
if(H>1){f("<a>").attr({"class":"remove-friend","data-friend-id":w.handle,"data-friend-index":H,href:"javascript:void(0)"}).appendTo(x).on("click",function(){var t=f(this);
l.removeFriendColmAt(parseInt(t.attr("data-friend-index")),t.attr("data-friend-id"));
if(typeof s!=="undefined"){PDC.SC.click("comparegamestrophies","remove-friend","button",null)
}})
}if(w.isPlusUser){f("<div>").attr({"class":"plus"}).html("&nbsp;").appendTo(x)
}f("<img>").attr({"class":"avatar-image",src:w.avatarUrl,alt:w.handle,title:w.handle}).appendTo(C);
f("<h4>").attr({"class":"user-name"}).html(w.handle).appendTo(C)
}else{var D=f("<div>").attr({"class":"compare-trophies-avatar addFriend"}).appendTo(G).css({opacity:".4",position:"relative","z-index":"999"});
var u=f("<a>").attr({"class":"add-friend-link","data-add-friend-index":H-2}).appendTo(D);
f("<div>").attr({"class":"add-friend"}).html("<span>&nbsp;</span>").appendTo(u);
f("<h4>").attr({"class":"user-name blank-user"}).html(Adobe.I18n.get("Add friend")).appendTo(D)
}}else{if(p===1&&H>0&&"trophies" in w){var A=f("<div>").attr({"class":"compare-trophies-tile"}).appendTo(G);
var z=f("<ul>").attr({"class":"trophy-summary allTrophyInfo"}).appendTo(A);
var E=w.trophies;
f("<li>").attr({"class":"bronze"}).html(E.bronze).appendTo(z);
f("<li>").attr({"class":"silver"}).html(E.silver).appendTo(z);
f("<li>").attr({"class":"gold"}).html(E.gold).appendTo(z);
f("<li>").attr({"class":"platinum"}).html(E.platinum).appendTo(z)
}else{if(p===2&&H>0&&"progress" in w){var F=f("<div>").attr({"class":"compare-trophies-tile"}).appendTo(G);
var y=f("<div>").attr({"class":"progress clearfix trophyProgress"}).appendTo(F);
var v=f("<div>").attr({"class":"bar"}).appendTo(y);
f("<div>").attr({"class":"slider"}).css({width:w.progress+"%"}).appendTo(v);
f("<span>").html(w.progress+"%").appendTo(y)
}else{if(p===2&&H===0){l.addSortComponentOn(G)
}}}}}})
});
l.activateAddFriendBtn();
l.buildTableTrohpiesRows()
};
c.prototype.activateAddFriendBtn=function(){var l=this;
if(l.$tHead){var k=l.$tHead.find(".addFriend").eq(0).css({opacity:1}).find(".add-friend-link");
k.off();
k.attr({href:"javascript:void(0)"}).on("click",function(){l.curAddFriendIndex=parseInt(f(this).attr("data-add-friend-index"));
l.openFriendListPopup();
if(typeof s!=="undefined"){PDC.SC.click("comparegametrophies","add-friend","button",null)
}})
}};
c.prototype.buildTableTrohpiesRows=function(){var k=this;
var l=k.options;
k.sortTrophiesList();
var q=k.$tBody=k.$tBody||f("<tbody>").appendTo(k.$table);
var m=k.curSortedTableData.body;
q.html("");
var p=m.length;
k.totalPage=Math.ceil(p/l.tilesPerPage);
var o=l.curPage*l.tilesPerPage;
if(l.curPage>k.totalPage){l.curPage=k.totalPage
}o=o>=p?p:o;
var n=m.slice(0,o);
f(n).each(function(H,I){var J=f("<tr>").addClass("trophy-tr").appendTo(q);
for(var G=0;
G<l.tableColms;
G++){var C=I[G];
$td=f("<td>").addClass("trophy-td").appendTo(J);
if(C){if(G===0){C.type==="unknown"?$td.addClass("trophy-unlocked-false"):$td.addClass("trophy-unlocked-true");
var D=C.trophyWon||C.type;
var z=C.time;
var u=f("<div>").attr({"class":"absolute-position-wrapper"}).appendTo($td);
f("<span>").attr({"class":"trophy-icon trophy-type-"+D.toLowerCase()}).appendTo(u);
var B=f("<div>").attr({"class":"itemWrap singleTrophyTile"}).appendTo($td);
var r=f("<a>").attr({href:"javascript:void(0)"}).appendTo(B);
var w=f("<div>").attr({"class":"cellWrap cell1"}).appendTo(r);
if(C.trophyWon){f("<img>").attr({src:C.imgUrl,alt:f("<div>").html(C.title).html(),title:f("<div>").html(C.title).html(),}).appendTo(w)
}else{f("<img>").attr({src:l.lockedTrophyImgUrl}).appendTo(w)
}var v=f("<div>").attr({"class":"cellWrap cell2 image"}).appendTo(r);
var E=f("<hgroup>").appendTo(v);
f("<h1>").attr({"class":"trophy_name "+D.toLowerCase()}).html(C.title).appendTo(E);
f("<h2>").html(C.desc).appendTo(E)
}else{if(C.trophyWon){var x=f("<div>",{"class":"holderCallOut",});
var y=f("<span>",{"class":C.trophyWon.toLowerCase(),});
y.appendTo(x);
var F=f("<div>",{"class":"holderDiv"}).appendTo(x);
f("<div>",{"class":"CallOutPointer"}).html("pointer").appendTo(F);
if(C.avatarUrlTable){var A=f("<div>",{"class":"avtarImg"}).appendTo(F);
f("<img>").attr({src:C.avatarUrlTable}).appendTo(A)
}if(C.handleTable){var t=f("<div>",{"class":"GameDetails"}).appendTo(F);
f("<h6>").attr({title:C.handleTable}).html(C.handleTable).appendTo(t)
}if(C.dateOfTrophyWon){f("<p>",{"class":""}).html(Adobe.I18n.get("Trophy Earned")).appendTo(t);
f("<p>",{"class":""}).html(C.dateOfTrophyWon).appendTo(t);
f("<p>",{"class":""}).html(C.timeOfTrophyWon).appendTo(t)
}x.appendTo($td)
}else{f("<span>").appendTo($td).addClass("locked")
}$td.find("span").hover(function(L){f("div.holderDiv").removeAttr("style").hide();
f("div.holderDiv").children("div.CallOutPointer").removeAttr("style");
var M=f(this).next("div.holderDiv").outerWidth(true);
var O=f(this).offset();
var N=f(d).width()-(f(this).offset().left+f(this).width());
var K=navigator.userAgent.match(/iPad/i)!=null;
if(N<=399&&K){f(this).next("div.holderDiv").css({right:f(this).width()+10,});
f(this).next("div.holderDiv").children("div.CallOutPointer").css({"background-position":"left bottom",right:"-55px",})
}else{if(N<=550&&!K){f(this).next("div.holderDiv").css({right:f(this).width()+10,});
f(this).next("div.holderDiv").children("div.CallOutPointer").css({"background-position":"left bottom",right:"-55px",})
}else{f(this).next("div.holderDiv").css({left:"113px"});
f(this).next("div.holderDiv").children("div.CallOutPointer").css({"background-position":"left top",left:"-55px",})
}}f(this).next("div.holderDiv").show()
},function(){f(this).next("div.holderDiv").hide()
});
f(".holderDiv").hover(function(K){f(this).show()
},function(){f(this).hide()
})
}}}});
if(l.showMoreLink&&l.curPage<k.totalPage&&!k.$showMoreLink){k.$showMoreLink=f("<a>").attr({href:"javascript:void(0);","class":"more-link"}).html('<span class="more">'+Adobe.I18n.get("MORE")+"</span>").on("click",function(){l.curPage++;
k.buildTableTrohpiesRows();
if(typeof s!=="undefined"){PDC.SC.click("comparegamestrophies","more","text",null)
}}).appendTo(k.$element)
}else{if(k.$showMoreLink&&l.curPage>=k.totalPage){l.curPage=k.totalPage;
k.$showMoreLink.remove();
k.$showMoreLink=null
}}};
c.prototype.removeFriendColmAt=function(m,n){var k=this;
var l=k.options;
var o=500;
if(n!=="user"){var p=[];
k.$tBody.find(".trophy-tr").each(function(q,r){f(f(r).find(".trophy-td")[m]).empty().css({padding:0}).animate({opacity:0},o,function(){var t=f(this).parent();
f(this).remove()
})
});
k.$tHead.find("tr").each(function(q,r){f(r).find("th").eq(m).empty().css({width:116}).stop().animate({opacity:0,width:0,padding:0},o,function(){f(this).remove()
})
});
if(k.colmRemoveTimeoutId){clearTimeout(k.colmRemoveTimeoutId);
k.colmRemoveTimeoutId=null
}k.colmRemoveTimeoutId=setTimeout(function(){k.curCompareIds.splice(m-2,1);
k.updateHash()
},o+100)
}};
c.prototype.addSortComponentOn=function(o){var k=this;
var m=k.options;
if(typeof f.fn.selectbox!=="function"){return
}o.addClass("sort-by-container");
o.html("");
k.$sortCompHolder=null;
k.$sortCompHolder=f("<div>").attr({"class":"CM162-compare-game-trophies CC034-sortBy",id:"compareTrophySort","data-filter-key":"trophyOrder","data-target-id":"sort-by-target-CM162","data-loading-container-id":"loading-container-CM162","data-replace-content":"true"}).css({visibility:"visible"}).appendTo(o);
var n=f("<div>").attr({"class":"sort"}).appendTo(k.$sortCompHolder);
var l=f("<select>").attr({id:"sortBy-compareTrophySort"}).appendTo(n);
f(m.sortOptions).each(function(p,q){var r=f("<option>").attr({"class":"filter exclusive-filter",value:q.value}).html(q.title).appendTo(l);
if(q.value===m.curSort){r.attr({selected:"selected"})
}});
l.selectbox({effect:"fade",speed:400,onChange:function(q,p){m.curSort=q;
k.buildTableTrohpiesRows();
if(typeof s!=="undefined"){PDC.SC.click("comparegamestrophies",q,"text",null)
}}})
};
c.prototype.sortTrophiesList=function(){var l=this;
var m=l.options;
l.curSortedTableData=f.extend(true,{},l.curTableData);
if(m.curSort==="trophyType"){var k=["unknown","bronze","silver","gold","platinum"];
l.curSortedTableData.body.sort(function(o,n){o=o[0];
n=n[0];
o=f.inArray(o.type,k);
n=f.inArray(n.type,k);
return n-o
})
}else{if(m.curSort==="trophiesOwned"){l.curSortedTableData.body.sort(function(p,n){p=p[0];
n=n[0];
p=p.time||"";
n=n.time||"";
var r=/(\d){4}-(\d){1,2}-(\d){1,2}T(\d){1,2}:(\d){1,2}:(\d){1,2}/;
if(r.test(p)){var q=l.parseDateData(p);
q=new Date(q.getTime());
p=(q)
}else{p=0
}if(r.test(n)){var o=l.parseDateData(n);
o=new Date(o.getTime());
n=(o)
}else{n=0
}return n-p
})
}}};
c.prototype.buildCurTableData=function(){var z=this;
var u=z.options;
z.mergeAllUserTrophiesList();
var v=u.compareData[z.curGameId];
var l=[];
l.push(v[z.loginUserId+"_arranged"]);
f(z.curCompareIds).each(function(B,C){l.push(v[C+"_arranged"])
});
var v=u.compareData[z.curGameId];
var y,w;
var k=z.curTableData={head:[],body:[]};
var q=k.head;
var t=3;
for(var p=0;
p<t;
p++){q[p]=[];
for(var o=0;
o<u.tableColms;
o++){q[p][o]={};
if(p===0&&o===0){q[p][o]={gameImgUrl:v.imgUrl,gameTitle:v.gameTitle,gameId:v.gameId}
}var r=l[o-1];
if(p===0&&o>0&&r){q[p][o]={avatarUrl:r.avatarUrl,handle:r.handle,isPlusUser:parseInt(r.isPlusUser)};
y=r.avatarUrl;
w=r.handle
}if(p===1&&o>0&&r){q[p][o]={trophies:r.trophies}
}if(p===2&&o>0&&r){q[p][o]={progress:r.progress}
}}}var n=v[z.loginUserId+"_arranged"].list;
var m=k.body;
var A=n.length;
for(p=0;
p<A;
p++){m[p]=[];
for(o=0;
o<u.tableColms;
o++){var x;
if(o===0&&l[o]){x=l[o].list[p];
m[p][o]={imgUrl:x.imgUrl,title:x.title,type:x.type.toLowerCase(),desc:x.desc,trophyId:x.trophyId.toString(),time:x.trophyStamp.toString(),trophyWon:x.trophyWon}
}if(o>0&&l[o-1]){x=l[o-1].list[p]||{};
pdata=l[o-1]||{};
m[p][o]={trophyWon:x.trophyWon,trophyId:x.trophyId&&x.trophyId.toString(),type:x.type&&x.type.toLowerCase(),avatarUrlTable:pdata.avatarUrl,handleTable:pdata.handle,dateOfTrophyWon:x.stampDate,timeOfTrophyWon:x.stampTime,}
}}}};
c.prototype.mergeAllUserTrophiesList=function(){var l=this;
var m=l.options;
l.mergeListArray=[];
var o=m.compareData[l.curGameId];
var k=o[l.loginUserId+"_arranged"]=f.extend(true,{},o[l.loginUserId]);
var n=k.list;
f(l.curCompareIds).each(function(q,t){var r=o[t+"_arranged"]=f.extend(true,{},o[t]);
var p=r.list;
var u=[];
f(n).each(function(v,w){var x=w.trophyId.toString();
f(p).each(function(z,y){if(x&&x.match(y.trophyId.toString())){u[v]=y;
p.splice(z,1)
}});
if(!u[v]){u[v]={}
}});
f(p).each(function(w,v){u.push(v);
n.push({imgUrl:m.lockedTrophyImgUrl,title:v.title,desc:v.desc,trophyId:v.trophyId,type:v.type,timeStamp:v.trophyStamp})
});
r.list=u
})
};
c.prototype.parseTrohpiesData=function(n){var k=this;
var l=k.options;
k.loginUserId=n.handle;
var o=l.compareData[n.gameId]=l.compareData[n.gameId]||{};
o.imgUrl=n.imgUrl;
o.gameTitle=n.gameTitle;
o.gameId=n.gameId;
f(n.users).each(function(p,q){var r=q.handle;
o[r]=q;
if(k.curGameId!==n.gameId&&r!==k.loginUserId){k.curCompareIds.push(r)
}});
k.curGameId=n.gameId;
var m=k.curCompareIds.length;
f(k.curCompareIds).each(function(p,q){if(!o[q]){k.curCompareIds.splice(p,1);
l.colorBoxProps.html=k.getNoResultDom(f("<div />").html(l.noFriendFoundMsg).text()+' "'+q+'"',l.noFriendIcon,"no-results-main favourite-friends recentlyPlayedByYou");
if(k.invalidFriendErrorId){d.clearTimeout(k.invalidFriendErrorId)
}k.invalidFriendErrorId=d.setTimeout(function(){f.colorbox(l.colorBoxProps)
},800)
}});
if(m>k.curCompareIds.length){k.updateHash();
return false
}return true
};
c.prototype.parseDateData=function(o){var n=/(\d{4})-(\d\d)-(\d\d)T(\d\d):(\d\d):(\d\d)(\.\d+)?(Z|([+-])(\d\d):(\d\d))/;
var q=[];
q=o.match(n);
if(!q){throw"Couldn't parse ISO 8601 date string '"+o+"'"
}var k=[1,2,3,4,5,6,10,11];
for(var m in k){q[k[m]]=parseInt(q[k[m]],10)
}q[7]=parseFloat(q[7]);
var l=Date.UTC(q[1],q[2]-1,q[3],q[4],q[5],q[6]);
if(q[7]>0){l+=Math.round(q[7]*1000)
}if(q[8]!="Z"&&q[10]){var p=q[10]*60*60*1000;
if(q[11]){p+=q[11]*60*1000
}if(q[9]=="+"){l-=p
}else{l+=p
}}return new Date(l)
};
c.prototype.filterFriendListHtmlBy=function(p){var m=this;
var n=m.options;
if(m.lastFriendListFilterTxt!==p){var o=[];
var k=n.friendListData.list;
var l=[];
f(k).each(function(q,r){if(f.inArray(r.handle,m.curCompareIds)===-1){l.push(r)
}});
f(l).each(function(q,t){var r=new RegExp("^"+p,"i");
if(r.test(t.handle)){o.push(t)
}});
if(o.length>0){m.$curCboxElem.find(".selectFriend").off();
m.$curCboxElem.find("#searchFriendList").html(m.getFriendListTable(o));
m.$curCboxElem.find(".selectFriend").on("click",m.addFriendClickHandler)
}else{m.$curCboxElem.find("#searchFriendList").html("")
}}m.lastFriendListFilterTxt=p
};
c.prototype.buildFriendListHtml=function(){var v=this;
var q=v.options;
var n=q.friendListData.list;
var t=v.$friendListMainDiv=v.$friendListMainDiv||f("<div>");
t.html("");
if(n.length<=0){var p=f("<section>").attr({"class":"page-section"}).appendTo(t).css({padding:0});
var o=f("<div>").attr({"class":"searchpsnId"}).appendTo(p);
o.html(f("<div />").html(q.searchFriendTitle).text());
var l=f("<div>").attr({"class":"single skin_help_section"}).appendTo(o);
var u=f("<div>").attr({"class":"search-box"}).appendTo(l);
var r=f("<span>").css({display:"inline-block",width:"100%"}).appendTo(u);
f("<input>").attr({type:"text",placeholder:"","class":"searchInputbox",autocomplete:"off",maxlength:"16",spellcheck:"false"}).css({"vertical-align":"top","background-color":"transparent",dir:"auto"}).appendTo(r);
f("<a>").attr({"class":"search"}).html("<span>search</span>").appendTo(l);
var k=f("<div>").attr({id:"searchFriendList"}).appendTo(p);
var m=[];
f(n).each(function(w,x){if(f.inArray(x.handle,v.curCompareIds)===-1){m.push(x)
}});
f(".searchInputbox").focus();
v.getFriendListTable(m).appendTo(k);
f("<div>").attr({"class":"overlay"}).appendTo(k);
t.append(v.getNoResultDom(f("<div />").html(q.noFriendsDataMsg).text(),q.noFriendIcon,"no-results-main favourite-friends recentlyPlayedByYou"))
}else{var p=f("<section>").attr({"class":"page-section compareGameTriphiesSearchModule"}).appendTo(t).css({padding:0});
var o=f("<div>").attr({"class":"searchpsnId"}).appendTo(p);
o.html(f("<div />").html(q.searchFriendTitle).text());
var l=f("<div>").attr({"class":"single skin_help_section"}).appendTo(o);
var u=f("<div>").attr({"class":"search-box"}).appendTo(l);
var r=f("<span>").css({display:"inline-block",width:"100%"}).appendTo(u);
f("<input>").attr({type:"text",placeholder:"","class":"searchInputbox",autocomplete:"off",maxlength:"16",spellcheck:"false"}).css({"vertical-align":"top","background-color":"transparent",dir:"auto"}).appendTo(r);
f("<a>").attr({"class":"search"}).html("<span>search</span>").appendTo(l);
var k=f("<div>").attr({id:"searchFriendList"}).appendTo(p);
var m=[];
f(n).each(function(w,x){if(f.inArray(x.handle,v.curCompareIds)===-1){m.push(x)
}});
v.getFriendListTable(m).appendTo(k);
f("<div>").attr({"class":"overlay"}).appendTo(k)
}};
c.prototype.getNoResultDom=function(q,o,n){var l=this;
var m=l.options;
var p=f("<div>").attr({"class":"CM159_noOverviewResults-compare-games"}).css({"max-width":"700px","margin-top":"60px"});
var k=f("<div>").attr({"class":n}).css({"background-image":"url("+o+")",display:"block"});
k.html(q);
p.append(k);
return p
};
c.prototype.getFriendListTable=function(l){var o=f("<table>").html("<colgroup> <col> <col> <col> <col> <col> <col> </colgroup>");
var n=f("<tbody>").appendTo(o);
var m=6;
var k;
f(l).each(function(p,q){if(p%m===0){k=f("<tr>").appendTo(n)
}var r=f("<td>").appendTo(k);
var t=f("<a>").attr({"class":"compare-trophies-avatar selectFriend",href:"javascript:void(0)","data-friend-id":q.handle}).appendTo(r);
f("<img>").attr({"class":"avatar-image",src:q.avatarUrl,alt:q.handle,title:q.handle}).appendTo(t);
f("<div>").attr({"class":"trophy-count"}).html(q.totalTrophies).appendTo(t);
f("<h4>").attr({"class":"user-name"}).html(q.handle+"<span> "+Adobe.I18n.get("Level")+q.curLevel+"</span>").appendTo(t);
if(parseInt(q.isPlusUser)===1){f("<div>").attr({"class":"plus"}).html("$nbsp;").appendTo(t)
}$btn=f("<div>").attr({"class":"link-btn blue-btn"}).appendTo(t);
f("<div>").attr({"class":"btn "}).html(Adobe.I18n.get("Add")).appendTo($btn)
});
return o
};
var b=true;
c.prototype.openFriendListPopup=function(){var l=this;
var m=l.options;
if(l.addFriendClickHandler){f("#searchFriendList").find(".selectFriend").off("click",l.addFriendClickHandler)
}var n={};
if(f.cookie("userinfo")){n.userInfoCookie=f.cookie("userinfo")
}if(f.cookie("ps_auth")){n.ps_auth=f.cookie("ps_auth")
}n.callback="JSON_CALLBACK";
var k=m.friendListData.list;
if(!k){l.friendListAjax=f.ajax({url:m.friendListDataUrl,dataType:"json",cache:false,data:n}).done(function(q){l.friendListAjax=null;
m.friendListData=q;
l.openFriendListPopup()
})
}else{l.buildFriendListHtml()
}var p=(f(d).height()-120)+"px";
m.colorBoxProps.colorBoxHeight=(f(d).height()-120)+"px";
m.colorBoxProps.onClosed=function(){if(l.friendListAjax){l.friendListAjax.abort();
l.friendListAjax=null;
if(l.$curCboxElem){l.$curCboxElem.find(".selectFriend").off()
}}};
if(l.$friendListMainDiv){m.colorBoxProps.html=l.$friendListMainDiv.html();
l.$friendListMainDiv
}f.colorbox(m.colorBoxProps);
if(l.$friendListMainDiv){l.searchAndAddFriend=function(){var w=f(".currentUserProfile img").map(function(){return f(this).attr("alt").toUpperCase()
}).get();
var v=l.$curCboxElem.find(".search-box input");
var u=v.attr("value");
var r=u.toUpperCase();
for(var q=0;
q<=w.length;
q++){if(w[q]===r){f("#searchFriendList").html('<div class="CM159_noOverviewResults-compare-games" style="width: 700px; margin-top:70px; margin-left:25px;"><div class="no-results-main favourite-friends recentlyPlayedByYou" style="background-image: url(&quot;/etc/designs/pdc/clientlibs_base/images/CM159_noOverviewResults/icon-recently-played-friend.png&quot;); display: block;"><h1>'+u+" "+f("<div />").html(m.friendExist).text()+".</h1></div></div>");
f(".CM159_noOverviewResults-compare-games").hide();
f("#searchFriendList .CM159_noOverviewResults-compare-games").show();
return false
}}if(u&&u.match(/^[\w-]{3,16}/ig)&&!u.match(/[\W-]/ig)){l.curCompareIds[l.curAddFriendIndex]=u;
l.updateHash();
f.colorbox.close()
}else{var t=l.$curCboxElem.find(".search-box");
t.stop().animate({"border-color":"#EE0000"},400);
if(l.searchBoxErrorTimeout){d.clearTimeout(l.searchBoxErrorTimeout)
}l.searchBoxErrorTimeout=d.setTimeout(function(){l.lastSearchBoxBorderColor="#E7E7E7";
t.stop().animate({"border-color":l.lastSearchBoxBorderColor},400)
},1000)
}};
l.addFriendClickHandler=function(){var q=f(this).attr("data-friend-id");
l.curCompareIds[l.curAddFriendIndex]=q;
l.updateHash();
f.colorbox.close();
if(typeof s!=="undefined"){PDC.SC.click("addfriendoverlay","add-friend","button",null)
}};
var o=l.$curCboxElem=f("#cboxLoadedContent");
o.find(".selectFriend").on("click",l.addFriendClickHandler);
o.find(".search").on("click",l.searchAndAddFriend);
o.find(".search-box input").on("keyup",function(q){if(q.keyCode===13){l.searchAndAddFriend()
}});
o.find(".search-box input").on("keyup",function(q){l.filterFriendListHtmlBy(l.$curCboxElem.find(".search-box input").attr("value"))
})
}};
c.prototype.encodeUrlVars=function(l){l=l||"";
var k={};
l.replace(/([^#&=?]+)=([^&=]+)/gi,function(n,m,p,o){k[m]=p
});
return k
};
f.fn[e]=function(k){return this.each(function(){if(!f.data(this,"plugin_"+e)){f.data(this,"plugin_"+e,new c(this,k))
}})
}
})(jQuery,window,document);
(function(e,c,a,g){var d="compareGameTrophiesGamesList",f={gameListDataUrl:"//my.playstation.com/playstation/psn/profile/user/gameList/",noGameListMsg:"What, no games played yet!",noGameIcon:"/etc/designs/pdc/clientlibs_base/images/CM162_CompateGamesTrophies/icon-recently-played-you.png",exploreGamesLink:"/en-us/explore/games/newreleases/",myTrophiesPageLink:"//my.playstation.com/logged-in/trophies/",useUrlVars:false};
function b(k,h){this.element=k;
this.$element=e(this.element);
this.$elementParent=this.$element.parent();
this.$key=e(this.element).attr("id");
this.options=e.extend(true,{},f,h);
this._defaults=f;
this._name=d;
this.init()
}b.prototype.init=function(){var h=this;
var k=h.options;
this.options.exploreGamesLink=h.$element.closest("section").find(".exploreGamesLink").data("href");
this.options.myTrophiesPageLink=h.$element.closest("section").find(".myTrophiesPageLink").data("href");
var n=h.encodeUrlVars(c.sessionStorage.compareTrophiesVars);
h.curGameId=n.gid;
if(!n.gid){if(k.useUrlVars){var m=h.encodeUrlVars(c.location.href).gid;
h.curGameId=m
}else{c.location=k.myTrophiesPageLink
}}e(c).on("compareGameTrophiesLoaded",function(p,o){o=o||{};
h.buildGameListDropdown();
if(!o.gameId){c.location=k.myTrophiesPageLink
}});
if(h.gameListAjax){h.gameListAjax.abort()
}if(!k.gameListData){h.$element.find(".ajax-loader").remove();
e("<div>").attr({"class":"ajax-loader CM162-compare-game-trophies CC038-selectDropdown clearfix"}).appendTo(h.$element).css({"z-index":"230",width:"310px",height:"40px",position:"relative","background-position":"50% 0%"});
var l={};
if(e.cookie("userinfo")){l.userInfoCookie=e.cookie("userinfo")
}l.callback="JSON_CALLBACK";
h.gameListAjax=e.ajax({url:k.gameListDataUrl,cache:false,async:true,crossDomain:true,dataType:"json",data:l}).done(function(o){h.$element.find(".ajax-loader").remove();
k.gameListData=o;
if(o.list){h.sortGameList()
}h.curGameId=h.curGameId||o.curGameId;
k.gameListData.list.length>0?h.buildGameListDropdown():h.showNoGameListMsg()
})
}else{h.buildGameListDropdown()
}};
b.prototype.sortGameList=function(){var h=this;
var k=h.options;
k.gameListData.list.sort(function(m,l){m=m.title.toLowerCase();
l=l.title.toLowerCase();
if(m<l){return -1
}else{if(m>l){return 1
}else{return 0
}}})
};
b.prototype.showNoGameListMsg=function(){var k=this;
var l=k.options;
var o=k.$elementParent.parent().parent();
o.html("");
var n=e("<div>").addClass("CM159_noOverviewResults-compare-games").appendTo(o);
var h=e("<div>").attr({"class":"no-results-main recently-played recentlyPlayedByYou recentlyPlayed"}).css({"background-image":"url("+l.noGameIcon+")",display:"block"}).appendTo(n).html(e("<div />").html(l.noGameListMsg).text());
var m=e("<div>").attr({"class":"genericButtonRow buttonRow"}).appendTo(h);
e("<a>").attr({"class":"link-btn blue-btn   -btn",href:l.exploreGamesLink}).html('<div class="btn ">'+Adobe.I18n.get("Explore Games")+"</div>").appendTo(m)
};
b.prototype.buildGameListDropdown=function(){var h=this;
var k=h.options;
if(typeof e.fn.selectbox!=="function"){return 0
}if(h.$dropDown||!k.gameListData||!k.gameListData.list.length||!h.curGameId){return 0
}var l=h.$dropDown=e("<div>").attr({"class":"CM162-compare-game-trophies CC038-selectDropdown clearfix"}).appendTo(h.$element);
var n=e("<div>").attr({"class":"sort"}).appendTo(l).css("z-index","220");
var o=e("<select>").appendTo(n);
var m=e("<option>").attr({selected:"selected",value:"current","class":"filter exclusive-filter"}).html(Adobe.I18n.get("Change Game")).appendTo(o);
e(k.gameListData.list).each(function(p,r){var q=e("<option>").attr({value:r.gameId+","+r.title,"class":"filter exclusive-filter"}).html(r.title).appendTo(o);
if(h.curGameId===r.gameId){h.$elementParent.parent().parent().find(".module-sub-heading.left").html(r.title)
}});
o.selectbox({effect:"fade",speed:400,onChange:function(r,p){if(r!="current"){var q=r.split(",");
h.$elementParent.parent().parent().find(".module-sub-heading.left").html(q[1]);
h.curGameId=q[0];
h.setGameId();
h.$dropDown.remove();
h.$dropDown.off();
h.$dropDown=null;
h.buildGameListDropdown();
if(typeof s!=="undefined"){PDC.SC.click("comparegametrophies",q[1],"text",null)
}e(c).trigger("gameListChange",h.curGameId)
}}})
};
b.prototype.setGameId=function(l){var h=this;
var k=h.options;
if(!k.useUrlVars){var m=h.encodeUrlVars(c.sessionStorage.compareTrophiesVars);
var n="";
if(m.compare){n="&compare="+m.compare
}c.sessionStorage.compareTrophiesVars="#gid="+h.curGameId+n;
k.gid=h.curGameId
}};
b.prototype.encodeUrlVars=function(k){k=k||"";
var h={};
k.replace(/([^#&=?]+)=([^&=]+)/gi,function(m,l,o,n){h[l]=o
});
return h
};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))
}})
}
})(jQuery,window,document);
(function(e,c,a,g){var d="compareGameTrophiesPageToggle",f={curGameId:null,curCompareIds:"",comparePageLink:"",compareGameFriendPageLink:"",useUrlVars:false,sessionStoreCall:"/candc/psn/profile/compare/trophies"};
function b(k,h){this.element=k;
this.$element=e(this.element);
this.$elementParent=this.$element.parent();
this.$key=e(this.element).attr("id");
this.options=e.extend(true,{},f,h);
this._defaults=f;
this._name=d;
this.init()
}b.prototype.init=function(){var h=this;
var k=h.options;
var m=h.encodeUrlVars(c.location.href);
var l=m.gid;
if(k.useUrlVars&&l){h.curGameId=l;
h.curCompareIds=m.compare||"";
h.setLinkUrl();
h.$element.css("display","block");
e(c).on("gameListChange",function(n,o){h.curGameId=o;
h.updateHash()
})
}else{h.$element.css("display","block")
}};
b.prototype.updateHash=function(){var h=this;
var k=h.options;
var l="#gid="+h.curGameId+"&compare="+h.curCompareIds.join(",");
c.location.replace(l)
};
b.prototype.setLinkUrl=function(){var h=this;
var k=h.options;
h.$element.find("a").on("click",function(l){l.preventDefault();
c.location=e(this).attr("href")+"#gid="+h.curGameId+"&compare="+h.curCompareIds
})
};
b.prototype.encodeUrlVars=function(k){k=k||"";
var h={};
k.replace(/([^#&=?]+)=([^&=]+)/gi,function(m,l,o,n){h[l]=o
});
return h
};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){e.data(this,"plugin_"+d,new b(this,h))
}})
}
})(jQuery,window,document);
(function(e,g,k,b){var c=false;
var a="";
var f="compareTrophiesOverview",d={gamesDataUrl:"//my.playstation.com/playstation/psn/profile/compare/userData",friendListDataUrl:"//my.playstation.com/playstation/psn/profile/compare/friends/",dataVars:null,compareData:{},friendListData:{},tableColms:5,tilesPerPage:16,curPage:1,showMoreLink:true,sortOptions:[{title:Adobe.I18n.get("Alphabetical"),value:"alphabetical"},{title:Adobe.I18n.get("Total Trophies"),value:"totalTrophies"},{title:Adobe.I18n.get("Most Recent"),value:"mostRecent"}],curSort:"mostRecent",noFriendIcon:"/etc/designs/pdc/clientlibs_base/images/mypdc/icon-recently-played-friend.png",exploreGamesLink:"/en-us/explore/games/newreleases/",noDataIcon:"/etc/designs/pdc/clientlibs_base/images/mypdc/icon-recently-played-you.png",colorBoxProps:{initialWidth:400,initialHeight:300,scrolling:true,width:"760px",height:"500px",maxWidth:"760px",maxHeight:"695px",overlayClose:true,photo:false},userUrlVars:false};
function l(o,n){var m=this;
m.element=o;
m.$element=e(o);
m.$elementParent=m.$element.parent();
m.$key=e(m.element).attr("id");
m.options=e.extend(true,{},d,n);
m._defaults=d;
m._name=f;
m.friendsCompareCount=0;
m.init()
}l.prototype.init=function(){var m=this;
var n=m.options;
PDC.MyPlaystationProfile.getSignedUserData(function(o){if(o.handle){m.loginUserId=o.handle;
m.initGamesCompare()
}else{PDC.MyPlaystationProfile.redirectToLogin()
}})
};
l.prototype.updateHash=function(){var m=this;
var n=m.options;
var o="#compare="+m.curCompareIds.join(",");
if(n.useUrlVars){g.location.replace(o)
}else{g.sessionStorage.compareGamesVars=o;
m.initGamesCompare()
}};
l.prototype.initGamesCompare=function(){var m=this;
var n=m.options;
if(n.useUrlVars){m.compareVars=m.encodeUrlVars(g.location.href);
m.addHashEvent()
}else{m.compareVars=m.encodeUrlVars(g.sessionStorage.compareGamesVars)
}m.curCompareIds=m.compareVars.compare?m.compareVars.compare.split(","):[];
n.curSort=m.compareVars.sort||n.curSort;
m.curCompareIds=m.curCompareIds||[];
var r=e.inArray(m.loginUserId,m.curCompareIds);
if(r!==-1){m.curCompareIds.splice(r,1)
}var t=[];
e.each(m.curCompareIds,function(u,v){if(v&&e.inArray(v,t)===-1){t.push(v)
}});
if(m.curCompareIds.length>t.length){m.curCompareIds=t;
if(n.useUrlVars){m.updateHash()
}}m.curGameListIndex=m.curGameListIndex||0;
n.compareData=n.compareData||{};
var q=[];
e(m.curCompareIds).each(function(u,v){if(!n.compareData[v]){q.push(v)
}});
if(!n.compareData[m.loginUserId]){q.push(m.loginUserId)
}m.$tableWrapper=m.$tableWrapper||e("<div>").attr({"class":"table-overflow-wrapper clearfix"}).appendTo(m.$element).css({height:"250px"});
m.$element.find(".CM163_loader").remove();
if(m.gamesAjax){m.gamesAjax.abort()
}if(q.length>0){var p=e("<div>").attr({"class":"ajax-loader CM163_loader"}).css({"z-index":"999",top:"0px"});
m.$element.append(p);
var o={};
if(q.length>0){o.userIds=q.join(",")
}if(e.cookie("userinfo")){o.userInfoCookie=e.cookie("userinfo")
}o.callback="JSON_CALLBACK";
m.gamesAjax=e.ajax({url:n.gamesDataUrl,dataType:"json",cache:false,async:true,crossDomain:true,data:o}).done(function(u){if(u.handle){m.$element.find(".CM163_loader").remove();
var v=true;
e(u.users).each(function(w,x){if(!x.list.length){if(x.handle.match(m.loginUserId)){m.$element.html("").append(m.getNoResultDom(e("<div />").html(n.noUserDataMsg).text(),n.noDataIcon,"no-results-main recently-played recentlyPlayedByYou recentlyPlayed"));
v=false;
return v
}else{n.colorBoxProps.html=m.getNoResultDom(e("<div />").html(n.noFriendFoundMsg).text()+' "'+a+'"',n.noFriendIcon,"no-results-main favourite-friends recentlyPlayedByYou");
v=false;
return false
}}});
if(v&&m.parseTrohpiesData(u)){m.buildCurTableData();
m.buildCurTableDom()
}}m.gamesAjax=null;
e(g).trigger("compareGamesLoaded",u)
})
}else{m.buildCurTableData();
m.buildCurTableDom()
}};
l.prototype.buildCurTableDom=function(){var n=this;
var p=n.options;
n.$tableWrapper.css("height","");
n.$tableWrapper.html("");
n.$tBody=null;
n.$table=null;
n.$tHead=null;
var o=n.$table=e("<table>").appendTo(n.$tableWrapper).html("<colgroup> <col> <col> <col> <col> <col> </colgroup>");
var m=n.$tHead=e("<thead>").appendTo(o);
var q=n.curTableData.head;
n.$elementParent.find(".module-sub-heading.left").html(q[0][0].gameTitle);
e(q).each(function(t,x){var w=e("<tr>").appendTo(m);
var r="";
var u="";
var v="";
e(x).each(function(G,z){var F=e("<th>").appendTo(w);
if(t===0&&G===0){e("<p>").html(p.subTitle).appendTo(F)
}else{if(t===0&&G>0){if("handle" in z){var D=e("<div>").attr({"class":"compare-trophies-avatar currentUserProfile"}).appendTo(F);
var A=e("<div>").attr({"class":"absolute-position-wrapper"}).appendTo(D);
if(G>1){e("<a>").attr({"class":"remove-friend","data-friend-id":z.handle,"data-friend-index":G,href:"javascript:void(0)"}).appendTo(A).on("click",function(){var I=e(this);
n.removeFriendColmAt(parseInt(I.attr("data-friend-index")),I.attr("data-friend-id"));
if(typeof s!=="undefined"){PDC.SC.click("comparefriendgames","remove-friend","button",null)
}})
}if(z.curLevel==="undefined"||z.curLevel===b){r="-"
}else{r=z.curLevel
}if(z.avatarUrl==="undefined"||z.avatarUrl===b){v="/etc/designs/pdc/clientlibs_base/images/mypdc/DefaultAvatar_s.png"
}else{v=z.avatarUrl
}if(z.isPlusUser){e("<div>").attr({"class":"plus"}).html("&nbsp;").appendTo(A)
}e("<img>").attr({src:v,alt:z.handle,title:z.handle}).appendTo(D);
var H=e("<div>").attr({"class":"trophy-count"}).appendTo(D).html(z.totalTrophies);
e("<h4>").attr({"class":"user-name"}).html(z.handle+" <span>"+Adobe.I18n.get("Level")+r+"</span>").appendTo(D)
}else{var E=e("<div>").attr({"class":"compare-trophies-avatar addFriend"}).appendTo(F).css({opacity:".4",position:"relative","z-index":"999"});
var y=e("<a>").attr({"class":"add-friend-link","data-add-friend-index":G-2}).appendTo(E);
e("<div>").attr({"class":"add-friend"}).html("<span>&nbsp;</span>").appendTo(y);
e("<h4>").attr({"class":"user-name blank-user"}).html(Adobe.I18n.get("Add friend")).appendTo(E)
}}else{if(t===1&&G>0&&"trophies" in z){var C=e("<div>").attr({"class":"compare-trophies-tile"}).appendTo(F);
var B=e("<ul>").attr({"class":"trophy-summary allTrophyInfo"}).appendTo(C);
e("<li>").attr({"class":"bronze"}).appendTo(B);
e("<li>").attr({"class":"silver"}).appendTo(B);
e("<li>").attr({"class":"gold"}).appendTo(B);
e("<li>").attr({"class":"platinum"}).appendTo(B)
}else{if(t===1&&G===0){n.addSortComponentOn(F)
}}}}})
});
n.activateAddFriendBtn();
n.buildTableTrohpiesRows()
};
l.prototype.activateAddFriendBtn=function(){var n=this;
if(n.$tHead){var m=n.$tHead.find(".addFriend").eq(0).css({opacity:1}).find(".add-friend-link");
m.off();
m.attr({href:"javascript:void(0)"}).on("click",function(){n.curAddFriendIndex=parseInt(e(this).attr("data-add-friend-index"));
n.openFriendListPopup();
if(typeof s!=="undefined"){PDC.SC.click("comparefriendgames","add-friend","button",null)
}})
}};
l.prototype.buildTableTrohpiesRows=function(){var m=this;
var n=m.options;
m.sortTrophiesList();
var t=m.$tBody=m.$tBody||e("<tbody>").appendTo(m.$table);
var o=m.curSortedTableData.body;
t.html("");
var r=o.length;
m.totalPage=Math.ceil(r/n.tilesPerPage);
var q=n.curPage*n.tilesPerPage;
if(n.curPage>m.totalPage){n.curPage=m.totalPage
}q=q>=r?r:q;
var p=o.slice(0,q);
e(p).each(function(C,J){var F=e("<tr>").addClass("trophy-tr").appendTo(t);
for(var A=0;
A<n.tableColms;
A++){var v=J[A];
$td=e("<td>").addClass("trophy-td").appendTo(F);
if(v){if(A===0){var B=e("<a>").attr({"class":"game-info-tile"}).appendTo($td);
var E=e("<div>").attr({"class":"img-container"}).appendTo(B);
e("<img>").attr({"class":"img-bkg",alt:e("<div>").html(v.title).html(),title:e("<div>").html(v.title).html(),src:e("<div>").html(v.imgUrl).html()}).css({}).appendTo(E);
var D=v.platform?v.platform.split(","):[];
e(D).each(function(K,L){if(L.match(/ps3/i)){D[K]="PS3"
}else{if(L.match(/vita/i)){D[K]="PS VITA"
}else{if(L.match(/ps2/i)){D[K]="PS2"
}else{if(L.match(/psp/i)){D[K]=="PSP"
}else{if(L.match(/ps4/i)){D[K]=="PS4"
}}}}}});
var w=v.platform=D.join(", ");
w=w.replace(/\s/g,"");
w=w.split(",");
var z="";
for(var C=0;
C<w.length;
C++){z+="<span class='titleLogo"+w[C]+"'></span>"
}var u=v.title.length>50?v.title.slice(0,50)+"...":v.title;
e("<div>").attr({"class":"txt-container"}).html(z+"<span style='width:100%;font-size: 18px;line-height: 20px; float:left; color: #363636;'>"+u+"</span>").appendTo(B);
if(v.gameLink){B.attr({href:v.gameLink})
}}else{if("trophies" in v&&"progress" in v){var x=e("<div>").attr({"class":"compare-trophies-tile"}).appendTo($td);
var H=e("<ul>").attr({"class":"trophy-summary trophyCountsAndProgress"}).appendTo(x);
var I=v.trophies;
e("<li>").html(I.bronze).appendTo(H);
e("<li>").html(I.silver).appendTo(H);
e("<li>").html(I.gold).appendTo(H);
e("<li>").html(I.platinum).appendTo(H);
var G=e("<div>").attr({"class":"progress clearfix trophyCountsAndProgress"}).appendTo(x);
var y=e("<div>").attr({"class":"bar"}).appendTo(G);
e("<div>").attr({"class":"slider"}).css({width:v.progress+"%"}).appendTo(y);
e("<span>").html(v.progress+"%").appendTo(G)
}else{if(A==1){e("<div>").attr({"class":"no-progress"}).html("&nbsp;").appendTo($td)
}else{e("<div>").attr({"class":"no-progress"}).html("&nbsp;").appendTo($td)
}}}}}});
if(n.showMoreLink&&n.curPage<m.totalPage&&!m.$showMoreLink){m.$showMoreLink=e("<a>").attr({href:"javascript:void(0);","class":"more-link"}).html('<span class="more">'+Adobe.I18n.get("MORE")+"</span>").on("click",function(){n.curPage++;
m.buildTableTrohpiesRows();
if(typeof s!=="undefined"){PDC.SC.click("comparefriendgames","more","text",null)
}}).appendTo(m.$element)
}else{if(m.$showMoreLink&&n.curPage>=m.totalPage){n.curPage=m.totalPage;
m.$showMoreLink.remove();
m.$showMoreLink=null
}}};
l.prototype.removeFriendColmAt=function(o,p){var m=this;
var n=m.options;
var q=500;
if(p!=="user"){var r=[];
m.$tBody.find(".trophy-tr").each(function(t,u){e(e(u).find(".trophy-td")[o]).empty().css({padding:0}).animate({opacity:0},q,function(){var v=e(this).parent();
e(this).remove()
})
});
m.$tHead.find("tr").each(function(t,u){e(u).find("th").eq(o).empty().css({width:116}).stop().animate({opacity:0,width:0,padding:0},q,function(){e(this).remove()
})
});
if(m.colmRemoveTimeoutId){clearTimeout(m.colmRemoveTimeoutId);
m.colmRemoveTimeoutId=null
}m.colmRemoveTimeoutId=setTimeout(function(){m.curCompareIds.splice(o-2,1);
m.updateHash()
},q+100)
}};
l.prototype.sortTrophiesList=function(){var m=this;
var n=m.options;
m.curSortedTableData=e.extend(true,{},m.curTableData);
if(n.curSort==="alphabetical"){m.curSortedTableData.body.sort(function(p,o){p=p[0];
o=o[0];
p=p.title.toLowerCase();
o=o.title.toLowerCase();
if(p<o){return -1
}else{if(p>o){return 1
}else{return 0
}}})
}else{if(n.curSort==="totalTrophies"){m.curSortedTableData.body.sort(function(p,o){p=p[1];
o=o[1];
var q;
if(p.trophies){q=p.trophies;
p=parseInt(q.bronze)+parseInt(q.silver)+parseInt(q.gold)+parseInt(q.platinum)
}else{p=0
}if(o.trophies){q=o.trophies;
o=parseInt(q.bronze)+parseInt(q.silver)+parseInt(q.gold)+parseInt(q.platinum)
}else{o=0
}return o-p
})
}}};
l.prototype.addSortComponentOn=function(q){var m=this;
var o=m.options;
if(typeof e.fn.selectbox!=="function"&&console&&typeof console.log==="function"){return
}q.addClass("sort-by-container");
q.html("");
m.$sortCompHolder=null;
m.$sortCompHolder=e("<div>").attr({"class":"CC034-sortBy",id:"compareTrophySort","data-filter-key":"trophyOrder","data-target-id":"sort-by-target-CM162","data-loading-container-id":"loading-container-CM162","data-replace-content":"true"}).css({visibility:"visible"}).appendTo(q);
var p=e("<div>").attr({"class":"sort"}).appendTo(m.$sortCompHolder);
var n=e("<select>").attr({id:"sortBy-compareTrophySort"}).appendTo(p);
e(o.sortOptions).each(function(r,t){var u=e("<option>").attr({"class":"filter exclusive-filter",value:t.value}).html(t.title).appendTo(n);
if(t.value===o.curSort){u.attr({selected:"selected"})
}});
n.selectbox({effect:"fade",speed:400,onChange:function(t,r){o.curSort=t;
m.buildTableTrohpiesRows();
if(typeof s!=="undefined"){PDC.SC.click("comparefriendsgames",t,"text",null)
}}})
};
l.prototype.buildCurTableData=function(){var A=this;
var y=A.options;
A.mergeAllUserTrophiesList();
var p=y.compareData;
var n=[];
n.push(p[A.loginUserId+"_arranged"]);
e(A.curCompareIds).each(function(C,D){n.push(p[D+"_arranged"])
});
var m=A.curTableData={head:[],body:[]};
var u=m.head;
var x=2;
for(var v=0;
v<x;
v++){u[v]=[];
for(var t=0;
t<y.tableColms;
t++){u[v][t]={};
var w=n[t-1];
if(v===0&&t>0&&w){u[v][t]={avatarUrl:w.avatarUrl,handle:w.handle,isPlusUser:parseInt(w.isPlusUser),curLevel:w.curLevel};
var r=0;
e(w.list).each(function(D,C){var E=C.trophies;
if(E){r=r+parseInt(E.bronze)+parseInt(E.silver)+parseInt(E.gold)+parseInt(E.platinum)
}});
u[v][t].totalTrophies=r
}if(v===1&&t>0&&w){u[v][t]={trophies:w.trophies}
}if(v===2&&t>0&&w){u[v][t]={progress:w.progress,curLevel:w.curLevel}
}}}var q=p[A.loginUserId+"_arranged"].list;
var o=m.body;
var B=q.length;
for(v=0;
v<B;
v++){o[v]=[];
for(t=0;
t<y.tableColms;
t++){var z;
if(t===0&&n[t]){z=n[t].list[v];
o[v][t]={platform:z.platform,imgUrl:z.imgUrl,title:z.title,gameId:z.gameId.toString(),gameLink:z.gameLink}
}if(t>0&&n[t-1]){z=n[t-1].list[v]||{};
o[v][t]={trophies:z.trophies,progress:z.progress};
if(t===1){o[v][t].getGameLink=z.getGameLink
}}}}};
l.prototype.mergeAllUserTrophiesList=function(){var n=this;
var o=n.options;
var q=o.compareData;
var m=q[n.loginUserId+"_arranged"]=e.extend(true,{},q[n.loginUserId]);
var p=m.list;
e(n.curCompareIds).each(function(r,u){var t=q[u+"_arranged"]=e.extend(true,{},q[u]);
var w=t.list;
var v=[];
e(p).each(function(x,z){var y=z.gameId.toString();
e(w).each(function(B,A){if(y&&y.match(A.gameId.toString())){v[x]=A;
w.splice(B,1)
}});
if(!v[x]){v[x]={}
}});
e(w).each(function(y,x){v.push(x);
p.push({imgUrl:x.imgUrl,platform:x.platform,title:x.title,gameId:x.gameId,getGameLink:x.getGameLink,gameLink:x.gameLink})
});
t.list=v
})
};
l.prototype.parseTrohpiesData=function(q){var m=this;
var n=m.options;
var o=!!m.loginUserId;
m.loginUserId=q.handle;
var r=n.compareData||{};
e(q.users).each(function(t,u){var v=u.handle;
r[v]=u;
if(!o&&v!==m.loginUserId){m.curCompareIds.push(v)
}});
var p=m.curCompareIds.length;
e(m.curCompareIds).each(function(t,u){if(!r[u]){m.curCompareIds.splice(t,1);
n.colorBoxProps.html=m.getNoResultDom(e("<div />").html(n.noFriendFoundMsg).text()+' "'+u+'"',n.noFriendIcon,"no-results-main favourite-friends recentlyPlayedByYou");
if(m.invalidFriendErrorId){g.clearTimeout(m.invalidFriendErrorId)
}m.invalidFriendErrorId=g.setTimeout(function(){e.colorbox(n.colorBoxProps)
},800)
}});
if(p>m.curCompareIds.length){m.updateHash();
return false
}return true
};
l.prototype.filterFriendListHtmlBy=function(r){var o=this;
var p=o.options;
if(o.lastFriendListFilterTxt!==r){var q=[];
var m=p.friendListData.list;
var n=[];
e(m).each(function(t,u){if(e.inArray(u.handle,o.curCompareIds)===-1){n.push(u)
}});
e(n).each(function(t,v){var u=new RegExp("^"+r,"i");
if(u.test(v.handle)){q.push(v)
}});
if(q.length>0){o.$curCboxElem.find(".selectFriend").off();
o.$curCboxElem.find("#searchFriendList").html(o.getFriendListTable(q));
o.$curCboxElem.find(".selectFriend").on("click",o.addFriendClickHandler)
}else{o.$curCboxElem.find("#searchFriendList").html("")
}}o.lastFriendListFilterTxt=r
};
l.prototype.buildFriendListHtml=function(){var x=this;
var t=x.options;
var p=t.friendListData.list;
var v=x.$friendListMainDiv=x.$friendListMainDiv||e("<div>");
v.html("");
if(p.length<=0){var r=e("<section>").attr({"class":"page-section"}).appendTo(v).css({padding:0});
var q=e("<div>").attr({"class":"searchpsnId"}).appendTo(r);
q.html(e("<div>").html(t.searchFriendTitle).text());
var n=e("<div>").attr({"class":"single skin_help_section"}).appendTo(q);
var w=e("<div>").attr({"class":"search-box"}).appendTo(n);
var u=e("<span>").css({display:"inline-block",width:"100%"}).appendTo(w);
e("<input>").attr({type:"text",placeholder:"","class":"searchInputbox",autocomplete:"off",maxlength:"16",spellcheck:"false"}).css({"vertical-align":"top","background-color":"transparent",dir:"auto"}).appendTo(u);
e("<a>").attr({"class":"search"}).html("<span>search</span>").appendTo(n);
var m=e("<div>").attr({id:"searchFriendList"}).appendTo(r);
var o=[];
e(p).each(function(y,z){if(e.inArray(z.handle,x.curCompareIds)===-1){o.push(z)
}});
e(".searchInputbox").focus();
x.getFriendListTable(o).appendTo(m);
e("<div>").attr({"class":"overlay"}).appendTo(m);
v.append(x.getNoResultDom(e("<div />").html(t.noFriendsDataMsg).text(),t.noFriendIcon,"no-results-main favourite-friends recentlyPlayedByYou"))
}else{var r=e("<section>").attr({"class":"page-section"}).appendTo(v).css({padding:0});
var q=e("<div>").attr({"class":"searchpsnId"}).appendTo(r);
q.html(e("<div>").html(t.searchFriendTitle).text());
var n=e("<div>").attr({"class":"single skin_help_section"}).appendTo(q);
var w=e("<div>").attr({"class":"search-box"}).appendTo(n);
var u=e("<span>").css({display:"inline-block",width:"100%"}).appendTo(w);
e("<input>").attr({type:"text",placeholder:"","class":"searchInputbox",autocomplete:"off",maxlength:"16",spellcheck:"false"}).css({"vertical-align":"top","background-color":"transparent",dir:"auto"}).appendTo(u);
e("<a>").attr({"class":"search"}).html("<span>search</span>").appendTo(n);
var m=e("<div>").attr({id:"searchFriendList"}).appendTo(r);
var o=[];
e(p).each(function(y,z){if(e.inArray(z.handle,x.curCompareIds)===-1){o.push(z)
}});
x.getFriendListTable(o).appendTo(m);
e("<div>").attr({"class":"overlay"}).appendTo(m)
}};
l.prototype.getNoResultDom=function(t,q,p){var n=this;
var o=n.options;
var r=e("<div>").attr({"class":"CM159_noOverviewResults"}).css({"max-width":"700px","margin-top":"60px"});
var m=e("<div>").attr({"class":p}).css({"background-image":"url("+q+")",display:"block"});
m.html(t);
r.append(m);
return r
};
l.prototype.getFriendListTable=function(q){var u=e("<table>").html("<colgroup> <col> <col> <col> <col> <col> <col> </colgroup>");
var t=e("<tbody>").appendTo(u);
var r=6;
var p;
var m="";
var n="";
var o="";
e(q).each(function(v,w){if(v%r===0){p=e("<tr>").appendTo(t)
}if(w.curLevel==="undefined"||w.curLevel===b){m="-"
}else{m=w.curLevel
}if(w.avatarUrl==="undefined"||w.avatarUrl===b){o="/etc/designs/pdc/clientlibs_base/images/mypdc/DefaultAvatar_s.png"
}else{o=w.avatarUrl
}var x=e("<td>").appendTo(p);
var y=e("<a>").attr({"class":"compare-trophies-avatar selectFriend",href:"javascript:void(0)","data-friend-id":w.handle}).appendTo(x);
e("<img>").attr({"class":"avatar-image",src:o,alt:w.handle,title:w.handle}).appendTo(y);
e("<div>").attr({"class":"trophy-count"}).html(w.totalTrophies).appendTo(y);
e("<h4>").attr({"class":"user-name"}).html(w.handle+"<span> "+Adobe.I18n.get("Level")+w.curLevel+"</span>").appendTo(y);
if(parseInt(w.isPlusUser)===1){e("<div>").attr({"class":"plus"}).html("$nbsp;").appendTo(y)
}$btn=e("<div>").attr({"class":"link-btn blue-btn"}).appendTo(y);
e("<div>").attr({"class":"btn "}).html("Add").appendTo($btn)
});
return u
};
var h=true;
l.prototype.openFriendListPopup=function(){var n=this;
var o=n.options;
if(n.addFriendClickHandler){e("#searchFriendList").find(".selectFriend").off("click",n.addFriendClickHandler)
}var p={};
if(e.cookie("userinfo")){p.userInfoCookie=e.cookie("userinfo")
}if(e.cookie("ps_auth")){p.ps_auth=e.cookie("ps_auth")
}p.callback="JSON_CALLBACK";
var m=o.friendListData.list;
if(!m){n.friendListAjax=e.ajax({url:o.friendListDataUrl,dataType:"json",cache:false,async:true,crossDomain:true,data:p}).done(function(t){n.friendListAjax=null;
o.friendListData=t;
n.openFriendListPopup()
})
}else{n.buildFriendListHtml()
}var r=(e(g).height()-120)+"px";
o.colorBoxProps.colorBoxHeight=(e(g).height()-120)+"px";
o.colorBoxProps.onClosed=function(){if(n.friendListAjax){n.friendListAjax.abort();
n.friendListAjax=null;
if(n.$curCboxElem){n.$curCboxElem.find(".selectFriend").off()
}}};
if(n.$friendListMainDiv){o.colorBoxProps.html=n.$friendListMainDiv.html();
n.$friendListMainDiv
}e.colorbox(o.colorBoxProps);
if(n.$friendListMainDiv){n.searchAndAddFriend=function(){var y=n.$curCboxElem.find(".search-box input");
var w=y.attr("value");
var u=w.toUpperCase();
var x=e(".currentUserProfile img").map(function(){return e(this).attr("alt").toUpperCase()
}).get();
for(var t=0;
t<=x.length;
t++){if(x[t]===u){e("#searchFriendList").html('<div class="CM159_noOverviewResults" style="width: 700px; margin-top:70px; margin-left:25px;"><div class="no-results-main favourite-friends recentlyPlayedByYou" style="background-image: url(&quot;'+noFriendIcon+'&quot;); display: block;">'+w+" "+e("<div />").html(o.friendExist).text()+".</div></div>");
e(".CM159_noOverviewResults").hide();
e("#searchFriendList .CM159_noOverviewResults").show();
return false
}}if(w&&w.match(/^[\w-]{3,16}/ig)&&!w.match(/[\W-]/ig)){n.curCompareIds[n.curAddFriendIndex]=w;
n.updateHash();
e.colorbox.close()
}else{var v=n.$curCboxElem.find(".search-box");
v.stop().animate({"border-color":"#EE0000"},400);
if(n.searchBoxErrorTimeout){g.clearTimeout(n.searchBoxErrorTimeout)
}n.searchBoxErrorTimeout=g.setTimeout(function(){n.lastSearchBoxBorderColor="#E7E7E7";
v.stop().animate({"border-color":n.lastSearchBoxBorderColor},400)
},1000)
}};
n.addFriendClickHandler=function(){var t=e(this).attr("data-friend-id");
n.curCompareIds[n.curAddFriendIndex]=t;
n.updateHash();
e.colorbox.close();
if(typeof s!=="undefined"){PDC.SC.click("addfriendoverlay","add-friend","button",null)
}};
var q=n.$curCboxElem=e("#cboxLoadedContent");
q.find(".selectFriend").on("click",n.addFriendClickHandler);
q.find(".search").on("click",n.searchAndAddFriend);
q.find(".search-box input").on("keyup",function(t){if(t.keyCode===13){n.searchAndAddFriend()
}});
q.find(".search-box input").on("keyup",function(t){n.filterFriendListHtmlBy(n.$curCboxElem.find(".search-box input").attr("value"))
})
}};
l.prototype.encodeUrlVars=function(n){n=n||"";
var m={};
n.replace(/([^#&=?]+)=([^&=]+)/gi,function(p,o,r,q){m[o]=r
});
return m
};
e.fn[f]=function(m){return this.each(function(){if(!e.data(this,"plugin_"+f)){e.data(this,"plugin_"+f,new l(this,m))
}})
}
})(jQuery,window,document);
(function(e,c,a,g){var d="shareablePortableHTML",f={pidUrl:"//my.playstation.com/playstation/psn/profile/pid/get_pid"};
function b(l,k){var h=this;
h.element=l;
h.$element=e(h.element);
h.options=e.extend({},f,k);
h._defaults=f;
h._name=d;
h.init()
}b.prototype.init=function(){var h=this;
var k=h.options;
PDC.portableId.getPidData(function(m){if(typeof m.pidUrl!=="undefined"&&m.pidUrl!==null&&m.pidUrl!==""){var n=h.$element.find("textarea");
var l='<a href="http://us.playstation.com/playstation/psn/visit/profiles/'+m.handle+'"><img src="http://fp.profiles.us.playstation.com/playstation/psn/pid/'+m.handle+'.png" width="230" height="155" border="0" /></a><br/><a href="http://www.us.playstation.com/psn/signup">'+Adobe.I18n.get("get_your_portable_id")+"</a>";
n.val(l)
}else{if(!e("body").hasClass("cq-wcm-edit")){h.$element.addClass("hide")
}else{var n=h.$element.find("textarea");
n.val("You are not logged in to get a message here!")
}}},k.pidUrl)
};
e.fn[d]=function(h){return this.each(function(){if(!e.data(this,"plugin_"+d)){var k=new b(this,h);
e.fn[d].refArray.push(k);
e.data(this,"plugin_"+d,k)
}})
}
})(jQuery,window,document);
(function(a){a.fn.showScene7VideoPanel=function(){var p=this.attr("data-link").split("/is/content/");
if(p.length!=2){return
}var e,b,d,q=false,l=0,g=p[0],k=p[1],c=this.attr("id"),o=this.parent().innerWidth(),m=this.parent().innerHeight();
function f(r,u,t){if(l==0&&e.viewController&&e.viewController.playbackInfo&&e.viewController.playbackInfo.duration){l=e.viewController.playbackInfo.duration/1000
}if(typeof s!="undefined"&&typeof s.Media!="undefined"&&l!=0){if(r=="Select"){if(t){d=t
}return
}var h=Number(t)/1000,v=d;
if(!v){v=u
}v=v.replace(/.*\//,"")+"/"+s.pageName.replace(/:/g,"-");
if(r=="Play"){s.Media.open(v,l,s.Media.playerName);
s.Media.play(v,h);
q=true
}else{if(r=="Ended"){s.Media.stop(v,h);
s.Media.close(v);
q=false
}else{if(r=="Pause"){s.Media.stop(v,h);
q=false
}else{if(r=="Seek"){if(q){s.Media.stop(v,b);
s.Media.play(v,h)
}}}}}b=h
}}if(g.substring(0,2)=="//"){g=location.protocol+g
}if(typeof this.attr("data-avs")!="undefined"){k=this.attr("data-avs")
}d=k;
this.css("width","100%").css("height","100%");
if(window.onVideoPlayerClose){window.onVideoPlayerClose()
}var n={serverUrl:g+"/is/image/",videoServerUrl:g+"/is/content/",asset:k,videoTitle:this.attr("data-title"),cqPath:this.attr("data-path"),ageRating:this.attr("data-agethreshold"),translationService:function(h){if(h=="seek video"||h=="video time"){return""
}if(typeof Adobe.I18n.get=="function"){return Adobe.I18n.get(h)
}return h
},container:document.getElementById(c),locale:window.mboxRelatedVideosLocale,mboxContId:window.mboxRelatedVideosName,onViewerEvent:f,params:{progressivebitrate:900,transition:"fade,1,0.5"}};
if(n.cqPath){d=n.cqPath
}if(window.scene7Servers){n.testServerUrl=scene7Servers.test+"/is/image/";
n.prodServerUrl=scene7Servers.production+"/is/image/";
n.testVideoServerUrl=scene7Servers.test+"/is/content/";
n.prodVideoServerUrl=scene7Servers.production+"/is/content/"
}e=new com.videoViewer.S7ViewerWrapper(n);
e.onWindowResize=function(){a.colorbox.resize({innerWidth:"80%",innerHeight:"80%"})
};
e.onUIFadeAnimation=function(t){var r=a("div#cboxPrevious");
var h=a("div#cboxNext");
r.css("opacity",t);
h.css("opacity",t);
r.css("left",(60*t)+"px");
h.css("right",(60*t)+"px")
};
window.onVideoPlayerClose=function(){try{e.onViewerClosed()
}catch(h){}try{delete window.onVideoPlayerClose
}catch(h){window.onVideoPlayerClose=undefined
}};
window.setRelatedVideos=function(h){e.setRelatedVideos(h)
};
e.draw()
};
a.fn.getVideoDivHTML=function(b){var c="";
a(this).each(function(){a.each(this.attributes,function(){if(this.name=="href"){c+="data-link='"+this.value+"' "
}else{if(this.name.match(/^data/)){c+=this.name+"='"+this.value.replace(/'/g,"&apos;")+"' "
}}})
});
return"<div class='s7videoContainer' id='"+b+"' "+c+"></div>"
}
})(jQuery);
if(!com){var com={videoViewer:{}}
}else{com.videoViewer={}
}com.videoViewer.DataController=function(b){this.processConfig(b);
this.utils=new com.videoViewer.ViewerUtils();
var a=navigator.userAgent.toLowerCase();
this.isIE=(a.indexOf("msie")!=-1&&!this.isOpera&&(a.indexOf("webtv")==-1));
this.isIE8=(a.indexOf("msie 8")!=-1);
this.isIE9=(this.isIE&&((a.indexOf("msie 9")!=-1)||(a.indexOf("msie 8")!=-1)||(a.indexOf("msie 7")!=-1)));
this.isAndroid=a.toLowerCase().indexOf("android")!=-1;
this.isChrome=a.toLowerCase().indexOf("chrome")!=-1;
this.container=null;
this.debugMode=false;
this.lasTrackedEvent=null;
this.applyCheckStop=(s7sdk.browser.device.name!="desktop")
};
com.videoViewer.DataController.prototype.processConfig=function(a){this.serverUrl=a.serverUrl?a.serverUrl:"/is/image";
this.videoServerUrl=a.videoServerUrl?a.videoServerUrl:null;
this.asset=a.asset?a.asset:null;
this.parentContainer=a.container?a.container:null;
this.posterImage=a.posterImage?a.posterImage:null;
this.videoTitle=a.videoTitle?a.videoTitle:null;
this.cqPath=a.cqPath?a.cqPath:null;
this.defaultGenre=a.defaultGenre?a.defaultGenre:null;
this.autoPlay="0";
this.locale=a.locale?a.locale:"en-uk";
this.review=a.review?a.review:[];
this.handler=a.onViewerEvent?a.onViewerEvent:null;
this.debugMode=a.debugMode?a.debugMode:false;
this.cqBasePath=a.cqBasePath?a.cqBasePath:"";
this.mboxContId=a.mboxContId?a.mboxContId:null;
this.translationService=a.translationService?a.translationService:null;
this.confParams=a.params?a.params:null;
this.ageRating=a.ageRating?a.ageRating:null;
this.testServerUrl=a.testServerUrl?a.testServerUrl:null;
this.testVideoServerUrl=a.testVideoServerUrl?a.testVideoServerUrl:null;
this.prodServerUrl=a.prodServerUrl?a.prodServerUrl:null;
this.prodVideoServerUrl=a.prodVideoServerUrl?a.prodVideoServerUrl:null
};
com.videoViewer.DataController.prototype.getContainer=function(){return this.container
};
com.videoViewer.DataController.prototype.init=function(){this.trackEvent("Init");
this.container=document.createElement("div");
this.containerId="viewerContainer_"+this.instanceCount;
this.container.id="viewerContainer_"+this.instanceCount;
this.container.style.overflow="hidden";
this.container.style.width="100%";
this.container.style.height="100%";
this.parentContainer.appendChild(this.container);
this.currentImageIdx=-1;
if(!s7sdk.video||(typeof(s7sdk.video.VideoPlayer)!=="function")){s7sdk.Util.lib.include("s7sdk.event.Event");
s7sdk.Util.lib.include("s7sdk.video.VideoPlayer");
s7sdk.Util.lib.include("s7sdk.common.Container");
s7sdk.Util.lib.include("s7sdk.common.ControlBar");
s7sdk.Util.lib.include("s7sdk.common.Button");
s7sdk.Util.lib.include("s7sdk.video.VideoControls");
s7sdk.Util.init()
}var b=this.container;
while(b.parentNode){b=b.parentNode;
if(b.id&&(b.id=="cboxLoadedContent")){this.cboxLoadedContent=b
}else{if(b.id&&(b.id=="colorbox")){this.colorbox=b
}else{if(b.id&&(b.id=="cboxContent")){this.cboxContent=b
}}}}if(!this.cboxCloseButton){var e=this.cboxContent.childNodes;
for(var c=0;
c<e.length;
c++){if(this.cboxContent.childNodes[c].id&&(this.cboxContent.childNodes[c].id=="cboxClose")){var a=this.cboxContent.childNodes[c];
var d=a.parentNode;
d.removeChild(a);
document.body.appendChild(a);
a.style.top=(this.colorbox.offsetTop)+"px";
a.style.left=(this.colorbox.offsetLeft+this.colorbox.offsetWidth-a.offsetWidth+4)+"px";
a.style.zIndex="9999";
this.cboxCloseButton=a;
com.videoViewer.DataController.cboxCloseButton=a;
break
}}}if(!this.cboxCloseButton&&com.videoViewer.DataController.cboxCloseButton){this.cboxCloseButton=com.videoViewer.DataController.cboxCloseButton
}this.createParamManager();
if(this.testServerUrl&&this.testVideoServerUrl&&this.prodServerUrl&&this.prodVideoServerUrl){this.createTestParamManager();
this.createProdParamManager()
}};
com.videoViewer.DataController.prototype.onAssetChanged=function(){this.params=null;
this.createParamManager()
};
com.videoViewer.DataController.prototype.createParamManager=function(){var d=this;
this.recommendationLabel="You might also like";
this.params=new s7sdk.ParameterManager(null,this.locale);
function e(){d.onDataControllerInitComplete()
}this.params.push("serverurl",this.serverUrl);
this.params.push("videoPlayer_"+this.instanceCount+".autoplay","0");
this.params.push("videoPlayerReview_"+this.instanceCount+".autoplay","1");
if(typeof(this.translationService)==="function"){var a={};
a[this.locale]={"PlayPauseButton.TOOLTIP_SELECTED":this.translationService("play"),"PlayPauseButton.TOOLTIP_UNSELECTED":this.translationService("pause"),"VideoScrubber.TOOLTIP":this.translationService("seek video"),"FullScreenButton.TOOLTIP_SELECTED":this.translationService("Exit full screen"),"FullScreenButton.TOOLTIP_UNSELECTED":this.translationService("full screen"),"VideoTime.TOOLTIP":this.translationService("video time"),"MutableVolume.TOOLTIP_SELECTED":this.translationService("video volume"),"MutableVolume.TOOLTIP_UNSELECTED":this.translationService("video volume")};
this.params.setLocalizedTexts(a);
this.recommendationLabel=this.translationService("You might also like")
}else{var a={};
a[this.locale]={"FullScreenButton.TOOLTIP_SELECTED":"Exit full screen",};
this.params.setLocalizedTexts(a)
}this.params.push("videoserverurl",this.videoServerUrl);
var b="1,-1,0.3,0";
if(s7sdk.browser.name=="ie"&&s7sdk.browser.version.minor==8){b="1,-1,0,0"
}this.params.push("iconeffect",b);
this.params.push("Container.stagesize","10, 10");
if(this.confParams){for(var c in this.confParams){this.params.push(c,this.confParams[c]+"")
}}if(this.posterImage){}this.params.addEventListener(s7sdk.Event.SDK_READY,e,false);
this.params.init()
};
com.videoViewer.DataController.prototype.createTestParamManager=function(){var d=this;
this.recommendationLabel="You might also like";
this.testParams=new s7sdk.ParameterManager(null,this.locale);
function e(){}this.testParams.push("serverurl",this.testServerUrl);
this.testParams.push("videoPlayer_"+this.instanceCount+".autoplay","0");
this.testParams.push("videoPlayerReview_"+this.instanceCount+".autoplay","1");
if(typeof(this.translationService)==="function"){var a={};
a[this.locale]={"PlayPauseButton.TOOLTIP_SELECTED":this.translationService("play"),"PlayPauseButton.TOOLTIP_UNSELECTED":this.translationService("pause"),"VideoScrubber.TOOLTIP":this.translationService("seek video"),"FullScreenButton.TOOLTIP_SELECTED":this.translationService("Exit full screen"),"FullScreenButton.TOOLTIP_UNSELECTED":this.translationService("full screen"),"VideoTime.TOOLTIP":this.translationService("video time"),"MutableVolume.TOOLTIP_SELECTED":this.translationService("video volume"),"MutableVolume.TOOLTIP_UNSELECTED":this.translationService("video volume")};
this.testParams.setLocalizedTexts(a);
this.recommendationLabel=this.translationService("You might also like")
}else{var a={};
a[this.locale]={"FullScreenButton.TOOLTIP_SELECTED":"Exit full screen",};
this.testParams.setLocalizedTexts(a)
}this.testParams.push("videoserverurl",this.testVideoServerUrl);
var b="1,-1,0.3,0";
if(s7sdk.browser.name=="ie"&&s7sdk.browser.version.minor==8){b="1,-1,0,0"
}this.testParams.push("iconeffect",b);
this.testParams.push("Container.stagesize","10, 10");
if(this.confParams){for(var c in this.confParams){this.testParams.push(c,this.confParams[c]+"")
}}if(this.posterImage){}this.testParams.addEventListener(s7sdk.Event.SDK_READY,e,false);
this.testParams.init()
};
com.videoViewer.DataController.prototype.createProdParamManager=function(){var d=this;
this.recommendationLabel="You might also like";
this.prodParams=new s7sdk.ParameterManager(null,this.locale);
function e(){}this.prodParams.push("serverurl",this.prodServerUrl);
this.prodParams.push("videoPlayer_"+this.instanceCount+".autoplay","0");
this.prodParams.push("videoPlayerReview_"+this.instanceCount+".autoplay","1");
if(typeof(this.translationService)==="function"){var a={};
a[this.locale]={"PlayPauseButton.TOOLTIP_SELECTED":this.translationService("play"),"PlayPauseButton.TOOLTIP_UNSELECTED":this.translationService("pause"),"VideoScrubber.TOOLTIP":this.translationService("seek video"),"FullScreenButton.TOOLTIP_SELECTED":this.translationService("Exit full screen"),"FullScreenButton.TOOLTIP_UNSELECTED":this.translationService("full screen"),"VideoTime.TOOLTIP":this.translationService("video time"),"MutableVolume.TOOLTIP_SELECTED":this.translationService("video volume"),"MutableVolume.TOOLTIP_UNSELECTED":this.translationService("video volume")};
this.prodParams.setLocalizedTexts(a);
this.recommendationLabel=this.translationService("You might also like")
}else{var a={};
a[this.locale]={"FullScreenButton.TOOLTIP_SELECTED":"Exit full screen",};
this.prodParams.setLocalizedTexts(a)
}this.prodParams.push("videoserverurl",this.prodVideoServerUrl);
var b="1,-1,0.3,0";
if(s7sdk.browser.name=="ie"&&s7sdk.browser.version.minor==8){b="1,-1,0,0"
}this.prodParams.push("iconeffect",b);
this.prodParams.push("Container.stagesize","10, 10");
if(this.confParams){for(var c in this.confParams){this.prodParams.push(c,this.confParams[c]+"")
}}if(this.posterImage){}this.prodParams.addEventListener(s7sdk.Event.SDK_READY,e,false);
this.prodParams.init()
};
com.videoViewer.DataController.prototype.getElementPosition=function(a){var c={x:0,y:0};
var b=a;
while(b.offsetParent!==null){c.x+=b.offsetLeft;
c.y+=b.offsetTop;
if(b!==a){c.x+=b.clientLeft;
c.y+=b.clientTop
}b=b.offsetParent
}return c
};
com.videoViewer.DataController.prototype.sjSetOpacity=function(b,d){if(d<0){d=0
}if(d>99){d=99.999999
}b.style.opacity=(d/100);
b.style.MozOpacity=(d/100);
b.style.KhtmlOpacity=(d/100);
var c=navigator.appVersion.split("MSIE");
var a=parseFloat(c[1]);
if((a>=5.5)&&(a<=8)&&(document.body.filters)){if(d>99){d=100;
b.style.opacity=(d/100)
}if(b.filters){if(b.filters.length>0){if(b.filters["DXImageTransform.Microsoft.Alpha"]){b.filters.item("DXImageTransform.Microsoft.Alpha").Opacity=d
}else{b.style.filter+=" progid:DXImageTransform.Microsoft.Alpha(opacity="+d+")"
}}else{b.style.filter=" progid:DXImageTransform.Microsoft.Alpha(opacity="+d+")"
}}}b.opacity=b.style.opacity;
return b.opacity
};
com.videoViewer.DataController.prototype.hitTestPoint=function(a,e,c){var d={x:a.getBoundingClientRect().left,y:a.getBoundingClientRect().top};
d.width=a.offsetWidth;
d.height=a.offsetHeight;
var b=false;
if((e>=d.x)&&e<=(d.x+d.width)&&(c>=d.y)&&c<=(d.y+d.height)){b=true
}return b
};
com.videoViewer.DataController.prototype.trackEvent=function(a,c,b){this.lasTrackedEvent=a;
if(typeof this.handler=="function"){this.handler(a,c,b)
}if(this.debugMode==true&&typeof console!="undefined"){console.log("-- "+this.getTimestamp()+" -- Event: "+a+(typeof c!="undefined"?" Asset: "+c:"")+(typeof b!="undefined"?" Data: "+b:""))
}};
com.videoViewer.DataController.prototype.getTimestamp=function(a){if(typeof a=="undefined"){a=new Date()
}return this.pad2digits(a.getHours())+":"+this.pad2digits(a.getMinutes())+":"+this.pad2digits(a.getSeconds())+"."+a.getMilliseconds()
};
com.videoViewer.DataController.prototype.pad2digits=function(a){return(a<10?"0"+a:a)
};
com.videoViewer.ViewerUtils=function(){};
com.videoViewer.ViewerUtils.prototype.parseVideoTime=function(b){var a=Math.floor(b/60);
var d=Math.floor(b-(a*60));
var c=a+":"+((d<10)?"0"+d:d);
return c
};
com.videoViewer.ViewerUtils.prototype.getOpacity=function(c){var b=c.style.opacity?c.style.opacity:c.style.MozOpacity?c.style.MozOpacity:c.style.KhtmlOpacity?c.style.KhtmlOpacity:null;
var d=navigator.appVersion.split("MSIE");
var a=parseFloat(d[1]);
if(!b&&(a>=5.5)&&(a<=8)&&(document.body.filters)){if(c.filters){if(c.filters.length>0){if(c.filters["DXImageTransform.Microsoft.Alpha"]){b=c.filters.item("DXImageTransform.Microsoft.Alpha").Opacity
}}}}return b?b:1
};
com.videoViewer.ViewerUtils.prototype.hitTestPoint=function(a,e,c){var d={x:a.getBoundingClientRect().left,y:a.getBoundingClientRect().top};
d.width=a.offsetWidth;
d.height=a.offsetHeight;
var b=false;
if((e>=d.x)&&e<=(d.x+d.width)&&(c>=d.y)&&c<=(d.y+d.height)){b=true
}return b
};
com.videoViewer.ViewerUtils.prototype.sjScreenSize=function(){var a=(window.innerWidth?window.innerWidth:(document.documentElement.clientWidth?document.documentElement.clientWidth:document.body.offsetWidth));
var b=(window.innerHeight?window.innerHeight:(document.documentElement.clientHeight?document.documentElement.clientHeight:document.body.offsetHeight));
return{w:a,h:b}
};
com.videoViewer.ViewerUtils.prototype.addClass=function(e,a){var f=e.className;
var d="";
if(f.indexOf(a)==-1){var b=" ";
if(f==""){b=""
}d=f+b+a;
e.className=d
}};
com.videoViewer.ViewerUtils.prototype.removeClass=function(d,a){var e=d.className;
var b="";
if(e.indexOf(a)!=-1){if(e.indexOf(" "+a)!=-1){b=e.replace(" "+a,"")
}else{b=e.replace(a,"")
}d.className=b
}};
com.videoViewer.ViewerUtils.prototype.hasClass=function(b,a){var d=b.className;
return(d.indexOf(a)!=-1)
};
var sjCallbacks=[];
var sjErrCallbacks=[];
function sjGetResponse(d,c,a,g){var b="";
var f=c.indexOf("?");
if(f>=0){b=c+"&"+d
}else{b=c+"?"+d
}var h=sjHashCode(b);
b+="&id="+h;
if(typeof a!="undefined"){sjCallbacks.push({callback:a,id:h})
}if(typeof g!="undefined"){sjErrCallbacks.push({callback:g,id:h})
}var e=document.getElementById("sjScript_"+h);
if(e){document.getElementsByTagName("head")[0].removeChild(e);
e=null
}e=document.createElement("script");
e.type="text/javascript";
e.id="sjScript_"+h;
e.src=b;
if(typeof e!="undefined"){document.getElementsByTagName("head")[0].appendChild(e)
}}function utilsJSONResponse(c,b){for(var a=0;
a<sjCallbacks.length;
a++){if(sjCallbacks[a]!=null){if(sjCallbacks[a].id==parseInt(b)){if(sjCallbacks[a].callback){sjCallbacks[a].callback(c)
}delete sjCallbacks[a]
}}}}function s7jsonError(d,c){var a=true;
for(var b=0;
b<sjErrCallbacks.length;
b++){if(sjErrCallbacks[b]!=null){if(sjErrCallbacks[b].id==parseInt(c)){if(sjErrCallbacks[b].callback){sjErrCallbacks[b].callback(d)
}delete sjErrCallbacks[b];
a=false
}}}if(a){}}function sjDebug(d,a,c,b){}function sjHashCode(f){if(!f||f==""){return 1
}var b=0,e=0;
for(var a=f.length-1;
a>=0;
a--){var k=parseInt(f.charCodeAt(a));
b=((b<<6)&268435455)+k+(k<<14);
if((e=b&266338304)!=0){b=(b^(e>>21))
}}return b
}com.videoViewer.ViewController=function(a){this.dataController=a;
this.androidTimeout=null;
this.positionAdjustmentTick=null;
this.videoHeader=null;
this.volumeControlsHideTick=null;
this.prevState=null;
this.playbackInfo={duration:0,playedTime:0,loadedTime:0};
this.checkStopTick=null;
this.skipCapabilityStateEvent=false;
this.lastTrackedTime=-1;
this.playEventSent=false;
this.doCallMBoxUpdate=true;
this.prevState=null;
this.disposed=false;
this.posterImageHolder=null;
this.fixTransparencyTick=null;
this.isTestMode=false;
this.playPending=false;
this.isMuted=false
};
com.videoViewer.ViewController.prototype.init=function(){this.createVideo();
this.createVideoToolBar();
this.createVideoHeader();
this.createReviewPage()
};
com.videoViewer.ViewController.prototype.resizeViewer=function(){var a={w:this.dataController.getContainer().offsetWidth,h:this.dataController.getContainer().offsetHeight};
if(!this.videoContainer.isFullScreen()){this.videoContainer.resize(a.w,a.h)
}};
com.videoViewer.ViewController.prototype.dispose=function(){this.disposed=true;
this.video.pause();
if(this.checkStopTick){clearInterval(this.checkStopTick);
this.checkStopTick=null
}if(this.androidTimeout){clearInterval(this.androidTimeout);
this.androidTimeout=null
}if(this.positionAdjustmentTick){clearInterval(this.positionAdjustmentTick);
this.positionAdjustmentTick=null
}if(this.volumeControlsHideTick){clearTimeout(this.volumeControlsHideTick);
this.volumeControlsHideTick=null
}if(this.doubleClickPendingTick){clearTimeout(this.doubleClickPendingTick);
this.doubleClickPendingTick=null
}if(this.volumeCtrl){this.volumeCtrl.dispose()
}if(this.videoHeader){this.videoHeader.dispose()
}};
com.videoViewer.ViewController.prototype.setAsset=function(a,b){this.doCallMBoxUpdate=true;
this.dataController.asset=a;
this.dataController.posterImage=b?b:null;
this.dataController.review=[];
this.playEventSent=false;
this.lastTrackedTime=-1;
this.dataController.trackEvent("Select",this.dataController.asset,this.dataController.cqPath);
this.createVideo();
this.playbackInfo={duration:0,playedTime:0,loadedTime:0}
};
com.videoViewer.ViewController.prototype.createVideo=function(){var b=this;
var k=this.dataController.getContainer().offsetWidth;
var e=this.dataController.getContainer().offsetHeight;
if(!this.videoContainer){this.videoContainer=new s7sdk.Container(this.dataController.containerId,this.dataController.params,"videoContainer_"+this.dataController.instanceCount);
this.videoContainer.resize(k,e);
this.videoContainer.addEventListener(s7sdk.event.ResizeEvent.COMPONENT_RESIZE,function(h){b.onResizeViewer(h)
},false);
this.videoContainer.addEventListener(s7sdk.event.ResizeEvent.FULLSCREEN_RESIZE,function(h){b.onFullscreen(h)
},false);
if(!this.videoContainer.supportsNativeFullScreen()){if(window.addEventListener){window.addEventListener("resize",function(m){if(b.videoContainer.isFullScreen()){var h=b.dataController.utils.sjScreenSize();
b.videoContainer.resize(h.w,h.h)
}},false)
}else{if(window.attachEvent){window.attachEvent("onresize",function(){if(b.videoContainer.isFullScreen()){var h=b.dataController.utils.sjScreenSize();
b.videoContainer.resize(h.w,h.h)
}})
}}}}var f=true;
var l=false;
if(this.video){this.videoToolbar.detachView(this.video);
this.videoContainer.obj.removeChild(this.video.obj);
if(this.dataController.testServerUrl&&this.dataController.testVideoServerUrl&&this.dataController.prodServerUrl&&this.dataController.prodVideoServerUrl){if(this.isTestMode){this.video=new s7sdk.video.VideoPlayer(this.videoContainer.id,this.dataController.testParams,"videoPlayerReview_"+this.dataController.instanceCount)
}else{this.video=new s7sdk.video.VideoPlayer(this.videoContainer.id,this.dataController.prodParams,"videoPlayerReview_"+this.dataController.instanceCount)
}}else{this.video=new s7sdk.video.VideoPlayer(this.videoContainer.id,this.dataController.params,"videoPlayerReview_"+this.dataController.instanceCount)
}l=true
}else{this.video=new s7sdk.video.VideoPlayer(this.videoContainer.id,this.dataController.params,"videoPlayer_"+this.dataController.instanceCount)
}if(this.dataController.isChrome){this.video.obj.style.visibility="hidden"
}this.video.addEventListener(s7sdk.event.VideoEvent.NOTF_CURRENT_TIME,function(h){b.onNotifyVideoTime(h)
},false);
this.video.addEventListener(s7sdk.event.VideoEvent.NOTF_DURATION,function(h){b.onNotifyVideoTime(h)
},false);
this.video.addEventListener(s7sdk.event.VideoEvent.NOTF_LOAD_PROGRESS,function(h){b.onNotifyVideoTime(h)
},false);
this.video.addEventListener(s7sdk.event.CapabilityStateEvent.NOTF_VIDEO_CAPABILITY_STATE,function(h){b.onNotifyVideoState(h)
},false);
this.video.setAsset(this.dataController.asset,this.dataController.posterImage?this.dataController.posterImage:null);
if((s7sdk.browser.name=="ie")&&(s7sdk.browser.version.minor==9)&&(this.video.obj.childNodes[0].tagName=="VIDEO")){var g=this.video.obj.childNodes;
var c=false;
for(var d=0;
d<g.length;
d++){if(g[d].tagName=="VIDEO"){c=true;
break
}}if(c){if(!this.posterImageHolder){this.posterImageHolder=document.createElement("img");
this.posterImageHolder.style.width="100%";
this.posterImageHolder.style.height="100%";
this.posterImageHolder.style.position="absolute";
this.posterImageHolder.style.left="0px";
this.posterImageHolder.style.top="0px";
this.videoContainer.obj.appendChild(this.posterImageHolder)
}var a=this.dataController.serverUrl+"/"+this.dataController.posterImage+"?wid="+this.dataController.getContainer().offsetWidth+"&hei="+this.dataController.getContainer().offsetHeight+"&fit=fit,1&bgc=0x000000";
this.posterImageHolder.src=a
}}this.videoMouseEventHolder=document.createElement("div");
this.videoMouseEventHolder.className="s7videoplayer";
this.videoContainer.obj.appendChild(this.videoMouseEventHolder);
this.videoMouseEventHolder.style.width="100%";
this.videoMouseEventHolder.style.height="100%";
this.videoMouseEventHolder.style.position="absolute";
this.videoMouseEventHolder.style.left="0px";
this.videoMouseEventHolder.style.top="0px";
this.videoMouseEventHolder.style.zIndex="1";
this.videoMouseEventHolder.style.background="#000000";
this.dataController.sjSetOpacity(this.videoMouseEventHolder,0);
this.videoMouseEventHolderIcon=document.createElement("div");
this.videoMouseEventHolderIcon.className="s7iconeffect";
this.videoMouseEventHolderIcon.style.position="absolute";
this.videoMouseEventHolderIcon.style.zIndex="9999";
this.videoMouseEventHolder.appendChild(this.videoMouseEventHolderIcon);
this.dataController.sjSetOpacity(this.videoMouseEventHolderIcon,0);
this.videoMouseEventHolderIcon.style.top="50%";
this.videoMouseEventHolderIcon.style.left="50%";
this.videoMouseEventHolderIcon.style.marginTop="-"+(this.videoMouseEventHolderIcon.offsetHeight/2)+"px";
this.videoMouseEventHolderIcon.style.marginLeft="-"+(this.videoMouseEventHolderIcon.offsetWidth/2)+"px";
if(window.addEventListener){this.videoMouseEventHolder.addEventListener("mouseup",function(){b.onVideoAreaClick()
});
this.videoMouseEventHolderIcon.addEventListener("mouseover",function(h){b.onOverIconEffect()
},false);
this.videoMouseEventHolderIcon.addEventListener("mouseout",function(h){b.onOutIconEffect()
},false)
}else{if(window.attachEvent){this.videoMouseEventHolder.attachEvent("onmouseup",function(){b.onVideoAreaClick()
});
this.videoMouseEventHolderIcon.attachEvent("onmouseover",function(h){b.onOverIconEffect()
});
this.videoMouseEventHolderIcon.attachEvent("onmouseout",function(h){b.onOutIconEffect()
})
}}if(l){this.videoToolbar.attachView(this.videoMouseEventHolder)
}};
com.videoViewer.ViewController.prototype.onOverIconEffect=function(){this.dataController.utils.addClass(this.dataController.getContainer(),"overIconEffect"+(this.dataController.isIE8?"IE8":""))
};
com.videoViewer.ViewController.prototype.onOutIconEffect=function(){this.dataController.utils.removeClass(this.dataController.getContainer(),"overIconEffect"+(this.dataController.isIE8?"IE8":""))
};
com.videoViewer.ViewController.prototype.onVideoAreaClick=function(){if(this.doubleClickPendingTick){clearTimeout(this.doubleClickPendingTick);
this.doubleClickPendingTick=null;
this.onDoubleClickPerformed()
}else{var a=this;
this.doubleClickPendingTick=setTimeout(function(){a.onSingleClickPerformed()
},250)
}};
com.videoViewer.ViewController.prototype.onDoubleClickPerformed=function(){this.onClickFullScreen()
};
com.videoViewer.ViewController.prototype.onSingleClickPerformed=function(){if(this.doubleClickPendingTick){clearTimeout(this.doubleClickPendingTick);
this.doubleClickPendingTick=null
}this.playStop()
};
com.videoViewer.ViewController.prototype.playStop=function(){var b=this.video.getCapabilityState();
var a=b.hasCapability(s7sdk.VideoCapabilityState.PLAY);
var d=b.hasCapability(s7sdk.VideoCapabilityState.PAUSE);
var c=b.hasCapability(s7sdk.VideoCapabilityState.STOP);
if(this.dataController.lasTrackedEvent=="Ended"){this.video.seek(0);
this.video.play()
}if(a){this.video.play()
}if(d){this.video.pause()
}};
com.videoViewer.ViewController.prototype.createVideoToolBar=function(){var c=this;
this.videoScrubberMinimized=new s7sdk.video.VideoScrubber(this.videoContainer.id,this.dataController.params,"minimizedVideoScrubber_"+this.dataController.instanceCount);
if(this.videoToolbar){}this.videoToolbar=new s7sdk.common.ControlBar(this.videoContainer.id,this.dataController.params,"videoToolbar_"+this.dataController.instanceCount);
this.videoToolbar.attachView(this.videoMouseEventHolder);
this.btnPlay=new s7sdk.common.PlayPauseButton(this.videoToolbar.id,this.dataController.params,"playpauseBtn_"+this.dataController.instanceCount);
this.btnPlay.setSelected(true);
this.btnPlay.addEventListener("click",function(f){c.onPlayPauseButtonClick(f)
},false);
this.videoScrubber=new s7sdk.video.VideoScrubber(this.videoToolbar.id,this.dataController.params,"videoScrubber_"+this.dataController.instanceCount);
if(this.dataController.isAndroid&&typeof(window.ontouchend)!=="undefined"){document.body.addEventListener("touchend",function(){c.videoScrubber.inTouch=false
},false)
}if(!this.videoContainer.isMobile()){this.createVolumeControl()
}else{this.dataController.getContainer().className="mobile"
}this.videoTime=new s7sdk.video.VideoTime(this.videoToolbar.id,this.dataController.params,"videoTime_"+this.dataController.instanceCount);
this.videoScrubber.resize((this.videoTime.obj.offsetLeft-this.videoScrubber.obj.offsetLeft)-24,this.videoScrubber.obj.offsetHeight);
this.videoScrubberMinimized.resize(this.videoToolbar.obj.offsetWidth,this.videoScrubberMinimized.obj.offsetHeight);
this.videoScrubber.addEventListener(s7sdk.event.SliderEvent.NOTF_SLIDER_DOWN,function(f){c.onNotifyScrubberEvent(f)
},false);
this.videoScrubber.addEventListener(s7sdk.event.SliderEvent.NOTF_SLIDER_MOVE,function(f){c.onNotifyScrubberEvent(f)
},false);
this.videoScrubber.addEventListener(s7sdk.event.SliderEvent.NOTF_SLIDER_UP,function(f){c.onNotifyScrubberEvent(f)
},false);
var d=this.videoScrubber.obj.childNodes;
var a=null;
for(var b=0;
b<d.length;
b++){if(d[b].className=="s7knob"){a=d[b];
break
}}if(window.addEventListener){this.videoScrubber.obj.addEventListener("mouseup",function(f){if(c.dataController.utils.getOpacity(c.videoToolbar.obj)>0.2){c.onVideoScrubberClick(f)
}else{c.onVideoAreaClick()
}},false);
this.videoScrubber.obj.addEventListener("mousedown",function(f){if(a&&c.dataController.utils.hitTestPoint(a,f.clientX,f.clientY)){return
}else{f.preventDefault();
f.stopPropagation()
}},true)
}else{if(window.attachEvent){this.videoScrubber.obj.attachEvent("onmouseup",function(){if(c.dataController.utils.getOpacity(c.videoToolbar.obj)>0.2){c.onVideoScrubberClick(window.event)
}else{c.onVideoAreaClick()
}})
}}this.btnFullscreen=new s7sdk.common.FullScreenButton(this.videoToolbar.id,this.dataController.params,"fullScreenBtn_"+this.dataController.instanceCount);
if(typeof(window.ontouchend)!=="undefined"){this.btnFullscreen.addEventListener("touchend",function(){c.onClickFullScreen()
})
}else{this.btnFullscreen.addEventListener("click",function(){c.onClickFullScreen()
})
}};
com.videoViewer.ViewController.prototype.onVideoScrubberClick=function(f){var c=this;
var g=this.videoScrubber.obj.getBoundingClientRect();
if(!this.video.getDuration()){return
}var d=Math.max(0,Math.min(1,(f.clientX-g.left-8)/(this.videoScrubber.obj.offsetWidth)));
if((1-d)<0.01){d=1
}var a=d*this.video.getDuration();
if((s7sdk.browser.device.name=="desktop")&&(a==this.video.getDuration())){a=-1
}var b=(a>-1)?a:this.video.getDuration();
this.dataController.trackEvent("Seek",this.dataController.asset,b);
if(!this.playEventSent&&(b>=this.video.getDuration()/2)){if(this.reviewPage&&this.doCallMBoxUpdate){this.doCallMBoxUpdate=false;
this.reviewPage.getRelatedVideosForVideo()
}}if(a>-1){this.videoScrubber.setPosition(d);
this.video.seek(a)
}else{this.video.seek(this.video.getDuration()-100);
if(this.checkStopTick){clearInterval(this.checkStopTick);
this.checkStopTick=null
}this.checkStopTick=setInterval(function(){c.checkStopBySeek()
},500)
}};
com.videoViewer.ViewController.prototype.createVolumeControl=function(){this.volumeControllerHolder=document.createElement("div");
this.volumeControllerHolder.className="VolumeControllerHolder s7mutablevolume";
this.videoToolbar.obj.appendChild(this.volumeControllerHolder);
this.volumeControllerHolderHei=this.volumeControllerHolder.offsetHeight;
var e=0;
this.vcTransition=new com.videoViewer.Transition(this.volumeControllerHolder.offsetHeight,this.volumeControllerHolderHei,250);
this.volumeControllerHolder.style.visibility="hidden";
this.dataController.sjSetOpacity(this.volumeControllerHolder,0);
var d=this;
this.volumeCtrl=new com.videoViewer.VolumeController();
this.volumeCtrl.setContainer(this.volumeControllerHolder);
function a(f){if(!d.volumeCtrl.onSliderDown){d.dataController.trackEvent("Volume",d.dataController.asset,d.volumeCtrl.getSliderPos())
}d.video.setVolume(d.volumeCtrl.getSliderPos())
}this.volumeCtrl.onSliderPositionChanged=function(f){a()
};
this.volumeCtrl.init();
this.vcTransition.onTransition=function(f){e=f;
d.dataController.sjSetOpacity(d.volumeControllerHolder,f*100);
if(f<0.01){d.volumeControllerHolder.style.visibility="hidden"
}else{d.volumeControllerHolder.style.visibility="inherit"
}};
this.btnVolume=new s7sdk.video.MutableVolume(this.videoToolbar.id,this.dataController.params,"mutableVolume_"+this.dataController.instanceCount);
function b(){d.vcTransition.stop();
d.vcTransition.setStartValue(e);
d.vcTransition.setEndValue(1);
d.vcTransition.start()
}function c(){d.vcTransition.stop();
d.vcTransition.setStartValue(e);
d.vcTransition.setEndValue(0);
d.vcTransition.start()
}this.btnVolume.addEventListener("click",function(f){d.isMuted=!d.isMuted;
if(d.isMuted){d.video.mute();
d.dataController.utils.addClass(d.dataController.getContainer(),"muted")
}else{d.video.unmute();
d.dataController.utils.removeClass(d.dataController.getContainer(),"muted")
}},false);
this.btnVolume.obj.onmouseover=function(f){if(d.volumeControlsHideTick){clearTimeout(d.volumeControlsHideTick);
d.volumeControlsHideTick=null
}d.volumeControlsHideTick=setTimeout(function(){c()
},2000);
b()
};
this.btnVolume.obj.onmouseout=function(f){if(!f){f=window.event
}if(!d.dataController.utils.hitTestPoint(d.volumeControllerHolder,f.clientX,f.clientY)){if(d.volumeControlsHideTick){clearTimeout(d.volumeControlsHideTick);
d.volumeControlsHideTick=null
}d.volumeControlsHideTick=setTimeout(function(){c()
},2000)
}};
this.volumeControllerHolder.onmouseover=function(f){if(d.volumeControlsHideTick){clearTimeout(d.volumeControlsHideTick);
d.volumeControlsHideTick=null
}};
this.volumeControllerHolder.onmousemove=function(){if(d.volumeControlsHideTick){clearTimeout(d.volumeControlsHideTick);
d.volumeControlsHideTick=null
}d.volumeControlsHideTick=setTimeout(function(){c()
},2000)
};
this.volumeControllerHolder.onmouseout=function(f){if(d.volumeControlsHideTick){clearTimeout(d.volumeControlsHideTick);
d.volumeControlsHideTick=null
}d.volumeControlsHideTick=setTimeout(function(){c()
},2000)
}
};
com.videoViewer.ViewController.prototype.createVideoHeader=function(){this.videoHeader=new com.videoViewer.VideoHeaderController(this.dataController);
this.videoHeader.setContainer(this.videoContainer.obj);
this.videoHeader.setTargetComponent(this.videoToolbar.obj);
var a=this;
this.videoHeader.onVideoHeaderHide=function(){a.videoScrubber.inTouch=false
};
this.videoHeader.onHeaderPositionChange=function(b){if(typeof(a.onUIFadeAnimation)==="function"){a.onUIFadeAnimation(b)
}};
this.videoHeader.init()
};
com.videoViewer.ViewController.prototype.createReviewPage=function(){var a=this;
this.reviewPage=new com.videoViewer.ReviewPageController(this.dataController);
this.reviewPage.setContainer(this.videoContainer.obj);
this.reviewPage.onReviewPageDisplayChange=function(){if(typeof(a.notifyReviewPageDisplayChange)==="function"){a.notifyReviewPageDisplayChange()
}};
this.reviewPage.onReviewIdxHandler=function(c){var b=a.dataController.reviewList[c];
a.dataController.cqPath=a.dataController.review[a.dataController.reviewList[c].reviewIndex].path;
a.dataController.videoTitle=a.dataController.reviewList[c].videoTitle;
if(a.videoHeader){a.videoHeader.updateVideoTitleText()
}if(a.videoScrubber){a.videoScrubber.setPlayedTime(0);
a.videoTime.setPlayedTime(0);
a.videoScrubber.setLoadedPosition(0);
a.videoTime.setDuration(0)
}if(b.published&&b.published=="true"){a.isTestMode=false
}else{if(b.published&&b.published=="false"){a.isTestMode=true
}}a.setAsset(b.assetId);
this.hide()
};
this.reviewPage.onReplayClick=function(){if(!a.video){return
}a.video.seek(0);
a.video.play()
};
this.reviewPage.init();
this.videoToolbar.attachView(this.reviewPage.getHolder())
};
com.videoViewer.ViewController.prototype.sjScreenSize=function(){var a=(window.innerWidth?window.innerWidth:(document.documentElement.clientWidth?document.documentElement.clientWidth:document.body.offsetWidth));
var b=(window.innerHeight?window.innerHeight:(document.documentElement.clientHeight?document.documentElement.clientHeight:document.body.offsetHeight));
return{w:a,h:b}
};
com.videoViewer.ViewController.prototype.onFullscreen=function(a){if(this.disposed){return
}this.btnFullscreen.setSelected(this.videoContainer.isFullScreen());
this.btnFullscreen.obj.setAttribute("state","up");
if(this.videoContainer.isFullScreen()){if(!$("html").hasClass("isFullScreenMode")){$("html").addClass("isFullScreenMode")
}if($("html").hasClass("isEmbeddedMode")){$("html").removeClass("isEmbeddedMode")
}this.dataController.trackEvent("EnterFullScreen",this.dataController.asset)
}else{if($("html").hasClass("isFullScreenMode")){$("html").removeClass("isFullScreenMode")
}if(!$("html").hasClass("isEmbeddedMode")){$("html").addClass("isEmbeddedMode")
}this.dataController.trackEvent("ExitFullScreen",this.dataController.asset)
}this.generateEvent()
};
com.videoViewer.ViewController.prototype.generateEvent=function(){if(typeof(document.createEvent)==="undefined"){return
}var a=document.createEvent("MouseEvents");
a.initEvent("mousemove",true,true);
this.btnFullscreen.obj.dispatchEvent(a)
};
com.videoViewer.ViewController.prototype.onResizeViewer=function(b){if(this.disposed){return
}this.dataController.getContainer().style.overflow=this.videoContainer.isFullScreen()?"visible":"hidden";
if(this.dataController.cboxLoadedContent){this.dataController.cboxLoadedContent.style.overflow=this.videoContainer.isFullScreen()?"visible":"auto"
}if(this.dataController.colorbox){this.dataController.colorbox.style.overflow=this.videoContainer.isFullScreen()?"visible":"visible"
}var a=this;
if(!this.videoContainer.isFullScreen()&&((this.dataController.getContainer().offsetWidth!=b.s7event.w)||(this.dataController.getContainer().offsetHeight!=b.s7event.h))){this.videoContainer.resize(this.dataController.getContainer().offsetWidth,this.dataController.getContainer().offsetHeight)
}s=b.s7event;
if(this.videoContainer.isFullScreen()&&(this.dataController.isChrome||this.dataController.isAndroid)&&this.videoContainer.supportsNativeFullScreen()){if(this.androidTimeout){clearInterval(this.androidTimeout);
this.androidTimeout=null
}this.androidTimeout=setInterval(function(){a.adjustComponents(a.videoContainer.obj.offsetWidth,a.videoContainer.obj.offsetHeight)
},500)
}else{this.adjustComponents(this.videoContainer.isFullScreen()?s.w:this.dataController.getContainer().offsetWidth,this.videoContainer.isFullScreen()?s.h:this.dataController.getContainer().offsetHeight)
}if(!this.videoContainer.supportsNativeFullScreen()&&(this.videoContainer.isMobile()||(s7sdk.browser.name=="ie"))){if(this.positionAdjustmentTick){clearInterval(this.positionAdjustmentTick);
this.positionAdjustmentTick=null
}if(this.dataController.colorbox&&(s7sdk.browser.name=="ie")){var c=this.videoContainer.isFullScreen()?"visible":"visible";
if(this.dataController.colorbox.style.overflow!==c){this.dataController.colorbox.style.overflow=this.videoContainer.isFullScreen()?"visible":"visible"
}}this.positionAdjustmentTick=setInterval(function(){a.adjustPosition()
},100)
}if(this.videoHeader){this.videoHeader.updateVideoTitleText()
}};
com.videoViewer.ViewController.prototype.adjustPosition=function(){if(!this.videoContainer.isFullScreen()&&this.positionAdjustmentTick){this.positionAdjustmentTick=clearInterval(this.positionAdjustmentTick);
this.positionAdjustmentTick=null;
return
}if((s7sdk.browser.name=="ie")&&(s7sdk.browser.version.minor>=9)){if(this.dataController.colorbox){var f=this.videoContainer.isFullScreen()?"visible":"visible";
if(this.dataController.colorbox.style.overflow!==f){this.dataController.colorbox.style.overflow=this.videoContainer.isFullScreen()?"visible":"visible"
}}}if((s7sdk.browser.name=="ie")&&(s7sdk.browser.version.minor<=9)){this.videoContainer.obj.style.position=this.videoContainer.isFullScreen()?"fixed":"relative";
this.videoContainer.obj.style.top=0+"px";
this.videoContainer.obj.style.left=0+"px";
return
}var e=window.pageXOffset||document.body.scrollLeft;
var d=window.pageYOffset||document.body.scrollTop;
var a=this.dataController.getContainer();
var c={x:a.getBoundingClientRect().left,y:a.getBoundingClientRect().top};
var b=this.dataController.getElementPosition(a);
if(this.videoContainer.obj.style.top!=(c.y*-1)+"px"){this.videoContainer.obj.style.top=(c.y*-1)+"px"
}if(this.videoContainer.obj.style.left!=(c.x*-1)+"px"){this.videoContainer.obj.style.left=(c.x*-1)+"px"
}if(this.dataController.colorbox&&this.dataController.isIE9){var f=this.videoContainer.isFullScreen()?"visible":"visible";
if(this.dataController.colorbox.style.overflow!==f){this.dataController.colorbox.style.overflow=this.videoContainer.isFullScreen()?"visible":"visible"
}}};
com.videoViewer.ViewController.prototype.adjustComponents=function(a,b){if(this.androidTimeout&&!this.videoContainer.isFullScreen()){clearInterval(this.androidTimeout);
this.androidTimeout=null
}if((parseInt(this.video.obj.style.width)!=a)||(parseInt(this.video.obj.style.height)!=b)){this.video.resize(a,b);
this.videoScrubber.resize((this.videoTime.obj.offsetLeft-this.videoScrubber.obj.offsetLeft)-24,this.videoScrubber.obj.offsetHeight);
this.videoScrubberMinimized.resize(a,this.videoScrubberMinimized.obj.offsetHeight)
}};
com.videoViewer.ViewController.prototype.onClickFullScreen=function(){if(this.videoContainer.isFullScreen()){this.videoContainer.cancelFullScreen()
}else{this.videoContainer.requestFullScreen()
}};
com.videoViewer.ViewController.prototype.onNotifyScrubberEvent=function(d){if(this.disposed){return
}if(!this.video.getDuration()){return
}var c=this;
var a=d.s7event.position*this.video.getDuration();
if((s7sdk.browser.device.name=="desktop")&&(a==this.video.getDuration())){a=-1
}if(d.s7event.type==s7sdk.event.SliderEvent.NOTF_SLIDER_UP){var b=(a>-1)?a:this.video.getDuration();
this.dataController.trackEvent("Seek",this.dataController.asset,b);
if(!this.playEventSent&&(b>=this.video.getDuration()/2)){if(this.reviewPage&&this.doCallMBoxUpdate){this.doCallMBoxUpdate=false;
this.reviewPage.getRelatedVideosForVideo()
}}}if(a>-1){this.video.seek(a)
}else{this.video.seek(this.video.getDuration()-100);
if((d.s7event.type==s7sdk.event.SliderEvent.NOTF_SLIDER_UP)){if(this.checkStopTick){clearInterval(this.checkStopTick);
this.checkStopTick=null
}this.checkStopTick=setInterval(function(){c.checkStopBySeek()
},500)
}}};
com.videoViewer.ViewController.prototype.onPlayPauseButtonClick=function(a){var b=this.video.getCapabilityState();
if(this.btnPlay.isSelected()){this.video.pause()
}else{if(this.video.getCapabilityState().hasCapability(s7sdk.VideoCapabilityState.REPLAY)||(this.dataController.lasTrackedEvent=="Ended")){this.video.seek(0)
}this.video.play();
if(!b.hasCapability(s7sdk.VideoCapabilityState.PLAY)&&!b.hasCapability(s7sdk.VideoCapabilityState.PAUSE)&&!b.hasCapability(s7sdk.VideoCapabilityState.STOP)){this.playPending=true
}}};
com.videoViewer.ViewController.prototype.onNotifyVideoState=function(b){if(s7sdk.browser.name=="ie"&&s7sdk.browser.version.minor==8){var a=this;
if(b.s7event.state.hasCapability(s7sdk.VideoCapabilityState.PLAY)){if(!this.fixTransparencyTick){this.fixTransparencyTick=setInterval(function(){a.fixIconEffectTransparency()
},100)
}}else{if(this.fixTransparencyTick){clearInterval(this.fixTransparencyTick);
this.fixTransparencyTick=null
}}}if(this.skipCapabilityStateEvent){this.btnPlay.setSelected(b.s7event.state.hasCapability(s7sdk.VideoCapabilityState.PLAY)||b.s7event.state.hasCapability(s7sdk.VideoCapabilityState.REPLAY));
this.skipCapabilityStateEvent=false;
return
}if(this.video.obj.style.visibility=="hidden"){this.video.obj.style.visibility="visible"
}if(b.s7event.state.hasCapability(s7sdk.VideoCapabilityState.PAUSE)&&!isNaN(this.video.getCurrentTime())){this.dataController.trackEvent("Play",this.dataController.asset,this.video.getCurrentTime());
this.hidePosterImage();
if(!this.playEventSent){if(this.reviewPage&&this.doCallMBoxUpdate){this.doCallMBoxUpdate=false;
this.reviewPage.getRelatedVideosForVideo()
}}this.playPending=false;
this.playEventSent=true
}else{if(b.s7event.state.hasCapability(s7sdk.VideoCapabilityState.PLAY)&&!isNaN(this.video.getCurrentTime())&&this.playEventSent){var c=this.video.getDuration()-this.video.getCurrentTime();
if(c>200&&(!this.prevState||this.prevState.hasCapability(s7sdk.VideoCapabilityState.PAUSE))){this.dataController.trackEvent("Pause",this.dataController.asset,this.video.getCurrentTime())
}}else{if(b.s7event.state.hasCapability(s7sdk.VideoCapabilityState.PLAY)&&!this.playEventSent&&this.playPending){this.video.play()
}}}if((!b.s7event.state.hasCapability(s7sdk.VideoCapabilityState.PLAY)&&!b.s7event.state.hasCapability(s7sdk.VideoCapabilityState.PAUSE)&&!b.s7event.state.hasCapability(s7sdk.VideoCapabilityState.STOP))){this.dataController.trackEvent("Ended",this.dataController.asset,this.video.getCurrentTime());
this.lastTrackedTime=-1;
if(this.dataController.reviewList.length==0){this.video.seek(0);
this.showPosterImage()
}else{this.reviewPage.show()
}}else{this.reviewPage.hide()
}if(this.playEventSent){this.btnPlay.setSelected(b.s7event.state.hasCapability(s7sdk.VideoCapabilityState.PLAY)||b.s7event.state.hasCapability(s7sdk.VideoCapabilityState.REPLAY))
}else{if(!this.playPending){this.btnPlay.setSelected(true)
}}this.prevState=b.s7event.state
};
com.videoViewer.ViewController.prototype.onNotifyVideoTime=function(c){if(this.disposed){return
}if(this.video.getDuration()&&(this.playbackInfo.duration!=this.video.getDuration())){this.playbackInfo.duration=this.video.getDuration();
this.videoScrubber.setDuration(this.playbackInfo.duration);
this.videoScrubberMinimized.setDuration(this.playbackInfo.duration);
this.videoTime.setDuration(this.playbackInfo.duration)
}if(c.s7event.type==s7sdk.event.VideoEvent.NOTF_CURRENT_TIME){this.playbackInfo.playedTime=c.s7event.data;
var e=this.video.getCapabilityState();
if(e.hasCapability(s7sdk.VideoCapabilityState.PAUSE)&&((this.lastTrackedTime==-1)||((this.video.getCurrentTime()-this.lastTrackedTime)>=1000))){if(!this.playEventSent){this.dataController.trackEvent("Play",this.dataController.asset,this.video.getCurrentTime());
this.hidePosterImage();
if(!this.playEventSent){if(this.reviewPage&&this.doCallMBoxUpdate){this.doCallMBoxUpdate=false;
this.reviewPage.getRelatedVideosForVideo()
}}this.playPending=false;
this.playEventSent=true;
this.btnPlay.setSelected(this.video.getCapabilityState().hasCapability(s7sdk.VideoCapabilityState.PLAY)||this.video.getCapabilityState().hasCapability(s7sdk.VideoCapabilityState.REPLAY))
}this.dataController.trackEvent("Progress",this.dataController.asset,this.video.getCurrentTime());
this.lastTrackedTime=this.video.getCurrentTime()
}}else{if(c.s7event.type==s7sdk.event.VideoEvent.NOTF_LOAD_PROGRESS){this.playbackInfo.loadedTime=c.s7event.data
}}if(this.video.ended()){this.playbackInfo.playedTime=this.playbackInfo.duration;
this.playbackInfo.loadedTime=this.playbackInfo.duration
}var b=Math.min(this.playbackInfo.playedTime,this.playbackInfo.duration);
var a=this;
if(this.dataController.applyCheckStop){if((Math.abs(b-this.playbackInfo.duration)<200)&&(this.playbackInfo.duration>0)){if(s7sdk.browser.device.name=="ipad"){this.skipCapabilityStateEvent=true;
this.video.pause()
}if(this.checkStopTick){clearInterval(this.checkStopTick);
this.checkStopTick=null
}this.checkStopTick=setInterval(function(){a.checkStop()
},500)
}else{if(this.checkStopTick){clearInterval(this.checkStopTick);
this.checkStopTick=null
}if(this.reviewPage.isVisible()){this.reviewPage.hide()
}}}this.videoScrubber.setPlayedTime(b);
this.videoScrubberMinimized.setPlayedTime(b);
this.videoTime.setPlayedTime(b);
var d=Math.min(this.playbackInfo.loadedTime,this.playbackInfo.duration);
this.videoScrubber.setLoadedPosition(d);
this.videoScrubberMinimized.setLoadedPosition(d)
};
com.videoViewer.ViewController.prototype.checkStop=function(){if(this.checkStopTick){clearInterval(this.checkStopTick);
this.checkStopTick=null
}if(this.reviewPage.isVisible()){return
}else{var a=Math.min(this.playbackInfo.playedTime,this.playbackInfo.duration);
if((this.playbackInfo.duration>0)&&(Math.abs(a-this.playbackInfo.duration)<200)){this.skipCapabilityStateEvent=true;
this.video.pause();
this.dataController.trackEvent("Ended",this.dataController.asset,this.video.getCurrentTime());
if(this.dataController.reviewList.length==0){this.video.seek(0);
this.showPosterImage()
}else{this.reviewPage.show()
}}}};
com.videoViewer.ViewController.prototype.checkStopBySeek=function(){if(this.checkStopTick){clearInterval(this.checkStopTick);
this.checkStopTick=null
}if(this.reviewPage.isVisible()){return
}else{var a=Math.min(this.playbackInfo.playedTime,this.playbackInfo.duration);
this.skipCapabilityStateEvent=true;
this.video.pause();
this.dataController.trackEvent("Ended",this.dataController.asset,this.video.getCurrentTime());
if(this.dataController.reviewList&&(this.dataController.reviewList.length>0)){this.reviewPage.show()
}}};
com.videoViewer.ViewController.prototype.fixIconEffectTransparency=function(){var c=this.video.obj.childNodes;
var a=null;
for(var b=0;
b<c.length;
b++){if(c[b].className=="s7iconeffect"){a=c[b];
break
}}if(a&&a.filters&&(a.filters.length>0)&&(this.dataController.utils.getOpacity(a)>0.9)&&(a.style.filter!="none")){a.style.filter="none"
}};
com.videoViewer.ViewController.prototype.hidePosterImage=function(){if(this.posterImageHolder){this.posterImageHolder.style.visibility="hidden"
}};
com.videoViewer.ViewController.prototype.showPosterImage=function(){if(this.posterImageHolder){this.posterImageHolder.style.visibility="visible"
}};
com.videoViewer.VolumeController=function(){this.mutedVolume=null
};
com.videoViewer.VolumeController.prototype.dispose=function(){if(this.tick){clearInterval(this.tick);
this.tick=null
}};
com.videoViewer.VolumeController.prototype.setContainer=function(a){this.container=a
};
com.videoViewer.VolumeController.prototype.init=function(){this.holder=document.createElement("div");
this.holder.style.width="100%";
this.holder.style.height="100%";
this.holder.style.position="absolute";
this.container.appendChild(this.holder);
this.volumeTrackOnHolder=document.createElement("div");
this.volumeTrackOnHolder.className="volumeTrackOnHolder";
this.holder.appendChild(this.volumeTrackOnHolder);
this.volumeTrackOnHolderInitialRect={w:this.volumeTrackOnHolder.offsetWidth,h:this.volumeTrackOnHolder.offsetHeight};
this.volumeTrackOn=document.createElement("div");
this.volumeTrackOn.className="volumeTrackOn";
this.volumeTrackOnHolder.appendChild(this.volumeTrackOn);
this.volumeKnob=document.createElement("div");
this.volumeKnob.className="volumeKnob";
this.holder.appendChild(this.volumeKnob);
this.volumeValue=document.createElement("div");
this.volumeValue.className="volumeValue";
this.holder.appendChild(this.volumeValue);
this.volumeKnob.style.top=this.volumeTrackOnHolder.offsetTop+"px";
this.setListeners();
this.updateVolumeValue()
};
com.videoViewer.VolumeController.prototype.setListeners=function(){var a=this;
if(window.attachEvent){document.attachEvent("onmousemove",function(){a.onSliderMouseMoveHandler(window.event)
});
document.attachEvent("onmouseup",function(){a.onSliderMouseUp(window.event)
});
this.holder.attachEvent("onmousedown",function(){a.onSliderMouseDown()
})
}else{if(typeof(document.body.ontouchstart)!=="undefined"){document.addEventListener("touchmove",function(b){a.onSliderTouchMoveHandler(b)
},true);
document.addEventListener("touchend",function(b){a.onSliderMouseUp(b)
},true);
this.holder.addEventListener("touchstart",function(b){a.onSliderTouchStart(b)
},false)
}else{document.addEventListener("mousemove",function(b){a.onSliderMouseMoveHandler(b)
},false);
document.addEventListener("mouseup",function(b){a.onSliderMouseUp(b)
},false);
this.holder.addEventListener("mousedown",function(b){a.onSliderMouseDown(b)
},false)
}}};
com.videoViewer.VolumeController.prototype.onSliderTouchStart=function(a){a.preventDefault();
var b=a.touches[0];
this.onSliderDown=true;
this.sliderStartX=b.clientX
};
com.videoViewer.VolumeController.prototype.onSliderMouseDown=function(b){if(!b){evt=window.event
}else{evt=b
}if(evt.preventDefault){evt.preventDefault()
}this.onSliderDown=true;
this.sliderStartY=evt.clientY;
var a=this.volumeTrackOn.offsetHeight;
this.volumeTrackOnHolder.style.height=Math.min(Math.max(0,this.volumeTrackOnHolderInitialRect.h-(evt.clientY-this.volumeTrackOn.getBoundingClientRect().top)),a)+"px";
this.volumeTrackOn.style.top="-"+(this.volumeTrackOnHolderInitialRect.h-parseInt(this.volumeTrackOnHolder.style.height))+"px";
this.volumeKnob.style.top=this.volumeTrackOnHolder.offsetTop+"px";
this.notifySliderPositionChanged()
};
com.videoViewer.VolumeController.prototype.onSliderMouseUp=function(a){if(this.onSliderDown){this.onSliderDown=false;
this.notifySliderPositionChanged()
}};
com.videoViewer.VolumeController.prototype.onSliderTouchMoveHandler=function(b){if(this.onSliderDown){b.preventDefault();
var c=b.touches[0];
var a=this.volumeTrackOn.offsetHeight;
this.volumeTrackOnHolder.style.height=Math.min(Math.max(0,this.volumeTrackOnHolderInitialRect.h-(evt.clientY-this.volumeTrackOn.getBoundingClientRect().top)),a)+"px";
this.volumeTrackOn.style.top="-"+(this.volumeTrackOnHolderInitialRect.h-parseInt(this.volumeTrackOnHolder.style.height))+"px";
this.volumeKnob.style.top=this.volumeTrackOnHolder.offsetTop+"px";
this.sliderStartY=c.clientY;
this.notifySliderPositionChanged()
}};
com.videoViewer.VolumeController.prototype.onSliderMouseMoveHandler=function(b){if(this.onSliderDown){if(!b){evt=window.event
}else{evt=b
}var a=this.volumeTrackOn.offsetHeight;
this.volumeTrackOnHolder.style.height=Math.min(Math.max(0,this.volumeTrackOnHolderInitialRect.h-(evt.clientY-this.volumeTrackOn.getBoundingClientRect().top)),a)+"px";
this.volumeTrackOn.style.top="-"+(this.volumeTrackOnHolderInitialRect.h-parseInt(this.volumeTrackOnHolder.style.height))+"px";
this.volumeKnob.style.top=this.volumeTrackOnHolder.offsetTop+"px";
this.sliderStartY=b.clientY;
this.notifySliderPositionChanged()
}};
com.videoViewer.VolumeController.prototype.notifySliderPositionChanged=function(){this.updateVolumeValue();
this.onSliderPositionChanged(this.getSliderPos())
};
com.videoViewer.VolumeController.prototype.getSliderPos=function(){return this.volumeTrackOnHolder.offsetHeight/this.volumeTrackOnHolderInitialRect.h
};
com.videoViewer.VolumeController.prototype.setSliderPos=function(a){this.volumeTrackOnHolder.style.height=this.volumeTrackOnHolderInitialRect.h*a+"px";
this.volumeTrackOn.style.top="0px";
this.volumeKnob.style.top=this.volumeTrackOnHolder.offsetTop+"px";
this.notifySliderPositionChanged()
};
com.videoViewer.VolumeController.prototype.setMuted=function(a){if(a){this.mutedVolume=this.getSliderPos();
this.setSliderPos(0)
}else{this.setSliderPos(this.mutedVolume)
}};
com.videoViewer.VolumeController.prototype.updateVolumeValue=function(){this.volumeValue.innerHTML=Math.round(this.getSliderPos()*5)
};
com.videoViewer.VolumeController.prototype.getElementPosition=function(a){var c={x:0,y:0};
var b=a;
while(b.offsetParent!==null){c.x+=b.offsetLeft;
c.y+=b.offsetTop;
if(b!==a){c.x+=b.clientLeft;
c.y+=b.clientTop
}b=b.offsetParent
}return c
};
com.videoViewer.Transition=function(c,b,a){this.startValue=c;
this.endValue=b;
this.transitionTime=a;
this.tick=null;
this.startTime=null;
this.currentValue=this.startValue
};
com.videoViewer.Transition.prototype.setStartValue=function(a){this.startValue=a
};
com.videoViewer.Transition.prototype.setEndValue=function(a){this.endValue=a
};
com.videoViewer.Transition.prototype.setTransitionTime=function(a){this.transitionTime=a
};
com.videoViewer.Transition.prototype.start=function(){var a=this;
this.doStop();
this.delta=this.endValue-this.startValue;
this.startTime=(new Date()).getTime();
this.tick=setInterval(function(){a.doTransition()
},10)
};
com.videoViewer.Transition.prototype.isRunning=function(){return(this.tick?true:false)
};
com.videoViewer.Transition.prototype.stop=function(){this.doStop()
};
com.videoViewer.Transition.prototype.doStop=function(){if(this.tick){clearInterval(this.tick);
this.tick=null
}};
com.videoViewer.Transition.prototype.doTransition=function(){var a=(new Date()).getTime();
var b=(a-this.startTime)/this.transitionTime;
if(b>=1){this.doStop();
b=1
}this.onTransition(this.startValue+this.delta*b)
};
com.videoViewer.Transition.prototype.onTransition=function(a){};
com.videoViewer.VideoHeaderController=function(a){this.dataController=a;
this.slideTick=null;
this.prevOpacity=null;
this.maxIterations=10;
this.iterationsCount=0
};
com.videoViewer.VideoHeaderController.prototype.dispose=function(){if(this.slideTick){clearInterval(this.slideTick);
this.slideTick=null
}};
com.videoViewer.VideoHeaderController.prototype.setContainer=function(a){this.container=a
};
com.videoViewer.VideoHeaderController.prototype.setTargetComponent=function(a){this.targetComponent=a
};
com.videoViewer.VideoHeaderController.prototype.init=function(){var a=this;
this.videoTitleContainer=document.createElement("div");
this.videoTitleContainer.className="videoTitleContainer";
this.videoTitleContainer.style.webkitTransform="translate3d(0,0,0)";
this.container.appendChild(this.videoTitleContainer);
this.videoTitleSlideHolder=document.createElement("div");
this.videoTitleSlideHolder.className="videoTitleSlideHolder";
this.videoTitleSlideHolder.style.webkitTransform="translate3d(0,0,0)";
this.videoTitleContainer.appendChild(this.videoTitleSlideHolder);
if(!this.dataController.videoTitle){this.videoTitleSlideHolder.style.top="-"+this.videoTitleSlideHolder.offsetHeight+"px"
}this.videoTitleSlideBg=document.createElement("div");
this.videoTitleSlideBg.className="videoTitleSlideBg";
this.videoTitleSlideHolder.appendChild(this.videoTitleSlideBg);
this.iconHolder=document.createElement("div");
this.iconHolder.className="videoTitleIcon";
this.videoTitleSlideHolder.appendChild(this.iconHolder);
this.labelHolder=document.createElement("span");
this.labelHolder.className="videoTitleLabel";
this.videoTitleSlideHolder.appendChild(this.labelHolder);
this.updateVideoTitleText();
this.setMouseEvent();
if(!this.slideTick){this.iterationsCount=0;
this.slideTick=setInterval(function(){a.checkTragetComponent()
},100)
}};
com.videoViewer.VideoHeaderController.prototype.updateVideoTitleText=function(){this.labelHolder.style.width=(this.videoTitleSlideHolder.offsetWidth-this.labelHolder.offsetLeft)+"px";
this.labelHolder.innerHTML=this.dataController.videoTitle
};
com.videoViewer.VideoHeaderController.prototype.setMouseEvent=function(){var a=this;
if(typeof(window.ontouchmove)!=="undefined"){this.container.addEventListener("touchmove",function(b){a.onMoveHandler(b)
},false);
this.container.addEventListener("touchstart",function(b){a.onMoveHandler(b)
},false);
this.container.addEventListener("touchend",function(b){a.onMoveHandler(b)
},false)
}else{if(typeof(window.addEventListener)!=="undefined"){this.container.addEventListener("mousemove",function(b){a.onMoveHandler(b)
},false);
this.container.addEventListener("mouseup",function(b){a.onMoveHandler(b)
},false)
}else{this.container.attachEvent("onmousemove",function(){a.onMoveHandler(window.event)
});
this.container.attachEvent("onmouseup",function(){a.onMoveHandler(window.event)
})
}}};
com.videoViewer.VideoHeaderController.prototype.onMoveHandler=function(b){var a=this;
if(!this.slideTick){this.iterationsCount=0;
this.slideTick=setInterval(function(){a.checkTragetComponent()
},10)
}};
com.videoViewer.VideoHeaderController.prototype.checkTragetComponent=function(){var b=this.dataController.utils.getOpacity(this.targetComponent);
var c=this;
if(this.targetComponent.style.visibility==="hidden"){this.updatePosition(0);
if(this.slideTick){clearInterval(this.slideTick);
this.slideTick=null;
this.onVideoHeaderHide()
}return
}else{if((this.targetComponent.style.visibility==="visible")||(this.targetComponent.style.visibility==="inherit")){this.updatePosition(1);
return
}}if(b==0){this.iterationsCount++;
if(this.iterationsCount>=10){if(this.slideTick){clearInterval(this.slideTick);
this.slideTick=null;
this.onVideoHeaderHide()
}}}this.updatePosition(b)
};
com.videoViewer.VideoHeaderController.prototype.updatePosition=function(b){this.onHeaderPositionChange(b);
if(!this.dataController.videoTitle){this.videoTitleSlideHolder.style.top="-"+this.videoTitleSlideHolder.offsetHeight+"px";
return
}var a="-"+this.videoTitleSlideHolder.offsetHeight*(1-b)+"px";
if(this.videoTitleSlideHolder.style.top!=a){this.videoTitleSlideHolder.style.top=a
}};
com.videoViewer.ReviewPageController=function(a){this.dataController=a;
this.reviewCellGrid=null;
this.completedRequestCount=0;
this.cellList=[]
};
com.videoViewer.ReviewPageController.prototype.setContainer=function(a){this.container=a
};
com.videoViewer.ReviewPageController.prototype.isVisible=function(){return(this.holder.style.display==="block")
};
com.videoViewer.ReviewPageController.prototype.init=function(){var a=this;
this.cellList=[];
this.dataController.onReviewListUpdated=function(){a.getRelatedVideo()
};
this.holder=document.createElement("div");
this.holder.className="reviewPageHolder";
this.container.appendChild(this.holder);
this.overlay=document.createElement("div");
this.overlay.className="reviewPageOverlay";
this.holder.appendChild(this.overlay);
this.contentContainer=document.createElement("div");
this.contentContainer.className="contentContainer";
this.holder.appendChild(this.contentContainer);
this.createLayout();
this.hide()
};
com.videoViewer.ReviewPageController.prototype.onAssetChanged=function(){this.getRelatedVideosForVideo()
};
com.videoViewer.ReviewPageController.prototype.getHolder=function(){return this.holder
};
com.videoViewer.ReviewPageController.prototype.show=function(){this.holder.style.display="block";
if(this.reviewCellGrid==null){this.createCellGrid()
}if(typeof(this.onReviewPageDisplayChange)==="function"){this.onReviewPageDisplayChange()
}};
com.videoViewer.ReviewPageController.prototype.hide=function(){if(this.reviewCellGrid!=null){this.destroyCellGrid()
}this.holder.style.display="none";
if(typeof(this.onReviewPageDisplayChange)==="function"){this.onReviewPageDisplayChange()
}};
com.videoViewer.ReviewPageController.prototype.createLayout=function(){this.headerLabel=document.createElement("span");
this.headerLabel.className="reviewPageheaderlabel";
this.contentContainer.appendChild(this.headerLabel);
this.headerLabel.innerHTML=this.dataController.recommendationLabel
};
com.videoViewer.ReviewPageController.prototype.createCellGrid=function(){this.reviewCellGrid=document.createElement("div");
this.reviewCellGrid.className="reviewCellGrid three";
this.contentContainer.appendChild(this.reviewCellGrid);
var c=0;
for(var b=0;
b<this.dataController.review.length;
b++){for(var a=0;
a<this.dataController.reviewList.length;
a++){if(this.dataController.reviewList[a].reviewIndex==b){this.createCell(a);
c++
}}}for(var b=c;
b<3;
b++){this.createBlankCell()
}for(var b=0;
b<this.reviewCellGrid.childNodes.length;
b++){if(b==0){for(var a=0;
a<this.cellList.length;
a++){if(this.cellList[a].holder==this.reviewCellGrid.childNodes[b]){this.dataController.utils.addClass(this.reviewCellGrid.childNodes[b],"firstCell");
this.cellList[a].setFirstChild(true);
break
}}break
}}};
com.videoViewer.ReviewPageController.prototype.destroyCellGrid=function(){this.contentContainer.removeChild(this.reviewCellGrid);
delete this.reviewCellGrid
};
com.videoViewer.ReviewPageController.prototype.createCell=function(c){var a=new com.videoViewer.ReviewCell(this.dataController);
a.setContainer(this.reviewCellGrid);
a.setIndex(c);
var b=this;
a.onCellClicked=function(d){b.onReviewIdxHandler(d)
};
a.init();
this.cellList.push(a)
};
com.videoViewer.ReviewPageController.prototype.createBlankCell=function(){var a=new com.videoViewer.ReviewBlankCell();
a.setContainer(this.reviewCellGrid);
a.init()
};
com.videoViewer.ReviewPageController.prototype.getRelatedVideosForVideo=function(){this.dataController.reviewList=[];
if(typeof(mboxUpdate)==="function"){mboxUpdate(this.dataController.mboxContId,"entity.id="+this.dataController.cqPath,"entity.locale="+this.dataController.locale,"entity.categoryId=video","entity.ageRating="+this.dataController.ageRating)
}};
com.videoViewer.ReviewPageController.prototype.getRelatedVideo=function(){var b=this;
this.dataController.reviewList=[];
if(!this.dataController.review){return
}for(var a=0;
a<Math.min(this.dataController.review.length,3);
a++){this.doGetRelatedVideo(this.dataController.review[a]["path"])
}};
com.videoViewer.ReviewPageController.prototype.checkAllReqsComplete=function(){this.completedRequestCount++;
if(this.completedRequestCount==Math.min(this.dataController.review.length,3)){if(this.dataController.testServerUrl&&this.dataController.testVideoServerUrl&&this.dataController.prodServerUrl&&this.dataController.prodVideoServerUrl){this.getIsAssetPublished()
}}};
com.videoViewer.ReviewPageController.prototype.getIsAssetPublished=function(){if(this.dataController.reviewList.length==0){return
}var f="";
for(var b=0;
b<this.dataController.reviewList.length;
b++){var c=this.dataController.reviewList[b]["assetId"];
if(f==""){f+=c
}else{f+=","+c
}}function e(g){if(d.dataController.reviewList.length==1){if(g.set.type=="unknown"&&g.set.item.i&&g.set.item.i.isDefault&&(g.set.item.i.isDefault==1)){d.dataController.reviewList[0].published="false"
}else{if((g.set.type!="unknown")&&(g.set.n==d.dataController.reviewList[0]["assetId"])){d.dataController.reviewList[0].published="true"
}}}else{var k=g.set["item"];
for(var h=0;
h<k.length;
h++){if(k[h].set&&(k[h].set.n==d.dataController.reviewList[h]["assetId"])){d.dataController.reviewList[h].published="true"
}else{if(k[h].i&&k[h].i.isDefault&&(k[h].i.isDefault==1)){d.dataController.reviewList[h].published="false"
}}}}}var a=this.dataController.serverUrl+"/psmediadev?req=set,json&imageSet="+f+"&defaultImage=Scene7SharedAssets/Backpack_B&handler=utilsJSONResponse";
var d=this;
sjGetResponse("",a,function(g){e(g)
},function(g){})
};
com.videoViewer.ReviewPageController.prototype.doGetRelatedVideo=function(a){var c=this;
var b=this.dataController.cqBasePath+a+"/jcr:content/metadata.json";
function d(k){if(!k||!k["dam:scene7Type"]||(k["dam:scene7Type"]!="MbrSet")){return
}var o=c.dataController.defaultGenre?c.dataController.defaultGenre:"";
if(k["cq:tags"]){var m=k["cq:tags"];
for(var h=0;
h<m.length;
h++){if(m[h].indexOf("asset_type")!=-1){o=m[h].split(":")[1];
break
}}}var e=k["dam:scene7VideoLength"];
var l=-1;
for(var h=0;
h<c.dataController.review.length;
h++){if(a===c.dataController.review[h]["path"]){l=h;
break
}}var p=o?o:"video/default";
if(typeof(c.dataController.translationService)=="function"){p=c.dataController.translationService(o);
if(p==o){p=c.dataController.translationService("video/default")
}}obj={assetId:k["dam:scene7File"],poster:k["dam:scene7File"],type:p,description:k["dc:title"]?k["dc:title"]:"",videoTitle:k["dc:title"]?k["dc:title"]:"",duration:e,reviewIndex:l};
if(c.dataController.locale&&k.locale_title){var f=k.locale_title;
for(var n in f){if(n.indexOf(c.dataController.locale)!=-1){obj.videoTitle=f[n];
obj.description=f[n];
doBreak=true;
break
}}}c.dataController.reviewList.push(obj)
}$.ajax({url:b,dataType:"json",success:function(e){d(e);
c.checkAllReqsComplete()
},error:function(e,g,f){c.checkAllReqsComplete()
}})
};
com.videoViewer.ReviewCell=function(a){this.dataController=a;
this.isFirstChild=false
};
com.videoViewer.ReviewCell.prototype.setContainer=function(a){this.container=a
};
com.videoViewer.ReviewCell.prototype.setIndex=function(a){this.index=a;
this.reviewConfig=this.dataController.reviewList[this.index]
};
com.videoViewer.ReviewCell.prototype.setFirstChild=function(a){this.isFirstChild=a
};
com.videoViewer.ReviewCell.prototype.init=function(){this.serverUrl=!this.reviewConfig.published?this.dataController.serverUrl:(this.reviewConfig.published=="true")?this.dataController.prodServerUrl:this.dataController.testServerUrl;
this.createLayout();
this.setContent()
};
com.videoViewer.ReviewCell.prototype.createLayout=function(){this.holder=document.createElement("div");
this.holder.className="reviewCell up"+(this.isFirstChild?" firstCell":"");
this.container.appendChild(this.holder);
var a=this;
if(typeof(window.ontouchstart)!=="undefined"){this.holder.addEventListener("touchstart",function(){a.onmouseOver()
},false);
this.holder.addEventListener("touchend",function(){a.onmouseOut();
a.onClickHandler()
},false)
}else{if(typeof(window.addEventListener)!=="undefined"){this.holder.addEventListener("mouseover",function(){a.onmouseOver()
},false);
this.holder.addEventListener("mouseout",function(){a.onmouseOut()
},false);
this.holder.addEventListener("click",function(){a.onClickHandler()
},false)
}else{if(typeof(window.attachEvent)!=="undefined"){this.holder.attachEvent("onmouseover",function(){a.onmouseOver()
});
this.holder.attachEvent("onmouseout",function(){a.onmouseOut()
});
this.holder.attachEvent("onclick",function(){a.onClickHandler()
})
}}}this.imageHolder=document.createElement("div");
this.imageHolder.className="reviewCellImage";
this.holder.appendChild(this.imageHolder);
this.overlayIcon=document.createElement("div");
this.overlayIcon.className="reviewCellOverlayIcon";
this.imageHolder.appendChild(this.overlayIcon);
this.infoContainer=document.createElement("div");
this.infoContainer.className="reviewCellInfoContainer";
this.holder.appendChild(this.infoContainer);
this.infoContainerBg=document.createElement("div");
this.infoContainerBg.className="reviewCellInfoContainerBg";
this.infoContainer.appendChild(this.infoContainerBg);
this.lblType=document.createElement("div");
this.lblType.className="reviewCellType";
this.infoContainer.appendChild(this.lblType);
this.lblDescription=document.createElement("div");
this.lblDescription.className="reviewCellDescription";
this.infoContainer.appendChild(this.lblDescription);
this.lblDuration=document.createElement("div");
this.lblDuration.className="reviewCellDuration";
this.infoContainer.appendChild(this.lblDuration)
};
com.videoViewer.ReviewCell.prototype.onmouseOver=function(){this.holder.className="reviewCell over"+(this.isFirstChild?" firstCell":"")
};
com.videoViewer.ReviewCell.prototype.onmouseOut=function(){this.holder.className="reviewCell up"+(this.isFirstChild?" firstCell":"")
};
com.videoViewer.ReviewCell.prototype.onClickHandler=function(){this.onCellClicked(this.index)
};
com.videoViewer.ReviewCell.prototype.setContent=function(){var a=this.serverUrl+"/"+encodeURI(this.reviewConfig.poster?this.reviewConfig.poster:this.reviewConfig.assetId)+"?fit=crop,1&wid="+this.imageHolder.offsetWidth+"&hei="+this.imageHolder.offsetHeight;
a=a.replace("(","%28");
a=a.replace(")","%29");
this.imageHolder.style.background="url("+a+") no-repeat center";
this.lblType.innerHTML=this.reviewConfig.type;
this.lblDescription.innerHTML=this.truncateDescription(this.reviewConfig.description);
this.lblDuration.innerHTML=this.dataController.utils.parseVideoTime(this.reviewConfig.duration)
};
com.videoViewer.ReviewCell.prototype.truncateDescription=function(b){var a=document.createElement("div");
a.className="reviewCellDescription";
this.infoContainer.appendChild(a);
var d=document.createElement("span");
a.appendChild(d);
d.style.width="100%";
var c=0;
var e="";
while((d.offsetHeight<a.offsetHeight)&&(c<=b.length)){e=b.substring(0,c);
d.innerHTML=e;
c++
}if((d.offsetHeight>=a.offsetHeight)){e=e.substring(0,e.length-4)+"..."
}this.infoContainer.removeChild(a);
return e
};
com.videoViewer.ReviewCell.prototype.getVideoDuration=function(){var a=this.serverUrl+"/"+this.reviewConfig.assetId+"?req=set,json,utf-8&handler=utilsJSONResponse";
var b=this;
sjGetResponse("",a,function(c){b.processResponse(c)
},function(c){})
};
com.videoViewer.ReviewCell.prototype.processResponse=function(c){var a=c.set;
a=a.item.length?a.item[0]:a.item;
a=a.userdata.length?a.userdata[0]:a.userdata;
var b=null;
if(a.Video_Length){b=a.Video_Length
}this.lblDuration.innerHTML=this.dataController.utils.parseVideoTime(b)
};
com.videoViewer.ReviewBlankCell=function(){};
com.videoViewer.ReviewBlankCell.prototype.setContainer=function(a){this.container=a
};
com.videoViewer.ReviewBlankCell.prototype.init=function(){this.createLayout()
};
com.videoViewer.ReviewBlankCell.prototype.createLayout=function(){this.holder=document.createElement("div");
this.holder.className="reviewBlankCell";
this.container.appendChild(this.holder)
};
com.videoViewer.S7ViewerWrapper=function(b){this.dataController=new com.videoViewer.DataController(b);
com.videoViewer.S7ViewerWrapper.COUNTER++;
this.dataController.instanceCount=com.videoViewer.S7ViewerWrapper.COUNTER;
com.videoViewer.S7ViewerWrapper.INSTANCES[com.videoViewer.S7ViewerWrapper.COUNTER]=this;
var a=this;
if(window.addEventListener){window.addEventListener("resize",function(c){a.notifyOnWindowResize()
},false)
}else{if(window.attachEvent){window.attachEvent("onresize",function(){a.notifyOnWindowResize()
})
}}this.resizeTimeout=null;
this.onResizeTick=null;
this.overflowTick=null
};
com.videoViewer.S7ViewerWrapper.COUNTER=0;
com.videoViewer.S7ViewerWrapper.INSTANCES=new Object();
com.videoViewer.S7ViewerWrapper.prototype.dispose=function(){delete this.viewController.onUIFadeAnimation;
delete this.viewController
};
com.videoViewer.S7ViewerWrapper.prototype.isReviewPageDisplayed=function(){return this.viewController.reviewPage.isVisible()
};
com.videoViewer.S7ViewerWrapper.prototype.setRelatedVideos=function(a){this.dataController.review=a;
this.dataController.onReviewListUpdated()
};
com.videoViewer.S7ViewerWrapper.prototype.onResize=function(){if(this.viewController){this.viewController.resizeViewer()
}if(this.dataController&&this.dataController.isChrome){if(this.resizeTimeout){clearTimeout(this.resizeTimeout);
this.resizeTimeout=null
}var a=this;
this.resizeTimeout=setTimeout(function(){if((parseInt(a.dataController.cboxLoadedContent.style.height)!=parseInt(a.dataController.cboxContent.style.height))||(parseInt(a.dataController.cboxLoadedContent.style.width)!=parseInt(a.dataController.cboxContent.style.width))){a.onWindowResize();
setTimeout(function(){a.onResize()
},500)
}},750)
}};
com.videoViewer.S7ViewerWrapper.prototype.notifyOnWindowResize=function(){if(this.dataController.cboxContent){this.dataController.cboxContent.style.overflow="hidden";
this.dataController.cboxCloseButton.style.visibility="hidden"
}if(typeof(this.onWindowResize)==="function"){this.onWindowResize()
}var a=this;
this.onResize();
if(this.onResizeTick){clearTimeout(this.onResizeTick)
}this.onResizeTick=setTimeout(function(){a.onResize()
},750);
if(this.overflowTick){clearTimeout(this.overflowTick);
this.overflowTick=null
}this.overflowTick=setTimeout(function(){if(a.dataController.cboxContent){a.btnClosePositionStartTime=(new Date()).getTime();
if(a.btnClosePositionTick){clearInterval(a.btnClosePositionTick);
a.btnClosePositionTick=null
}a.btnClosePositionTick=setInterval(function(){a.positionCloseButton()
},100);
a.dataController.cboxContent.style.overflow="visible";
a.dataController.cboxCloseButton.style.visibility="visible";
a.dataController.cboxCloseButton.style.top=(a.dataController.colorbox.offsetTop)+"px";
a.dataController.cboxCloseButton.style.left=(a.dataController.colorbox.offsetLeft+a.dataController.colorbox.offsetWidth-a.dataController.cboxCloseButton.offsetWidth)+"px"
}},950)
};
com.videoViewer.S7ViewerWrapper.prototype.positionCloseButton=function(){if(((new Date()).getTime()-this.btnClosePositionStartTime)>10000){clearInterval(this.btnClosePositionTick);
this.btnClosePositionTick=null
}var a=this;
a.dataController.cboxCloseButton.style.top=(a.dataController.colorbox.offsetTop)+"px";
a.dataController.cboxCloseButton.style.left=(a.dataController.colorbox.offsetLeft+a.dataController.colorbox.offsetWidth-a.dataController.cboxCloseButton.offsetWidth)+"px"
};
com.videoViewer.S7ViewerWrapper.prototype.onViewerClosed=function(){if($("html").hasClass("isFullScreenMode")){$("html").removeClass("isFullScreenMode")
}if($("html").hasClass("isEmbeddedMode")){$("html").removeClass("isEmbeddedMode")
}this.dataController.cboxContent.appendChild(this.dataController.cboxCloseButton);
this.dataController.cboxCloseButton.style.top="";
this.dataController.cboxCloseButton.style.left="";
com.videoViewer.DataController.cboxCloseButton=null;
this.viewController.dispose()
};
com.videoViewer.S7ViewerWrapper.prototype.draw=function(){var a=this;
this.dataController.onDataControllerInitComplete=function(){a.init()
};
this.dataController.init()
};
com.videoViewer.S7ViewerWrapper.prototype.init=function(){var a=this;
this.dataController.trackEvent("Ready");
this.viewController=new com.videoViewer.ViewController(this.dataController);
this.viewController.onUIFadeAnimation=function(b){if(typeof(a.onUIFadeAnimation)==="function"){a.onUIFadeAnimation(!a.viewController.reviewPage.isVisible()?b:0)
}};
this.viewController.notifyReviewPageDisplayChange=function(){if(typeof(a.onUIFadeAnimation)==="function"){a.onUIFadeAnimation(!a.viewController.reviewPage.isVisible()?1:0)
}};
this.viewController.init()
};
com.videoViewer.S7NativeVideoWrapper=function(f){this.isAppleMobile=((navigator.platform.indexOf("iPhone")!=-1)||(navigator.userAgent.indexOf("iPhone")!=-1)||(navigator.userAgent.indexOf("iPod")!=-1)||(navigator.userAgent.indexOf("iPad")!=-1));
this.parentContainer=f.container;
this.videoObjRef=null;
this.eventsTimeout=null;
var g=$("#"+this.parentContainer.id).attr("data-link").split("/is/content/");
if(g.length!=2){return
}this.server=g[0];
this.asset=g[1];
if(this.isAppleMobile){this.asset=$("#"+this.parentContainer.id).attr("data-avs")
}this.vidServerUrl=this.server+"/is/content/";
this.serverUrl=this.server+"/is/image/";
this.poster=f.poster?f.poster:null;
this.videoTitle=$("#"+this.parentContainer.id).attr("data-title")?$("#"+this.parentContainer.id).attr("data-title"):null;
this.slideTick=null;
this.slideTickTimeout=null;
this.headerHideTime=500;
this.headerHideDelay=2000;
this.utils=new com.videoViewer.ViewerUtils();
this.isHeaderHidden=false;
var e=this;
if(window.addEventListener){window.addEventListener("resize",function(k){e.notifyOnWindowResize()
},false)
}else{if(window.attachEvent){window.attachEvent("onresize",function(){e.notifyOnWindowResize()
})
}}var b=this.parentContainer;
while(b.parentNode){b=b.parentNode;
if(b.id&&(b.id=="cboxLoadedContent")){this.cboxLoadedContent=b
}else{if(b.id&&(b.id=="colorbox")){this.colorbox=b
}else{if(b.id&&(b.id=="cboxContent")){this.cboxContent=b
}}}}if(!this.cboxCloseButton){var h=this.cboxContent.childNodes;
for(var c=0;
c<h.length;
c++){if(this.cboxContent.childNodes[c].id&&(this.cboxContent.childNodes[c].id=="cboxClose")){var a=this.cboxContent.childNodes[c];
var d=a.parentNode;
d.removeChild(a);
document.body.appendChild(a);
a.style.top=(this.colorbox.offsetTop)+"px";
a.style.left=(this.colorbox.offsetLeft+this.colorbox.offsetWidth-a.offsetWidth)+"px";
a.style.zIndex="9999";
this.cboxCloseButton=a;
com.videoViewer.S7NativeVideoWrapper.cboxCloseButton=this.cboxCloseButton;
break
}}}if(!this.cboxCloseButton&&com.videoViewer.S7NativeVideoWrapper.cboxCloseButton){this.cboxCloseButton=com.videoViewer.S7NativeVideoWrapper.cboxCloseButton
}};
com.videoViewer.S7NativeVideoWrapper.prototype.onViewerClosed=function(){if(this.cboxContent&&this.cboxCloseButton){this.cboxContent.appendChild(this.cboxCloseButton);
com.videoViewer.S7NativeVideoWrapper.cboxCloseButton=null
}if(this.videoObjRef){if(this.videoObjRef.video){document.body.removeChild(this.videoObjRef.video);
this.videoObjRef.video=null
}if(this.container){this.parentContainer.removeChild(this.container);
this.container=null
}}if(this.eventsTimeout){clearTimeout(this.eventsTimeout);
this.eventsTimeout=null
}};
com.videoViewer.S7NativeVideoWrapper.prototype.notifyOnWindowResize=function(){if(this.cboxCloseButton){this.cboxCloseButton.style.visibility="hidden"
}if(typeof(this.onWindowResize)==="function"){this.onWindowResize()
}var a=this;
this.onResize();
if(this.onResizeTick){clearTimeout(this.onResizeTick)
}this.onResizeTick=setTimeout(function(){a.onResize()
},750);
if(this.overflowTick){clearTimeout(this.overflowTick);
this.overflowTick=null
}this.overflowTick=setTimeout(function(){if(a.cboxContent){a.btnClosePositionStartTime=(new Date()).getTime();
if(a.btnClosePositionTick){clearInterval(a.btnClosePositionTick);
a.btnClosePositionTick=null
}a.btnClosePositionTick=setInterval(function(){a.positionCloseButton()
},100);
a.cboxCloseButton.style.visibility="visible";
a.cboxCloseButton.style.top=(a.colorbox.offsetTop)+"px";
a.cboxCloseButton.style.left=(a.colorbox.offsetLeft+a.colorbox.offsetWidth-a.cboxCloseButton.offsetWidth)+"px"
}},950)
};
com.videoViewer.S7NativeVideoWrapper.prototype.draw=function(){this.createLayout();
this.init();
this.createVideoHeader()
};
com.videoViewer.S7NativeVideoWrapper.prototype.positionCloseButton=function(){if(((new Date()).getTime()-this.btnClosePositionStartTime)>10000){clearInterval(this.btnClosePositionTick);
this.btnClosePositionTick=null
}var a=this;
a.cboxCloseButton.style.top=(a.colorbox.offsetTop)+"px";
a.cboxCloseButton.style.left=(a.colorbox.offsetLeft+a.colorbox.offsetWidth-a.cboxCloseButton.offsetWidth)+"px"
};
com.videoViewer.S7NativeVideoWrapper.prototype.onResize=function(){this.posterContainer.src=this.serverUrl+(this.poster?this.poster:this.asset)+"?wid="+this.container.offsetWidth+"&hei="+this.container.offsetHeight+"&bgc=0x000000"
};
com.videoViewer.S7NativeVideoWrapper.prototype.createLayout=function(){this.container=document.createElement("div");
this.container.className="s7NativeVideoContainer";
this.parentContainer.appendChild(this.container);
this.posterContainer=document.createElement("img");
this.posterContainer.className="s7PosterContainer";
this.container.appendChild(this.posterContainer);
this.iconEffect=document.createElement("div");
this.iconEffect.className="s7NativeVideoIconEffect";
if(this.isAppleMobile){this.iconEffect.style.display="none"
}this.container.appendChild(this.iconEffect)
};
com.videoViewer.S7NativeVideoWrapper.prototype.init=function(){var a="/is/content";
var e=$("#"+this.parentContainer.id).attr("data-link");
this.posterContainer.src=this.serverUrl+(this.poster?this.poster:this.asset)+"?wid="+this.container.offsetWidth+"&hei="+this.container.offsetHeight+"&bgc=0x000000";
var d=this;
if(this.isAppleMobile&&e.indexOf(a)>0){var c=e.substring(0,e.indexOf(a)+a.length)+"/";
e=c+$("#"+this.parentContainer.id).attr("data-avs").replace("-AVS","-AVS.m3u8")
}var b={};
this.videoObjRef=b;
b.createVideo=function(){b.video=document.createElement("video");
b.video.className="fsVideoPlayer";
b.video.style.position="absolute";
b.video.style.top="0px";
b.video.style.left="0px";
b.video.style.width="10px";
b.video.style.height="10px";
document.body.appendChild(b.video);
b.video.controls=true;
b.video.src=e;
b.video.addEventListener("loadedmetadata",function(g){if(d.isAppleMobile){b.video.webkitEnterFullscreen()
}});
b.video.addEventListener("canplay",function(g){if(d.isAppleMobile){b.video.webkitEnterFullscreen()
}});
b.video.addEventListener("webkitendfullscreen",function(){b.removeVideoElement()
},false);
b.video.addEventListener("webkitfullscreenchange",function(){b.removeVideoElement()
},false)
};
b.createVideo();
b.openVideo=function(g){b.video.play();
if(b.video.webkitSupportsFullscreen){b.video.webkitEnterFullscreen()
}};
b.removeVideoElement=function(){if((typeof(b.video.webkitDisplayingFullscreen)!=="undefined")&&!b.video.webkitDisplayingFullscreen){document.body.removeChild(b.video);
b.video=null;
d.videoObjRef=null;
d.cboxContent.appendChild(d.cboxCloseButton);
d.cboxCloseButton.style.top="";
d.cboxCloseButton.style.left="";
com.videoViewer.S7NativeVideoWrapper.cboxCloseButton=null;
if(this.container){this.parentContainer.removeChild(this.container);
this.container=null
}if(typeof d.onExitFullscreen==="function"){d.onExitFullscreen()
}if(this.eventsTimeout){clearTimeout(this.eventsTimeout);
this.eventsTimeout=null
}}};
function f(){d.posterContainer.addEventListener("click",function(g){try{b.openVideo(g);
g.preventDefault()
}catch(g){}});
d.iconEffect.addEventListener("click",function(g){try{b.openVideo(g);
g.preventDefault()
}catch(g){}});
d.iconEffect.addEventListener("touchend",function(g){d.utils.removeClass(d.iconEffect,"overIconEffect")
});
d.iconEffect.addEventListener("touchstart",function(g){d.utils.addClass(d.iconEffect,"overIconEffect")
});
d.iconEffect.style.display="block"
}if(b.video.webkitEnterFullscreen){if(d.isAppleMobile){this.eventsTimeout=setTimeout(function(){f()
},1000)
}else{f()
}}else{b.removeVideoElement()
}};
com.videoViewer.S7NativeVideoWrapper.prototype.createVideoHeader=function(){var a=this;
this.videoTitleContainer=document.createElement("div");
this.videoTitleContainer.className="videoTitleContainer";
this.videoTitleContainer.style.webkitTransform="translate3d(0,0,0)";
this.container.appendChild(this.videoTitleContainer);
this.videoTitleSlideHolder=document.createElement("div");
this.videoTitleSlideHolder.className="videoTitleSlideHolder";
this.videoTitleSlideHolder.style.webkitTransform="translate3d(0,0,0)";
this.videoTitleContainer.appendChild(this.videoTitleSlideHolder);
if(!this.videoTitle){this.videoTitleSlideHolder.style.top="-"+this.videoTitleSlideHolder.offsetHeight+"px"
}this.videoTitleSlideBg=document.createElement("div");
this.videoTitleSlideBg.className="videoTitleSlideBg";
this.videoTitleSlideHolder.appendChild(this.videoTitleSlideBg);
this.iconHolder=document.createElement("div");
this.iconHolder.className="videoTitleIcon";
this.videoTitleSlideHolder.appendChild(this.iconHolder);
this.labelHolder=document.createElement("span");
this.labelHolder.className="videoTitleLabel";
this.videoTitleSlideHolder.appendChild(this.labelHolder);
this.updateVideoTitleText()
};
com.videoViewer.S7NativeVideoWrapper.prototype.updateVideoTitleText=function(){this.labelHolder.style.width=(this.videoTitleSlideHolder.offsetWidth-this.labelHolder.offsetLeft)+"px";
this.labelHolder.innerHTML=this.videoTitle
};
(function(b){var c=((navigator.platform.indexOf("iPhone")!=-1)||(navigator.userAgent.indexOf("iPhone")!=-1)||(navigator.userAgent.indexOf("iPod")!=-1)||(navigator.userAgent.indexOf("iPad")!=-1));
var a="/is/content";
function d(l,p){if(l.videoObjRef&&typeof s!="undefined"&&typeof s.Media!="undefined"){var n=l.videoObjRef.video,g=p.replace(/.*\//,"")+"/"+s.pageName.replace(/:/g,"-"),h=-1,k,o=false,f=false;
function e(){s.Media.open(g,h,s.Media.playerName+" (HTML5)");
s.Media.play(g,k);
o=true;
f=false
}function m(){if(h==-1&&!isNaN(n.duration)){h=n.duration;
if(f){e()
}}if(!n.seeking){k=Math.round(n.currentTime)
}}n.addEventListener("loadedmetadata",function(q){m()
});
n.addEventListener("timeupdate",function(q){m()
});
n.addEventListener("play",function(q){m();
if(h>-1){e()
}else{f=true
}});
n.addEventListener("ended",function(q){m();
s.Media.stop(g,k);
s.Media.close(g);
o=false
});
n.addEventListener("pause",function(q){m();
s.Media.stop(g,k);
o=false
});
n.addEventListener("seeked",function(r){var q=k;
m();
if(o){s.Media.stop(g,q);
s.Media.play(g,k)
}})
}}b.fn.s7NativeVideo=function(){this.css("width","100%").css("height","100%");
var f=this.attr("id");
var e=new com.videoViewer.S7NativeVideoWrapper({container:document.getElementById(f),});
e.draw();
e.onWindowResize=function(){b.colorbox.resize({innerWidth:"80%",innerHeight:"80%"})
};
d(e,this.attr("data-path"));
e.onExitFullscreen=function(){b(this).colorbox.close()
};
window.onVideoPlayerClose=function(){try{e.onViewerClosed()
}catch(g){}try{delete window.onVideoPlayerClose
}catch(g){window.onVideoPlayerClose=undefined
}}
};
b.fn.nativeKmjVideo=function(){b(this).each(function(){var g=b(this).prop("href");
if(c&&g.indexOf(a)>0){var f=g.substring(0,g.indexOf(a)+a.length)+"/";
g=f+b(this).attr("data-avs").replace("-AVS","-AVS.m3u8");
b(this).prop("href",g)
}var e={};
e.createVideo=function(){e.video=document.createElement("video");
e.video.className="fsVideoPlayer";
e.video.style.position="absolute";
e.video.style.top="0px";
e.video.style.left="0px";
e.video.style.width="10px";
e.video.style.height="10px";
document.body.appendChild(e.video);
e.video.controls=true;
e.video.src=g;
e.video.addEventListener("loadedmetadata",function(h){e.video.webkitEnterFullscreen()
});
e.video.addEventListener("webkitendfullscreen",function(){e.removeVideoElement()
},false);
e.video.addEventListener("webkitfullscreenchange",function(){e.removeVideoElement()
},false)
};
e.createVideo();
e.openVideo=function(h){e.video.play();
if(e.video.webkitSupportsFullscreen){e.video.webkitEnterFullscreen()
}};
e.removeVideoElement=function(){if((typeof(e.video.webkitDisplayingFullscreen)!=="undefined")&&!e.video.webkitDisplayingFullscreen){document.body.removeChild(e.video);
e.video=null;
e.createVideo()
}};
if(e.video.webkitEnterFullscreen){b(this).find("img").bind("click",function(h){try{if(h.stopPropagation){h.stopPropagation()
}h.preventDefault();
e.openVideo(h)
}catch(h){}})
}else{e.removeVideoElement()
}})
}
})(jQuery);
function ytPlayerDestroyed(a){psplayer.players[a].setPlayerDestroy("videoPlayer")
}function videoPlayerDestroyed(a){psplayer.players[a].setPlayerDestroy("ytPlayer")
}function onPsMediaPlayerReady(a){psplayer.players[a].setPlayerReady("playlistPlayer")
}function onPsYtPlayerReady(a){psplayer.players[a].setPlayerReady("ytPlayer")
}function onPsPlayerReady(a){psplayer.players[a].setPlayerReady("videoPlayer")
}function initVars(d){var c=d.flashVars||{},b=d.params||{};
return d.playerRef&&(psplayer.players[d.playerApiId]=d.playerRef),c.playerApiId=d.playerApiId,c.ytPlayerId=d.ytPlayerId||psplayer.ytVideoPlayerId,c.psPlayerId=d.psPlayerId||psplayer.flvVideoPlayerId,c.imgViewerId=d.imgViewerId||psplayer.imgViewerId,d.playlistPlayerId||(d.playlistPlayerId=psplayer.playlistPlayerId),d.assetPath=d.assetPath||psplayer.assetPath,d.dataPath=d.dataPath||psplayer.dataPath,null!=d.fullscreen&&(c.fullscreen=d.fullscreen),null!=d.embedding&&(c.embedding=d.embedding),null!=d.sharing&&(c.sharing=d.sharing),d.autoPlayId&&(c.autoPlayId=d.autoPlayId),null!=d.autoPlayIndex&&(c.autoPlayIndex=d.autoPlayIndex),d.playlistId&&(c.playlistId=d.playlistId),d.playlistUrl&&(c.playlistUrl=encodeURIComponent(d.playlistUrl)),d.playlistTitle&&(c.playlistTitle=d.playlistTitle),d.videoId&&(c.videoId=d.videoId),d.videoUrl&&(c.videoUrl=encodeURIComponent(d.videoUrl)),d.playlist&&(c.playlist=d.playlist),d.playlistIndex&&(c.playlistIndex=d.playlistIndex),null!=d.autoPlay&&(c.autoPlay=d.autoPlay),d.videoImgUrl&&(c.videoImgUrl=d.videoImgUrl),d.videoImgId&&(c.videoImgId=d.videoImgId),d.ageGate&&(c.ageGate=d.ageGate),b.menu=d.menu||"false",b.scale=d.scale||"noscale",b.allowfullscreen=d.allowfullscreen||"true",b.allowscriptaccess=d.allowscriptaccess||"always",b.bgcolor=d.bgcolor||"#000000",b.allownetworking=d.allownetworking||"all",b.wmode=d.wmode||"transparent",d.fpVersion=d.fpVersion||"9.0.47",d.flashVars=c,d.params=b,d
}function encodeUrlVars(h){for(var f=h.substring(h.indexOf("?")+1),c={},d=f.split("&"),b=d.length;
b--;
){var k=d[b],g=k.substring(0,k.indexOf("="));
c[g]=k.substring(k.indexOf("=")+1)
}return c
}var swfobject=function(){function aL(){if(!ai){try{var f=ae.getElementsByTagName("body")[0].appendChild(aI("span"));
f.parentNode.removeChild(f)
}catch(d){return
}ai=!0;
for(var b=am.length,c=0;
b>c;
c++){am[c]()
}}}function ax(a){ai?a():am[am.length]=a
}function aP(b){if(typeof ac.addEventListener!=X){ac.addEventListener("load",b,!1)
}else{if(typeof ae.addEventListener!=X){ae.addEventListener("load",b,!1)
}else{if(typeof ac.attachEvent!=X){aD(ac,"onload",b)
}else{if("function"==typeof ac.onload){var a=ac.onload;
ac.onload=function(){a(),b()
}
}else{ac.onload=b
}}}}}function aH(){aF?aE():aC()
}function aE(){var f=ae.getElementsByTagName("body")[0],d=aI(at);
d.setAttribute("type",af);
var b=f.appendChild(d);
if(b){var c=0;
(function(){if(typeof b.GetVariable!=X){var a=b.GetVariable("$version");
a&&(a=a.split(" ")[1].split(","),aa.pv=[parseInt(a[0],10),parseInt(a[1],10),parseInt(a[2],10)])
}else{if(10>c){return c++,setTimeout(arguments.callee,10),void 0
}}f.removeChild(d),b=null,aC()
})()
}else{aC()
}}function aC(){var r=ak.length;
if(r>0){for(var B=0;
r>B;
B++){var x=ak[B].id,k=ak[B].callbackFn,g={success:!1,id:x};
if(aa.pv[0]>0){var d=av(x);
if(d){if(!aJ(ak[B].swfVersion)||aa.wk&&312>aa.wk){if(ak[B].expressInstall&&aB()){var w={};
w.data=ak[B].expressInstall,w.width=d.getAttribute("width")||"0",w.height=d.getAttribute("height")||"0",d.getAttribute("class")&&(w.styleclass=d.getAttribute("class")),d.getAttribute("align")&&(w.align=d.getAttribute("align"));
for(var b={},A=d.getElementsByTagName("param"),v=A.length,o=0;
v>o;
o++){"movie"!=A[o].getAttribute("name").toLowerCase()&&(b[A[o].getAttribute("name")]=A[o].getAttribute("value"))
}ay(w,b,x,k)
}else{aM(d),k&&k(g)
}}else{ab(x,!0),k&&(g.success=!0,g.ref=az(x),k(g))
}}}else{if(ab(x,!0),k){var m=az(x);
m&&typeof m.SetVariable!=X&&(g.success=!0,g.ref=m),k(g)
}}}}}function az(f){var d=null,b=av(f);
if(b&&"OBJECT"==b.nodeName){if(typeof b.SetVariable!=X){d=b
}else{var c=b.getElementsByTagName(at)[0];
c&&(d=c)
}}return d
}function aB(){return !aj&&aJ("6.0.65")&&(aa.win||aa.mac)&&!(aa.wk&&312>aa.wk)
}function ay(h,f,c,d){aj=!0,an=d||null,al={success:!1,id:c};
var b=av(c);
if(b){"OBJECT"==b.nodeName?(aO=ar(b),z=null):(aO=b,z=c),h.id=ad,(typeof h.width==X||!/%$/.test(h.width)&&310>parseInt(h.width,10))&&(h.width="310"),(typeof h.height==X||!/%$/.test(h.height)&&137>parseInt(h.height,10))&&(h.height="137"),ae.title=ae.title.slice(0,47)+" - Flash Player Installation";
var m=aa.ie&&aa.win?"ActiveX":"PlugIn",g="MMredirectURL="+(""+ac.location).replace(/&/g,"%26")+"&MMplayerType="+m+"&MMdoctitle="+ae.title;
if(typeof f.flashvars!=X?f.flashvars+="&"+g:f.flashvars=g,aa.ie&&aa.win&&4!=b.readyState){var k=aI("div");
c+="SWFObjectNew",k.setAttribute("id",c),b.parentNode.insertBefore(k,b),b.style.display="none",function(){4==b.readyState?b.parentNode.removeChild(b):setTimeout(arguments.callee,10)
}()
}aA(h,f,c)
}}function aM(b){if(aa.ie&&aa.win&&4!=b.readyState){var a=aI("div");
b.parentNode.insertBefore(a,b),a.parentNode.replaceChild(ar(b),a),b.style.display="none",function(){4==b.readyState?b.parentNode.removeChild(b):setTimeout(arguments.callee,10)
}()
}else{b.parentNode.replaceChild(ar(b),b)
}}function ar(g){var f=aI("div");
if(aa.win&&aa.ie){f.innerHTML=g.innerHTML
}else{var c=g.getElementsByTagName(at)[0];
if(c){var d=c.childNodes;
if(d){for(var b=d.length,h=0;
b>h;
h++){1==d[h].nodeType&&"PARAM"==d[h].nodeName||8==d[h].nodeType||f.appendChild(d[h].cloneNode(!0))
}}}}return f
}function aA(m,x,w){var k,h=av(w);
if(aa.wk&&312>aa.wk){return k
}if(h){if(typeof m.id==X&&(m.id=w),aa.ie&&aa.win){var g="";
for(var b in m){m[b]!=Object.prototype[b]&&("data"==b.toLowerCase()?x.movie=m[b]:"styleclass"==b.toLowerCase()?g+=' class="'+m[b]+'"':"classid"!=b.toLowerCase()&&(g+=" "+b+'="'+m[b]+'"'))
}var f="";
for(var A in x){x[A]!=Object.prototype[A]&&(f+='<param name="'+A+'" value="'+x[A]+'" />')
}h.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+g+">"+f+"</object>",aq[aq.length]=m.id,k=av(m.id)
}else{var u=aI(at);
u.setAttribute("type",af);
for(var v in m){m[v]!=Object.prototype[v]&&("styleclass"==v.toLowerCase()?u.setAttribute("class",m[v]):"classid"!=v.toLowerCase()&&u.setAttribute(v,m[v]))
}for(var c in x){x[c]!=Object.prototype[c]&&"movie"!=c.toLowerCase()&&aw(u,c,x[c])
}h.parentNode.replaceChild(u,h),k=u
}}return k
}function aw(f,d,b){var c=aI("param");
c.setAttribute("name",d),c.setAttribute("value",b),f.appendChild(c)
}function aN(b){var a=av(b);
a&&"OBJECT"==a.nodeName&&(aa.ie&&aa.win?(a.style.display="none",function(){4==a.readyState?aK(b):setTimeout(arguments.callee,10)
}()):a.parentNode.removeChild(a))
}function aK(d){var c=av(d);
if(c){for(var b in c){"function"==typeof c[b]&&(c[b]=null)
}c.parentNode.removeChild(c)
}}function av(d){var c=null;
try{c=ae.getElementById(d)
}catch(b){}return c
}function aI(a){return ae.createElement(a)
}function aD(d,c,b){d.attachEvent(c,b),q[q.length]=[d,c,b]
}function aJ(d){var c=aa.pv,b=d.split(".");
return b[0]=parseInt(b[0],10),b[1]=parseInt(b[1],10)||0,b[2]=parseInt(b[2],10)||0,c[0]>b[0]||c[0]==b[0]&&c[1]>b[1]||c[0]==b[0]&&c[1]==b[1]&&c[2]>=b[2]?!0:!1
}function au(h,f,c,d){if(!aa.ie||!aa.mac){var b=ae.getElementsByTagName("head")[0];
if(b){var k=c&&"string"==typeof c?c:"screen";
if(d&&(ap=null,ao=null),!ap||ao!=k){var g=aI("style");
g.setAttribute("type","text/css"),g.setAttribute("media",k),ap=b.appendChild(g),aa.ie&&aa.win&&typeof ae.styleSheets!=X&&ae.styleSheets.length>0&&(ap=ae.styleSheets[ae.styleSheets.length-1]),ao=k
}aa.ie&&aa.win?ap&&typeof ap.addRule==at&&ap.addRule(h,f):ap&&typeof ae.createTextNode!=X&&ap.appendChild(ae.createTextNode(h+" {"+f+"}"))
}}}function ab(d,c){if(ag){var b=c?"visible":"hidden";
ai&&av(d)?av(d).style.visibility=b:au("#"+d,"visibility:"+b)
}}function ah(d){var c=/[\\\"<>\.;]/,b=null!=c.exec(d);
return b&&typeof encodeURIComponent!=X?encodeURIComponent(d):d
}var aO,z,an,al,ap,ao,X="undefined",at="object",Y="Shockwave Flash",K="ShockwaveFlash.ShockwaveFlash",af="application/x-shockwave-flash",ad="SWFObjectExprInst",aG="onreadystatechange",ac=window,ae=document,Z=navigator,aF=!1,am=[aH],ak=[],aq=[],q=[],ai=!1,aj=!1,ag=!0,aa=function(){var k=typeof ae.getElementById!=X&&typeof ae.getElementsByTagName!=X&&typeof ae.createElement!=X,v=Z.userAgent.toLowerCase(),u=Z.platform.toLowerCase(),h=u?/win/.test(u):/win/.test(v),g=u?/mac/.test(u):/mac/.test(v),f=/webkit/.test(v)?parseFloat(v.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,b=!1,c=[0,0,0],w=null;
if(typeof Z.plugins!=X&&typeof Z.plugins[Y]==at){w=Z.plugins[Y].description,!w||typeof Z.mimeTypes!=X&&Z.mimeTypes[af]&&!Z.mimeTypes[af].enabledPlugin||(aF=!0,b=!1,w=w.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),c[0]=parseInt(w.replace(/^(.*)\..*$/,"$1"),10),c[1]=parseInt(w.replace(/^.*\.(.*)\s.*$/,"$1"),10),c[2]=/[a-zA-Z]/.test(w)?parseInt(w.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0)
}else{if(typeof ac.ActiveXObject!=X){try{var m=new ActiveXObject(K);
m&&(w=m.GetVariable("$version"),w&&(b=!0,w=w.split(" ")[1].split(","),c=[parseInt(w[0],10),parseInt(w[1],10),parseInt(w[2],10)]))
}catch(p){}}}return{w3:k,pv:c,wk:f,ie:b,win:h,mac:g}
}();
return function(){aa.w3&&((typeof ae.readyState!=X&&"complete"==ae.readyState||typeof ae.readyState==X&&(ae.getElementsByTagName("body")[0]||ae.body))&&aL(),ai||(typeof ae.addEventListener!=X&&ae.addEventListener("DOMContentLoaded",aL,!1),aa.ie&&aa.win&&(ae.attachEvent(aG,function(){"complete"==ae.readyState&&(ae.detachEvent(aG,arguments.callee),aL())
}),ac==top&&function(){if(!ai){try{ae.documentElement.doScroll("left")
}catch(a){return setTimeout(arguments.callee,0),void 0
}aL()
}}()),aa.wk&&function(){return ai?void 0:/loaded|complete/.test(ae.readyState)?(aL(),void 0):(setTimeout(arguments.callee,0),void 0)
}(),aP(aL)))
}(),function(){aa.ie&&aa.win&&window.attachEvent("onunload",function(){for(var g=q.length,f=0;
g>f;
f++){q[f][0].detachEvent(q[f][1],q[f][2])
}for(var c=aq.length,d=0;
c>d;
d++){aN(aq[d])
}for(var b in aa){aa[b]=null
}aa=null;
for(var h in swfobject){swfobject[h]=null
}swfobject=null
})
}(),{registerObject:function(g,f,c,d){if(aa.w3&&g&&f){var b={};
b.id=g,b.swfVersion=f,b.expressInstall=c,b.callbackFn=d,ak[ak.length]=b,ab(g,!1)
}else{d&&d({success:!1,id:g})
}},getObjectById:function(a){return aa.w3?az(a):void 0
},embedSWF:function(o,w,k,h,g,b,p,v,x,t){var m={success:!1,id:w};
aa.w3&&!(aa.wk&&312>aa.wk)&&o&&w&&k&&h&&g?(ab(w,!1),ax(function(){k+="",h+="";
var f={};
if(x&&typeof x===at){for(var d in x){f[d]=x[d]
}}f.data=o,f.width=k,f.height=h;
var l={};
if(v&&typeof v===at){for(var a in v){l[a]=v[a]
}}if(p&&typeof p===at){for(var c in p){typeof l.flashvars!=X?l.flashvars+="&"+c+"="+p[c]:l.flashvars=c+"="+p[c]
}}if(aJ(g)){var e=aA(f,l,w);
f.id==w&&ab(w,!0),m.success=!0,m.ref=e
}else{if(b&&aB()){return f.data=b,ay(f,l,w,t),void 0
}ab(w,!0)
}t&&t(m)
})):t&&t(m)
},switchOffAutoHideShow:function(){ag=!1
},ua:aa,getFlashPlayerVersion:function(){return{major:aa.pv[0],minor:aa.pv[1],release:aa.pv[2]}
},hasFlashPlayerVersion:aJ,createSWF:function(d,c,b){return aa.w3?aA(d,c,b):void 0
},showExpressInstall:function(f,d,b,c){aa.w3&&aB()&&ay(f,d,b,c)
},removeSWF:function(a){aa.w3&&aN(a)
},createCSS:function(f,d,b,c){aa.w3&&au(f,d,b,c)
},addDomLoadEvent:ax,addLoadEvent:aP,getQueryParamValue:function(f){var d=ae.location.search||ae.location.hash;
if(d){if(/\?/.test(d)&&(d=d.split("?")[1]),null==f){return ah(d)
}for(var b=d.split("&"),c=0;
b.length>c;
c++){if(b[c].substring(0,b[c].indexOf("="))==f){return ah(b[c].substring(b[c].indexOf("=")+1))
}}}return""
},expressInstallCallback:function(){if(aj){var a=av(ad);
a&&aO&&(a.parentNode.replaceChild(aO,a),z&&(ab(z,!0),aa.ie&&aa.win&&(aO.style.display="block")),an&&an(al)),aj=!1
}}}
}();
if(function(){function d(p,w){var v,m,k,h,f="mList_"+p,g=!1,x=!1,q=w.width||"860",u=w.height||"581";
return this.setPlayerReady=function(a){"playlistPlayer"==a&&(v=document.getElementById(f),"function"==typeof h.onComplete&&h.onComplete({target:v})),"videoPlayer"==a&&(m=document.getElementById(f),g&&m.pauseVideo(),m.addEventListener("onPlayerDestroy","videoPlayerDestroyed"),g=!1),"ytPlayer"==a&&(k=document.getElementById(f),k.addEventListener("onPlayerDestroy","ytPlayerDestroyed"),x&&k.pauseVideo(),x=!1)
},this.setPlayerDestroy=function(a){"ytPlayer"==a&&(k=null),"videoPlayer"==a&&(m=null)
},w.playerRef=this,w.playerApiId=f,h=initVars(w),swfobject.addDomLoadEvent(function(){var l=document.getElementById(p);
if(l&&swfobject.hasFlashPlayerVersion(h.fpVersion)){l.innerHTML='<div id="'+f+'"> </div>';
var e=h.assetPath+h.playlistPlayerId+"?psCacheBust="+(new Date).getTime();
swfobject.embedSWF(e,f,q,u,h.fpVersion,h.assetPath+"expressInstall.swf",h.flashVars,h.params,{id:f})
}}),{pauseVideo:function(){var a=v.getCurrentMediaType();
"video"==a?m?m.pauseVideo():g=!0:"yt-video"==a&&(k?k.pauseVideo():x=!0)
},playVideo:function(){g=!1,x=!1;
var a=v.getCurrentMediaType();
"video"==a&&m?m.playVideo():"yt-video"==a&&k&&k.playVideo()
},viewMediaAt:function(a){v&&v.viewMediaAt(a)
},closeMedia:function(){v&&v.viewMediaAt(-1)
},nextMedia:function(){v&&v.nextMedia()
},previousMedia:function(){v&&v.previousMedia()
},loadQuery:function(a){v&&v.loadQuery(a)
},loadPlaylistByUrl:function(l,a){v&&v.loadPlaylistByUrl(l,a)
},loadPlaylistById:function(l,a){v&&v.loadPlaylistById(l,a)
},loadPlaylistByUrls:function(l,a){v&&v.loadPlaylistByUrls(l,a)
},loadPlaylistByIds:function(l,a){v&&v.loadPlaylistByIds(l,a)
},getPlayerRef:function(){return v
},destroy:function(){g=!1,x=!1,m=null,k=null,v=null,swfobject.removeSWF(f)
},vars:h}
}function c(p,w){function v(){var o=h.videoId?h.videoId:h.videoUrl;
if(!o){if(!h.playlist){return
}o=h.playlist
}var n,l=o.toLowerCase();
n=-1!=l.indexOf(".flv")||-1!=l.indexOf(".mp4")||-1!=l.indexOf(".f4v")?k.assetPath+h.psPlayerId:k.assetPath+h.ytPlayerId,x=!1,m=null,swfobject.removeSWF(g),swfobject.addDomLoadEvent(function(){var y=document.getElementById(f);
if(y&&swfobject.hasFlashPlayerVersion(k.fpVersion)){var r=-1!=(""+q).indexOf("%")?q:q+"px",t=-1!=(""+u).indexOf("%")?u:u+"px";
y.innerHTML='<div style="background-color:'+k.params.bgcolor+";width:"+r+";height:"+t+';"><div id="'+g+'"></div></div>',swfobject.embedSWF(n,g,"100%","100%",k.fpVersion,k.assetPath+"expressInstall.swf",h,k.params,{id:g})
}})
}var m,k,h,f=p,g="vPlayer_"+p,x=!1,q=w.width||"616",u=w.height||"348";
return this.setPlayerReady=function(){m=document.getElementById(g),x&&m.pauseVideo(),x=!1,"function"==typeof k.onComplete&&k.onComplete({target:m})
},this.setPlayerDestroy=function(){m=null
},w.playerRef=this,w.playerApiId=g,k=initVars(w),h=k.flashVars,v(),{loadVideoByUrl:function(a){delete h.videoId,h.videoUrl=encodeURIComponent(a),h.autoPlay=1,v()
},loadVideoById:function(a){delete h.videoUrl,h.videoId=a,h.autoPlay=1,v()
},cueVideoByUrl:function(l,a){delete h.videoId,h.videoUrl=encodeURIComponent(l),a&&a.length>0?h.videoImgUrl=a:delete h.videoImgUrl,h.autoPlay=0,v()
},cueVideoById:function(l,a){delete h.videoId,h.videoId=l,h.videoImgId=a,h.autoPlay=0,v()
},loadPlaylist:function(l,a){delete h.videoId,delete h.videoUrl,h.playlist=l,a&&(h.playlistIndex=a),h.autoPlay=1
},cuePlaylist:function(l,a){delete h.videoId,delete h.videoUrl,h.playlist=l,a&&(h.playlistIndex=a),h.autoPlay=0
},pauseVideo:function(){m?m.pauseVideo():x=!0
},playVideo:function(){m&&m.playVideo()
},destroy:function(){x=!1,m=null,swfobject.removeSWF(g)
},getPlayerRef:function(){return m
},vars:k}
}var b=window.psplayer;
b={players:{},flvVideoPlayerId:"ps-video-player.swf",ytVideoPlayerId:"ps-youtube-player.swf",playlistPlayerId:"ps-media-playlist.swf",imgViewerId:"ps-img-viewer.swf",assetPath:"/etc/designs/pdc/clientlibs_youtube/swf/",dataPath:"/etc/designs/pdc/clientlibs_youtube/swf/",httpVideoPath:"/etc/designs/pdc/clientlibs_youtube/swf/",PlaylistPlayer:d,VideoPlayer:c},window.psplayer=b
}(),"function"!=typeof getAssetPath){var getAssetPath=function(){return psplayer.assetPath
}
}else{psplayer.assetPath=getAssetPath()
}if("function"!=typeof getHttpVideoPath){var getHttpVideoPath=function(){return psplayer.httpVideoPath
}
}else{psplayer.httpVideoPath=getHttpVideoPath()
}if("function"!=typeof getDataPath){var getDataPath=function(){return psplayer.dataPath
}
}else{psplayer.dataPath=getDataPath()
}function getOmnitureAccount(){if(typeof s_account!="undefined"){return s_account
}}function getSiteCatalystConfig(){pdclog("yvideo:getSiteCatalystConfig > s=",s,", s_account=",s_account);
if(typeof s!="undefined"){return{s_account:s_account,charSet:s.charSet,trackingServer:s.trackingServer,trackingServerSecure:s.trackingServerSecure,visitorNamespace:s.visitorNamespace,currencyCode:s.currencyCode,pageName:s.pageName}
}return{}
}(function(b){var a=["rated mature","content inappropriate for children","inappropriate content for children"];
b.fn.showYTVideoPanel=function(){var d=this.attr("data-video");
var f={};
f.videoId=d;
f.autoPlay="0";
f.ageGate="0";
f.width="100%";
f.height="100%";
if(swfobject.hasFlashPlayerVersion("9.0.2")){var e=new psplayer.VideoPlayer(this.prop("id"),f)
}else{c(this)
}function c(g){g.html('<iframe width="100%" height="100%" src="//www.youtube.com/embed/'+f.videoId+"?autoplay="+f.autoPlay+'&rel=0&showinfo=0&autohide=1&iv_load_policy=3" frameborder="0" allowfullscreen></iframe>')
}};
b.fn.getYTVideoDivHTML=function(c){var d="";
b(this).each(function(){b.each(this.attributes,function(){if(this.name=="href"){d+="data-video='"+this.value.replace(/.*=/,"")+"' "
}else{if(this.name.match(/^data/)){d+=this.name+"='"+this.value.replace(/'/g,"&apos;")+"' "
}}})
});
return"<div class='ytVideoContainer' id='"+c+"' "+d+"></div>"
};
b.fn.updateYoutubeMetadata=function(){b(this).each(function(){var e=b(this),c=e.attr("href"),d=c.substring(c.indexOf("?v=")+3),f="//www.googleapis.com/youtube/v3/videos?part=snippet&id="+d+"&key=AIzaSyAKRzl4h3hhO1X3imjDNBNFkgqmiBhzk_U&alt=json&callback=?";
b.getJSON(f,function(g){if(b(g.items).isVideoItemAgeGated()){e.attr("data-agegating","yes")
}else{e.attr("data-agegating","no")
}})
})
};
b.fn.isVideoItemAgeGated=function(){var d=this[0];
if(d.snippet){var f=d.snippet["description"];
if(f){var e=f;
if(e){e=e.toLowerCase();
for(var c=0;
c<a.length;
c++){if(e.indexOf(a[c])>=0){return true
}}}}}return false
}
})(jQuery);
(function(a){a.fn.showKMJVideoPanel=function(){var b=this.attr("data-video");
var d={};
d.videoId=b;
d.autoPlay="1";
d.ageGate="0";
d.width="100%";
d.height="100%";
if(swfobject.hasFlashPlayerVersion("9.0.2")){var c=new psplayer.VideoPlayer(this.prop("id"),d)
}else{}};
a.fn.getKMJVideoDivHTML=function(b){var c="";
a(this).each(function(){a.each(this.attributes,function(){if(this.name=="href"){c+="data-video='"+this.value+"' "
}else{if(this.name.match(/^data/)){c+=this.name+"='"+this.value.replace(/'/g,"&apos;")+"' "
}}})
});
return"<div class='kmjVideoContainer' id='"+b+"' "+c+"></div>"
}
})(jQuery);