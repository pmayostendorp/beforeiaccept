var GravityInsights=function(a){function b(){var a=f();void 0!==a&&a&&c(a)}function c(a){var b=d(a,i()),c=document.createElement("script");c.src=m+"/log?"+b,c.type="text/javascript";var e=document.getElementsByTagName("head")[0]||document.documentElement;e.insertBefore(c,e.firstChild)}function d(b,c){var d=void 0===document.getElementsByTagName("title")[0]?"":encodeURIComponent(document.getElementsByTagName("title")[0].innerHTML),f=new Date,g=f.getMilliseconds()+"-"+f.getSeconds(),i=["cbust="+g,"site_guid="+a.site_guid,"action="+c,"user_guid="+b,"referrer="+e(document.referrer),"browser_useragent="+e(navigator.userAgent),"OS="+e(j()),"href="+e(location.href),"url="+k()];a.super_site_guid&&i.push("super_site_guid="+a.super_site_guid),null!=a.thread_id&&i.push("thread_id="+a.thread_id),null!=a.forum_id&&i.push("forum_id="+a.forum_id),null!=a.user_id&&i.push("user_id="+a.user_id),null!=d&&i.push("article_title="+d),null!=a.external_user_id&&i.push("external_user_id="+a.external_user_id),null!=a.article_id&&i.push("article_id="+a.article_id),null!=a.type&&i.push("type="+a.type);var l=h("grvUsesAbp");return"1"===l&&i.push("abp=1"),i.join("&")}function e(a){return window.encodeURIComponent?encodeURIComponent(a):escape(a)}function f(){var a=h("grvinsights");return null==a||""===a?(g(),!1):a}function g(){var b="?u="+a.user_id+"&sg="+a.site_guid,c=document.createElement("script");c.src=m+"/initialize"+b,c.type="text/javascript";var d=document.getElementsByTagName("head")[0]||document.documentElement;d.insertBefore(c,d.firstChild)}function h(a){var b=encodeURI(a)+"=",c=document.cookie||"",d=c.indexOf(b);if(-1==d)return null;var e=d+b.length,f=c.indexOf(";",e),g=c.substring(e,-1==f?c.length:f);return decodeURI(g)}function i(){return a.action||"beacon"}function j(){var a="Unknown OS";return-1!==navigator.appVersion.indexOf("Win")&&(a="Windows"),-1!==navigator.appVersion.indexOf("Mac")&&(a="MacOS"),-1!==navigator.appVersion.indexOf("X11")&&(a="UNIX"),-1!==navigator.appVersion.indexOf("Linux")&&(a="Linux"),a}function k(){var a=document.getElementsByTagName("link"),b=a.length,c="";for(x=0;x<b;x++){if(c=a[x].getAttribute("rel"),c&&0===c.indexOf("canonical")&&(a[x].getAttribute("href")||"").replace(/^\s+|\s+$/g,""))return encodeURIComponent(a[x].getAttribute("href"));if(x===b)break}return encodeURIComponent(location.href)}function l(a){var b,c=a?a.replace(/^\W*/,""):"";return c?(b=-1!==window.location.hostname.indexOf(c,window.location.hostname.length-c.length),b?"; domain="+a:""):""}var m="https:"==document.location.protocol?"https://secure-api.gravity.com/v1/beacons":"http://rma-api.gravity.com/v1/beacons";return b(),{cc:function(a,b,d){if(""!==a){var e=new Date;e.setTime(e.getTime()+432e8);var f="; expires="+e.toGMTString(),g=l(d);document.cookie=a+"="+b+f+g+"; path=/",c(b)}},readCookie:h}}(gravityInsightsParams);