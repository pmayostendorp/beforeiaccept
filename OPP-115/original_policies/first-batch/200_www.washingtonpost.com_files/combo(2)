(function(){TWP=window.TWP||{};TWP.StaticMethods=TWP.StaticMethods||{};TWP.StaticMethods.addCss=function(b){var c=document.getElementsByTagName("head");if(c.length){var a=document.createElement("style");a.type="text/css";if(a.styleSheet){a.styleSheet.cssText=b;}else{a.appendChild(document.createTextNode(b));}c[0].appendChild(a);}};TWP.StaticMethods.addScript=function(c,e){var f=("https:"==document.location.protocol)?e:c;var d=document.getElementsByTagName("head");if(f&&d.length){var b=document.createElement("script");b.type="text/javascript";b.src=f;d[0].appendChild(b);}};TWP.StaticMethods.prependBodyHTML=function(c,d){d=(!isNaN(d)&&d>=0)?Math.floor(d):10;var a=document.getElementsByTagName("body");if(a.length){a=a[0];if(a.childNodes[0]){var e=document.createElement("div");e.innerHTML=c;for(var b=e.childNodes.length-1;b>=0;b--){a.insertBefore(e.childNodes[b],a.childNodes[0]);}}else{setTimeout(function(){TWP.StaticMethods.prependBodyHTML(c);},d);}}else{setTimeout(function(){TWP.StaticMethods.prependBodyHTML(c);},d);}};TWP.StaticMethods.tokenize=function(a,b){b=b||"_";return a.toLowerCase().replace(/^\s+|\s+$/g,"").replace(/[^a-z0-9_\-\s]/g,"").replace(/\s+/g,b);};TWP.StaticMethods.getUniqueNumber=function(){var a="";a+=""+Math.floor(Math.random()*1000000);a+=""+new Date().getTime();return a;};TWP.StaticMethods.getUniqueToken=function(a){a=TWP.StaticMethods.tokenize(a||"twp");a=a.replace(/^(\d|_|-)+/,"")||"twp";return a+"_"+TWP.StaticMethods.getUniqueNumber();};TWP.StaticMethods.getDefaultFontObject=function(b){var a={},d=3/32;switch(b){case"%":a={size:100,nudge:10};break;case"in":a={size:d,nudge:1/64};break;case"cm":a={size:2.54*d,nudge:2.54/64};break;case"mm":a={size:25.4*d,nudge:25.4/64};break;case"pt":a={size:72*d,nudge:72/64};break;case"pc":a={size:72*d/12,nudge:72/(8*64)};break;case"px":a={size:11,nudge:2};break;case"ex":a={size:1,nudge:0.1};break;case"em":a={size:1,nudge:0.1};break;case"rem":a={size:1,nudge:0.1};break;default:a={size:1,nudge:0.1};}return a;};TWP.StaticMethods.incrementFontSize=function(a,b){TWP.StaticMethods.adjustFontSize(a,jQuery.extend({decrement:false},b));};TWP.StaticMethods.decrementFontSize=function(a,b){TWP.StaticMethods.adjustFontSize(a,jQuery.extend({decrement:true},b));};TWP.StaticMethods.adjustFontSize=function(a,b){b=b||{};jQuery(a).each(function(g,l){var f=!!b.forcePx,h=(f)?jQuery(l).css("font-size"):l.style.fontSize,j=(h.match(/([^0-9]+)$/i))?RegExp.$1:"em",c=(!b.decrement);defaultFontObject=TWP.StaticMethods.getDefaultFontObject(j);var d=Math.abs((isNaN(parseFloat(b.nudge)))?defaultFontObject.nudge:parseFloat(b.nudge));if(!c){d=-1*d;}var k=(isNaN(parseFloat(h))?defaultFontObject.size:parseFloat(h))+d;if(k>0||d>0){l.style.fontSize=(f)?jQuery(l).css("font-size",k+j):k+j;}});};TWP.StaticMethods.areCookiesEnabled=function(){var a=(navigator.cookieEnabled)?true:false;if(typeof navigator.cookieEnabled=="undefined"&&!a){document.cookie="testcookie";a=(document.cookie.indexOf("testcookie")!=-1)?true:false;}return(a);};TWP.StaticMethods.getCookie=function(b){var e=b+"=";var a=document.cookie.split(";");for(var d=0;d<a.length;d++){var f=a[d];while(f.charAt(0)==" "){f=f.substring(1,f.length);}if(f.indexOf(e)==0){return f.substring(e.length,f.length);}}return null;};TWP.StaticMethods.setCookie=function(b,d,a,f,c,e){document.cookie=b+"="+escape(d)+(a?"; expires="+a:"")+(f?"; path="+f:"; path=/")+(c?"; domain="+c:"; domain="+(/(?:[^\.]+)(\.([^\.]+\.){1,}[^\.]+)$/.test(document.location.host)?RegExp.$1:document.location.host))+(e?"; secure":"");};TWP.StaticMethods.deleteCookie=function(a,c,b){if(TWP.StaticMethods.getCookie(a)){document.cookie=a+"="+((c)?"; path="+c:"/")+((b)?"; domain="+b:"")+"; expires=Thu, 01-Jan-70 00:00:01 GMT";}};TWP.StaticMethods.getCountingCookie=TWP.StaticMethods.getIntegerCookie||function(b){var c=0;if(!!b&&TWP.StaticMethods.areCookiesEnabled()){var a=TWP.StaticMethods.getCookie(b);c=!isNaN(parseInt(a))?parseInt(a):0;c=(c<0)?0:c;}return c;};TWP.StaticMethods.incrementCountingCookie=TWP.StaticMethods.incrementCountingCookie||function(b,a){if(!!b){a=a||{};TWP.StaticMethods.setCookie(b,TWP.StaticMethods.getCountingCookie(b)+1,a.expires,a.path,a.domain,a.secure);}};TWP.StaticMethods.getFlagCookie=TWP.StaticMethods.getFlagCookie||function(c){var a=0;if(!!c&&TWP.StaticMethods.areCookiesEnabled()){var b=TWP.StaticMethods.getCookie(c);a=!isNaN(parseInt(b))?parseInt(b):0;a=(a<0)?0:a;}return(a%2);};TWP.StaticMethods.toggleFlagCookie=TWP.StaticMethods.toggleFlagCookie||function(b,a){if(!!b){a=a||{};TWP.StaticMethods.setCookie(b,(TWP.StaticMethods.getFlagCookie(b)+1)%2,a.expires,a.path,a.domain,a.secure);}};TWP.StaticMethods.initCommentCount=function(c,a){var d="https://comments-api-staging.ext.nile.works/v1/count?q=(childrenof:'{guid}'"+encodeURI("source:washpost.com (((state:Untouched user.state:ModeratorApproved) OR (state:CommunityFlagged,ModeratorApproved,ModeratorDeleted -user.state:ModeratorBanned,ModeratorDeleted) )))"+" children: 2 (((state:Untouched user.state:ModeratorApproved) OR (state:CommunityFlagged,ModeratorApproved -user.state:ModeratorBanned,ModeratorDeleted) ) )"+"&appkey="+((TWP.Data.echo_appkey!="undefined")?TWP.Data.echo_appkey:"dev.washpost.com"));var b;c=(typeof c=="undefined")?"div.comment-bubble-small":c;$(c).each(function(e,g){var f=a||$(g).attr("guid")||$(g).attr("data");if(typeof f!="undefined"){b=d.replace("{guid}",f);TWP.StaticMethods.getCommentCount(b,g);}});};TWP.StaticMethods.getCommentCount=function(b,a){var c=window.setTimeout(function(){TWP.StaticMethods.getCommentCount(b,a);},5000);jQuery.ajax({url:b,dataType:"jsonp",cache:false,context:a}).done(function(e,d){if(d!="error"){if(typeof e.count!="undefined"){$(a).html(e.count);}else{if(e.errorCode=="more_than"){$(a).html("5000+");}}window.clearTimeout(c);}});};TWP.Util=TWP.Util||{};TWP.Util.initCommentCount=TWP.StaticMethods.initCommentCount;TWP.StaticMethods.remarryHeadline=function(a){try{jQuery(a).each(function(f){var h=$(this);var g=h.html();var j=h.text();h.html("&nbsp;");var k=h.height();h.html(g);var l=Math.floor(h.height()/k);if(l>1){var e=l;var c=10;for(var f=0;e==l&&(f<h.width()/c);f++){var d=h.width();h.width(d-c);e=Math.floor(h.height()/k);if(e>l){h.width(d);}}}});}catch(b){}};TWP.StaticMethods.treatAsNotIframed=function(){return(self===top)||(self!==top&&!!self.document.referrer.match(/https?:\/\/([^\.]+\.)?(stumbleupon|jungroup|hyprmx|facebook|flickr|snip|wapo)\.(com|ly|st)\//));};})();