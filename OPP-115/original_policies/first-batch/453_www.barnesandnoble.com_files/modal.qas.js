/*! BARNES-BUILDER 2015-06-29 */
BN.Modal.QAS=BN.Modal.QAS||{},BN.Modal.QAS.Base=BN.Modal.QAS.Base||Extend(function(){var a=function(a,b){consoleLog("Instantiating BN.Modal.QAS.Base"),this.data=b};return a.prototype={data:null,defaultOptions:{tplDir:SITE_ROOT+"/modals/qas/",useCache:!1},initView:function(){var a=this,b=this.tplName,c=this.data,d=$(this.modal);return c&&$(c.qas.form[0]).closest(".main-content").find(".mini-cart-spinner").remove(),this.on("display",function(){d.find("select").selectBox()}),a.parent&&a.parent.pureModal&&a.parent.hideSpinner(),this.initAddrEntered(),"partial"==b?this.initPartialView():this.initStandardView()},initAddrEntered:function(){var a=this,b=this.data,c=$(this.modal),d=c.find("#addrEntered"),e=d.find("li").first();$(b.qas.form).on("amplifiFormError amplifiFormSuccess",function(){a.Close()}),c.find("#asEntered").on("click",function(){consoleLog("Using As Entered"),a.parent&&a.parent.pureModal?a.Close():a.displaySpinner(),b.selectAddress(-1),a.displaySpinner()}),e.find("address").children().first().html(b.address.address1+"<br>"+(""==b.address.address2?"":b.address.address2+"<br>")+(""==b.address.city?"":b.address.city+", ")+(""==b.address.state?"":b.address.state+" ")+b.address.postalCode),e.find("label").on("click",function(){var a=$(this).parent();c.find("li").not(a).find(".continue").attr("hidden",!1),a.find(".continue").attr("hidden",!1)})},initStandardView:function(){var a=this,b=this.tplName,c=this.data,d=c.suggestions,e=$(this.modal);if("nomatches"!=b){var f=e.find("#addrMatches"),g=f.find("li").first().clone();f.empty();for(var h=0;h<d.length;h++){var i=d[h],j=g.clone(),k=j.find('label [type="radio"]');k.val(h).prop("checked",!1),j.find("label").on("click",function(){var a=$(this).parent();e.find("li").not(a).find(".continue").attr("hidden",!1),a.find(".continue").attr("hidden",!1)}),j.find("address").children().first().html(i.address1+"<br>"+(""==i.address2?"":i.address2+"<br>")+i.city+", "+i.state+" "+i.postalCode),j.appendTo(f)}}e.find(".continue").on("click",function(){var b=$(this).parents("li").find("label input[name='address']").val();a.parent&&a.parent.pureModal?a.Close():a.displaySpinner(),c.selectAddress(b)}).attr("hidden",!0),this.on("display",function(){e.find("#addrMatches li").first().find("label").click()})},initPartialView:function(){var a=this,b=this.tplName,c=this.data,d=c.suggestions,e={},f="",g=$(this.modal);switch(BN.QAS.CountryHelperFactory.Bind(g.find("#addAddress")),c.verificationType){case"PremisesPartial":f="address2";break;case"StreetPartial":default:f="address1"}for(var h in c.address){var i=g.find("#qas_"+h);i.length<0||(e[h]=i,i.val(c.address[h]),"state"==h&&($state=this.$state=g.find("select.address-state-selecter"),$state.selectBox("value",c.address[h])))}if(h=i=void 0,c.prompt&&(g.find(".error-msg").show(),g.find("#experianPrompt").text(c.prompt)),g.find("#continue-btn").on("click",function(b){a.parent&&a.parent.pureModal?a.Close():a.displaySpinner();var d={};for(var b in e)d[b]=e[b].val();c.replaceAddress(d)}),"nomatches"!=b){var j=g.find("#addrMatches"),k=j.find("li").first().clone();j.empty();for(var l=0;l<d.length;l++){var m=d[l],n=k.clone(),o=n.find('label [type="radio"]');o.val(l).prop("checked",!1),n.find("label").on("click",function(){var a=$(this).parent();g.find("li").not(a).find(".continue").attr("hidden",!1),a.find(".continue").attr("hidden",!1)}),n.find("address").children().first().html(m.address1+"<br>"+(""==m.address2?"":m.address2+"<br>")+m.city+", "+m.state+" "+m.postalCode),n.appendTo(j)}}g.find(".continue").on("click",function(){var b=$(this).parents("li").find("label input[name='address']").val();a.parent&&a.parent.pureModal?a.Close():a.displaySpinner(),c.selectAddress(b)}).attr("hidden",!0),this.on("display",function(){g.find("#addrMatches li").first().find("label").click()})}},a}(),BN.Modal.Base,!0);