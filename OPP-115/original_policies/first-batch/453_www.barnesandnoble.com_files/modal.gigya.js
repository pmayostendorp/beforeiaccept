/*! BARNES-BUILDER 2015-06-29 */
BN.Modal.Gigya=BN.Modal.Gigya||{},BN.Modal.Gigya.Base=BN.Modal.Gigya.Base||Extend(function(){var a=function(){consoleLog("Instantiating BN.Modal.Browse.Base")};return a.prototype={defaultOptions:{tplDir:SITE_ROOT+"/modals/gigya/"}},a}(),BN.Modal.Base,!0),BN.Modal.Gigya=BN.Modal.Gigya||{},BN.Modal.Gigya.ReviewGuidelines=BN.Modal.Gigya.ReviewGuidelines||Extend(function(){var a=function(){consoleLog("Instantiating BN.Modal.Gigya.ReviewGuidelines")};return a.prototype={tplName:"review-guidline",initView:function(){this.data;this.initGenericView(),this.initForm()}},a}(),BN.Modal.Gigya.Base,!0),BN.Modal.Gigya=BN.Modal.Gigya||{},BN.Modal.Gigya.WriteReview=BN.Modal.Gigya.WriteReview||Extend(function(){var a=function(){consoleLog("Instantiating BN.Modal.Browse.writeReview")};return a.prototype={tplName:"writeReview",initView:function(){var a=this,b="Products",c=a.data["work-id"],d=a.data.uid,e=a.data.ean;this.displaySpinner(),this.on("display",function(){function f(b){0==b.errorCode?(a.Close(),new BN.Modal.Success(null,{title:"Success!",messages:[{type:"success",message:"Your review has been submitted."}]})):400002==b.errorCode||400006==b.errorCode?($(".wr-error").css("display","block"),$(".errmsg").html("Please select a rating"),a.$spinner.remove()):403037==b.errorCode?($(".wr-error").css("display","block"),$(".errmsg").html("This product has already been reviewed"),a.$spinner.remove()):($(".wr-error").css("display","block"),$(".errmsg").html(b.errorDetails),a.$spinner.remove())}function g(a){var g=$(".review-textarea").val(),h=g.length>70?g.substring(0,66)+" ...":g,i=$('input[name="rating"]:checked').val(),j=$("#prodSummary h1").html(),k=window.location.href,l=$("#leaveAnonymousReview").prop("checked");if(postParams={categoryID:b,streamID:c,commentTitle:h,commentText:g,ratings:{_overall:i},UID:d,anonymous:l,tags:[e],callback:f},0==a.streamInfo.commentCount){var m={categoryID:b,streamID:c,streamTitle:j,streamURL:k};gigya.comments.setStreamInfo(m)}gigya.comments.postComment(postParams)}a.$spinner.remove();var h="",i=$('input[name="rating"]');i.on("change",function(){for(var a=$(this),b=a.attr("id"),c=i.siblings(".styled-radio"),d=0;5>d;d++)switch(b){case"rating1":d>0?c.eq(d).css("backgroundPosition","-34px 0"):c.eq(d).css("backgroundPosition","0 0");break;case"rating2":d>1?c.eq(d).css("backgroundPosition","-34px 0"):c.eq(d).css("backgroundPosition","0 0");break;case"rating3":d>2?c.eq(d).css("backgroundPosition","-34px 0"):c.eq(d).css("backgroundPosition","0 0");break;case"rating4":d>3?c.eq(d).css("backgroundPosition","-34px 0"):c.eq(d).css("backgroundPosition","0 0");break;case"rating5":d>4?c.eq(d).css("backgroundPosition","-34px 0"):c.eq(d).css("backgroundPosition","0 0")}}),$(".styled-radio").on("mouseenter",function(a){a.preventDefault(),$(".rating-msg-pop").show();var b=a.target,c=b.getAttribute("data-value");1==c?(h="Poor",$(".rating-msg-pop").css("left","65px"),$(".rating-msg-pop .triangle-up").css("left","5px"),$(".rating-msg-pop p").text(h)):2==c?(h="Below Average",$(".rating-msg-pop").css("left","55px"),$(".rating-msg-pop .triangle-up").css("left","33px"),$(".rating-msg-pop p").text(h)):3==c?(h="Good",$(".rating-msg-pop").css("left","100px"),$(".rating-msg-pop .triangle-up").css("left","7px"),$(".rating-msg-pop p").text(h)):4==c?(h="Very good ",$(".rating-msg-pop").css("left","107px"),$(".rating-msg-pop .triangle-up").css("left","20px"),$(".rating-msg-pop p").text(h)):5==c&&(h="Excellent",$(".rating-msg-pop").css("left","130px"),$(".rating-msg-pop .triangle-up").css("left","18px"),$(".rating-msg-pop p").text(h))}).on("mouseleave",function(){$(".rating-msg-pop").hide()}),initializeTextAreaCounter($(".review-textarea"),$(".limit-notifier")),$("#postReview").on("click",function(a){a.preventDefault();var d={categoryID:b,streamID:c,callback:g};"undefined"!=typeof gigya&&gigya.comments.getStreamInfo(d)}),$(a.modal).on("click","#cancelReview",function(b){b.preventDefault(),a.Close()}),$(a.modal).on("click","#checkPenNameModal",function(b){b.preventDefault(),new BN.Modal.Gigya.CheckPenName(null,null,{},a)}),$(a.modal).on("click",".review-guidelines-link",function(b){b.preventDefault(),new BN.Modal.Gigya.ReviewGuidelines(null,null,{},a)})})}},a}(),BN.Modal.Gigya.Base,!0),BN.Modal.Gigya.CheckPenName=BN.Modal.Gigya.CheckPenName||Extend(function(){var a=function(){consoleLog("Instantiating BN.Modal.Gigya.CheckPenName")};return a.prototype={tplName:"check-pen-name",initView:function(){var a=$(this.modal),b=a.find("form"),c=this;a.find(".pen-name-req-info").on("click",function(){$(this).hasClass("expandicon-change")?($(".pen-name-req-info-container").hide(),$(this).removeClass("expandicon-change")):($(".pen-name-req-info-container").show(),$(this).addClass("expandicon-change"))}),a.find(".continue-as-anonymous").on("click",function(){$("#leaveAnonymousReview").prop("checked",!0)}),this.initForm(!1),b.on("amplifiFormSuccess",function(){c.hideSpinner(),new BN.Modal.Gigya.SavePenName(null,null,{tplParams:{penName:$("input#penName").val()}},c)})}},a}(),BN.Modal.Gigya.Base,!0),BN.Modal.Gigya.SavePenName=BN.Modal.Gigya.SavePenName||Extend(function(){var a=function(){consoleLog("Instantiating BN.Modal.Gigya.SavePenName")};return a.prototype={tplName:"save-pen-name",initView:function(){var a=$(this.modal),b=a.find("form"),c=this;a.find(".continue-as-anonymous").on("click",function(){$("#leaveAnonymousReview").prop("checked",!0),c.flow().goTo(0)}),this.initForm(!1),b.on("amplifiFormSuccess",function(){c.hideSpinner(),$("#leaveAnonymousReview").prop("checked",!1),$("#userPenNameText").text($("#newPenName").val()),c.flow().goTo(0)})}},a}(),BN.Modal.Gigya.Base,!0);