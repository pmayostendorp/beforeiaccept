var kraft=kraft||{};kraft.sliders={defineSettings:function(n){var t={slider:{interval:!1,wrap:!1},style:{touch:!1,numvisible:-1,itemType:"img",itemWidth:"fixed",dots:{present:!1,clickable:!1},controls:!1,peekAdjust:!1}};switch(n){case"multi-peek":t.style.touch=!0;t.style.itemType="box";t.style.peekAdjust=!0;break;case"brands":t.style.itemType="box";t.style.itemWidth="fixed";t.style.controls=!0;break;case"clipped":t.style.itemType="box";t.style.itemWidth="fixed";t.style.controls=!0;t.style.peekAdjust=!0;break;case"clipped-nested":t.style.itemType="box";t.style.itemWidth="fixed";t.style.peekAdjust=!0;t.style.touch=!0;t.style.controls=!0;break;case"slideshow":t.slider.interval=5e3;t.slider.wrap="both";t.style.numvisible=1;t.style.itemType="box";t.style.dots.present=!0;t.style.dots.clickable=!0;t.style.controls=!0;break;case"single-peek":t.style.touch=!0;t.style.numvisible=1;t.style.itemWidth="vary";t.style.dots.present=!0;break;case"single-peek-clipped":t.style.touch=!0;t.style.numvisible=1;t.style.itemWidth="vary";t.style.controls=!0;break;case"double-peek":t.slider.interval=5e3;t.slider.wrap="both";t.style.itemType="box";t.style.touch=!0;t.style.numvisible=1;t.style.itemWidth="fixed";t.style.dots.present=!0;break;case"contained":t.style.itemType="box";t.style.itemWidth="fixed";t.style.controls=!0;t.style.touch=kraft.viewportWidth<kraft.breakpoint?!0:!1}return t},checkPeek:function(n){var t=n.innerWidth(),i=n.jcarousel("items").first().outerWidth(!0),r=Math.floor(t/i),f=r*i,e=t-f,u;e<20?kraft.sliders.peekAdjust(n,10+e,r):(u=f+i-t,u<10?kraft.sliders.peekAdjust(n,10-u,r):n.jcarousel("items").each(function(){$(this).removeAttr("style")}))},peekAdjust:function(n,t,i){var u=t,r=u/i,f=parseInt(n.jcarousel("items").first().css("margin-left"),10);n.jcarousel("items").each(function(){$(this).css({marginLeft:"+="+r})});n.jcarousel("items").last().css({marginRight:f+r+"px"})},initSlider:function(n,t){var r,f,i,u,e,s,o;if($(".single").siblings(".falloff-shadow-left").addClass("disabled").end().siblings(".falloff-shadow-right").addClass("disabled"),r=$(n),t=="check"&&(t=window.innerWidth<kraft.breakpoint?r.attr("data-mobileStyle"):r.attr("data-desktopStyle")),t!="brands"&&(f=$(n).closest(".jcarousel-wrapper"),f.removeClass("multi-peek brands clipped slideshow single-peek single-peek-clipped double-peek clipped-nested"),f.addClass(t)),r.find(">ul > li").length>1)r.removeClass("single"),r.removeClass("mobile"),r.removeClass("desktop");else{r.addClass("single");kraft.viewportWidth<kraft.breakpoint?r.addClass("mobile"):r.addClass("desktop");return}i=kraft.sliders.defineSettings(t);r.attr("data-settings-overrides")&&(u=r.data("settings-overrides"),console.log("WE HAVE OVERRIDES"),u=kraft.viewportWidth<kraft.breakpoint?u.mobile?u.mobile:{}:u.desktop?u.desktop:{},console.log(u),e=$.extend(!0,{},i,u),i=e,console.log(i));i.style.dots.present&&(s=r.find(">ul .item").length,o='<span class="jcarousel-pagination"><\/span>',r.after(o));$(n).data("styleFlag",t);$(n).on("jcarousel:create jcarousel:reload",function(n){var u=$(this),r=u.innerWidth(),f;i.style.numvisible!=-1&&(r=r/i.style.numvisible);f=i.style.itemType=="img"&&i.style.itemWidth=="vary"?!0:!1;r=r*(f?.95:1);u.jcarousel("items").each(function(){var n=$(this);f?(n.find("img").width()>r&&n.find("img").css("width",r+"px"),(kraft.viewportWidth<kraft.breakpoint||t=="single-peek-clipped")&&n.hasClass("video-still")&&(n.css("width",n.find("img, svg.default-image").width()),n.find("h2").hide())):i.style.numvisible!=-1&&(u.attr("data-itemType")=="img"?n.find("img").css("width",r+"px"):n.css("width",r+"px"))});i.style.peekAdjust&&u.attr("data-sliderid")!="relatedVideoTips"&&kraft.sliders.checkPeek(u);n.type=="jcarousel:create"&&t=="contained"&&u.hasClass("whatshot")&&kraft.whatsHot.init()}).on("jcarousel:scroll",function(n,i,r){var f=$(this),e,u;f.attr("data-ajaxed")=="false"&&(e=f.attr("data-moreItems"),$.get(e,function(n){f.find("ul").append(n);f.parent().find(".jcarousel-pagination").jcarouselPagination("reloadCarouselItems");f.jcarousel("reload");f.attr("data-ajaxed","true")}));t=="contained"&&f.hasClass("whatshot")&&(u=0,typeof r=="string"?(u=i.items().index(i.last()),r==="+=1"?u++:u--,u>i.items().length-1?u=i.items().length-1:u<0&&(u=0)):u=r,kraft.whatsHot.updateControls(u))}).on("jcarousel:createend",function(){var n=this,u,o,s,f,e;t=$(n).data("styleFlag");i.slider.interval&&(u=$(n),u.jcarouselAutoscroll({interval:i.slider.interval}),u.hover(function(){u.jcarouselAutoscroll("stop")},function(){u.jcarouselAutoscroll("start")}));i.style.dots.present&&($(".jcarousel-pagination").on("jcarouselpagination:active","a",function(){$(this).addClass("active")}).on("jcarouselpagination:inactive","a",function(){$(this).removeClass("active")}).on("click",function(n){n.preventDefault()}).jcarouselPagination({perPage:1,item:function(n){return"<a "+(i.style.dots.clickable?'href="#'+n+'"':"")+">"+n+"<\/a>"}}),i.style.dots.clickable||$(".jcarousel-pagination a").each(function(){$(this).off("click")}));i.style.controls&&(o=t=="single-peek-clipped"?$(n).parent().parent().children(".jcarousel-control-next"):$(n).parent().children(".jcarousel-control-next"),s=t=="single-peek-clipped"?$(n).parent().parent().children(".jcarousel-control-prev"):$(n).parent().children(".jcarousel-control-prev"),s.on("jcarouselcontrol:active",function(){$(this).removeClass("disabled").addClass("enabled");(t=="clipped"||t=="clipped-nested")&&$(this).parent().find(".falloff-shadow-left").removeClass("disabled").addClass("enabled")}).on("jcarouselcontrol:inactive",function(){$(this).removeClass("enabled").addClass("disabled");(t=="clipped"||t=="clipped-nested")&&$(this).parent().find(".falloff-shadow-left").removeClass("enabled").addClass("disabled")}).jcarouselControl({target:"-=1"}),o.on("jcarouselcontrol:active",function(){$(this).removeClass("disabled").addClass("enabled");(t=="clipped"||t=="clipped-nested")&&$(this).parent().find(".falloff-shadow-right").removeClass("disabled").addClass("enabled")}).on("jcarouselcontrol:inactive",function(){$(this).removeClass("enabled").addClass("disabled");(t=="clipped"||t=="clipped-nested")&&$(this).parent().find(".falloff-shadow-right").removeClass("enabled").addClass("disabled")}).jcarouselControl({target:"+=1"}));i.style.touch&&(f=r.closest(".jcarousel-wrapper"),e=f,f.hasClass("nested")&&(e=r.find("> ul > li .top")),e.swipe({swipeLeft:function(){$(n).jcarousel("scroll","+=1")},swipeRight:function(){$(n).jcarousel("scroll","-=1")},threshold:50,allowPageScroll:"vertical",excludedElements:"button, input, select, textarea, .noSwipe"}))}).jcarousel(i.slider)},init:function(n){$(".jcarousel").each(function(){if(kraft.editMode===!0)$(this).closest(".jcarousel-wrapper").addClass("editMode");else{var t=parseInt($(this).attr("data-sliderEnv"),10);(n==t||t==2)&&(t==0?kraft.sliders.initSlider($(this)[0],$(this).attr("data-mobileStyle")):t==1?kraft.sliders.initSlider($(this)[0],$(this).attr("data-desktopStyle")):t==2&&kraft.sliders.initSlider($(this)[0],"check"))}})},destroy:function(n,t){$(".jcarousel:not(.single)").each(function(){var r=parseInt($(this).attr("data-sliderEnv"),10),t=$(this),i;t.removeData("styleFlag");t.removeClass("single");t.removeClass("mobile");t.removeClass("desktop");(n==r||r==2)&&(i=t.closest(".jcarousel-wrapper"),i.children("a[data-jcarouselcontrol='true']").each(function(){$(this).removeAttr("jcarouselcontrol");$(this).removeData("jcarouselcontrol")}),t.parent().find(".jcarousel-pagination").remove(),t.find("li").removeAttr("style"),t.find("li h2").removeAttr("style"),t.jcarousel("destroy"),i.removeClass("multi-peek brands clipped slideshow single-peek single-peek-clipped double-peek clipped-nested"),i.swipe("destroy"))});t!==null&&t("init")}};kraft=kraft||{};kraft.modals={currentModalClasses:[],getModalContent:function(n){$.ajax({url:n.url,data:n.data,cache:!1,dataType:n.returnType}).done(function(t){kraft.modals.populateModal(t,n)}).fail(function(){$("html, body, .kraft-modal").animate({scrollTop:0},"slow")})},populateModal:function(n,t){kraft.modals.currentModalClasses=t.classes.split(" ");var i=document.createElement("div");i.innerHTML=n;n=$(i).hide().find("form").html();$(".kraft-modal").removeClass("recipe-style").addClass(t.classes).find(".modal-body").html(n);kraft.modals.showModal(t)},showModal:function(n){$(".kraft-modal").data("modalSettings",n);$(".kraft-modal").modal("show");n.modalSwitch&&n.callback&&n.callback()},cancelAction:function(){$(".modal").modal("hide")},cleanup:function(){$(".kraft-modal .modal-body").html("");for(var n=0;n<kraft.modals.currentModalClasses.length;n++)$(".kraft-modal").removeClass(kraft.modals.currentModalClasses[n]);kraft.modals.currentModalClasses=[]},init:function(){$(window).load(function(){$(".kraft-modal").on("shown.bs.modal",function(){var n=$(this).data("modalSettings");n.callback&&n.callback()}).on("hidden.bs.modal",function(){var n=$(this).data("modalSettings");n.destroyCallback&&n.destroyCallback();kraft.modals.cleanup()}).modal({backdrop:"static",show:!1})})},destroy:function(){}};kraft.modals.init();kraft=kraft||{};kraft.imageGallery={scrollToIndex:0,callback:function(){kraft.sliders.initSlider("div[data-sliderid='imageGallery']","single-peek-clipped");kraft.imageGallery.scrollToIndex>0&&($("div[data-sliderid='imageGallery']").jcarousel("scroll",kraft.imageGallery.scrollToIndex,!1),kraft.imageGallery.scrollToIndex=0);kraft.utilities.manageAds()},show:function(n){if(kraft.viewportWidth<kraft.breakpoint)window.location.href=n+"?recipeId="+kraft.recipeId;else{var t={url:n,classes:"modal-image-gallery generic",data:{modal:!0,recipeId:kraft.recipeId},returnType:"html",callback:function(){kraft.imageGallery.callback()}};kraft.modals.getModalContent(t)}},init:function(){$(document).on(kraft.clickEventName,".view-all-images",function(n){n.preventDefault();var t=$(this).attr("data-modalUrl");kraft.imageGallery.show(t)});$(document).on(kraft.clickEventName,'.recipe-imagery ul li:not(".imagery-actions")',function(){if(kraft.viewportWidth>=kraft.breakpoint&&$(this).parent().find("li").length>1){var n=$(this).parents(".recipe-imagery").attr("data-modalUrl");kraft.imageGallery.scrollToIndex=$(this).index();$(this).parents(".video-additional-images").length>0&&kraft.imageGallery.scrollToIndex++;kraft.imageGallery.show(n)}});$(document).on(kraft.clickEventName,".upload-photo-link",function(n){var t,i;n.preventDefault();t=$(this).attr("data-modalUrl");kraft.viewportWidth<kraft.breakpoint?window.location.href=t:(i={url:t,classes:"modal-signin generic",data:{modal:!0},returnType:"html"},kraft.modals.getModalContent(i))})}};kraft.imageGallery.init();kraft=kraft||{};kraft.whatOnHand={submit:function(){var i=$(".submit-ingredients").attr("data-modalurl"),n="",t;$("#ingredient1").val()!=""&&(n+=$("#ingredient1").val());$("#ingredient2").val()!=""&&(n+=","+$("#ingredient2").val());$("#ingredient3").val()!=""&&(n+=","+$("#ingredient3").val());n=encodeURIComponent(n);t="?include="+n+"&course="+$("#category").val()+"&searchTerm=*";window.location.href=i+t},init:function(n){var t=$("html").hasClass("lt-ie10")?"keyup":"input";$(document).on(kraft.clickEventName,".submit-ingredients",function(t){t.preventDefault();kraft.forms.validation.isValid($(this).parents(".ingredientForm"))&&kraft.whatOnHand.submit(n)});$(".ingredientName").each(function(){$(this).data("oldlength",0)});$(".tips-ideas-section .row").last().css("box-shadow","none");$(".collection").last().css("margin-bottom","0");$(document).on(t,".ingredientName",function(n){var t,i;n.preventDefault();n.stopPropagation();t=$(this).val().length;t>3&&t!=$(this).data("oldlength")&&(i={source:this,data:{suggestTerm:$(this).val(),scopes:"ingredient"},dataurl:kraft.environmentSettings.siteSearch.predictions.url,rendering:{target:".tag-container",enable:!1,rendertoinput:!0},instanceClass:"ingredientPredictions"},kraft.utilities.typeaheadSearch(i));t<=3&&$(".popover.ingredientPredictions").popover("hide");$(this).data("oldlength",t)});$(document).on(kraft.clickEventName,".clear-ingredients-form",function(n){n.preventDefault();kraft.utilities.clearFormElements("ingredientForm")})}};kraft.whatOnHand.init();kraft=kraft||{};kraft.addPhoto={invalidCheck:!1,iframeCallback:function(n){var i,r,t,u=!1;try{r=$(n.currentTarget.contentDocument).find("pre")}catch(f){console.log(f)}r&&(t=r.text(),t===""&&(u=!0));t!==""&&typeof t!="undefined"&&(i=JSON.parse(t),i.errorCode===0&&(u=!0));u===!0?kraft.addPhoto.ajaxCallbacks.submitDone(i):kraft.addPhoto.ajaxCallbacks.submitFail(i)},ajaxCallbacks:{submitDone:function(n){var i,t;console.log("submit done",n);i=$(".no-file-text").html();$(".file-list").html(i);kraft.utilities.loadingSpinner.hide(".submit-photo");kraft.utilities.clearFormElements("add-photo-form");$(".submit-photo-error").hide();$(".submit-photo-success").show();t=$(".file-upload").parents(".form").validate();t.resetForm();t.reset();window.setTimeout(function(){if(kraft.viewportWidth<kraft.breakpoint){var n=kraft.utilities.readCookie("kraft_returnPage");n&&n!==null&&($(".submit-photo").prop("disabled",!1),window.location.href=n)}else $(".submit-photo").prop("disabled",!1),$(".modal").modal("hide")},2e3)},submitFail:function(n){var t,i,r;console.log("submit fail",n);t=n.fieldErrors;i=[];t&&$.each(t,function(n,t){i.push("<span>"+t.fieldError+"<\/span>")});kraft.utilities.loadingSpinner.hide(".submit-photo");n.errorCode===604?(r=$(".file-upload").parents(".form").validate(),r.showErrors({"photo-file":n.errorMessage}),kraft.addPhoto.invalidCheck=!0):n.errorMessage?$(".submit-photo-error").html(n.errorMessage).show():$(".submit-photo-error").html(i.join()).show();$(".submit-photo-success").hide()}},callback:function(){kraft.utilities.styleFileInputs();$(document).on("click",".submit-photo",function(n){n.preventDefault();kraft.forms.validation.isValid($(this).parents(".form"))&&(kraft.utilities.loadingSpinner.show(".submit-photo"),kraft.addPhoto.submit(this))})},submit:function(n){var i,t,r;$("#distribute-approval").addClass("valid");$("div[for=distribute-approval]").hide();kraft.addPhoto.invalidCheck&&(kraft.addPhoto.invalidCheck=kraft.utilities.extraValidateChecked("#distribute-approval")?!1:!0);kraft.addPhoto.invalidCheck?(kraft.utilities.loadingSpinner.hide(".submit-photo"),$("div[for=distribute-approval]").length===0?$("#distribute-approval").parent().after('<div for="distribute-approval" class="error">Please accept Kraft policy.<\/div>'):$("div[for=distribute-approval]").show()):(i={RecipeID:kraft.recipeId,PhotoDescription:$('textarea[name="photo-description"]').val(),PhotoTitle:$('input[name="photo-title"]').val(),IsMemberRecipe:kraft.isMemberRecipe},kraft.formDataHelper.settings.action=$(n).attr("data-modalurl"),kraft.formDataHelper.settings.target="formDataUpload",t=[],r={key:"UserPhotoRequest",val:JSON.stringify(i)},t.push(r),kraft.formDataHelper.createFormData(t,null,!1),kraft.formDataHelper.createIframe(null,kraft.addPhoto.iframeCallback),$(this).prop("disabled",!0),kraft.formDataHelper.submitFormData())},init:function(){kraft.viewportWidth<kraft.breakpoint&&kraft.addPhoto.callback();$(document).on(kraft.clickEventName,".add-photo",function(){var n=$(this).attr("data-modalUrl"),t;kraft.utilities.createCookie("kraft_returnPage",window.location.href);kraft.viewportWidth<kraft.breakpoint?window.location.href=n+"?recipeId="+kraft.recipeId:(t={url:n,classes:"modal-add-photo generic",data:{modal:!0},returnType:"html",callback:function(){kraft.addPhoto.callback()},destroyCallback:function(){kraft.addPhoto.modalDestroy()}},kraft.modals.getModalContent(t))});$(document).off("click",".upload-photo-link").on("click",".upload-photo-link",function(n){var t,i;n.preventDefault();t=$(this).attr("data-modalUrl");kraft.viewportWidth<kraft.breakpoint?window.location.href="registration-mobile.html":(i={url:t,classes:"modal-registration generic",data:{modal:!0},returnType:"html"},kraft.modals.getModalContent(i))});$(document).on(kraft.clickEventName,".cancel-remove a",function(n){n.preventDefault();kraft.utilities.cancelModalPage()})},modalDestroy:function(){$(document).off(kraft.clickEventName,".submit-photo");$("form").removeData();$("#formDataUpload").remove()}};kraft.addPhoto.init()