var WWW={prepare:function(){WWW.TickerHover.prepare()},Centers:{}};Fool.onLoad(WWW.prepare);WWW.TickerHover=(function(){var a="/common/ajax/tickerhover.aspx?t=";var b="/common/ajax/tickerhover.aspx?i=";return{prepare:function(){$$("span.ticker a").each(function(c,e){var g=c.firstChild.nodeValue;var d=c.readAttribute("data-id");var h=a+g+"&ref="+encodeURIComponent(document.location.href);if(d){h=b+d+"&ref="+encodeURIComponent(document.location.href)}var f=new Fool.Widgets.Hover({isExclusive:true,theme:"globalTickerHover",trigger:c,url:h,onShowCallback:function(){$$(".globalTickerHover").each(function(i){Fool.Util.QueryStringHelpers.addQueryParamsToLinks(i)})}})})}}})();WWW.Expando=(function(){var a=true,i,d,f,j,e;var h=30,c=400,b=9000,g=500;return{prepare:function(){if(!(f=$("expando"))){return}e=Element.getData(f);f.observe("mousedown",this.controller.bindAsEventListener(this));j=document.createElement("A");j.href="javascript:void(0)";j.className="linkToggle";j.innerHTML="Collapse";f.appendChild(j);f.style.height=h+"px";d=new Fx.Style(f,"height",{duration:g,wait:false,fps:20,unit:"px",onComplete:function(){if(a){f.className="contracted"}}});var k=f.getElementsByTagName("object")[0];if(k){Fool.Util.Flash.activate(k)}i=window.setTimeout(WWW.Expando.collapse.bind(WWW.Expando,true),b);WWW.Expando.expand.delay(1,true)},controller:function(k){switch(k.target.className){case"linkToggle":return this.toggle(true)}},expand:function(l){a=false;j.innerHTML="Collapse";f.className="expanded";if(e&&e.trackingpxurl){var k=$(document.createElement("IMG"));k.src=e.trackingpxurl;k.addClassName("ex-tracking-px");k.id="expandedTrackingPx"}d[(false||l)?"start":"set"](c)},collapse:function(k){window.clearTimeout(i);a=true;j.innerHTML="Expand";var l=$("expandedTrackingPx");if(l!=null){l.remove()}d[(false||k)?"start":"set"](h)},toggle:function(k){this[(a)?"expand":"collapse"](k)}}})();WWW.Main={prepare:function(){Fool.onLoad(function(){WWW.Expando.prepare();var a=new Fool.Util.Clickable("happeningNow")});Fool.onContent(function(){new Fool.Form.PlaceHolderText();WWW.MOM.prepare();if(!Fool.ActiveListRotator){Fool.ActiveListRotator=new ListRotator()}})}};WWW.NewMain={prepare:function(){Fool.onLoad(function(){});Fool.onLoad(function(){WWW.Expando.prepare();capsrater=new Fool.Ticker.Rater({});var a=new Fool.Util.Clickable("happeningNow");var b=function(d){if(Element.match(d,"tr.clickable")){var c=$w(d.className).detect(function(e){if(e!="clickable"&&e!="hover"){return e}});if(c==this.lastTickerClass){return false}else{this.lastTickerClass=c}return d}};Fool.Event.delegate({ancestor:$("todaysMarket"),test:b.bind(this),type:"mouseover",action:function(f,d){var c=$w(d.className).detect(function(e){if(e!="clickable"&&e!="hover"){return e}});this.imgs=this.imgs||this.ancestor.select("img.chart");this.trs=this.trs||this.ancestor.select("table tr.clickable");this.imgs.each(function(e){if(e.hasClassName(c)){e.removeClassName("hidden")}else{e.addClassName("hidden")}});this.trs.each(function(e){if(e.hasClassName(c)){e.addClassName("active")}else{e.removeClassName("active")}})}});Fool.Event.delegate({ancestor:$("todaysMarket"),test:function(c){return Element.match(c,"tr.clickable")},action:function(d,c){window.location=c.down("a").href}})});Fool.onContent(function(){new Fool.Form.PlaceHolderText();WWW.MOM.prepare();var a=new Fool.StockTracking({formId:"myWatchlistModuleAdd",buttonId:"myWatchlistModuleButton",inputId:"myWatchlistModuleTickers",source:"iwlsitbut0000012"});if(!Fool.ActiveListRotator){Fool.ActiveListRotator=new ListRotator()}})}};WWW.NewMain.ClickableBackground=Class.create({target:null,callback:null,styles:null,initialize:function(a,c,b){this.target=$$(a).first();if(!this.target){return false}this.callback=c;this.styles=b;this.apply_styles();this.target.observe("click",this.controller.bind(this))},apply_styles:function(){$A(this.styles).each(function(a){$$(a.sel).each(function(b){b.setStyle(this.value)}.bind(a))})},controller:function(b){var a=Event.findElement(b);if(a.getAttribute("id")==="mid"||a.getAttribute("id")==="header"){this.callback()}return}});WWW.Centers.Main={prepare:function(a){Fool.onLoad(function(){WWW.Expando.prepare();var c=$("performance");if(c){if(c.hasClassName("cellA")||c.hasClassName("cellB")){WWW.Centers.Main.TopPerformers.prepare("18","11","04")}else{if(c.hasClassName("cellC")){var b=null;c.observe("mouseover",function(e){var d=e.target;if(d.nodeName&&d.nodeName=="TD"){if(d.parentNode.parentNode.nodeName=="TBODY"){if(b){b.style.backgroundColor=""}d.style.backgroundColor="#fbfbfb";b=d}}})}else{if(c.hasClassName("cellD")){}}}}})},CAG:function(){var c="/ajax/communityactivities.ashx";var d=["Published by ","Comment added by ","Blog post added by ","Blog comment added by ","CAPS Stock Pitch by ","CAPS Stock Pick by "];var b={ArticlePublished:"Published by",ArticleComment:"Comment added by",BlogPost:"Blog post added by",BlogComment:"Comment added by",CapsStockPitch:"CAPS Stock Pitch by",CapsStockPick:"Picked by",BoardMessage:"Message added by",TickerQuote:"Ticker Quote by",FoolTweet:"Tweet published by The Motley Fool",WikiUpdate:"Wiki updated by",RssItem:"RSS Feed updated by",FoolMoneyPodcast:"Podcast published by The Motley Fool",FoolConversationsPodcast:"Podcast published by The Motley Fool"};return{queue:$A(),tzOffset:(new Date()).getTimezoneOffset()*60,prepare:function(){var e=10;new PeriodicalExecuter(function(){if(WWW.Centers.Main.CAG.queue.size()>0){WWW.Centers.Main.CAG.displayActivity()}else{WWW.Centers.Main.CAG.getActivities()}},e)},displayActivity:function(){var g=this.queue.pop();var e=new Template('<li class="clearfix ajaxActivity" rel="#{seconds}"><img src="#{avatar}" alt="#{author}" class="userAvatar"><div><p class="desc"><a href="#{uri}" class="#{classNames}">#{title}</a></p><p class="ugcInfo">#{activity} <span class="ago">#{timeAgo}</span></p></div></li>').evaluate({uri:g.link,title:g.title,desc:g.description,timeAgo:this.timeAgo((new Date(g.pubDate).getTime())-this.tzOffset),activity:b[g.category[0]["#text"]]+" "+g.author,avatar:g["Fool:avatarUrl"]["#text"],author:g.author,seconds:Math.round((new Date(g.pubDate).getTime()-this.tzOffset)/1000)});$$("#happeningOnFool ul li").pop().remove();$("happeningOnFool").down("ul").insert({top:e});var f=new Fx.Style($("happeningOnFool").down("ul").down("li"),"opacity",{duration:1000});f.start(0,1)},getActivities:function(){new Ajax.Request(c,{method:"GET",evalJSON:"force",onFailure:function(e){},onSuccess:function(f){var e=$$("#happeningOnFool ul li").first().readAttribute("rel");WWW.Centers.Main.CAG.queue=f.responseJSON.rss.channel.item.reject(function(h){var g=Math.round((new Date(h.pubDate).getTime()-this.tzOffset)/1000);if(g>e){return false}else{return true}});WWW.Centers.Main.CAG.displayActivity()}})},timeAgo:function a(k,f,e){var f=f||1;var e=e||new Date();var l=((e-k)/1000).ceil();var j=[{name:"second",secs:1},{name:"minute",secs:60},{name:"hour",secs:3600},{name:"day",secs:86400},{name:"month",secs:86400*30},{name:"year",secs:86400*365}].inject(0,function(m,n){return(l>n.secs)?n:m});var h=(l/j.secs).floor();var i=new Template("#{num} #{plural_name}").evaluate({num:h,plural_name:j.name+((h==1)?"":"s")});if(j.name=="second"||f<=1){return i+" ago"}else{var g=new Date(k.getTime()+(h*j.secs*1000));return i+", "+a(g,f-1,e)}}}}(),TopPerformers:(function(){var c=null,f=null,d=null,e=[];function g(j){var i=f.down("a.productId-"+j);if(!i){throw"TopPerformers.prepare has been supplied a ProductId which does not exist in table.products"}var l=i.parentNode.parentNode;var k={ProductId:j,ProductName:i.firstChild.nodeValue.trim(),Return:l.cells[l.cells.length-1].firstChild.nodeValue.replace("%",""),Href:i.href};return k}function b(){var i=d.down("a");var j=new Fx.Style(i,"margin-top",{duration:750,fps:15,onComplete:function(){h();delete j}});j.start(0,-148)}var a=0;function h(){if(++a>=e.length){a=0}d.appendChild(d.firstChild);var j=d.lastChild,i=e[a];j.style.marginTop=0;j.className="p-"+i.ProductId;j.href=i.Href;var m=j.firstChild,n=m.childNodes[0],l=m.childNodes[1],k=l.firstChild;if(i.Return>0){n.nodeValue="Outperform by";l.className="pos";k.nodeValue=i.Return+"%"}else{if(i.Return<0){n.nodeValue="Underperform by";l.className="neg";k.nodeValue=i.Return+"%"}else{n.nodeValue="Outperform by";l.className="";k.nodeValue=""}}}return{prepare:function(){if(!arguments.length>=1){throw"TopPerformers.prepare requires two or more Product IDs"}c=$("performance");d=c.down("div.slides");f=c.down("table.products");d.collapse();for(var j=0;j<arguments.length;j++){e.push(g(arguments[j]))}d.appendChild(d.firstChild.cloneNode(true));h();window.setInterval(b,3000)}}})()};WWW.MOM={prepare:function(){if($("membersOnly")){var b;if($$("#membersOnly.expanded")[0]){b=$("membersOnly").getHeight()}else{b=307}var a;if($$("#version2 #membersOnly")[0]){b=$$("#version2 #membersOnly div.person")[0].getHeight()+50;a=50}else{a=32}var c=new Fx.Expando({expandoSelector:"div#membersOnly",toggleSelector:"div#membersOnly div.control",expandedHeight:b,collapsedHeight:a,onExpandComplete:function(){new Ajax.Request("/Common/Handlers/Preference.ashx",{method:"post",parameters:{MOMStatus:"true"}})},onCollapseComplete:function(){new Ajax.Request("/Common/Handlers/Preference.ashx",{method:"post",parameters:{MOMStatus:"false"}})}})}}};WWW.OneColumn={prepare:function(){Fool.onLoad(function(){var a=[{selector:".round, #secondary .component",cornerType:"all"},{selector:"#pageHeader",cornerType:"north"},{selector:"#mainStory div.wrap",cornerType:"south"}];Fool.Util.Corners.prepare(a)})}};WWW.TwoColumn={prepare:function(){Fool.onLoad(function(){var a=[{selector:".round, #secondary .component",cornerType:"all"},{selector:"#pageHeader",cornerType:"north"},{selector:"#mainStory div.wrap",cornerType:"south"}];Fool.Util.Corners.prepare(a)})}};WWW.Centers.InvestingAgg={prepare:function(a){},prepareTopPerformers:function(){WWW.Centers.Main.TopPerformers.prepare("18","04","11")}};WWW.Centers.Brokers={prepare:function(a){}};WWW.Centers.MDPBook={prepare:function(a){}};WWW.Investing={prepare:function(){}};WWW.HowToInvest={prepare:function(){}};Fx.Expando=Class.create({initialize:function(a){this.expandoElement=$(a.expandoElement)||$$(a.expandoSelector)[0];this.toggleElement=$(a.toggleElement)||$$(a.toggleSelector)[0]||null;this.openElement=$(a.openElement)||$$(a.openSelector)[0]||null;this.closeElement=$(a.closeElement)||$$(a.closeSelector)[0]||null;this.expandedClass=a.expandedClass||"expanded";this.collapsedClass=a.collapsedClass||"collapsed";this.onExpandComplete=a.onExpandComplete||Prototype.emptyFunction;this.onCollapseComplete=a.onCollapseComplete||Prototype.emptyFunction;this.onStart=a.onStart||Prototype.emptyFunction;this.onBeforeCollapse=a.onBeforeCollapse||Prototype.emptyFunction;this.onBeforeExpand=a.onBeforeExpand||Prototype.emptyFunction;this.duration=a.duration||500;this.expandedHeight=a.expandedHeight;this.collapsedHeight=a.collapsedHeight||0;if(!this.expandedHeight){this.expandedHeight=this.expandoElement&&$(this.expandoElement).getHeight()}this.fx=new Fx.Style(this.expandoElement,"height",{duration:this.duration,wait:true,onStart:this.onStart});if(!!this.toggleElement){this.toggleElement.observe("click",this.toggle.bind(this))}if(!!this.openElement){this.openElement.observe("click",this.open.bind(this))}if(!!this.closeElement){this.closeElement.observe("click",this.close.bind(this))}},toggle:function(a){if(this.expandoElement.hasClassName(this.expandedClass)){this.closeNoCheckIfExpanded()}else{this.openNoCheckIfCollapsed()}Event.stop(a)},open:function(){if(this.expandoElement.hasClassName(this.collapsedClass)){this.openNoCheckIfCollapsed()}Event.stop(event)},close:function(){if(this.expandoElement.hasClassName(this.expandedClass)){this.CloseNoCheckIfExpanded()}Event.stop(event)},openNoCheckIfCollapsed:function(){var a=this;a.onBeforeExpand();this.fx.options.onComplete=function(){a.expandoElement.removeClassName(a.collapsedClass).addClassName(a.expandedClass);a.onExpandComplete()};this.fx.start(this.collapsedHeight,this.expandedHeight)},closeNoCheckIfExpanded:function(){var a=this;a.onBeforeCollapse();this.fx.options.onComplete=function(){a.expandoElement.removeClassName(a.expandedClass).addClassName(a.collapsedClass);a.onCollapseComplete()};this.fx.start(this.expandedHeight,this.collapsedHeight)}});var Fool=Fool||{};if(!Fool.StockTracking){Fool.StockTracking={}}Fool.StockTracking=Class.create({API:{add:"/Common/Ajax/MyWatchlist/Add.ashx"},initialize:function(a){var b={formId:"addToMyWatchlist",buttonId:"scorecard-add-button",inputId:"scorecard-add-tickers",source:"iwlsitlnk0000003"};this.options=Fool.Options.setOptions(b,a);this.button=$(this.options.buttonId);this.input=$(this.options.inputId);this.form=$(this.options.formId);if(isLoggedIn){if(!this.form){return false}this.form.removeClassName("hidden");this.watchInputs()}},watchInputs:function(){$(this.button).observe("click",this.handleAdd.bindAsEventListener(this));$(this.input).observe("keydown",function(b){var a=Event.findElement(b,"input");if(b.keyCode==Event.KEY_RETURN&&a===this.input){this.handleAdd(b);Event.stop(b)}}.bindAsEventListener(this))},handleAdd:function(b){var a=this.input.getValue();if(a!=this.input.placeholder){var c=this.parseTickers(a);this.shield=new Fx.Shield(this.form,{wait:false,duration:150});this.disableFormElements();this.addTickers(a)}},addTickers:function(a){if(!a||a===""){return}new Ajax.Request(this.API.add,{method:"post",onComplete:this.onAddComplete.bind(this),parameters:{t:a,source:this.options.source}})},onAddComplete:function(a){this.enableFormElements();this.clearFormElements();if(a.status==200&&a.responseJSON){this.setInvalidTickerCookie(a.responseJSON.InvalidTickers);this.setDupeTickerCookie(a.responseJSON.DupeTickers)}this.redirectToWatchList()},redirectToWatchList:function(){var a="my.fool.com/watchlist";if(Fool.Env.envPrefix.length>0){a="http://"+Fool.Env.envPrefix+"."+a}else{a="http://"+a}location.href=a},setTickerCookie:function(a,c){if(!a||!a.size||a.size()<1||!Fool.Cookie){return}var b=Object.toJSON(a);Fool.Cookie.create({name:c,value:b,expires:null,domain:".fool.com",path:"/"})},setInvalidTickerCookie:function(a){this.setTickerCookie(a,"invalidMwlTickers")},setDupeTickerCookie:function(a){this.setTickerCookie(a,"dupeMwlTickers")},getCookieExpiry:function(){var a=2;var b=new Date();b.setMinutes(b.getMinutes()+a);return b},disableFormElements:function(){this.form.select("input, button, textarea").each(function(a){a.disabled=true});this.shield.start(0,0.8)},enableFormElements:function(){this.form.select("input, button, textarea").each(function(a){a.disabled=false});this.shield.start(0.8,0)},clearFormElements:function(){this.form.select("input[type=text], textarea").each(function(a){a.value=""})},parseTickers:function(a){return a.strip().split(/[^a-zA-Z.-]+/)}});var ListRotator=Class.create({options:{waitTime:4,listWrapper:"WatchlistLinks",activeElementSelector:"li:not(.hidden)"},currentList:null,pe:null,shield:null,initialize:function(a){if(a){Object.extend(this.options,a)}this.currentList=$(this.options.listWrapper);if(!this.currentList){return false}this.shield=new Fx.Shield(this.currentList,{wait:false,duration:500});this.pe=new PeriodicalExecuter(this.rotateList.bind(this),this.options.waitTime);this.currentList.on("mouseover",this.options.activeElementSelector,function(c,b){this.pe.stop()}.bind(this));this.currentList.on("mouseout",this.options.activeElementSelector,function(c,b){this.pe=new PeriodicalExecuter(this.rotateList.bind(this),this.options.waitTime)}.bind(this));return this},stop:function(){if(!this.pe){return}this.pe.stop()},rotateList:function(){var b=this.currentList.down(this.options.activeElementSelector);if(!b){b=this.currentList.down("li")}var a=b.next("li");if(!a){a=this.currentList.down("li")}b.addClassName("hidden");a.removeClassName("hidden");this.shield.start(1,0)}});