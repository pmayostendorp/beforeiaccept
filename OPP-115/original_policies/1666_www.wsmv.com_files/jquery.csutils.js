/*
 * WorldNow CSUtilities 1.4.3 (2012-08-15)
 */
(function(a,b){if(typeof a.csFormatter!=="undefined"){return}var c="header";var d="feature";var e="category";var f="clip";var g="story";var h="widgets";a.extend({csFormatter:function(a,b){var c=a;c=c.replace(/\{if \$(.+?)\}([\s\S]*?)\{\/if\}/g,function(){return b[arguments[1]]?arguments[2]:""});for(var d in b){if(b.hasOwnProperty(d)){c=c.split("{$"+d+"}").join(b[d])}}return c},$csFormatter:function(){return a(a.csFormatter.apply(null,arguments))}});a.fn.extend({wnDVSummaryExtract:function(){var b=[];this.each(function(){var c=a(this);b.push({$self:c,isClip:c.find("h4.wnRole-CLIP").length>0,isVideo:c.find("h4 .wnVideoIncluded").length>0,dateText:function(){var a=c.find(".wnDate script").html()||"";var b=a.match(/wnRenderDate\('(.+?)'.*\)/);var d=(b||[])[1];return wnRenderDate(d,"",true,true)}()||"",sectionText:c.find(".wnSectionTitle").text()||"",headlineText:c.find("h4 a span").text()||"",headlineHref:c.find("h4 a").attr("href")||"",graphicSrc:c.find(".wnImage img").attr("src")||"",graphicWidth:c.find(".wnImage img").attr("width")||"",graphicText:c.find(".wnImage span").text()||"",summaryHtml:c.find("p span").html()||""})});return b},wnDVHeadlineExtract:function(){var b=[];this.each(function(){var c=a(this);b.push({$self:c,isClip:c.find("h4.wnRole-CLIP").length>0,headlineText:c.find("h4 a span").text()||"",headlineHref:c.find("h4 a").attr("href")||""})});return b},wnItemExtract:function(){var b=[];this.each(function(){var e=a(this);if(e.hasClass(c)){b.push({$self:e,type:c,defaultText:e.find("h3 .siteDefault").text()||"",sectionText:e.find("h3 .sectionTitle").text()||"",abridgedText:e.find("h3 .abridgedHeadline").text()||"",moreText:e.find("h3 a.more .text").text()||"",moreHref:e.find("h3 a.more").attr("href")||""})}else if(e.hasClass(d)){b.push({$self:e,type:d,isClip:e.find("h4.headline .wn-icon-clip").length>0,isVideo:e.find("h4.headline .wn-icon-video-included").length>0,dateText:e.find(".wnDate .servertime").text()||"",sectionText:e.find("h4.sectionTitle .text").text()||"",headlineText:e.find("h4.headline:not(.abridged) .text").text()||"",headlineHref:e.find("h4.headline:not(.abridged) a").attr("href")||"",graphicSrc:function(){var a=e.find(".summaryImage:not(.abridged) img");return a.attr("src")||a.attr("data-path")}()||"",graphicWidth:e.find(".summaryImage:not(.abridged) img").attr("width")||"",graphicText:e.find(".summaryImage:not(.abridged) .caption").text()||"",summaryHtml:e.find(".summary:not(.abridged) .text").html()||"",abridgedHeadlineText:e.find("h4.headline.abridged .text").text()||"",abridgedGraphicSrc:function(){var a=e.find(".summaryImage.abridged img");return a.attr("src")||a.attr("data-path")}()||"",abridgedGraphicWidth:e.find(".summaryImage.abridged img").attr("width")||"",abridgedGraphicText:e.find(".summaryImage.abridged .caption").text()||"",abridgedSummaryHtml:e.find(".summary.abridged .text").html()||"",contentClassification:e.find('meta[itemprop="genre"]').attr("content")||""})}});return b},wnAPIStoryExtract:function(){var c={};this.each(function(){var d=a(this);var i=d.prop("tagName");var j=d.attr("displaysize");var k=d.attr("displayorder");if(j===b||k===b){return true}c[j]=c[j]||[];c[j][k]=c[j][k]||[];switch(i){case e:case f:case g:c[j][k].push({$self:d,type:i,isClip:i===f,isVideo:d.find('> surfaceable type:contains("Clip")').length>0,dateText:function(){if(i===f){return d.find("> rfc822lastediteddate").text()||""}else{var a=d.find("> lastediteddate month").text()||"";var b=d.find("> lastediteddate date").text()||"";var c=d.find("> lastediteddate year").text()||"";var e=d.find("> lastediteddate time").text()||"";var g=d.find("> lastediteddate timezone").text()||"";return a.substr(0,3)+" "+b+", "+c+" "+e+" "+g}}(),sectionText:d.find("> sectiontitle").text()||"",headlineText:d.find("> headline").text()||"",headlineHref:function(){var a=d.find("> id").text()||"";var b=d.find("> seo pageurl").text()||"";return"/story/"+a+"/"+b}(),clipId:d.find("> id:first").text()||"",pageURL:d.find("> seo pageurl").text()||"",graphicSrc:d.find("> abstractimage filename").text()||"",graphicWidth:d.find("> abstractimage width").text()||"",graphicText:d.find("> abstractimage caption").text()||"",summaryHtml:d.find("> abstract").text()||"",abridgedHeadlineText:d.find("abridged headline").text()||"",abridgedGraphicSrc:d.find("abridged abstractimage filename").text()||"",abridgedGraphicWidth:d.find("abridged abstractimage width").text()||"",abridgedGraphicText:d.find("abridged abstractimage caption").text()||"",abridgedSummaryHtml:d.find("abridged abstract").text()||"",contentClassification:d.find("> targetadstag").text()||""});break;case h:break}});var d={};a.each(c,function(c,e){d[c]=[];a.each(e,function(e,f){if(f!==b){a.merge(d[c],f)}})});return d},csHeaderSplit:function(){this.find("li.header").add(this.filter("li.header")).each(function(){var b=a(this).parent();var c=a(this).detach().contents();var d=a("<div />").append(c);a.each(this.attributes,function(){if(!/(^$|^null$|^false$|^0$)/i.test(this.value)){d.attr(this.name,this.value)}});b.before(d)});return this},csFormatterHtml:function(){this.html(a.csFormatter.apply(null,arguments))},csFormatterPrepend:function(){this.prepend(a.csFormatter.apply(null,arguments))},csFormatterAppend:function(){this.append(a.csFormatter.apply(null,arguments))},csPatternStyler:function(b,c){var d=b.length;c=!!c;if(d<1){return this}var e=this.find(".wnGroup");if(e.length<1){e=this}e.each(function(){a(this).find(".wnItem.feature").each(function(e){var f=c?e%d:Math.min(e,d-1);this.className=this.className.replace(/displaySizeId[^\s]+/g,"");a(this).addClass("displaySizeId"+b[f])})});return this}})})($wn)