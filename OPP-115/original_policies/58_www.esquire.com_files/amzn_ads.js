function amzn_ads(t){"use strict";try{amznads.updateAds(t)}catch(e){try{console.log("amzn_ads: "+e)}catch(a){}}}function aax_write(t,e){t.write(e),t.close()}function aax_render_ad(t){if(t.passback)return void aax_write(document,t.html);var e=t.slotSize;if(!e)return void aax_write(document,t.html);var a=e.indexOf("x"),n=e.substring(0,a),o=e.substring(a+1),r="amznad"+Math.round(1e6*Math.random());aax_write(document,'<iframe id="'+r+'" width="'+n+'" height="'+o+'" src="javascript:\'\'" scrolling="no" frameborder="0" marginwidth="0" marginheight="0" bgcolor="#FFFFFF" topmargin="0" leftmargin="0" rightmargin="0" bottommargin="0"></iframe>');var i;try{i=document.getElementById(r);var s=i.contentWindow||i.contentDocument;s.document&&(s=s.document),aax_write(s,t.html)}catch(d){i&&(i.style.display="none")}}var amzn_console=function(){"use strict";var t={};return t.log=function(){},t}();window.console&&(amzn_console=window.console);var amznads=function(t,e,a,n){"use strict";function o(n,r,i,s,d,c,l){this.element=n,this.impId=d,this.win=c,this.doc=l,this.start=null,this.end=null,this.area=null,this.cutoff=r,this.cutoffTime=1e3*i,this.focused=null,this.timer=!1,this.timerStarted=!1,this.getDuration=s,this.reported=!1,this.above=null,this.totalTime=0,this.leftPos=null,this.topPos=null,o.prototype.calcArea=function(){try{var n=e.getElementsByTagName("body")[0],o=a.top.innerWidth||e.documentElement.clientWidth||n.clientWidth,r=a.top.innerHeight||e.documentElement.clientHeight||n.clientHeight,i=t.$jQ(a).scrollTop(),s=t.$jQ(this.element).offset().top,d=t.$jQ(this.element).height(),c=t.$jQ(a).scrollLeft(),l=t.$jQ(this.element).offset().left,g=t.$jQ(this.element).width(),u=Math.max(s,i),m=Math.min(s+d,i+r),f=m-u;f=Math.max(0,f);var h=Math.max(l,c),p=Math.min(l+g,c+o),y=p-h;y=Math.max(0,y);var T=f*y,v=g*d;return this.leftPos=l/t.$jQ(e).width(),this.topPos=s/t.$jQ(e).height(),T/v}catch(A){t.log("calcArea failed for ad id="+this.element+"; error="+A)}return 0},o.prototype.displayTime=function(){if(this.getDuration){var e=this.end-this.start;t.log(this.element+" viewed for: "+e),this.totalTime+=e}},o.prototype.adInView=function(){t.log(this.element+" IN VIEW")},o.prototype.adNotInView=function(){t.log(this.element+" NOT IN VIEW")},o.prototype.seenForTime=function(){t.log(this.element+" displayed for "+this.cutoffTime/1e3+" seconds"),t.log(" "),this.reported=!0;try{{encodeURIComponent(location.protocol+location.host+location.pathname)}}catch(e){this.firePixel('/{"adViewability":[{"error": '+JSON.stringify(encodeURIComponent("Error encoding url - "+e))+"}]}")}try{this.firePixel('/{"adViewability":[{"viewable": true }]}')}catch(e){t.log(e),this.firePixel('/{"adViewability":[{"error": '+JSON.stringify(encodeURIComponent("Error sending pixel - "+e))+"}]}")}},o.prototype.firePixel=function(e){(new Image).src=t.protocol+t.host+t.px_svc+this.impId+e+"&cb="+Math.round(1e7*Math.random())},o.prototype.getAreaTime=function(){function a(){r.reported||(r.timer=setTimeout(function(){r.seenForTime()},r.cutoffTime))}function n(){r.adInView(),r.start=new Date,a(),r.timerStarted=!0}function o(){clearTimeout(r.timer),r.timerStarted=!1,r.end=new Date,r.adNotInView(),r.displayTime()}var r=this;if(null==this.area){this.area=this.calcArea(),this.above=this.area>this.cutoff?!0:!1;try{this.firePixel('/{"adViewability":[{"above_the_fold": '+this.above+', "topPos": '+this.topPos+', "leftPos": '+this.leftPos+"}]}")}catch(i){t.log(i),this.firePixel('/{"adViewability":[{"error": '+JSON.stringify(encodeURIComponent("Error sending pixel - "+i))+"}]}")}}var s=this.calcArea();e.hasFocus()&&(0==this.focused||null==this.focused)&&s>this.cutoff&&0==this.timerStarted&&n(),e.hasFocus()?this.focused=!0:this.area>this.cutoff&&1==this.focused&&(o(),this.focused=!1),(this.area>=this.cutoff&&s<this.cutoff||this.area<this.cutoff&&s>=this.cutoff)&&(s>=this.cutoff&&0==this.timerStarted?n():s<this.area&&o()),this.area=s},o.prototype.collectData=function(){var e=this;e.getAreaTime(),t.$jQ(a).on("scroll resize focus blur",function(){e.reported||e.getAreaTime()})}}var r="https:"===e.location.protocol;return t.protocol=r?"https://":"http://",t.DEFAULT_HOST="aax.amazon-adsystem.com",t.host=t.DEFAULT_HOST,t.dtb_svc="/e/dtb/bid",t.pb_svc="/x/getad",t.px_svc="/x/px/",t.debug_mode=t.debug_mode||!1,t.MIN_TIMEOUT=0,t.DEFAULT_TIMEOUT=1e3,t.targetingKey="amznslots",t.vidKey="amzn_vid",t.tasks=t.tasks||[],t.$jQ=t.$jQ||null,t.VIEWABILITY_CUTOFF_AREA=t.VIEWABILITY_CUTOFF_AREA||.5,t.VIEWABILITY_CUTOFF_DURATION_SEC=t.VIEWABILITY_CUTOFF_DURATION_SEC||1,t.CSM_JS="//c.amazon-adsystem.com/aax2/csm.js.gz",t.isjQueryPresent=function(){if("function"==typeof t.$jQ)return!0;try{if(a.top.jQuery&&a.top.jQuery.fn.on&&a.top.jQuery.fn.scrollTop)return t.$jQ=a.top.jQuery,!0}catch(e){}return!1},t.log=function(e){try{t.debug_mode&&n.log(e)}catch(a){}},t.log("Initiating amznads"),t.ads||(t.ads={}),t.updateAds=function(e){if(t.ads=e.ads,t.ev=e.ev,e.vads){t.ads||(t.ads={});var a;for(a in e.vads)e.vads.hasOwnProperty(a)&&(t.ads[a]=e.vads[a],t.amzn_vid=e.vads[a])}t.log("Updated ads. Executing rest of the task queue"),t.doAllTasks(),t.tasks.push=function(e){t.doTask(e)}},t.saveAds=function(e){t.saved_ads=e.ads,t.updateAds(e)},t.getAdForSlot=function(a,n,o){t.src_id=a;var r=r||{},i=r.u;i||(i=t.getReferrerURL()),i&&-1!==i.indexOf("amzn_debug_mode")&&(t.debug_mode=!0),t.log("amznads.getAdForSlot: Using url="+i);var s="src="+t.src_id+"&slot_uuid="+n+"&c=100&u="+i+"&cb="+Math.round(1e7*Math.random()),d=t.protocol+t.host+t.pb_svc+"?jsd=1&"+s;t.log("amznads.getAdAdForSlot: "+(o?"Async ":"")+"Call to: "+d),o?t.appendScriptTag(d):aax_write(e,"<script type='text/javascript' src='"+d+"'></script>")},t.getAdsCallback=function(e,a,n,o,r){var i=null,r=r||{};try{a&&"function"==typeof a&&(i=t.handleCallBack(a,n))}catch(s){t.log("amznads.getAdsAsyncWithCallback(): Error occured in setting up callback functionality."+s)}r.to||(r.to=n),t.doGetAdsAsync(e,o,r,i)},t.getVideoAdsCallback=function(e,a,n,o,r){var r=r||{};r.mt="V",t.getAdsCallback(e,a,n,o,r)},t.getDisplayAdsCallback=function(e,a,n,o,r){var r=r||{};r.mt="D",t.getAdsCallback(e,a,n,o,r)},t.getAdsAsync=function(e,a,n){t.doGetAdsAsync(e,a,n)},t.getVideoAdsAsync=function(e,a,n){var n=n||{};n.mt="V",t.getAdsAsync(e,a,n)},t.getDisplayAdsAsync=function(e,a,n){var n=n||{};n.mt="D",t.getAdsAsync(e,a,n)},t.handleCallBack=function(e,n){var o=!1,r=null,i=function(t){if(!o){try{e(t),r&&clearTimeout(r)}catch(a){}o=!0}},s=t.getValidMilliseconds(n);return r=s?a.setTimeout(i,s):a.setTimeout(i,t.DEFAULT_TIMEOUT),i},t.getValidMilliseconds=function(e){if(!e)return!1;try{var a=~~Number(e);if(a>t.MIN_TIMEOUT)return a}catch(n){return t.log("amznads.isValidMilliseconds(): Invalid timeout specified."+n),!1}return!1},t.getAds=function(a,n,o,r){if(r)return void t.doGetAdsAsync(a,n,o);var i=t.getScriptSource(a,n,o);t.log("amznads.getAds: Call to: "+i),aax_write(e,"<script type='text/javascript' src='"+i+"'></script>")},t.getVideoAds=function(e,a,n,o){var n=n||{};n.mt="V",t.getAds(e,a,n,o)},t.getDisplayAds=function(e,a,n,o){var n=n||{};n.mt="D",t.getAds(e,a,n,o)},t.doGetAdsAsync=function(e,a,n,o){var r=t.getScriptSource(e,a,n);t.log("amznads.getAds: Async Call to: "+r),t.appendScriptTag(r,o)},t.getScriptSource=function(a,n,o){t.src_id=a;var o=o||{},r=o.u,i=o.d,s=o.to,d=o.mt;if(r||(r=t.getReferrerURL()),r&&-1!==r.indexOf("amzn_debug_mode")&&(t.debug_mode=!0),t.ads&&(t.log("amznads.getAds(): clear out existing ads"),t.clearTargetingFromGPTAsync(),t.ads={}),t.saved_ads&&(t.ads=t.saved_ads),i)try{e.domain=i,t.log("amznads.getAds(): Using domain="+i)}catch(c){t.log("amznads.getAds(): Unable to override document domain with '"+i+"'; exception="+c)}t.log("amznads.getAds(): Using url="+r);var l="src="+a+"&u="+r+"&cb="+Math.round(1e7*Math.random());n&&(l+="&sz="+n),s&&(l+="&t="+s),d&&(l+="&mt="+d);var g=t.protocol+t.host+t.dtb_svc+"?"+l;return g},t.getReferrerURL=function(){var n=encodeURIComponent(e.documentURI);try{n=encodeURIComponent(a.top.location.href),n&&"undefined"!=n||(n=t.detectIframeAndGetURL())}catch(o){n=t.detectIframeAndGetURL()}return n},t.detectIframeAndGetURL=function(){try{if(a.top!==a.self)return t.log("Script is loaded within iFrame"),encodeURIComponent(e.referrer)}catch(n){return encodeURIComponent(e.documentURI)}},t.appendScriptTag=function(a,n){var o=e.getElementsByTagName("script")[0],r=e.createElement("script");r.type="text/javascript",r.async=!0,r.src=a;try{n&&"function"==typeof n&&(r.readyState?(r.onreadystatechange=function(){("loaded"==r.readyState||"complete"==r.readyState)&&(r.onreadystatechange=null,n(!0))},t.log("amznads.appendScriptTag: setting callBack function for < IE-8 ")):(r.onload=function(){n(!0)},t.log("amznads.appendScriptTag: setting callBack function for all other browsers exluding  < IE-8")))}catch(i){t.log("amznads.appendScriptTag: Could not associate callBack function; "+i)}o.parentNode.insertBefore(r,o)},t.renderAd=function(e,a){if(t.log("amznads.renderAd: key="+a+"; ad-tag="+t.ads[a]),t.ads[a]){var n=t.ads[a];if(t.ev){var o="amznad"+Math.round(1e6*Math.random());n=n.replace("window.top.amznads.detectViewability","window.amzncsm.rmD"),n=n.replace(/id=[^ ]*/,'id="'+o+'"');var r="<script type='text/javascript' src='"+t.CSM_JS+"'></script>\n";t.host!=t.DEFAULT_HOST&&(r+="<script type='text/javascript'>try{amzncsm.host=window.top.amznads.host;}catch(e){amzncsm.host=amznads.host;}</script>\n"),n=r+n}aax_write(e,n)}else{var i=new Object;i.c="dtb",i.src=t.src_id,i.kvmismatch=1,i.pubReturnedKey=a,i.aaxReturnedKeys=t.getTokens(),i.cb=Math.round(1e7*Math.random());try{i.u=encodeURIComponent(location.host+location.pathname),navigator&&(i.ua=encodeURIComponent(navigator.userAgent))}catch(s){}var d=encodeURIComponent(JSON.stringify(i)),c=t.protocol+t.host+"/x/px/p/0/"+d;t.log("amznads.renderAd: keyValueMismatch detected, pubReturnedKey="+a+", aaxReturnedKeys="+t.getTokens()),aax_write(e,"<img src='"+c+"'/>")}},t.detectViewability=function(e,n,r,i){t.isjQueryPresent()&&(r===a.top?new o(e,t.VIEWABILITY_CUTOFF_AREA,t.VIEWABILITY_CUTOFF_DURATION_SEC,!0,n,r,i).collectData():new o(r.frameElement,t.VIEWABILITY_CUTOFF_AREA,t.VIEWABILITY_CUTOFF_DURATION_SEC,!0,n,r,i).collectData())},t.hasAds=function(e){var a;if(!e)try{return Object.keys(t.ads).length>0}catch(n){t.log("amznads.hasAds: looks like IE 8 (and below): "+n);for(a in t.ads)if(t.ads.hasOwnProperty(a))return!0}for(a in t.ads)if(t.ads.hasOwnProperty(a)&&a.indexOf(e)>0)return!0;return!1},t.getTargeting=function(){var e={};return t.getTokens()&&t.getTokens().length>0&&(e[t.targetingKey]=t.getTokens(),t.amzn_vid&&(e[t.vidKey]=t.amzn_vid)),e},t.setTargeting=function(e,a){var n;for(n in t.ads)if(t.ads.hasOwnProperty(n)){if(a&&n.indexOf(a)<0)continue;e(n,"1")}},t.setTargetingForGPTAsync=function(e){try{if(e){t.targetingKey=e;var a=t.getTokens();"undefined"!=typeof a&&a.length>0&&googletag.cmd.push(function(){googletag.pubads().setTargeting(e,a),t.amzn_vid&&googletag.pubads().setTargeting(t.vidKey,t.amzn_vid)})}else{var n;for(n in t.ads)t.ads.hasOwnProperty(n)&&!function(){var e=n;t.log("amznads.setTargetingForGPTAsync: pushing localKey="+e),googletag.cmd.push(function(){amznads.debug_mode&&amznads.log("amznads.setTargetingForGPTAsync: localKey="+e),googletag.pubads().setTargeting(e,"1"),t.amzn_vid&&googletag.pubads().setTargeting(t.vidKey,t.amzn_vid)})}()}t.log("amznads.setTargetingForGPTAsync: Completed successfully. Number of ads returned by Amazon: "+Object.keys(t.ads).length)}catch(o){t.log("amznads.setTargetingForGPTAsync: ERROR - "+o)}},t.setTargetingForGPTSync=function(e){try{if(e){t.targetingKey=e;var a=t.getTokens();"undefined"!=typeof a&&a.length>0&&(googletag.pubads().setTargeting(e,a),t.amzn_vid&&googletag.pubads().setTargeting(t.vidKey,t.amzn_vid))}else{var n;for(n in t.ads)t.ads.hasOwnProperty(n)&&(googletag.pubads().setTargeting(n,"1"),t.amzn_vid&&googletag.pubads().setTargeting(t.vidKey,t.amzn_vid))}t.log("amznads.setTargetingForGPTSync: Completed successfully. Number of ads returned by Amazon: "+Object.keys(t.ads).length)}catch(o){t.log("amznads.setTargetingForGPTSync: ERROR - "+o)}},t.clearTargetingFromGPTAsync=function(){try{googletag&&googletag.pubads()&&googletag.pubads().clearTargeting(t.targetingKey),googletag.pubads().clearTargeting(t.vidKey)}catch(e){}},t.appendTargetingToAdServerUrl=function(e){var a=e;try{-1===e.indexOf("?")&&(e+="?");var n;for(n in t.ads)t.ads.hasOwnProperty(n)&&(e+="&"+n+"=1");t.log("amznads.appendTargetingToAdServerUrl: Completed successfully. Number of ads returned by Amazon: "+t.ads.length)}catch(o){t.log("amznads.appendTargetingToAdServerUrl: ERROR - "+o)}return t.log("amznads.appendTargetingToAdServerUrl: input url: "+a+"\nreturning url: "+e),e},t.appendTargetingToQueryString=function(e){var a=e;try{var n;for(n in t.ads)t.ads.hasOwnProperty(n)&&(e+="&"+n+"=1")}catch(o){t.log("amznads.appendTargetingToQueryString: ERROR - "+o)}return t.log("amznads.appendTargetingToQueryString: input query-string:"+a+"\nreturning query-string:"+e),e},t.getTokens=function(e){var a,n=[];try{for(a in t.ads)if(t.ads.hasOwnProperty(a)){if(e&&a.indexOf(e)<0)continue;n.push(a)}}catch(o){t.log("amznads.getTokens: ERROR - "+o)}return t.log("amznads.getTokens: returning tokens = "+n),n},t.getKeys=t.getTokens,t.getVid=function(){return t.amzn_vid},t.doAllTasks=function(){for(;t.tasks.length>0;){var e=t.tasks.shift();t.doTask(e)}},t.doTask=function(e){try{e.call()}catch(a){t.log("Failed calling task: "+a)}},t.tryGetAdsAsync=function(){t.asyncParams&&t.getAdsCallback(t.asyncParams.id,t.asyncParams.callbackFn,t.asyncParams.timeout,t.asyncParams.size,t.asyncParams.data)},t}(amznads||{},document,window,amzn_console);amznads.tryGetAdsAsync(),window.amzn_ads=amzn_ads,window.amznads=amznads;
