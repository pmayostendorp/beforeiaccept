function ULS04Z(){var o=new Object;o.ULSTeamName="Microsoft SharePoint Foundation";o.ULSFileName="SP.Ribbon.js";return o;}
Type.registerNamespace("SP");SP.BWsaStreamTypes=function(){};SP.BWsaStreamTypes.prototype={"static":1,cyclic:2};SP.BWsaStreamTypes.registerEnum("SP.BWsaStreamTypes",false);SP.SQMDP=function(){};SP.SQMDP.prototype={none:0,dataiD_SESSION_TYPE:60,dataiD_BSQM_BROWSERINFO:7982,dataiD_BSQM_MAXSTREAMROWS:7993,dataiD_BSQM_MAXLSTREAMROWSOVERWRITTEN:7994,dataiD_BSQM_MAXSTREAMROWSOVERWRITTENSTREAMID:8047,dataiD_BSQM_MAXSTREAMROWSSTREAMID:8048,dataiD_BSQM_OSDATA:8049,dataiD_BSQM_COMMANDUIACTION:8327,dataiD_BSQM_APPVER:8472,dataiD_BSQM_INVALIDVALUEDP:8763,dataiD_OFFICESQMSESSIONTYPE:8814};SP.SQMDP.registerEnum("SP.SQMDP",false);SP.BWsaConfig=function(){ULS04Z:;this.$2G=[60,7982,7993,7994,8047,8048,8049,8472];this.$1q="";this.$G=false;this.$1n=1.8e6;this.$2T=65536;this.$1o=2147483647;this.$4H=9;this.$4I=1e3;this.$2U=1e3};SP.BWsaConfig.prototype={$1q:null,$G:false,$1n:0,$2T:0,$1o:0,$4I:0,$2U:0,$4H:0,get_maxSessionMs:function(){ULS04Z:;return this.$1n},set_maxSessionMs:function(a){ULS04Z:;this.$1n=a;return a}};SP.Ticks=function(){};SP.Ticks.getTicks32=function(){ULS04Z:;var b=new Date,a=b.getTime();if(!SP.Ticks.$1x_0)SP.Ticks.$1x_0=a;return 1+a-SP.Ticks.$1x_0&2147483647};SP.Ticks.getTicks64=function(){ULS04Z:;var b=new Date,a=b.getTime();a=a+1.16444736e13;a=a*1e4;return a};SP.TimerResetCheck=function(){};SP.TimerResetCheck.isTimerResetNeeded=function(){ULS04Z:;var a=false,c=new Date,b=c.getTime();if(!SP.TimerResetCheck.$1c_0||b-SP.TimerResetCheck.$1c_0>6e4){a=true;SP.TimerResetCheck.$1c_0=b}return a};SP.StreamRowCounters=function(){};SP.BWsaDatapoint=function(a){ULS04Z:;this.m_WsaId=a;this.m_Value=0;this.m_Ticks=SP.Ticks.getTicks32();this.m_Count=0;this.m_Sum=0};SP.BWsaDatapoint.prototype={m_WsaId:0,m_Value:0,m_Ticks:0,m_Count:0,m_Sum:0};SP.WsaStreamRow=function(a){ULS04Z:;this.m_Ticks=SP.Ticks.getTicks32();this.m_Values=new Array(a)};SP.WsaStreamRow.prototype={m_Ticks:0,m_Values:null};SP.BWsaStream=function(d,c,b,a){ULS04Z:;if(a<1||a>1e3)a=1e3;this.m_WsaId=d;this.m_StreamType=c;this.m_Width=b;this.m_MaxRows=a;this.m_RowCount=0;this.m_RowsOverwritten=0;this.m_Rows={}};SP.BWsaStream.prototype={m_WsaId:0,m_StreamType:0,m_Width:0,m_MaxRows:0,m_RowCount:0,m_RowsOverwritten:0,m_Rows:null};SP.BWsaHeader=function(){ULS04Z:;this.m_StartTime=SP.Ticks.getTicks64();this.m_EndTime=0};SP.BWsaHeader.prototype={m_StartTime:0,m_EndTime:0};SP.BWsaData=function(){ULS04Z:;this.m_cDataPoints=0;this.m_cStreams=0;this.m_cbStreams=0;this.m_wsaHeader=new SP.BWsaHeader;this.m_wsaDatapoints={};this.m_wsaStreams={}};SP.BWsaData.prototype={m_cDataPoints:0,m_cStreams:0,m_cbStreams:0,m_wsaHeader:null,m_wsaDatapoints:null,m_wsaStreams:null};SP.BWsaClient=function(b,c){ULS04Z:;this.$2h=Function.createDelegate(this,this.$4q_0);this.$7_0=new SP.BWsaData;this.$6_0=new SP.BWsaConfig;this.$2O_0=false;this.$1l_0=0;this.$t_0=0;this.$1F_0=false;this.$1g_0={};for(var a=0;a<this.$6_0.$2G.length;a++)this.$1g_0[this.$6_0.$2G[a]]=true;this.$6_0.$1q=b;this.$6_0.$G=b===""?false:c};SP.BWsaClient.$5i_0=function(){ULS04Z:;var a=0,c=window.navigator.userAgent,b=-1;if((b=c.indexOf(" MSIE "))>-1){b+=6;a=2<<24}else if((b=c.indexOf(" Firefox/"))>-1){b+=9;a=3<<24}else if((b=c.indexOf(" Chrome/"))>-1){b+=8;a=6<<24}else if((b=c.indexOf(" Safari/"))>-1&&(b=c.indexOf(" Version/"))>-1){b+=9;a=4<<24}else if((b=c.indexOf("Opera/"))>-1){b+=6;a=5<<24}else{a=1<<24;b=-1}if(b>=0){var d=SP.BWsaClient.$43_0(c.substr(b));if(Sys.Browser.agent===Sys.Browser.InternetExplorer&&d[0]===7&&c.indexOf("Trident/4.0")>=0)d[0]=8;a=a|(d[0]<<16)+d[1]}try{if(window.navigator.cookieEnabled)a=a|1073741824;else a=a|1610612736}catch(e){}a=a;return a};SP.BWsaClient.$43_0=function(b){ULS04Z:;var a=[0,0];if(SP.BWsaClient.$2K_0(b.charAt(0)))a[0]=parseInt(b);for(var c=0;c<b.length;c++)if(!SP.BWsaClient.$2K_0(b.charAt(c))){b=b.substr(c+1);break}if(SP.BWsaClient.$2K_0(b.charAt(0)))a[1]=parseInt(b);if(a[0]<0||a[0]>255||a[1]<0||a[1]>65535){a[0]=0;a[1]=0}return a};SP.BWsaClient.$5m_0=function(){ULS04Z:;var a=0,c=1,b=window.navigator.userAgent;if(b.indexOf("Windows CE")>=0)c=3;else if(b.indexOf("Windows")>=0)c=2;else if(b.indexOf("PPC")>=0||b.indexOf("Macintosh")>=0)c=4;else if(b.indexOf("SunOS")>=0)c=5;else if(b.indexOf("Linux")>=0)c=6;a=c<<24;if(b.indexOf("Windows 95")>=0)a=a+6225920;else if(b.indexOf("Windows 9x")>=0)a=a+6488064;else if(b.indexOf("Windows 98")>=0)a=a+6422528;else if(b.indexOf("Windows NT 5.01")>=0)a=a+327680|254;else{var e="Windows NT ",f=b.indexOf(e);if(f<0){e="Mac OS X ";f=b.indexOf(e)}if(f>=0){var h=SP.BWsaClient.$43_0(b.substr(f+e.length));a=a+((h[0]<<16)+h[1])}}var d=0;try{var g=window.navigator.platform;if(b.indexOf("WOW64")!==-1)d=2;else if(g==="Win64")d=3;else if(g==="Win32"||g==="Linux i686")d=1}catch(i){}a=a|d<<29;return a};SP.BWsaClient.$6V_0=function(f){ULS04Z:;var a=new Sys.StringBuilder,b=true;a.append("{");a.append('"StartTime":'+f.m_wsaHeader.m_StartTime+",");a.append('"EndTime":'+f.m_wsaHeader.m_EndTime+",");a.append('"wsaDatapoints":[');var c=f.m_wsaDatapoints;for(var d in c){var m={key:d,value:c[d]},g=m.value;!b&&a.append(",");a.append('{"Id":'+g.m_WsaId+",");a.append('"Val":'+g.m_Value+",");a.append('"Tic":'+g.m_Ticks+"}");b=false}a.append('],"wsaStreams":[');b=true;var c=f.m_wsaStreams;for(var d in c){var n={key:d,value:c[d]},h=n.value,l=true;!b&&a.append(",");a.append('{"Id":'+h.m_WsaId+",");a.append('"Width":'+h.m_Width+",");a.append('"Rows":[');var j=h.m_Rows;for(var k in j){var o={key:k,value:j[k]},i=o.value;!l&&a.append(",");a.append('{"Tic":'+i.m_Ticks+",");a.append('"Vals":[');for(var e=0;e<i.m_Values.length;e++){e>0&&a.append(",");a.append(i.m_Values[e])}a.append("]}");l=false}a.append("]}");b=false}a.append("]}");return a.toString()};SP.BWsaClient.$2K_0=function(a){ULS04Z:;return a>="0"&&a<="9"};SP.BWsaClient.getSQMLocationFromCUICommandInfo=function(c){ULS04Z:;if(!c)return 0;var a=0,b=c["RootType"],d=c["RootLocation"];if(b)if(b==="Ribbon"){if(d==="LowerRibbon")a=2;else if(d==="UpperRibbon")a=1}else if(b==="QAT")a=3;else if(b==="Jewel")a=4;return a};SP.BWsaClient.prototype={$7_0:null,$6_0:null,$2O_0:false,$1l_0:0,$t_0:0,$1F_0:false,$1g_0:null,$f_0:null,get_wsaConfig:function(){ULS04Z:;return this.$6_0},$2Y_0:function(){ULS04Z:;var a=this.$7_0.m_cDataPoints*SP.BWsaClient.$1J_0+this.$7_0.m_cbStreams;if(a>=this.$6_0.$2T){this.uploadWsaData();a=this.$7_0.m_cDataPoints*SP.BWsaClient.$1J_0+this.$7_0.m_cbStreams;return a>=this.$6_0.$2T}return false},$4X_0:function(c){ULS04Z:;try{if(this.$1F_0||this.$1g_0[c])return;this.$1F_0=true;var a=SP.OfficeVersion.fullBuildBase.split(".");this.$1S_0(8472,(parseInt(a[2])<<16)+parseInt(a[0]));this.$1S_0(7982,SP.BWsaClient.$5i_0());this.$1S_0(8049,SP.BWsaClient.$5m_0());this.$1S_0(8814,3)}catch(b){}},setDw:function(a,c){ULS04Z:;try{if(!this.$6_0.$G)return;if(Object.getType(a)!==Number||Object.getType(c)!==Number)return;if(a<1||a>this.$6_0.$1o)return;if(c<0||c>4294967295){this.setDw(8763,a);return}if(this.$2Y_0())return;this.$4X_0(a);this.$n_0();var b=this.$7_0.m_wsaDatapoints[a];if(!b){b=new SP.BWsaDatapoint(a);this.$7_0.m_wsaDatapoints[a]=b;this.$7_0.m_cDataPoints++}b.m_Value=c;b.m_Count++;b.m_Sum=c+b.m_Sum}catch(d){}},setBool:function(b,a){ULS04Z:;if(a)a=1;this.setDw(b,a)},setBitsOrAnd:function(c,a,b){ULS04Z:;try{if(!this.$6_0.$G)return;if(Object.getType(c)!==Number||Object.getType(a)!==Number||Object.getType(b)!==Number)return;if(a<0||a>4294967295||b<0||b>4294967295){this.setDw(8763,c);return}var d=this.$7_0.m_wsaDatapoints[c];if(d){this.$n_0();d.m_Value&=b;d.m_Value|=a;d.m_Count++}else this.setDw(c,a)}catch(e){}},setBitsOr:function(a,b){ULS04Z:;this.setBitsOrAnd(a,b,4294967295)},setBitsAnd:function(a,b){ULS04Z:;this.setBitsOrAnd(a,0,b)},setIfMax:function(b,a){ULS04Z:;try{if(!this.$6_0.$G)return;if(Object.getType(b)!==Number||Object.getType(a)!==Number)return;var c=this.$7_0.m_wsaDatapoints[b];if(!c||c.m_Value<a)this.setDw(b,a);else this.$n_0()}catch(d){}},setIfMin:function(b,a){ULS04Z:;try{if(!this.$6_0.$G)return;if(Object.getType(b)!==Number||Object.getType(a)!==Number)return;var c=this.$7_0.m_wsaDatapoints[b];if(!c||c.m_Value>a)this.setDw(b,a);else this.$n_0()}catch(d){}},incrementDw:function(a,b){ULS04Z:;try{if(!this.$6_0.$G)return;if(Object.getType(a)!==Number||Object.getType(b)!==Number)return;if(!b){this.$n_0();return}var c=0,d=this.$7_0.m_wsaDatapoints[a];if(d)c=d.m_Value;this.setDw(a,c+b)}catch(e){}},addToAverage:function(b,c){ULS04Z:;try{if(!this.$6_0.$G)return;if(Object.getType(b)!==Number||Object.getType(c)!==Number)return;this.setDw(b,c);var a=this.$7_0.m_wsaDatapoints[b];if(a)a.m_Value=Math.floor(a.m_Sum/a.m_Count)}catch(d){}},createStream:function(a,c,d,b){ULS04Z:;try{if(!this.$6_0.$G)return;if(a<1||a>this.$6_0.$1o)return;if(c!==1&&c!==2)return;if(d<1||d>this.$6_0.$4H)return;if(this.$2Y_0())return;if(b<1||b>this.$6_0.$2U)b=this.$6_0.$2U;if(!this.$7_0.m_wsaStreams[a]){var f=new SP.BWsaStream(a,c,d,b);this.$7_0.m_wsaStreams[a]=f;this.$7_0.m_cStreams++;this.$7_0.m_cbStreams+=SP.BWsaClient.$1J_0}}catch(e){}},$6M_0:function(a){ULS04Z:;delete a.m_Rows[a.m_RowsOverwritten];this.$7_0.m_cbStreams-=(a.m_Width+1)*4;a.m_RowCount--;a.m_RowsOverwritten++;if(a.m_RowsOverwritten>SP.StreamRowCounters.maxOverwritten){SP.StreamRowCounters.maxOverwritten=a.m_RowsOverwritten;this.setDw(7994,a.m_RowsOverwritten);this.setDw(8047,a.m_WsaId)}},addToStreamDw8:function(b,c,d,e,f,g,h,i,j){ULS04Z:;try{var a=new SP.WsaStreamRow(8);a.m_Values[0]=c;a.m_Values[1]=d;a.m_Values[2]=e;a.m_Values[3]=f;a.m_Values[4]=g;a.m_Values[5]=h;a.m_Values[6]=i;a.m_Values[7]=j;this.$4l_0(b,a)}catch(k){}},$4l_0:function(b,c){ULS04Z:;if(!this.$6_0.$G)return;if(b<1||b>this.$6_0.$1o)return;if(this.$2Y_0())return;this.$4X_0(b);for(var d=0;d<c.m_Values.length;d++){var e=c.m_Values[d];if(e<0||e>4294967295){this.setDw(8763,b);return}}var a=this.$7_0.m_wsaStreams[b];if(a){this.$n_0();if(a.m_Width!==c.m_Values.length)return;a.m_RowCount>=a.m_MaxRows&&a.m_StreamType===2&&this.$6M_0(a);if(a.m_RowCount<a.m_MaxRows){var f=a.m_RowCount+a.m_RowsOverwritten;a.m_Rows[f]=c;a.m_RowCount++;this.$7_0.m_cbStreams+=(a.m_Width+1)*4;if(a.m_RowCount>SP.StreamRowCounters.maxRowCount){SP.StreamRowCounters.maxRowCount=a.m_RowCount;this.setDw(7993,a.m_RowCount);this.setDw(8048,a.m_WsaId)}}else{a.m_RowsOverwritten++;if(a.m_RowsOverwritten>SP.StreamRowCounters.maxOverwritten){SP.StreamRowCounters.maxOverwritten=a.m_RowsOverwritten;this.setDw(7994,a.m_RowsOverwritten);this.setDw(8047,a.m_WsaId)}}}},terminate:function(){ULS04Z:;this.uploadWsaData()},uploadWsaData:function(){ULS04Z:;try{this.$1U_0();if(!this.$7_0||!this.$6_0)return;if(!this.$6_0.$G)return;if(this.$6_0.$1q===""){this.$6_0.$G=false;return}var f=SP.Ticks.getTicks32();if(this.$1l_0>0&&f<=this.$1l_0+this.$6_0.$4I)return;this.$1l_0=f;var a=new Array(0),d=this.$7_0.m_wsaStreams;for(var e in d){var g={key:e,value:d[e]},i=g.value;if(!i.m_RowCount)a[a.length]=g.key}for(var b=0;b<a.length;b++){delete this.$7_0.m_wsaStreams[a[b]];this.$7_0.m_cStreams--;this.$7_0.m_cbStreams-=SP.BWsaClient.$1J_0}if(this.$1F_0){if(this.$2O_0)this.setDw(60,1);else{this.setDw(60,0);this.$2O_0=true}this.$7_0.m_wsaHeader.m_EndTime=SP.Ticks.getTicks64();var c=SP.BWsaClient.$6V_0(this.$7_0);this.$7_0=new SP.BWsaData;this.$1F_0=false;c&&c.length>0&&this.uploadWsaDataRequest(c)}}catch(h){}},uploadWsaDataRequest:function(a){ULS04Z:;if(!this.$f_0)this.$f_0=new XMLHttpRequest;if(this.$f_0.readyState===0||this.$f_0.readyState===4){this.$f_0.open("POST",this.$6_0.$1q,true);this.$f_0.setRequestHeader("Content-Type","application/json");this.$f_0.send(a)}},isUserOptedIn:function(){ULS04Z:;return this.$6_0.$G},disable:function(){ULS04Z:;try{this.$1U_0();this.$6_0.$G=false}catch(a){}},$1S_0:function(a,c){ULS04Z:;if(!this.$7_0.m_wsaDatapoints[a]){var b=new SP.BWsaDatapoint(a);b.m_Value=c;this.$7_0.m_wsaDatapoints[a]=b;this.$7_0.m_cDataPoints++}},$1U_0:function(){ULS04Z:;if(this.$t_0){window.clearTimeout(this.$t_0);this.$t_0=0}},$n_0:function(){ULS04Z:;if(SP.TimerResetCheck.isTimerResetNeeded()){this.$1U_0();this.$t_0=window.setTimeout(this.$2h,this.$6_0.$1n)}},$4q_0:function(){ULS04Z:;this.$t_0=0;this.$1U_0();this.uploadWsaData();this.$n_0()},addCommonDatapoint:function(a){ULS04Z:;this.$1g_0[a]=true}};Type.registerNamespace("SP.Ribbon");SP.Ribbon.ControlDataRecord=function(){};SP.Ribbon.$create_ControlDataRecord=function(){ULS04Z:;return new SP.Ribbon.ControlDataRecord};SP.Ribbon.IRelatedFieldsInfoRequestor=function(){};SP.Ribbon.IRelatedFieldsInfoRequestor.registerInterface("SP.Ribbon.IRelatedFieldsInfoRequestor");SP.Ribbon.Utility=function(){};SP.Ribbon.Utility.$2H_0=function(){ULS04Z:;return window.self.self};SP.Ribbon.Utility.$4o=function(b,c){ULS04Z:;var a=SP.Ribbon.Utility.$2H_0();$addHandler(a,b,c)};SP.Ribbon.Utility.$5Z=function(b,c){ULS04Z:;var a=SP.Ribbon.Utility.$2H_0();$removeHandler(a,b,c)};SP.Ribbon.Utility.$F=function(a,b){ULS04Z:;return a&&a.className&&Sys.UI.DomElement.containsCssClass(a,b)};SP.Ribbon.Utility.get_$U=function(){ULS04Z:;if(!SP.Ribbon.Utility.$z_0&&window._spWebPermMasks){var a=window._spWebPermMasks;if(!SP.Ribbon.SU.$0(a)&&!SP.BasePermissions.isInstanceOfType(a)){SP.Ribbon.Utility.$z_0=new SP.BasePermissions;!SP.Ribbon.Utility.$z_0.customFromJson(a)&&SP.Ribbon.Utility.$z_0.fromJson(a)}}return SP.Ribbon.Utility.$z_0};SP.Ribbon.UtilityInternal=function(){};SP.Ribbon.UtilityInternal.$61_0=function(){ULS04Z:;return Sys.Browser.agent===Sys.Browser.Firefox||Sys.Browser.name.toLowerCase().indexOf("firefox")!==-1};SP.Ribbon.UtilityInternal.$2H_0=function(){ULS04Z:;if(!SP.Ribbon.UtilityInternal.$61_0())return document.body;else return window.self.self};SP.Ribbon.UtilityInternal.$4n=function(b,c){ULS04Z:;var a=SP.Ribbon.UtilityInternal.$2H_0();$addHandler(a,b,c)};SP.Ribbon.UtilityInternal.$e=function(){ULS04Z:;SP.Ribbon.UtilityInternal.$1s_0>0&&window.clearTimeout(SP.Ribbon.UtilityInternal.$1s_0);SP.Ribbon.UtilityInternal.$1s_0=window.setTimeout(SP.Ribbon.UtilityInternal.$4W_0,0)};SP.Ribbon.UtilityInternal.$6U=function(){ULS04Z:;SP.Ribbon.PageManager.get_instance().get_commandDispatcher().executeCommand(Commands.CommandIds.ApplicationStateChanged,null);var a=window._spNextRibbonTabId;if(!SP.Ribbon.SU.$0(a)){window.SelectRibbonTab(a);window._spNextRibbonTabId=null}CUI.PMetrics.perfMark(7736)};SP.Ribbon.SQMUtility=function(){};SP.Ribbon.SQMUtility.calcActionId=function(d){ULS04Z:;for(var a=5381,b=a,f=d.length,c=0;c<f;c+=2){a=((a<<5)+a^d.charCodeAt(c))&4294967295;if(c===f-1)break;b=((b<<5)+b^d.charCodeAt(c+1))&4294967295}var g=b*35685,h=b*23896<<16,e=a+g+h&4294967295;if(e<0)e+=4294967296;return e};SP.Ribbon.SU=function(){};SP.Ribbon.SU.$2=function(a){ULS04Z:;var b=null;return a===b||typeof a==="undefined"||!a.length};SP.Ribbon.SU.$0=function(a){ULS04Z:;var b=null;return a===b||typeof a==="undefined"};SP.Ribbon.SU.$1C=function(a){ULS04Z:;return typeof a==="undefined"};SP.Ribbon.CommandUIExtensionPageComponent=function(){ULS04Z:;this.$3O=Function.createDelegate(this,this.onHandlersReturned);SP.Ribbon.CommandUIExtensionPageComponent.initializeBase(this)};SP.Ribbon.CommandUIExtensionPageComponent.get_instance=function(){ULS04Z:;if(null===SP.Ribbon.CommandUIExtensionPageComponent.$1I_1)SP.Ribbon.CommandUIExtensionPageComponent.$1I_1=new SP.Ribbon.CommandUIExtensionPageComponent;return SP.Ribbon.CommandUIExtensionPageComponent.$1I_1};SP.Ribbon.CommandUIExtensionPageComponent.registerWithPageManager=function(){ULS04Z:;if(!SP.Ribbon.SU.$0(SP.Ribbon.CommandUIExtensionPageComponent.get_instance().$10_1)&&!SP.Ribbon.CommandUIExtensionPageComponent.$25_1){SP.Ribbon.CommandUIExtensionPageComponent.$6O_1();return}SP.Ribbon.PageManager.get_instance().addPageComponent(SP.Ribbon.CommandUIExtensionPageComponent.get_instance());!SP.ScriptUtility.isNullOrUndefined(SP.Ribbon.PageManager.get_instance().get_ribbon())&&SP.Ribbon.PageManager.get_instance().get_commandDispatcher().executeCommand(Commands.CommandIds.ApplicationStateChanged,null)};SP.Ribbon.CommandUIExtensionPageComponent.$6O_1=function(){ULS04Z:;var c=null,a=SP.Ribbon.CommandUIExtensionPageComponent.get_instance();if(!SP.Ribbon.SU.$0(a.$10_1))c=a.$10_1;else return;var e=null;if(!SP.Ribbon.SU.$0(a.$1L_1))e=a.$1L_1;var f=null;if(!SP.Ribbon.SU.$0(a.$1K_1))f=a.$1K_1;var b;if(c.indexOf("?")===-1)b=c+"?ver=";else b=c+"&ver=";b=b+e+"&lcid="+f+"&qt=commandhandlers";var d=new Sys.Net.WebRequest;d.set_httpVerb("GET");d.set_url(b);d.add_completed(a.$3O);d.invoke()};SP.Ribbon.CommandUIExtensionPageComponent.unregisterWithPageManager=function(){ULS04Z:;null!==SP.Ribbon.CommandUIExtensionPageComponent.$1I_1&&SP.Ribbon.PageManager.get_instance().removePageComponent(SP.Ribbon.CommandUIExtensionPageComponent.get_instance())};SP.Ribbon.CommandUIExtensionPageComponent.prototype={$10_1:null,get_dataUrl:function(){ULS04Z:;return this.$10_1},set_dataUrl:function(a){ULS04Z:;this.$10_1=a;return a},$1K_1:null,get_dataLCID:function(){ULS04Z:;return this.$1K_1},set_dataLCID:function(a){ULS04Z:;this.$1K_1=a;return a},$1L_1:null,get_dataVersion:function(){ULS04Z:;return this.$1L_1},set_dataVersion:function(a){ULS04Z:;this.$1L_1=a;return a},$W_1:null,$28_1:null,onHandlersReturned:function(a){ULS04Z:;if(a.get_responseAvailable())this.$28_1=a.get_object();SP.Ribbon.CommandUIExtensionPageComponent.$25_1=true;SP.Ribbon.CommandUIExtensionPageComponent.registerWithPageManager()},$3Z_1:function(d){ULS04Z:;if(SP.Ribbon.SU.$0(this.$W_1))this.$W_1=[];var a=d.children;if(SP.ScriptUtility.isNullOrUndefined(a))return;for(var c=a.length,b=0;b<c;b++)this.$W_1[this.$W_1.length]=a[b].attrs},init:function(){ULS04Z:;!SP.Ribbon.SU.$0(this.$28_1)&&this.$3Z_1(this.$28_1);var a=window.g_commandUIHandlers;!SP.Ribbon.SU.$0(a)&&this.$3Z_1(a);this.$5V_1()},$V_1:null,get_$5s_1:function(){ULS04Z:;if(SP.Ribbon.SU.$0(this.$V_1)){this.$V_1=[];for(var a=0;a<this.$W_1.length;a++){var b=this.$W_1[a];if(!SP.Ribbon.SU.$0(b)){var c=b.Command;if(!SP.Ribbon.SU.$0(c))this.$V_1[a]=c}}this.$V_1[this.$V_1.length]="CustomCommandsTab";this.$V_1[this.$V_1.length]="CustomCommandsGroup"}return this.$V_1},getGlobalCommands:function(){ULS04Z:;return this.get_$5s_1()},canHandleCommand:function(a){ULS04Z:;if(a==="CustomCommandsTab"||a==="CustomCommandsGroup")return true;var b=this.get_$2I_1()[a];if(SP.Ribbon.SU.$0(b))return false;if(Array.isInstanceOfType(b)){for(var c=0;c<b.length;c++)if(this.$3j_1(b[c],a))return true}else return this.$3j_1(b,a);return false},$3p_1:function(b){ULS04Z:;if(SP.Ribbon.SU.$0(b))return true;var a=SP.Ribbon.WebPartComponent.get_pageComponentIdOfActiveWebPart();return !SP.Ribbon.SU.$0(a)&&a===b},$3j_1:function($p0,$p1){var $v_0=$p0.WebPartId,$v_1=$p0.EnabledScript;if(!this.$3p_1($v_0))return false;var $v_2=SP.Ribbon.Utility.get_$U();if(!SP.Ribbon.SU.$2($p0.HPerms)&&!SP.Ribbon.SU.$2($p0.LPerms)&&!SP.Ribbon.SU.$0($v_2)){var $v_3=parseInt($p0.HPerms,10),$v_4=parseInt($p0.LPerms,10);if(!$v_2.hasPermissions($v_3,$v_4))return false}if(!SP.Ribbon.SU.$0($v_1)&&$v_1.toLowerCase().startsWith("javascript:")){window.g_CUIcommandId=$p1;var $v_5=eval($p0.EnabledScript);window.g_CUIcommandId=null;return $v_5}return true},$23_1:null,get_$2I_1:function(){ULS04Z:;if(SP.Ribbon.SU.$0(this.$23_1))this.$23_1={};return this.$23_1},$5V_1:function(){ULS04Z:;for(var c=this.get_$2I_1(),f=this.$W_1.length,d=0;d<f;d++){var a=this.$W_1[d];if(SP.Ribbon.SU.$0(a.Command))continue;var b=c[a.Command];if(SP.Ribbon.SU.$0(b))c[a.Command]=a;else if(Array.isInstanceOfType(b))Array.add(b,a);else{var e=[];Array.add(e,b);Array.add(e,a);c[a.Command]=e}}},handleCommand:function(b,d){ULS04Z:;var a=this.get_$2I_1()[b];if(SP.Ribbon.SU.$0(a))return false;if(Array.isInstanceOfType(a)){for(var c=0;c<a.length;c++)if(this.$45_1(a[c],b,d))return true}else return this.$45_1(a,b,d);return false},$45_1:function($p0,$p1,$p2){var $v_0=$p0.CommandAction,$v_1=$p0.Command,$v_2=$p0.WebPartId;if(this.$3p_1($v_2))if(!SP.Ribbon.SU.$2($v_0)){if($v_0.toLowerCase().startsWith("javascript:")){window.g_CUIcommandProperties=$p2;window.g_CUIcommandId=$p1;eval(this.$4U_1($v_0,false));window.g_CUIcommandProperties=null;window.g_CUIcommandId=null}else STSNavigate(this.$4U_1($v_0,true));return true}return false},$4U_1:function(b,j){ULS04Z:;var e=null,a=null,f=SP.ListOperation.Selection.getSelectedItems();a=SP.ListOperation.Selection.getSelectedList();if(!SP.Ribbon.SU.$0(a)&&j){a=a.replace("{","%7B");a=a.replace("-","%2D");a=a.replace("}","%7D")}if(!SP.Ribbon.SU.$0(f)){var g=0,h=null,c=f;for(var d in c){var i={key:d,value:c[d]};h=i.value.id.toString();g++}if(g===1)e=h}b=b.replace(new RegExp("{SelectedListId}","g"),a);b=b.replace(new RegExp("{SelectedItemId}","g"),e);return b}};SP.Ribbon.ToolbarRibbonAdapterData=function(){};SP.Ribbon.ToolbarRibbonAdapterData.prototype={ToolbarData:null};SP.Ribbon.ToolbarRibbonAdapter=function(b,a){ULS04Z:;SP.Ribbon.ToolbarRibbonAdapter.initializeBase(this);this._data=a;this.$3W_1=b};SP.Ribbon.ToolbarRibbonAdapter.prototype={_controlData:null,_componentData:null,$3W_1:null,_data:null,get_controlData:function(){ULS04Z:;return this._controlData},ensureCommandInfoStructure:function(){ULS04Z:;for(var $v_0=eval(this._data.ToolbarData),$v_1=0;$v_1<$v_0.length;$v_1++){var $v_2=$v_0[$v_1];if(SP.Ribbon.SU.$0($v_2.Command))continue;var $v_3=this._controlData[$v_2.Command];if(SP.Ribbon.SU.$0($v_3)){this._controlData[$v_2.Command]=$v_2;if(!SP.Ribbon.SU.$0($v_2.ContextualGroupCommand))this._componentData[$v_2.ContextualGroupCommand]=true;if(!SP.Ribbon.SU.$0($v_2.TabCommand))this._componentData[$v_2.TabCommand]=true;if(!SP.Ribbon.SU.$0($v_2.GroupCommand))this._componentData[$v_2.GroupCommand]=true}}},canHandleCommand:function(commandId){ULS04Z:;if(this._componentData[commandId])return true;var $v_0=this._controlData[commandId];if(SP.Ribbon.SU.$0($v_0))return false;if(SP.Ribbon.SU.$2($v_0.HiddenScript)||SP.Ribbon.SU.$0($v_0.HiddenScript))return true;return !eval($v_0.HiddenScript)},getGlobalCommands:function(){ULS04Z:;return this.getToolbarCommands()},getFocusedCommands:function(){ULS04Z:;return []},getToolbarCommands:function(){ULS04Z:;var c=[],a=this._componentData;for(var b in a){var d={key:b,value:a[b]};Array.add(c,d.key)}var a=this._controlData;for(var b in a){var e={key:b,value:a[b]};Array.add(c,e.key)}return c},handleCommand:function(b){ULS04Z:;var a=this._controlData[b];if(SP.Ribbon.SU.$0(a))return false;this.executeClickScript(a.ClickScript);return true},executeClickScript:function(script){ULS04Z:;eval(script)},init:function(){ULS04Z:;this._controlData={};this._componentData={};this.ensureCommandInfoStructure()},isFocusable:function(){ULS04Z:;return false},receiveFocus:function(){ULS04Z:;throw Error.create("The ToolbarRibbonAdapter cannot receive focus.")},yieldFocus:function(){ULS04Z:;throw Error.create("The ToolbarRibbonAdapter cannot receive or yield focus.")},getId:function(){ULS04Z:;return this.$3W_1}};SP.Ribbon.WebPartPageComponentData=function(){ULS04Z:;SP.Ribbon.WebPartPageComponentData.initializeBase(this)};SP.Ribbon.WebPartPageComponent=function(b,a){ULS04Z:;SP.Ribbon.WebPartPageComponent.initializeBase(this,[b,a])};SP.Ribbon.WebPartPageComponent.prototype={isFocusable:function(){ULS04Z:;return true},$24_2:false,receiveFocus:function(){ULS04Z:;this.$24_2=true;return this.$24_2},yieldFocus:function(){ULS04Z:;this.$24_2=false;return true},get_webPartIsSelected:function(){ULS04Z:;return this.getId()===SP.Ribbon.WebPartComponent.get_pageComponentIdOfActiveWebPart()},canHandleCommand:function(a){ULS04Z:;if(this.get_alwaysEnabledCommands()[a])return true;return SP.Ribbon.WebPartPageComponent.callBaseMethod(this,"canHandleCommand",[a])},_alwaysEnabledCommands:null,get_alwaysEnabledCommands:function(){ULS04Z:;if(SP.Ribbon.SU.$0(this._alwaysEnabledCommands)){this._alwaysEnabledCommands={};this.addAlwaysEnabledCommands()}return this._alwaysEnabledCommands},addAlwaysEnabledCommands:function(){},simulateClick:function(a){ULS04Z:;if(Sys.Browser.agent===Sys.Browser.InternetExplorer)a.click();else SP.Ribbon.NativeUtility.ffClick(a)},executeOnClick:function(b){ULS04Z:;var a=b.attributes.getNamedItem("onclick").value;if(SP.Ribbon.SU.$0(a))b.click();else this.executeClickScript(a)},getGlobalCommands:function(){ULS04Z:;return this.getCommands()},getFocusedCommands:function(){ULS04Z:;return SP.Ribbon.WebPartPageComponent.callBaseMethod(this,"getFocusedCommands")},getCommands:function(){ULS04Z:;var c=SP.Ribbon.WebPartPageComponent.callBaseMethod(this,"getToolbarCommands"),a=this.get_alwaysEnabledCommands();for(var b in a){var d={key:b,value:a[b]};Array.add(c,d.key)}return c}};SP.Ribbon.ListViewWebPartPageComponentData=function(){ULS04Z:;SP.Ribbon.ListViewWebPartPageComponentData.initializeBase(this)};SP.Ribbon.ListViewWebPartPageComponentData.prototype={ViewId:null,ViewName:null,ViewReadOnly:null,ListId:null,ListEnableAttachments:null,BaseViewId:null,ListBaseType:null,ListTemplateType:null,ListPermissions:null,ListFolderPermissions:null,ListHasExternalDataSource:null,ServerRelativeWebUrl:null};SP.Ribbon.PagingInformation=function(){};SP.Ribbon.PagingInformation.prototype={NextNode:null,PreviousNode:null,CurrentRange:null};SP.Ribbon.ECBMenuItem=function(){ULS04Z:;SP.Ribbon.ECBMenuItem.initializeBase(this)};SP.Ribbon.ECBMenuItem.prototype={CUICommand:null,CUIEnabledCommands:null,onMenuClick:null,IsSubMenu:false};SP.Ribbon.CLVP=function(){};SP.Ribbon.CLVP.prototype={CUIItemInfo:null,ctx:null};SP.Ribbon.ListViewWebPartData=function(){ULS04Z:;SP.Ribbon.ListViewWebPartData.initializeBase(this)};SP.Ribbon.ListViewWebPartData.prototype={WebPartId:null,ViewDropDownOptions:null,NewMenuData:null};SP.Ribbon.ListViewWebPartPageComponent=function(id,data){ULS04Z:;this.$1a_3="/_layouts/$Resources:core,Language;/images/formatmap16x16.png".replace("$Resources:core,Language;",SP.Res.lcid);this.$1b_3="/_layouts/$Resources:core,Language;/images/formatmap32x32.png".replace("$Resources:core,Language;",SP.Res.lcid);SP.Ribbon.ListViewWebPartPageComponent.initializeBase(this,[id,data]);this.$b_3=data.ViewId;this.$2X_3=data.ViewName;this.$4N_3=data.ViewReadOnly==="true";this.$Z_3=data.ListId;this.$4G_3=data.ListEnableAttachments;this.$65_3=data.BaseViewId;this.$4F_3=data.ListBaseType;this.$2S_3=data.ListTemplateType;var $v_0=eval("("+data.ListPermissions+")");this.$l_3=new SP.BasePermissions;!this.$l_3.customFromJson($v_0)&&this.$l_3.fromJson($v_0);$v_0=eval("("+data.ListFolderPermissions+")");this.$1m_3=new SP.BasePermissions;!this.$1m_3.customFromJson($v_0)&&this.$1m_3.fromJson($v_0);this.$2R_3=data.ListHasExternalDataSource;this.$4M_3=data.ServerRelativeWebUrl};SP.Ribbon.ListViewWebPartPageComponent.navigateToView=function(b,a){ULS04Z:;if(SP.Ribbon.PageManager.get_instance().get_ribbon()&&!SP.ScriptUtility.isNullOrEmptyString(SP.Ribbon.PageManager.get_instance().get_ribbon().get_selectedTabId())){a=SP.Utilities.UrlBuilder.replaceOrAddQueryString(a,"InitialTabId",SP.Ribbon.PageManager.get_instance().get_ribbon().get_selectedTabId());a=SP.Utilities.UrlBuilder.replaceOrAddQueryString(a,"VisibilityContext","WSSListAndLibrary")}window.STSNavigateToView(b,a)};SP.Ribbon.ListViewWebPartPageComponent.prototype={$b_3:null,$2X_3:null,$4N_3:false,$Z_3:null,$4G_3:null,$65_3:null,$4F_3:null,$2S_3:null,$4M_3:null,$l_3:null,$1m_3:null,$2R_3:null,$1P_3:null,$26_3:null,$1M_3:false,executeClickScript:function(a){ULS04Z:;SP.Ribbon.NativeUtility.executeClickScript(a,"{"+this.$b_3.toUpperCase()+"}")},$4A_3:function(){ULS04Z:;var b=window.location.search,a=b.match(SP.Ribbon.ListViewWebPartPageComponent.$4R_3);return a&&a.length>0},canHandleCommand:function(a){ULS04Z:;if(!SP.Ribbon.SU.$0(this.get_alwaysEnabledCommands()[a]))return true;if(a==="DisplayView"||a==="QueryDisplayView")return !SP.Ribbon.SU.$0(this.get_viewSelectorOptions());var b=SP.Ribbon.ListViewWebPartPageComponent.callBaseMethod(this,"canHandleCommand",[a]);if(b)return true;var c=this.getCountOfSelectedItems();if(a==="CustomViewsGroup"||a==="ViewsTab")return true;if(a==="ModifyView"||a==="ModifyThisView"||a==="PopulateModifyViewMenu"){if(SP.Ribbon.SU.$0(this.get_viewSelectorOptions())||this.$4A_3())return false;else if(this.$4N_3)return false;return this.get_viewSelectorOptions().showEditView}if(a==="ModifyViewInDesigner"){if(SP.Ribbon.SU.$0(this.get_viewSelectorOptions()))return false;return this.get_viewSelectorOptions().showEditView&&this.$2J_3()}if(a==="LibraryPermissions")return this.$l_3.has(63);if(a==="EditList")return this.$2J_3();if(a==="ManageCopies")return this.$62_3(c);if(a==="AttachFile")return this.$4G_3==="True"&&this.canHandleECBCommand("EditProperties")&&this.$64_3();if(a==="CreateView"){if(SP.Ribbon.SU.$0(this.get_viewSelectorOptions()))return false;return this.get_viewSelectorOptions().showCreateView}if(a==="CurrentPage")return true;if(a==="PreviousPage"){var d=this.$17_3();return !SP.Ribbon.SU.$0(d.PreviousNode)}if(a==="NextPage"){var e=this.$17_3();return !SP.Ribbon.SU.$0(e.NextNode)}if(a==="EditDefaultForms")return this.$l_3.has(19)&&!this.$4A_3();if(a==="EditDefaultForm")return true;if(a==="PopulateDefaultFormsForList")return true;if(a==="PopulateViewDropDown")return this.get_hasViewSelectorInfo();if(a==="EmailLibraryLink")return this.get_ctx();if(a==="DisplayDatasheetView")if(!b&&!SP.Ribbon.ListViewWebPartPageComponent.callBaseMethod(this,"canHandleCommand",["DisplayStandardView"]))return false;else return Sys.Browser.agent===Sys.Browser.InternetExplorer;else if(a==="DisplayStandardView")return true;else if(a==="NavigateUp")return CanNavigateUp(this.get_ctx());if(a==="QueryDisplayDatasheetView")return Sys.Browser.agent===Sys.Browser.InternetExplorer;if(a==="QueryDisplayStandardView")return true;if(a==="NavZoomIn"||a==="NavZoomOut"||a==="NavScrollTask")return true;if(a==="AssociateWorkflows"||a==="EditWorkflowSettings"||a==="PopulateManageWorkFlowsMenu"||a==="ManageWorkflows"||a==="CreateReusableWorkflowInDesigner"||a==="CreateWorkflowInDesigner"||a==="AddButton")return this.$2J_3()&&this.$2R_3!=="True";return this.canHandleECBCommand(a)},$62_3:function($p0){if($p0!==1)return false;var $v_0=this.$19_3(),$$dict_1_0=$v_0;for(var $$key_1_1 in $$dict_1_0){var $v_2={key:$$key_1_1,value:$$dict_1_0[$$key_1_1]},$v_3=$v_2.key.split(",");if($v_3[2]==="1")return false}if(this.$2R_3==="True")return false;if(!this.$1m_3.has(3))return false;var $v_1=eval("parseInt("+this.$2S_3+");");if($v_1===101||$v_1===109||$v_1===130||$v_1===115)return true;return false},$64_3:function(){ULS04Z:;var f=this.$19_3(),d=0,b=f;for(var c in b){var g={key:c,value:b[c]},e=g.key.split(",");if(e[2]==="1")return false;var a=e[1];if(a.indexOf(".0.")!==-1||a.indexOf(".1.")!==-1||a.indexOf(".2.")!==-1)return false;d++}return 1===d},handleCommand:function(a,b){ULS04Z:;var h=this.get_ctx(),f=this.getCountOfSelectedItems(),i=this._controlData[a];if(!SP.Ribbon.SU.$0(i)){this.executeClickScript(i.ClickScript);return true}else if(a==="PopulateModifyViewMenu"){b.PopulationXML=this.$5l_3();return true}else if(a==="ModifyView"||a==="ModifyThisView"){var g=new SP.Utilities.UrlBuilder(this.$16_3("ViewEdit.aspx")),p=new SP.Guid(this.$b_3);g.addKeyValueQueryString("List",this.$Z_3);g.addKeyValueQueryString("View",p.toString("B").toUpperCase());SP.Utilities.HttpUtility.appendSourceAndNavigateTo(g.get_url())}else if(a==="ModifyViewInDesigner")EditInSPD(document.URL,true);else if(a==="CreateView"){var j=new SP.Utilities.UrlBuilder(this.$16_3("ViewType.aspx"));j.addKeyValueQueryString("List",this.$Z_3);SP.Utilities.HttpUtility.appendSourceAndNavigateTo(j.get_url())}else if(a==="DisplayView"){if(!this.get_hasViewSelectorInfo())return false;this.executeClickScript(b["CommandValueId"])}else if(a==="QueryDisplayView"){b["Value"]=!SP.ScriptUtility.isNullOrEmptyString(this.$2X_3)?this.$2X_3:SP.Res.viewGroupDefault;return this.get_hasViewSelectorInfo()}else if(a==="QueryCurrentPage"){var k=this.$17_3();if(!SP.Ribbon.SU.$0(k.CurrentRange))b["Value"]=k.CurrentRange;else b["Value"]="";return true}else if(a==="PreviousPage"){var l=this.$17_3();!SP.Ribbon.SU.$0(l.PreviousNode)&&this.simulateClick(l.PreviousNode);return true}else if(a==="NextPage"){var m=this.$17_3();!SP.Ribbon.SU.$0(m.NextNode)&&this.simulateClick(m.NextNode);return true}if(a==="EditDefaultForms")return true;if(a==="EditDefaultForm"){var q=b["CommandValueId"];this.navigateToFormPageDesignMode(q);return true}else if(a==="PopulateDefaultFormsForList")if(SP.Ribbon.SU.$0(this.$11_3)){this.getDefaultFormsInfo();var r=b;r.PollAgainInterval=100;++this.$27_3;if(SP.Ribbon.SU.$0(this.$1O_3)&&this.$27_3>5)this.$1O_3=SP.UI.Notify.addNotification(SP.Utilities.HttpUtility.htmlEncode(SP.Res.genericLoading),true);return true}else{b.PopulationXML=this.$11_3;!SP.Ribbon.SU.$0(this.$1O_3)&&SP.UI.Notify.removeNotification(this.$1O_3);this.$27_3=0;return true}else if(a==="PopulateViewDropDown"){if(!this.get_hasViewSelectorInfo())return false;if(SP.Ribbon.SU.$0(this.$1Q_3)){this.getViewGroupInfo();var s=b;s.PollAgainInterval=100;return true}else{b.PopulationJSON=this.$1Q_3;return true}}else if(a==="QueryDisplayStandardView"){b["On"]=!SP.Ribbon.ListViewWebPartPageComponent.callBaseMethod(this,"canHandleCommand",["DisplayStandardView"]);return true}else if(a==="QueryDisplayDatasheetView"){b["On"]=SP.Ribbon.ListViewWebPartPageComponent.callBaseMethod(this,"canHandleCommand",["DisplayStandardView"]);return true}else if(a==="DisplayStandardView")return true;else if(a==="DisplayDatasheetView")return true;else if(a==="LibraryPermissions"){var n=new SP.Guid(this.$Z_3),c=this.$16_3("user.aspx")+"?obj="+SP.Utilities.HttpUtility.urlKeyValueEncode(n.toString("B").toUpperCase());if(this.$4F_3==="1"&&this.$2S_3!=="113")c=c+",doclib";else c=c+",list";c=c+"&list="+SP.Utilities.HttpUtility.urlKeyValueEncode(n.toString("B").toUpperCase());SP.Utilities.HttpUtility.navigateTo(c)}else if(a==="EditList")this.$1d_3("?Cmd=EditList",true);else if(a==="PopulateManageWorkFlowsMenu"){b.PopulationXML=this.$5k_3();return true}else if(a==="EditWorkflowSettings"||a==="ManageWorkflows"){var t=new SP.Guid(this.$Z_3),u=this.$16_3("wrksetng.aspx")+"?List="+SP.Utilities.HttpUtility.urlKeyValueEncode(t.toString("B").toUpperCase());SP.Utilities.HttpUtility.navigateTo(u)}else if(a==="AssociateWorkflows"){var v=new SP.Guid(this.$Z_3),w=this.$16_3("Addwrkfl.aspx")+"?List="+SP.Utilities.HttpUtility.urlKeyValueEncode(v.toString("B").toUpperCase());SP.Utilities.HttpUtility.navigateTo(w)}else if(a==="CreateWorkflowInDesigner")this.$1d_3("?Cmd=NewWorkFlow",true);else if(a==="CreateReusableWorkflowInDesigner")this.$1d_3("?Cmd=NewReusableWorkFlow",false);else if(a==="AddButton")this.$1d_3("?Cmd=AddButton",true);else if(a==="NavigateUp"){NavigateUp(this.get_ctx());SP.Ribbon.PageManager.get_instance().get_commandDispatcher().executeCommand("appstatechanged",b)}else if(a==="ManageCopies"){if(f===1){var x=this.get_ctx();ManageCopies(x)}}else if(a==="AttachFile"){if(f===1){var y=this.get_ctx();AttachFile(y)}}else if(a==="EmailLibraryLink"){var z=h.HttpRoot,A=SP.Utilities.HttpUtility.urlPathEncode(this.$5j_3(z)),d=this.get_$g().rootFolder;if(SP.Ribbon.SU.$0(d))d=h.listUrlDir;else d=SP.Utilities.HttpUtility.urlPathEncode(d);var o=new Sys.StringBuilder(A);o.append(d);SP.Ribbon.EMailLink.openMailerWithUrl(o.toString());return true}else if(a==="NavZoomIn")this.get_$2L_3().ZoomInGantt();else if(a==="NavZoomOut")this.get_$2L_3().ZoomOutGantt();else if(a==="NavScrollTask")this.get_$2L_3().ScrollGanttToTask();else{this.$1M_3=true;if(f===1&&!this.$3d_3(a)&&this.$4b_3())return this.$3q(a);else{var e=this.get_ctx();if(a==="CheckOut")CheckoutSelectedItems(e);else if(a==="CheckIn")CheckinSelectedItems(e);else if(a==="Delete")DeleteSelectedItems(e);else if(a==="DiscardCheckOut")DiscardCheckoutSelectedItems(e);else return false}}return false},$2J_3:function(){ULS04Z:;return this.$l_3.has(12)&&this.$l_3.has(19)},$1d_3:function(c,d){ULS04Z:;var b=new SP.Guid(this.$Z_3),a=new Sys.StringBuilder;a.append(SP.PageContextInfo.get_webServerRelativeUrl());a.toString()!=="/"&&a.append("/");a.append(c);if(d){a.append("&ListId=");a.append(b.toString("B").toUpperCase())}EditInSPD(a.toString(),true)},$16_3:function(a){ULS04Z:;return SP.Utilities.UrlBuilder.urlCombine(this.$4M_3,"_layouts/"+a)},getGlobalCommands:function(){ULS04Z:;return []},$5j_3:function(a){ULS04Z:;if(SP.Ribbon.SU.$0(a))return "";var g=a.length,c=a.indexOf("://");if(c!==-1){var d=c+3,b=g-1,e=d<b?d:b,h=a.substr(e,b),f=h.indexOf("/");if(f!==-1)return a.substr(0,e+f)}return a},getFocusedCommands:function(){ULS04Z:;var a=SP.Ribbon.ListViewWebPartPageComponent.callBaseMethod(this,"getCommands");Array.add(a,"ModifyThisView");Array.add(a,"ModifyView");Array.add(a,"PopulateModifyViewMenu");Array.add(a,"ModifyViewInDesigner");Array.add(a,"PopulateViewDropDown");Array.add(a,"NextPage");Array.add(a,"CurrentPage");Array.add(a,"QueryCurrentPage");Array.add(a,"PreviousPage");Array.add(a,"LibraryPermissions");Array.add(a,"EditList");Array.add(a,"ManageCopies");Array.add(a,"AttachFile");Array.add(a,"DisplayExplorerView");Array.add(a,"EditDefaultForms");Array.add(a,"EditDefaultForm");Array.add(a,"PopulateDefaultFormsForList");Array.add(a,"EmailLibraryLink");Array.add(a,"Moderate");Array.add(a,"ChangeNewButton");Array.add(a,"QueryDisplayStandardView");Array.add(a,"QueryDisplayDatasheetView");Array.add(a,"ViewWorkflows");Array.add(a,"PopulateManageWorkFlowsMenu");Array.add(a,"ManageWorkflows");Array.add(a,"AssociateWorkflows");Array.add(a,"EditWorkflowSettings");Array.add(a,"CreateReusableWorkflowInDesigner");Array.add(a,"CreateWorkflowInDesigner");Array.add(a,"AddButton");Array.add(a,"NavigateUp");!Array.contains(a,"DisplayStandardView")&&Array.add(a,"DisplayStandardView");!Array.contains(a,"DisplayDatasheetView")&&Array.add(a,"DisplayDatasheetView");!Array.contains(a,"CreateView")&&Array.add(a,"CreateView");Array.add(a,"NavZoomIn");Array.add(a,"NavZoomOut");Array.add(a,"NavScrollTask");return a},$5l_3:function(){ULS04Z:;var a=new Sys.StringBuilder;a.append("<Menu Id='Ribbon.List.CustomViews.ModifyView.Menu'>");a.append("<MenuSection DisplayMode='Menu' Id='Ribbon.List.CustomViews.ModifyView.Menu.Manage'>");a.append("<Controls Id='Ribbon.List.CustomViews.ModifyView.Menu.Manage.Controls'>");a.append("<Button");a.append(" Id='Ribbon.List.CustomViews.ModifyView.Menu.Manage.ModifyView'");a.append(" Command='");a.append("ModifyView");a.append("'");a.append(" LabelText='");a.append(SP.Utilities.HttpUtility.htmlEncode(SP.Res.modifyViewLabel));a.append("'");a.append("/>");a.append("<Button");a.append(" Id='Ribbon.List.CustomViews.ModifyView.Menu.Manage.ModifyViewInDesigner'");a.append(" Command='");a.append("ModifyViewInDesigner");a.append("'");a.append(" LabelText='");a.append(SP.Utilities.HttpUtility.htmlEncode(SP.Res.modifyInDesignerLabel));a.append("'");a.append("/>");a.append("</Controls>");a.append("</MenuSection>");a.append("</Menu>");return a.toString()},$5k_3:function(){ULS04Z:;var a=new Sys.StringBuilder;a.append("<Menu Id='Ribbon.List.Settings.ManageWorkflows.Menu'>");a.append("<MenuSection DisplayMode='Menu' Id='Ribbon.List.Settings.ManageWorkflows.Menu.Manage'>");a.append("<Controls Id='Ribbon.List.Settings.ManageWorkflows.Menu.Manage.Controls'>");a.append("<Button");a.append(" Id='Ribbon.List.Settings.ManageWorkflows.Menu.Manage.EditSettings'");a.append(" Command='");a.append("EditWorkflowSettings");a.append("'");a.append(" MenuItemId='Ribbon.List.Settings.ManageWorkflows.Menu.Manage.WorkflowSettings.Menu'");a.append(" LabelText='");a.append(SP.Utilities.HttpUtility.htmlEncode(SP.Res.workflowSettingsLabel));a.append("'");a.append("/>");a.append("<Button");a.append(" Id='Ribbon.List.Settings.ManageWorkflows.Menu.Manage.Associate'");a.append(" Command='");a.append("AssociateWorkflows");a.append("'");a.append(" MenuItemId='Ribbon.List.Settings.ManageWorkflows.Menu.Manage.Associate.Menu'");a.append(" LabelText='");a.append(SP.Utilities.HttpUtility.htmlEncode(SP.Res.associateWorkflowLabel));a.append("'");a.append("/>");a.append("</Controls>");a.append("</MenuSection>");a.append("<MenuSection DisplayMode='Menu' Id='Ribbon.List.Settings.ManageWorkflows.Menu.CreateInSP'>");a.append("<Controls Id='Ribbon.List.Settings.ManageWorkflows.Menu.CreateInSP.Controls'>");a.append("<Button");a.append(" Id='Ribbon.List.Settings.ManageWorkflows.Menu.CreateInSP.CreateWorkflowInDesigner'");a.append(" Command='");a.append("CreateWorkflowInDesigner");a.append("'");a.append(" LabelText='");a.append(SP.Utilities.HttpUtility.htmlEncode(SP.Res.createWorkflowInDesignerLabel));a.append("'");a.append("/>");a.append("<Button");a.append(" Id='Ribbon.List.Settings.ManageWorkflows.Menu.CreateInSP.CreateReusableWorkflowInDesigner'");a.append(" Command='");a.append("CreateReusableWorkflowInDesigner");a.append("'");a.append(" LabelText='");a.append(SP.Utilities.HttpUtility.htmlEncode(SP.Res.createReUsableWorkflowInDesignerLabel));a.append("'");a.append("/>");a.append("</Controls>");a.append("</MenuSection>");a.append("</Menu>");return a.toString()},addAlwaysEnabledCommands:function(){ULS04Z:;SP.Ribbon.ListViewWebPartPageComponent.callBaseMethod(this,"addAlwaysEnabledCommands");var a=this.get_alwaysEnabledCommands();a["ViewsTab"]=true;a["TrackTab"]=true;a["ViewFormatGroup"]=true;a["WorkflowGroup"]=true;a["DisplayView"]=true;a["QueryDisplayView"]=true;a["DatasheetGroup"]=true;a["ViewActionsGroup"]=true;a["CustomViewsGroup"]=true;a["NotificationsGroup"]=true;a["ShareGroup"]=true;a["GanttViewGroup"]=true;a["CurrentView"]=true},setEcbStateDirty:function(){ULS04Z:;this.$1M_3=true},$3q:function(d){ULS04Z:;var a=this.$p(d);if(SP.Ribbon.SU.$0(a))return false;var c=this.get_ctx(),b=a.onMenuClick;if(SP.Ribbon.SU.$0(b)){if(SP.Ribbon.SU.$0(a.attributes.getNamedItem("onmenuclick")))return false;b=a.attributes.getNamedItem("onmenuclick").value}if(!SP.Ribbon.SU.$0(b)){SP.Ribbon.NativeUtility.executeECBCommand(b,c);return true}else return false},$p:function(c){ULS04Z:;var a=this.$19_3(),b=this.$3y_3(a);return this.$3x_3(b,c)},$3x_3:function(e,f){ULS04Z:;for(var b=0;b<e.childNodes.length;b++){var c=e.childNodes[b];if(c.getAttributeNode("type").value!=="separator"){var a=c;if(a.CUICommand===f)return a;else if(a.IsSubMenu){var d=this.$3x_3(a,f);if(!SP.Ribbon.SU.$0(d))return d}}}return null},$19_3:function(){ULS04Z:;var a=null,b=this.get_ctx();a=GetSelectedItemsDict(b);return a},getCountOfSelectedItems:function(){ULS04Z:;var a=this.$19_3();if(SP.Ribbon.SU.$0(a))return 0;var b=this.get_ctx();return CountSelectedItems(b)},canHandleECBCommand:function(b){ULS04Z:;if(!this.$4b_3())return false;if(this.$1M_3){this.get_$g().CUIItemInfo=null;this.$1M_3=false}var a=this.$19_3();if(SP.Ribbon.SU.$0(a))return false;var c=this.getCountOfSelectedItems();if(c===1){if(!this.$5c_3(a))return false;var d=this.$3y_3(a);if(this.$2E_3(d,b))return true}else if(c>1&&this.$3d_3(b))return this.$4m_3(a,b);return false},$4b_3:function(){ULS04Z:;if(SP.Ribbon.SU.$0(this.get_ctx()))return false;var a=this.get_ctx();if(a)return a["listTemplate"]!=="106"||a["isXslView"];else return false},$4m_3:function(g,h){ULS04Z:;var c=this.get_$g();if(SP.Ribbon.SU.$0(c))return false;var a=g;for(var b in a){var e={key:b,value:a[b]},d=e.key.split(",");if(!this.$3n_3(c,d[1]))return false;var f=this.get_$g().CUIItemInfo[d[1]];if(!this.$2E_3(f,h))return false}return true},$3d_3:function(a){ULS04Z:;return a==="CheckOut"||a==="CheckIn"||a==="Delete"||a==="DiscardCheckOut"},$3y_3:function(f){ULS04Z:;var a=f;for(var b in a){var c={key:b,value:a[b]},d=c.key.split(","),e=this.get_$g().CUIItemInfo[d[1]];return e}return null},$2E_3:function(a,e){ULS04Z:;var b="cacheVal_"+e,f=a.getAttribute(b);if(!SP.Ribbon.SU.$0(f))return f==="TRUE";for(var c=0;c<a.childNodes.length;c++){var g=a.childNodes[c];if(g.getAttributeNode("type").value!=="separator"){var d=g;if(this.$67_3(d,e)){a.setAttribute(b,"TRUE");return true}else if(d.IsSubMenu){var h=this.$2E_3(d,e);if(h){a.setAttribute(b,"TRUE");return true}}}}a.setAttribute(b,"FALSE");return false},$67_3:function(b,c){ULS04Z:;if(SP.Ribbon.SU.$0(b.CUIEnabledCommands))return false;for(var a=0;a<b.CUIEnabledCommands.length;a++)if(b.CUIEnabledCommands[a]===c)return true;return false},$5c_3:function(f){ULS04Z:;var c=this.get_$g();if(SP.Ribbon.SU.$0(c))return false;var a=f;for(var b in a){var d={key:b,value:a[b]},e=d.key.split(",");if(!this.$3n_3(c,e[1]))return false}return true},$3n_3:function(c,d){ULS04Z:;var a=c.CUIItemInfo;if(SP.Ribbon.SU.$0(a)){a={};c.CUIItemInfo=a}var b=a[d];if(SP.Ribbon.SU.$0(b)){b=this.$4r_3(c,d);if(SP.Ribbon.SU.$0(b))return false;a[d]=b}return true},$4r_3:function(d,e){ULS04Z:;var a=window.itemTable;window.itemTable=d.GetEcbInfo(e);if(SP.Ribbon.SU.$0(window.itemTable))return null;var b=this.get_ctx();window.dict=GetSelectedItemsDict(b);var c=BuildMenuWithInit(b);window.itemTable=a;if(!a)a=null;return c},get_ctx:function(){ULS04Z:;var a=this.get_$g();if(!a)return null;else return a.ctx},get_$g:function(){ULS04Z:;var a=SP.Ribbon.NativeUtility.getCtxForView("{"+this.$b_3.toUpperCase()+"}");if(!a)return null;else return a.clvp},$1N_3:false,$11_3:null,$1O_3:null,$27_3:0,get_defaultFormsDropDownXml:function(){ULS04Z:;return this.$11_3},getDefaultFormsInfo:function(){ULS04Z:;if(this.$1N_3)return;this.$1N_3=true;var a=new SP.Guid(this.$Z_3);SP.Application.UI.DefaultFormsMenuBuilder.getDefaultFormsInformation(this,a)},onDefaultFormsInformationRetrieveSuccess:function(a){ULS04Z:;this.$1N_3=false;this.$11_3=this.$5S_3(a)},onDefaultFormsInformationRetrieveFailure:function(){ULS04Z:;this.$1N_3=false;this.$11_3=this.$3o_3(SP.Utilities.HttpUtility.htmlEncode(SP.Res.relationships_ListFormsFetchFailed))},$3a_3:function(c,a,b){ULS04Z:;if(!SP.ScriptUtility.isNullOrEmptyString(a.NewFormUrl)){var d=SP.Utilities.HttpUtility.htmlEncode(!b?SP.Res.relationships_DefaultNewForm:String.format(SP.Res.relationships_CTNewForm,a.ContentTypeName)),e="-176",f="-16",g="-256",h="-320";c.append('<Button \r\n                                    Id="Ribbon.List.Settings.EditDefaultForms.Menu.MS.EditDefaultFormNew'+b+'"\r\n                                    CommandValueId="'+SP.Utilities.HttpUtility.htmlEncode(a.NewFormUrl)+'"\r\n                                    Command="EditDefaultForm"\r\n                                    Image16by16="'+this.$1a_3+'"\r\n                                    Image16by16Top="'+e+'"\r\n                                    Image16by16Left="'+f+'"\r\n                                    Image32by32="'+this.$1b_3+'"\r\n                                    Image32by32Top="'+g+'"\r\n                                    Image32by32Left="'+h+'"\r\n                                    LabelText="'+d+'" \r\n                                />')}if(!SP.ScriptUtility.isNullOrEmptyString(a.DisplayFormUrl)){var i=SP.Utilities.HttpUtility.htmlEncode(!b?SP.Res.relationships_DefaultDisplayForm:String.format(SP.Res.relationships_CTDisplayForm,a.ContentTypeName)),j="-32",k="-80",l="-96",m="-448";c.append('<Button \r\n                                    Id="Ribbon.List.Settings.EditDefaultForms.Menu.MS.EditDefaultFormDisplay'+b+'"\r\n                                    CommandValueId="'+SP.Utilities.HttpUtility.htmlEncode(a.DisplayFormUrl)+'"\r\n                                    Command="EditDefaultForm"\r\n                                    Image16by16="'+this.$1a_3+'"\r\n                                    Image16by16Top="'+j+'"\r\n                                    Image16by16Left="'+k+'"\r\n                                    Image32by32="'+this.$1b_3+'"\r\n                                    Image32by32Top="'+l+'"\r\n                                    Image32by32Left="'+m+'"\r\n                                    LabelText="'+i+'" \r\n                                />')}if(!SP.ScriptUtility.isNullOrEmptyString(a.EditFormUrl)){var n=SP.Utilities.HttpUtility.htmlEncode(!b?SP.Res.relationships_DefaultEditForm:String.format(SP.Res.relationships_CTEditForm,a.ContentTypeName)),o="-128",p="-224",q="-128",r="-96";c.append('<Button \r\n                                    Id="Ribbon.List.Settings.EditDefaultForms.Menu.MS.EditDefaultFormEdit'+b+'"\r\n                                    CommandValueId="'+SP.Utilities.HttpUtility.htmlEncode(a.EditFormUrl)+'"\r\n                                    Command="EditDefaultForm"\r\n                                    Image16by16="'+this.$1a_3+'"\r\n                                    Image16by16Top="'+o+'"\r\n                                    Image16by16Left="'+p+'"\r\n                                    Image32by32="'+this.$1b_3+'"\r\n                                    Image32by32Top="'+q+'"\r\n                                    Image32by32Left="'+r+'"\r\n                                    LabelText="'+n+'" \r\n                                />')}},$5S_3:function(b){ULS04Z:;if(SP.ScriptUtility.isNullOrEmptyString(b.DefaultForms.DisplayFormUrl)&&SP.ScriptUtility.isNullOrEmptyString(b.DefaultForms.NewFormUrl)&&SP.ScriptUtility.isNullOrEmptyString(b.DefaultForms.EditFormUrl))return this.$3o_3(SP.Utilities.HttpUtility.htmlEncode(SP.Res.relationships_NoNewEditDisplayListForms));var a=new Sys.StringBuilder;a.append('\r\n                <Menu Id="Ribbon.List.Settings.EditDefaultForms.Menu">');a.append('\r\n                  <MenuSection Id="Ribbon.List.Settings.EditDefaultForms.Menu.Default" Scrollable="false" DisplayMode="Menu16">\r\n                    <Controls Id="Ribbon.List.Settings.EditDefaultForms.Menu.Default.Controls">');this.$3a_3(a,b.DefaultForms,0);a.append("\r\n                    </Controls>\r\n                  </MenuSection>");for(var d=new Sys.StringBuilder,c=0;c<b.OtherForms.length;++c){var e=b.OtherForms[c];this.$3a_3(d,e,c+1)}if(!d.isEmpty()){a.append(String.format('\r\n                  <MenuSection Title="{0}" Id="Ribbon.List.Settings.EditDefaultForms.Menu.Other" Scrollable="false" DisplayMode="Menu16">\r\n                    <Controls Id="Ribbon.List.Settings.EditDefaultForms.Menu.Other.Controls">',SP.Utilities.HttpUtility.htmlEncode(SP.Res.relationships_CTForms)));a.append(d.toString());a.append("\r\n                    </Controls>\r\n                  </MenuSection>")}a.append("\r\n                </Menu>");return a.toString()},$3o_3:function(b){ULS04Z:;var a=new Sys.StringBuilder;a.append('\r\n                <Menu Id="Ribbon.List.Settings.EditDefaultForms.Menu">');a.append('\r\n                  <MenuSection Id="Ribbon.List.Settings.EditDefaultForms.Menu.Default" Scrollable="false" DisplayMode="Menu16">\r\n                    <Controls Id="Ribbon.List.Settings.EditDefaultForms.Menu.Default.Controls">');a.append('\r\n                    <Button \r\n                        Id="Ribbon.List.Settings.EditDefaultForms.Menu.MS.ListFormFetchErrorMessage"\r\n                        Image16by16="/_layouts/images/edit.gif"\r\n                        Image32by32="/_layouts/images/placeholder32x32.png"\r\n                        LabelText="'+b+'"\r\n                    />');a.append("\r\n                    </Controls>\r\n                  </MenuSection>");a.append("\r\n                </Menu>");return a.toString()},navigateToFormPageDesignMode:function(b){ULS04Z:;var a=new SP.Utilities.UrlBuilder(b);a.addKeyValueQueryString("DisplayMode","Design");a.addKeyValueQueryString("InitialTabId","Ribbon.WebPartPage");a.addKeyValueQueryString("VisibilityContext","WSSWebPartPage");SP.Utilities.HttpUtility.appendSourceAndNavigateTo(a.get_url())},get_viewSelectorOptions:function(){ULS04Z:;if(SP.Ribbon.SU.$0(this.$1P_3)&&!SP.Ribbon.SU.$0(this.get_$15_3().ViewDropDownOptions))this.$1P_3=eval("("+this.get_$15_3().ViewDropDownOptions+")");return this.$1P_3},$3X_3:null,$22_3:false,$1Q_3:null,get_viewDropDownXml:function(){ULS04Z:;return this.$1Q_3},get_hasViewSelectorInfo:function(){ULS04Z:;return !SP.Ribbon.SU.$0(this.get_viewSelectorOptions())},getViewGroupInfo:function(){ULS04Z:;if(this.$22_3)return;this.$22_3=true;SP.Application.UI.ViewSelectorMenuBuilder.getViewInformation(this,this.$1P_3)},onViewInformationReturned:function(a){ULS04Z:;this.$3X_3=a;this.$22_3=false;this.$1Q_3=this.$5T_3(this.$3X_3)},$1T_3:function(g,b,c,j){ULS04Z:;var e=j.appendChild("MenuSection",{Id:b});if(!SP.Ribbon.SU.$0(g))e.get_attributes()["Title"]=g;for(var f=e.appendChild("Controls",{Id:b+".Controls"}),a=0;a<c.length;a++){if(SP.Application.UI.ViewSelectorSubMenu.isInstanceOfType(c[a])){var i=c[a];this.$4k_3(i,b,f)}var d=c[a],h=this.$2F_3(d);this.$29_3(d.Text,b+"."+d.Id.toString(),h,f)}},$2F_3:function(a){ULS04Z:;return a.ActionScriptText},$4k_3:function(f,m,n){ULS04Z:;var a=m+".SubMenu",g=f.Text,b=SP.Ribbon.SU.$0(g),c="";if(!b)c=g;var h=n.appendChild("FlyoutAnchor",{Id:a,Command:"PopulateViewDropDown"});if(!b)h.get_attributes()["Title"]=c;a+=".Menu";var j=h.appendChild("Menu",{Id:a});a+=".SubMenu1";var i=j.appendChild("MenuSection",{Id:a});if(!b)i.get_attributes()["Title"]=c;for(var k=i.appendChild("Controls",{Id:a+".Controls"}),d=0;d<f.SubMenuItems.length;d++){var e=f.SubMenuItems[d],l=this.$2F_3(e);this.$29_3(e.Text,a+"."+e.Id.toString(),l,k)}},$29_3:function(a,d,b,e){ULS04Z:;var c=!SP.Ribbon.SU.$2(a)?a:SP.Res.viewGroupDefault;e.appendChild("Button",{Id:d,MenuItemId:b,CommandValueId:b,CommandType:"OptionSelection",Command:"DisplayView",LabelText:c})},$5T_3:function(a){ULS04Z:;var b=new CUI.JsonXmlElement("Menu",{Id:this.get_viewDropDownIdPrefix()+".Menu"});if(a.DefaultView){var c=b.appendChild("MenuSection",{Title:SP.Res.viewGroupDefault,Id:this.get_viewDropDownIdPrefix()+".Menu.DefaultView"}).appendChild("Controls",{Id:this.get_viewDropDownIdPrefix()+".Menu.DefaultView.Controls"});this.$29_3(a.DefaultView.Text,this.get_viewDropDownIdPrefix()+".Menu.DefaultView.DefaultView."+a.DefaultView.Id.toString(),this.$2F_3(a.DefaultView),c)}a.PersonalViews.length>0&&this.$1T_3(SP.Res.viewGroupPersonal,this.get_viewDropDownIdPrefix()+".Menu.Personal",a.PersonalViews,b);a.PublicViews.length>0&&this.$1T_3(SP.Res.viewGroupPublic,this.get_viewDropDownIdPrefix()+".Menu.Public",a.PublicViews,b);a.ModeratedViews.length>0&&this.$1T_3(SP.Res.viewGroupModerated,this.get_viewDropDownIdPrefix()+".Menu.Moderated",a.ModeratedViews,b);a.OtherViews.length>0&&this.$1T_3(SP.Res.viewGroupOther,this.get_viewDropDownIdPrefix()+".Menu.Other",a.OtherViews,b);return b},get_newMenuRecords:function(){ULS04Z:;if(SP.Ribbon.SU.$0(this.$26_3)&&!SP.Ribbon.SU.$0(this.get_$15_3().NewMenuData))this.$26_3=eval(this.get_$15_3().NewMenuData);return this.$26_3},getDefaultNewMenuItemScript:function(){ULS04Z:;if(this.get_newMenuData().length>0){var a=this.get_newMenuData()[0];if(!SP.ScriptUtility.isNullOrUndefined(a.CommandValueId))return a.CommandValueId;else if(!SP.ScriptUtility.isNullOrUndefined(a.ClickScript))return a.ClickScript;else return null}return null},$d_3:null,get_newMenuData:function(){ULS04Z:;if(SP.Ribbon.SU.$0(this.$d_3))this.$d_3=eval("("+this.get_$15_3().NewMenuData+")");return this.$d_3},getNewMenuXml:function(d,b){ULS04Z:;for(var c=new CUI.JsonXmlElement("Menu",{Id:b}),e=c.appendChild("MenuSection",{DisplayMode:"Menu32",Id:b+".Menu.ContentTypes"}).appendChild("Controls",{Id:b+".Menu.ContentTypes.Controls"}),a=0;a<this.get_newMenuData().length;a++)this.$4j_3(b+".Menu.ContentTypes."+a.toString(),d,this.$d_3[a].ClickScript,this.$d_3[a].LabelText,this.$d_3[a].Description,this.$d_3[a].Image32by32,e);return c},$4j_3:function(b,c,a,d,e,f,g){ULS04Z:;g.appendChild("Button",{Id:b,Command:c,MenuItemId:a,CommandValueId:a,CommandType:"OptionSelection",LabelText:d,Description:e,Image32by32:f})},$17_3:function(){ULS04Z:;var b=new SP.Ribbon.PagingInformation,e="WPQ1",c=this.getId();if(c.startsWith("WebPart")&&c.length>7)e=c.substring(7,c.length);var f=$get("bottomPagingCell"+e);if(!SP.Ribbon.SU.$0(f))for(var g=f.firstChild.firstChild.firstChild,d=0;d<g.childNodes.length;d++){var a=g.childNodes[d];if(a.className==="ms-paging")b.CurrentRange=SP.UI.UIUtility.getInnerText(a);else if(a.firstChild.firstChild.src.endsWith("prev.gif"))b.PreviousNode=a.firstChild;else if(a.firstChild.firstChild.src.endsWith("next.gif"))b.NextNode=a.firstChild}return b},get_$2L_3:function(){ULS04Z:;return window.self[this.getId()+"_JSGridController"]},get_$15_3:function(){ULS04Z:;return this._data},get_viewDropDownIdPrefix:function(){ULS04Z:;return "Ribbon.List.CustomViews.DisplayView"}};SP.Ribbon.ListFormWebPartPageComponentData=function(){ULS04Z:;SP.Ribbon.ListFormWebPartPageComponentData.initializeBase(this)};SP.Ribbon.ListFormWebPartPageComponentData.prototype={ViewId:null};SP.Ribbon.ListFormWebPartPageComponent=function(b,a){ULS04Z:;SP.Ribbon.ListFormWebPartPageComponent.initializeBase(this,[b,a]);this.$b_3=a.ViewId};SP.Ribbon.ListFormWebPartPageComponent.prototype={$b_3:null,canHandleCommand:function(a){ULS04Z:;if(a==="Ribbon.ListForm.Edit.Clipboard.Cut"||a==="Ribbon.ListForm.Edit.Clipboard.Copy"||a==="Ribbon.ListForm.Edit.Clipboard.Paste")return true;if(!SP.Ribbon.SU.$0(this.get_alwaysEnabledCommands()[a]))return true;var b=this._controlData[a];if(!SP.Ribbon.SU.$0(b))if(b.Enabled==="False")return false;if(SP.Ribbon.ListFormWebPartPageComponent.callBaseMethod(this,"canHandleCommand",[a]))return true;return false},handleCommand:function(a){ULS04Z:;var b=this._controlData[a];if(!SP.Ribbon.SU.$0(b)){if(a==="Ribbon.ListForm.Edit.Commit.SaveAsDraft"||a==="Ribbon.ListForm.Edit.Commit.Publish"||a==="Ribbon.ListForm.Edit.Commit.CheckIn"||a==="Ribbon.ListForm.Edit.Commit.Cancel"||a==="Ribbon.ListForm.Display.Manage.ClaimReleaseTask"||a==="Ribbon.ListForm.Display.Manage.DeleteItemVersion"||a==="Ribbon.ListForm.Display.Manage.RestoreItemVersion"||a==="Ribbon.ListForm.Display.HealthActions.HealthRuleRunNow"||a==="Ribbon.ListForm.Display.HealthActions.HealthReportRunNow"||a==="Ribbon.ListForm.Display.HealthActions.HealthReportRepair"){var h=$get(b.ElementClientId);h&&this.simulateClick(h)}else if(a==="Ribbon.ListForm.Display.Manage.DeleteItem"){var c="",e="";if(!SP.Ribbon.SU.$2(b.ClickScript))if(b.ClickScript.indexOf("DeleteInstanceConfirmation()")!==-1)e="DeleteInstanceConfirmation()";else if(b.ClickScript.indexOf("DeleteItemConfirmation()")!==-1)e="DeleteItemConfirmation()";var f=$get(b.ElementClientId);if(f&&!SP.Ribbon.SU.$2(e)){c=f.getAttribute("href");if(!SP.Ribbon.SU.$2(c)){c=c.replace("javascript:","");c="if("+e+"){"+c+";};"}}if(!SP.Ribbon.SU.$2(c))this.executeClickScript(c);else f&&this.simulateClick(f)}else if(a==="Ribbon.ListForm.Display.Solution.ActivateSolution"||a==="Ribbon.ListForm.Display.Solution.DeactivateSolution"||a==="Ribbon.ListForm.Display.Solution.UpgradeSolution"){var g=$get(b.ElementClientId),d="";if(g){d=g.getAttribute("href");if(!SP.Ribbon.SU.$2(d))d=d.replace("javascript:","")}if(!SP.Ribbon.SU.$2(d))this.executeClickScript(d);else g&&this.simulateClick(g)}else!SP.Ribbon.SU.$2(b.ClickScript)&&this.executeClickScript(b.ClickScript);return true}if(a==="Ribbon.ListForm.Edit.Clipboard.Cut"){this.executeClipboardCommand("Cut");return true}else if(a==="Ribbon.ListForm.Edit.Clipboard.Copy"){this.executeClipboardCommand("Copy");return true}else if(a==="Ribbon.ListForm.Edit.Clipboard.Paste"){this.executeClipboardCommand("Paste");return true}return false},executeClipboardCommand:function(a){ULS04Z:;try{document.body.ownerDocument.execCommand(a,false,null)}catch(b){alert(SP.Res.errorClipboard)}},executeClickScript:function(a){ULS04Z:;SP.Ribbon.NativeUtility.executeClickScriptSimple(a)},getGlobalCommands:function(){ULS04Z:;var a=SP.Ribbon.ListFormWebPartPageComponent.callBaseMethod(this,"getGlobalCommands");Array.add(a,"Ribbon.ListForm.Edit.Clipboard.Paste");Array.add(a,"Ribbon.ListForm.Edit.Clipboard.Copy");Array.add(a,"Ribbon.ListForm.Edit.Clipboard.Cut");return a},getFocusedCommands:function(){ULS04Z:;return SP.Ribbon.ListFormWebPartPageComponent.callBaseMethod(this,"getFocusedCommands")},addAlwaysEnabledCommands:function(){ULS04Z:;var a=this.get_alwaysEnabledCommands();a["Ribbon.ListForm.Edit"]=true;a["Ribbon.ListForm.Edit.CommitGroup"]=true;a["Ribbon.ListForm.Edit.ActionsGroup"]=true;a["Ribbon.ListForm.Edit.ClipboardGroup"]=true;a["Ribbon.ListForm.Display"]=true;a["Ribbon.ListForm.Display.ManageGroup"]=true;a["Ribbon.ListForm.Display.HealthActionsGroup"]=true;a["Ribbon.ListForm.Display.Solution.SolutionGroup"]=true;a["Ribbon.ListForm.Display.ActionsGroup"]=true},isFocusable:function(){ULS04Z:;return false}};SP.Ribbon.DocLibWebPartPageComponent=function(b,a){ULS04Z:;SP.Ribbon.DocLibWebPartPageComponent.initializeBase(this,[b,a]);this.$b_4=a.ViewId};SP.Ribbon.DocLibWebPartPageComponent.prototype={$b_4:null,handleCommand:function(a,b,c){ULS04Z:;var f=this.get_ctx(),g=this.getCountOfSelectedItems();if(a==="PopulateSendToMenu"){b.PopulationXML=this.$5p_4();return true}else if(a==="PopulateNewDocumentMenu"){b.PopulationJSON=this.getNewMenuXml("NewDocument","Ribbon.Document.All.NewDocument");return true}else if(a==="NewDocument"){var d=b["CommandValueId"];this.executeClickScript(d);return true}else if(a==="NewDefaultDocument"){this.executeClickScript(this.getDefaultNewMenuItemScript());return true}else if(a==="SendToOfficialFile"){var e=b["CommandValueId"];this.$3q(e);return true}return SP.Ribbon.DocLibWebPartPageComponent.callBaseMethod(this,"handleCommand",[a,b,c])},addAlwaysEnabledCommands:function(){ULS04Z:;SP.Ribbon.DocLibWebPartPageComponent.callBaseMethod(this,"addAlwaysEnabledCommands");var a=this.get_alwaysEnabledCommands();a["DocumentNewGroup"]=true;a["DocumentTab"]=true;a["DocumentEditCheckoutGroup"]=true;a["DocumentCopiesGroup"]=true;a["DocumentManageGroup"]=true;a["DocumentPublishingGroup"]=true;a["FormActionsGroup"]=true;a["DocumentsQuickStepsGroup"]=true;a["LibraryTab"]=true;a["SettingsGroup"]=true;a["ActionsGroup"]=true;a["LibraryNavigationGroup"]=true},canHandleCommand:function(a){ULS04Z:;if(a==="UploadDocumentMenuOpen")return SP.Ribbon.DocLibWebPartPageComponent.callBaseMethod(this,"canHandleCommand",["UploadDocument"]);if(a==="NewDefaultDocument"||a==="PopulateNewDocumentMenu"||a==="NewDocument")return !SP.Ribbon.SU.$0(this.get_newMenuData());if(a==="NewDocumentMenuOpen"){if(SP.Ribbon.SU.$0(this.get_newMenuData()))return false;return this.get_newMenuData().length>0}if(a==="SendToOfficialFile")return this.canHandleECBCommand("SendToOfficialFile0");return SP.Ribbon.DocLibWebPartPageComponent.callBaseMethod(this,"canHandleCommand",[a])},$5p_4:function(){ULS04Z:;var b,a=new Sys.StringBuilder;a.append("<Menu Id='Ribbon.Document.All.SendTo.Menu'>");a.append("<MenuSection Id='Ribbon.Document.All.SendTo.Menu.Items' DisplayMode='Menu16'>");a.append("<Controls Id='Ribbon.Document.All.SendTo.Menu.Items.Controls'>");if(this.canHandleECBCommand("SendToRecommendedLocation")){a.append("<Button");a.append(" Id='Ribbon.Document.All.SendTo.Menu.Items.RecommendedLocation'");a.append(" Command='");a.append("SendToRecommendedLocation");a.append("' LabelText='");b=this.$p("SendToRecommendedLocation");a.append(SP.Utilities.HttpUtility.htmlEncode(b.attributes.getNamedItem("text").value));a.append("'");a.append("/>")}if(this.canHandleECBCommand("SendToExistingCopies")){a.append("<Button");a.append(" Id='Ribbon.Document.All.SendTo.Menu.Items.ExistingCopies'");a.append(" Command='");a.append("SendToExistingCopies");a.append("' Image16by16='/_layouts/images/existingLocations.gif'");a.append(" LabelText='");b=this.$p("SendToExistingCopies");a.append(SP.Utilities.HttpUtility.htmlEncode(b.attributes.getNamedItem("text").value));a.append("'");a.append("/>")}a.append("<Button");a.append(" Id='Ribbon.Document.All.SendTo.Menu.Items.OtherLocation'");a.append(" Command='");a.append("SendToOtherLocation");a.append("' Image16by16='/_layouts/images/sendOtherLoc.gif'");a.append(" LabelText='");b=this.$p("SendToOtherLocation");if(!SP.Ribbon.SU.$0(b))a.append(SP.Utilities.HttpUtility.htmlEncode(b.attributes.getNamedItem("text").value));else a.append(SP.Utilities.HttpUtility.htmlEncode(SP.Res.sendToOtherLocation));a.append("'");a.append("/>");var d=0;while(true){var c="SendToOfficialFile"+d.toString();if(this.canHandleECBCommand(c)){a.append("<Button");a.append(" Id='Ribbon.Document.All.SendTo.Menu.Items.OfficialFile");a.append(d.toString());a.append("'");a.append(" Command='");a.append("SendToOfficialFile");a.append("'");a.append(" MenuItemId='");a.append(SP.Utilities.HttpUtility.htmlEncode(c));a.append("'");a.append(" CommandValueId='");a.append(SP.Utilities.HttpUtility.htmlEncode(c));a.append("'");a.append(" CommandType='OptionSelection'");a.append(" LabelText='");b=this.$p(c);a.append(SP.Utilities.HttpUtility.htmlEncode(b.attributes.getNamedItem("text").value));a.append("'");a.append("/>")}else break;d++}if(this.canHandleECBCommand("CreateDocumentWorkspace")){a.append("<Button");a.append(" Id='Ribbon.Document.All.SendTo.Menu.Items.CreateDocumentWorkspace'");a.append(" Command='");a.append("CreateDocumentWorkspace");a.append("' LabelText='");b=this.$p("CreateDocumentWorkspace");a.append(SP.Utilities.HttpUtility.htmlEncode(b.attributes.getNamedItem("text").value));a.append("'");a.append("/>")}a.append("</Controls>");a.append("</MenuSection>");a.append("</Menu>");return a.toString()},getGlobalCommands:function(){ULS04Z:;return SP.Ribbon.DocLibWebPartPageComponent.callBaseMethod(this,"getGlobalCommands")},getFocusedCommands:function(){ULS04Z:;var a=SP.Ribbon.DocLibWebPartPageComponent.callBaseMethod(this,"getFocusedCommands");Array.add(a,"ViewProperties");Array.add(a,"EditProperties");Array.add(a,"EditDocument");Array.add(a,"ManagePermissions");Array.add(a,"Delete");Array.add(a,"CheckOut");Array.add(a,"CheckIn");Array.add(a,"DiscardCheckOut");Array.add(a,"EmailLink");Array.add(a,"Publish");Array.add(a,"Unpublish");Array.add(a,"CancelApproval");Array.add(a,"ViewVersions");Array.add(a,"Subscribe");Array.add(a,"GotoSourceItem");Array.add(a,"SendTo");Array.add(a,"SendToOtherLocation");Array.add(a,"SendToExistingCopies");Array.add(a,"SendToRecommendedLocation");Array.add(a,"CreateDocumentWorkspace");Array.add(a,"PopulateSendToMenu");Array.add(a,"NewDocumentMenuOpen");Array.add(a,"DownloadCopy");Array.add(a,"EmailDocumentLink");Array.add(a,"SendToOfficialFile");Array.add(a,"NewDocument");Array.add(a,"PopulateNewDocumentMenu");Array.add(a,"NewDefaultDocument");Array.add(a,"UploadDocumentMenuOpen");return a},get_viewDropDownIdPrefix:function(){ULS04Z:;return "Ribbon.Library.CustomViews.DisplayView"}};SP.Ribbon.GenericListWebPartPageComponentData=function(){ULS04Z:;SP.Ribbon.GenericListWebPartPageComponentData.initializeBase(this)};SP.Ribbon.GenericListWebPartPageComponent=function(b,a){ULS04Z:;SP.Ribbon.GenericListWebPartPageComponent.initializeBase(this,[b,a])};SP.Ribbon.GenericListWebPartPageComponent.prototype={canHandleCommand:function(a){ULS04Z:;if(a==="NewListItemMenuOpen"){if(SP.Ribbon.SU.$0(this.get_newMenuData()))return false;return this.get_newMenuData().length>0}if(a==="NewDefaultListItem"||a==="PopulateNewListItemMenu"||a==="NewListItem")return !SP.Ribbon.SU.$0(this.get_newMenuData());if(SP.Ribbon.GenericListWebPartPageComponent.callBaseMethod(this,"canHandleCommand",[a]))return true;return false},handleCommand:function(a,b,c){ULS04Z:;if(a==="PopulateNewListItemMenu"){b.PopulationJSON=this.getNewMenuXml("NewListItem","Ribbon.Document.All.NewListItem");return true}else if(a==="NewListItem"){var d=b["CommandValueId"];this.executeClickScript(d);return true}else if(a==="NewDefaultListItem"){this.executeClickScript(this.getDefaultNewMenuItemScript());return true}return SP.Ribbon.GenericListWebPartPageComponent.callBaseMethod(this,"handleCommand",[a,b,c])},getGlobalCommands:function(){ULS04Z:;return SP.Ribbon.GenericListWebPartPageComponent.callBaseMethod(this,"getGlobalCommands")},getFocusedCommands:function(){ULS04Z:;var a=SP.Ribbon.GenericListWebPartPageComponent.callBaseMethod(this,"getFocusedCommands");Array.add(a,"ViewProperties");Array.add(a,"EditProperties");Array.add(a,"ManagePermissions");Array.add(a,"Delete");Array.add(a,"ViewVersions");Array.add(a,"Subscribe");Array.add(a,"NewListItemMenuOpen");Array.add(a,"NewDefaultListItem");Array.add(a,"PopulateNewListItemMenu");Array.add(a,"NewListItem");return a},addAlwaysEnabledCommands:function(){ULS04Z:;SP.Ribbon.GenericListWebPartPageComponent.callBaseMethod(this,"addAlwaysEnabledCommands");var a=this.get_alwaysEnabledCommands();a["ListItemTab"]=true;a["ListTab"]=true;a["ListItemManageGroup"]=true;a["ListItemNewGroup"]=true;a["ListItemPublishingGroup"]=true;a["ListItemWorkflowGroup"]=true;a["ListItemQuickStepsGroup"]=true;a["SettingsGroup"]=true;a["ActionsGroup"]=true;a["LibraryNavigationGroup"]=true}};SP.Ribbon.SolutionsPageComponent=function(b,a){ULS04Z:;SP.Ribbon.SolutionsPageComponent.initializeBase(this,[b,a]);this.$b_4=a.ViewId};SP.Ribbon.SolutionsPageComponent.prototype={$b_4:null,handleCommand:function(a,b,c){ULS04Z:;if(a==="DownloadSolutions"){window.DownloadSolutionHandler();return true}else return SP.Ribbon.SolutionsPageComponent.callBaseMethod(this,"handleCommand",[a,b,c])},get_alwaysEnabledCommands:function(){ULS04Z:;if(SP.Ribbon.SU.$0(this._alwaysEnabledCommands)){this._alwaysEnabledCommands=SP.Ribbon.SolutionsPageComponent.callBaseMethod(this,"get_alwaysEnabledCommands");this._alwaysEnabledCommands["NewDocument"]=true;this._alwaysEnabledCommands["UploadDocumentMenuOpen"]=true;this._alwaysEnabledCommands["SolutionTab"]=true;this._alwaysEnabledCommands["DocumentAllGroup"]=true;this._alwaysEnabledCommands["DocumentNewGroup"]=true;this._alwaysEnabledCommands["DocumentShareGroup"]=true;this._alwaysEnabledCommands["DocumentManageGroup"]=true;this._alwaysEnabledCommands["LibraryTab"]=true;this._alwaysEnabledCommands["SettingsGroup"]=true;this._alwaysEnabledCommands["ActionsGroup"]=true;this._alwaysEnabledCommands["LibraryNavigationGroup"]=true;this._alwaysEnabledCommands["DownloadSolutions"]=true}return this._alwaysEnabledCommands},canHandleCommand:function(a){ULS04Z:;if(a==="SolutionTab"||a==="LibraryTab")return true;return SP.Ribbon.SolutionsPageComponent.callBaseMethod(this,"canHandleCommand",[a])},getGlobalCommands:function(){ULS04Z:;var a=SP.Ribbon.SolutionsPageComponent.callBaseMethod(this,"getGlobalCommands");Array.add(a,"Delete");Array.add(a,"ActivateSolution");Array.add(a,"DeactivateSolution");Array.add(a,"UpgradeSolution");return a},getFocusedCommands:function(){ULS04Z:;return SP.Ribbon.SolutionsPageComponent.callBaseMethod(this,"getFocusedCommands")}};SP.Ribbon.WikiPageComponent=function(){ULS04Z:;this.$3S=Function.createDelegate(this,this.$6Q_1);this.$2u=Function.createDelegate(this,this.$55_1);this.$2q=Function.createDelegate(this,this.$51_1);this.$2k=Function.createDelegate(this,this.$4u_1);this.$2j=Function.createDelegate(this,this.$2C_1);this.$2o=Function.createDelegate(this,this.$4z_1);this.$39=Function.createDelegate(this,this.$5N_1);this.$34=Function.createDelegate(this,this.$5G_1);this.$32=Function.createDelegate(this,this.$5E_1);this.$35=Function.createDelegate(this,this.$5H_1);this.$36=Function.createDelegate(this,this.$1V_1);this.$3R=Function.createDelegate(this,this.$6N_1);SP.Ribbon.WikiPageComponent.initializeBase(this)};SP.Ribbon.WikiPageComponent.registerWithPageManager=function(a){ULS04Z:;if(!SP.Ribbon.WikiPageComponent.$3_1){SP.Ribbon.WikiPageComponent.$3_1=new SP.Ribbon.WikiPageComponent;SP.Ribbon.WikiPageComponent.$3_1.$1w(a);SP.Ribbon.PageManager.get_instance().addPageComponent(SP.Ribbon.WikiPageComponent.$3_1);SP.Ribbon.PageState.PageStateHandler.setHandleSaveMenu(false);if(a.editMode){SP.Ribbon.WikiPageComponent.$48_1();!SP.Ribbon.SU.$0(SP.Ribbon.WikiPageComponent.$S_1)&&SP.Ribbon.WikiPageComponent.$S_1.editingPageCallback()}!SP.Ribbon.SU.$2(a.conflictMergeTargetStatusHtml)&&SP.Ribbon.SaveConflictHandler.$6Y(a.conflictMergeTargetStatusHtml)}else SP.Ribbon.WikiPageComponent.$3_1.$1w(a)};SP.Ribbon.WikiPageComponent.unregisterWithPageManager=function(){ULS04Z:;if(SP.Ribbon.WikiPageComponent.$3_1){SP.Ribbon.PageManager.get_instance().removePageComponent(SP.Ribbon.WikiPageComponent.$3_1);SP.Ribbon.PageState.PageStateHandler.setHandleSaveMenu(true)}};SP.Ribbon.WikiPageComponent.get_instance=function(){ULS04Z:;return SP.Ribbon.WikiPageComponent.$3_1};SP.Ribbon.WikiPageComponent.$3g_1=function(){ULS04Z:;return !SP.Ribbon.WikiPageComponent.$P_1&&SP.Ribbon.WikiPageComponent.$D()};SP.Ribbon.WikiPageComponent.$3i_1=function(){ULS04Z:;return !SP.Ribbon.WikiPageComponent.$P_1&&SP.Ribbon.WikiPageComponent.$D()};SP.Ribbon.WikiPageComponent.$D=function(){ULS04Z:;var a=false,b=$get("_wikiPageMode");if(b)a=b.value==="Edit";return a};SP.Ribbon.WikiPageComponent.$4B=function(){ULS04Z:;return !SP.Ribbon.SU.$0($get("_wikiPageMode"))};SP.Ribbon.WikiPageComponent.$5I_1=function(f,d){ULS04Z:;var a=d[CUI.Controls.DropDownCommandProperties.SelectedItemId];if(SP.ScriptUtility.isNullOrUndefined(a))return false;var c=a.lastIndexOf(".");if(c<0)return false;var e=a.substring(0,c+1),b=e;if(SP.Ribbon.WikiPageComponent.$D())b+="SaveAndStop";else b+="Edit";d[CUI.Controls.DropDownCommandProperties.SelectedItemId]=b;return true};SP.Ribbon.WikiPageComponent.$48_1=function(){ULS04Z:;if(SP.Ribbon.WikiPageComponent.$1v_1)return;var a=window._spWikiPageNameEditorFlag;if(a)if(SP.Ribbon.SU.$0(SP.Ribbon.WikiPageComponent.$S_1)){var b=window._spWikiPageNameDisplayElemId,c=window._spWikiPageNameEditElemId,d=window._spWikiPageNameEditTextBoxId;SP.Ribbon.WikiPageComponent.$S_1=new SP.Application.UI.WikiPageNameInPlaceEditor(window.document,b,c,d)}SP.Ribbon.WikiPageComponent.$1v_1=true};SP.Ribbon.WikiPageComponent.$5J_1=function(b,a){ULS04Z:;a&&CUI.RibbonCommand.serverButton(a["SourceControlId"],a["MenuItemId"]);return true};SP.Ribbon.WikiPageComponent.$60_1=function(a,b,c,d){ULS04Z:;window._wikiCallback(a,b,c,d)};SP.Ribbon.WikiPageComponent.$4p_1=function(){ULS04Z:;var a=new Sys.StringBuilder;a.append("\r\n<table style='padding:10px;'>\r\n    <tr>\r\n        <td><img src='/_layouts/images/warning32by32.gif' alt='' /></td>\r\n        <td>");a.append(SP.Utilities.HttpUtility.htmlEncode(SP.Res.saveChangeDialogDesc));a.append("</td>\r\n    </tr>\r\n    <tr>\r\n        <td></td>\r\n        <td nowrap align='center'>\r\n            <input type='button' id='SaveDlgYes' class='ms-NarrowButtonHeightWidth' onclick='SP.Ribbon.WikiPageComponent.saveDialogClick(0)' value='");a.append(SP.Utilities.HttpUtility.htmlEncode(SP.Res.buttonYes));a.append("' />\r\n            <span class='ms-SpaceBetButtons'>&#160;</span>\r\n            <input type='button' id='SaveDlgNo' class='ms-NarrowButtonHeightWidth' onclick='SP.Ribbon.WikiPageComponent.saveDialogClick(1)' value='");a.append(SP.Utilities.HttpUtility.htmlEncode(SP.Res.buttonNo));a.append("' />\r\n            <span class='ms-SpaceBetButtons'>&#160;</span>\r\n            <input type='button' id='SaveDlgCancel' class='ms-NarrowButtonHeightWidth' onclick='SP.Ribbon.WikiPageComponent.saveDialogClick(2)' value='");a.append(SP.Utilities.HttpUtility.htmlEncode(SP.Res.buttonCancel));a.append("' />\r\n        </td>\r\n    </tr>\r\n    <tr><td style='height:3px;'></td></tr>\r\n</table>\r\n");var b=document.createElement("DIV");b.innerHTML=a.toString();b=b.getElementsByTagName("table")[0];return b};SP.Ribbon.WikiPageComponent.saveDialogClick=function(a){ULS04Z:;if(!a){SP.UI.ModalDialog.get_childDialog().set_returnValue("PageStateGroupSaveAndStop");SP.UI.ModalDialog.get_childDialog().close(1)}else if(a===1){SP.UI.ModalDialog.get_childDialog().set_returnValue("PageStateGroupDontSaveAndStop");SP.UI.ModalDialog.get_childDialog().close(1)}else SP.UI.ModalDialog.get_childDialog().close(0)};SP.Ribbon.WikiPageComponent.prototype={$1_1:null,$1w:function(b){ULS04Z:;this.$1_1=b;var a=this.$1_1.itemPermMasks;if(!SP.BasePermissions.isInstanceOfType(a)){this.$1_1.itemPermMasks=new SP.BasePermissions;!this.$1_1.itemPermMasks.customFromJson(a)&&this.$1_1.itemPermMasks.fromJson(a)}a=this.$1_1.listPermMasks;if(!SP.BasePermissions.isInstanceOfType(a)){this.$1_1.listPermMasks=new SP.BasePermissions;!this.$1_1.listPermMasks.customFromJson(a)&&this.$1_1.listPermMasks.fromJson(a)}},getGlobalCommands:function(){ULS04Z:;if(!SP.Ribbon.WikiPageComponent.$R_1)SP.Ribbon.WikiPageComponent.$R_1=["CheckoutMenuOpen","CPEditTab","PageStateGroupEdit","EditAndCheckoutGroup","EditMobilePageMenuOpen","EditInDesigner","EditingGroup","EditingToolsContextualGroup","RenamePage","LibrarySettingsGroup","LinksGroup","MediaGroup","NotificationsGroup","PageActionsGroup","PageLayoutGroup","PageStateGroupDontSaveAndStop","PageStateGroupSave","PageStateGroupSaveAndStop","PageStateGroupOpenMenuSave","PageStateGroupQuerySaveMenu","PageStateGroupSaveSplit","ServerButton","ShareGroup","PageStateGroupStopEditing","TablesGroup","TrackTab","WebPartsGroup","WikiEditWebPart","WikiPageTab"];return SP.Ribbon.WikiPageComponent.$R_1},canHandleCommand:function(e){ULS04Z:;this.$5x_1();var f=this.$M_1[e];if(!SP.Ribbon.SU.$0(f)){var g=f;return g()}if(!SP.Ribbon.WikiPageComponent.$v_1){SP.Ribbon.WikiPageComponent.$v_1={};var a=this.getGlobalCommands();if(a)for(var h=a.length,c=0;c<h;c++)SP.Ribbon.WikiPageComponent.$v_1[a[c]]=true;var b=this.getFocusedCommands();if(b)for(var i=b.length,d=0;d<i;d++)SP.Ribbon.WikiPageComponent.$v_1[b[d]]=true}return !SP.Ribbon.SU.$0(SP.Ribbon.WikiPageComponent.$v_1[e])},handleCommand:function(b,a,c){ULS04Z:;return this.$44_1(b,a,c)},$44_1:function(b,d,e){ULS04Z:;this.$47_1();var a=this.$H_1[b];if(!SP.Ribbon.SU.$0(a)){var c=a;return c(b,d,e)}return true},getId:function(){ULS04Z:;return "WikiPageComponent"},$4z_1:function(){ULS04Z:;return this.$2C_1()||SP.Ribbon.WikiPageComponent.$3g_1()||SP.Ribbon.WikiPageComponent.$3i_1()},$2C_1:function(){ULS04Z:;return !SP.Ribbon.WikiPageComponent.$P_1&&!SP.Ribbon.WikiPageComponent.$D()&&this.$1_1.editable},$4u_1:function(){ULS04Z:;return this.$2C_1()&&this.$1_1.listPermMasks.has(12)&&this.$1_1.listPermMasks.has(19)},$5E_1:function(d,a,c){ULS04Z:;var b=a["CommandValueId"];return this.$44_1(b,a,c)},get_$4Q_1:function(){ULS04Z:;if(window.SPAutoSaveIsPageDirty&&window.SPAutoSaveIsPageDirty())return true;return false},$5H_1:function($p0,$p1,$p2){if(!SP.Ribbon.WikiPageComponent.$P_1){CUI.PMetrics.perfMark(7111);var $v_0='<img src="/_layouts/images/loadingcirclests16.gif" style="vertical-align: middle" />';$v_0+=SP.Utilities.HttpUtility.htmlEncode(SP.Res.saving);var $v_1=SP.UI.Notify.addNotification($v_0,true),$v_2=$v_1,$v_3=Function.createDelegate(this,function($p1_0,$p1_1){SP.Ribbon.WikiPageComponent.$P_1=false;SP.UI.Notify.removeNotification($v_2);SP.Ribbon.PageState.PageStateHandler.ignoreNextUnload=false;if(!SP.Ribbon.SU.$2($p1_0))eval($p1_0);CUI.PMetrics.perfMark(7112)}),$v_4=Function.createDelegate(this,function(a){ULS04Z:;SP.Ribbon.WikiPageComponent.$P_1=false;SP.UI.Notify.removeNotification($v_2);SP.Ribbon.PageState.PageStateHandler.ignoreNextUnload=false;if(SP.Ribbon.SU.$2(a))a=SP.Res.saveFailed;alert(a)});SP.Ribbon.WikiPageComponent.$P_1=true;SP.Ribbon.WikiPageComponent.$60_1("PageStateGroupSave",$v_3,null,$v_4)}return true},$1V_1:function($p0,$p1,$p2){if(!SP.Ribbon.WikiPageComponent.$P_1){if("PageStateGroupStopEditing"===$p0)if(this.get_$4Q_1()){this.$6Z_1();return true}else $p0="PageStateGroupDontSaveAndStop";if($p0==="EditInDesigner"){EditInSPD(document.URL,false);return true}var $v_0=null,$v_1,$v_2='<img src="/_layouts/images/loadingcirclests16.gif" style="vertical-align: middle" />',$v_3=false;switch($p0){case "PageStateGroupEdit":$v_1="Ribbon.WikiPageTab.EditAndCheckout.SaveEdit.Menu.SaveEdit.Edit";$v_2+=SP.Utilities.HttpUtility.htmlEncode(SP.Res.autocompleteLoading);break;case "PageStateGroupDontSaveAndStop":$v_1="Ribbon.WikiPageTab.EditAndCheckout.SaveEdit.Menu.SaveEdit.Revert";$v_2+=SP.Utilities.HttpUtility.htmlEncode(SP.Res.genericLoading);$v_3=true;break;case "PageStateGroupSaveAndStop":$v_1="Ribbon.WikiPageTab.EditAndCheckout.SaveEdit.Menu.SaveEdit.SaveAndStop";$v_2+=SP.Utilities.HttpUtility.htmlEncode(SP.Res.saving);$v_3=true;break;default:return false}if($p0==="PageStateGroupEdit"&&(SP.Ribbon.PageState.ImportedNativeData.PageState["DocLibCheckoutRequired"]||this.$1_1.missingRequiredFields)&&!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsCheckedOutToCurrentUser"])if(!confirm(window.L_ConfirmCheckout_Text))return true;if($v_3)typeof window.SP.UI!=="undefined"&&typeof window.SP.UI.Rte!=="undefined"&&typeof window.SP.UI.Rte.SnapshotManager!=="undefined"&&typeof window.SP.UI.Rte.SnapshotManager.clear!=="undefined"&&window.SP.UI.Rte.SnapshotManager.clear();if(!SP.Ribbon.WebPartComponent.get_$63()&&($p0==="PageStateGroupDontSaveAndStop"||$p0==="PageStateGroupSaveAndStop")){var $v_4=$get("_wikiPageCommand");$v_4.value=$p0;$v_4=$get("MSOWebPartPage_Shared");if($v_4)$v_4.value="";$v_4=$get("MSOLayout_InDesignMode");if($v_4)$v_4.value="0";$v_4=$get("MSOSPWebPartManager_DisplayModeName");if($v_4)$v_4.value="Browse";var $v_5=this.$1_1.postbackScript;eval($v_5);return true}if(CUI.RibbonCommand.serverQueryButton($v_1))$v_0=SP.UI.Notify.addNotification($v_2,true);CUI.PMetrics.perfMark(7111);CUI.RibbonCommand.serverButton($v_1,null);if($v_0){SP.Ribbon.WikiPageComponent.$P_1=true;var $v_6=null,$v_7=$v_0,$v_8=Function.createDelegate(this,function(){ULS04Z:;$v_6&&Sys.WebForms.PageRequestManager.getInstance().remove_pageLoaded($v_6);$v_6=null;SP.Ribbon.UtilityInternal.$e();CUI.PMetrics.perfMark(7112)});$v_6=$v_8;Sys.WebForms.PageRequestManager.getInstance().add_pageLoaded($v_8);var $v_9=null,$v_A=Function.createDelegate(this,function(b,a){ULS04Z:;SP.UI.Notify.removeNotification($v_7);SP.Ribbon.WikiPageComponent.$P_1=false;if(!SP.Ribbon.SU.$0(a.get_error())){$v_6&&Sys.WebForms.PageRequestManager.getInstance().remove_pageLoaded($v_6);$v_6=null;$v_9&&Sys.WebForms.PageRequestManager.getInstance().remove_endRequest($v_9);$v_9=null;if(!a.get_errorHandled()){alert(a.get_error().message);a.set_errorHandled(true)}}});$v_9=$v_A;Sys.WebForms.PageRequestManager.getInstance().add_endRequest($v_A);switch($p0){case "PageStateGroupEdit":SP.Ribbon.WikiPageComponent.$48_1();!SP.Ribbon.SU.$0(SP.Ribbon.WikiPageComponent.$S_1)&&SP.Ribbon.WikiPageComponent.$S_1.editingPageCallback();break;case "PageStateGroupSaveAndStop":!SP.Ribbon.SU.$0(SP.Ribbon.WikiPageComponent.$S_1)&&SP.Ribbon.WikiPageComponent.$S_1.savingPageCallback()}}}return true},$51_1:function(){ULS04Z:;return SP.Ribbon.WikiPageComponent.$1v_1&&window._spWikiPageNameEditorFlag},$5G_1:function(){ULS04Z:;var a=SP.UI.$create_DialogOptions();a.url=SP.Utilities.Utility.getLayoutsPageUrl("RenamePageDialog.aspx");var b=window._spWikiPageNameDisplayElemId;a.url+="?Source="+document.URL;a.dialogReturnValueCallback=this.$3R;a.title=SP.Res.renamePageDialog_Title;SP.UI.ModalDialog.showModalDialog(a);return true},$6N_1:function(a,b){ULS04Z:;if(a!==-1&&!SP.Ribbon.SU.$0(b)){var c=window._spWikiPageNameEditTextBoxId;$get(c).value=b}a===1&&this.$1V_1("PageStateGroupSaveAndStop",null,0)},$55_1:function(){ULS04Z:;return this.$1_1.editable&&!SP.Ribbon.WikiPageComponent.$D()},$5N_1:function(){ULS04Z:;window.ChangeLayoutMode(false);return true},$H_1:null,$47_1:function(){ULS04Z:;if(this.$H_1)return;var a;this.$H_1={};a=this.$36;this.$H_1["PageStateGroupEdit"]=a;this.$H_1["PageStateGroupSaveAndStop"]=a;this.$H_1["PageStateGroupStopEditing"]=a;this.$H_1["PageStateGroupDontSaveAndStop"]=a;this.$H_1["EditInDesigner"]=a;a=this.$35;this.$H_1["PageStateGroupSave"]=a;this.$H_1["PageStateGroupQuerySaveMenu"]=SP.Ribbon.WikiPageComponent.$5I_1;this.$H_1["PageStateGroupSaveSplit"]=this.$32;this.$H_1["ServerButton"]=SP.Ribbon.WikiPageComponent.$5J_1;this.$H_1["RenamePage"]=this.$34;this.$H_1["WikiEditWebPart"]=this.$39},$M_1:null,$5x_1:function(){ULS04Z:;if(this.$M_1)return;var a;this.$M_1={};this.$M_1["PageStateGroupSaveSplit"]=this.$2o;this.$M_1["PageStateGroupEdit"]=this.$2j;this.$M_1["EditInDesigner"]=this.$2k;a=SP.Ribbon.WikiPageComponent.$3g_1;this.$M_1["PageStateGroupSave"]=a;this.$M_1["PageStateGroupSaveAndStop"]=a;this.$M_1["PageStateGroupStopEditing"]=SP.Ribbon.WikiPageComponent.$3i_1;this.$M_1["EditingToolsContextualGroup"]=SP.Ribbon.WikiPageComponent.$D;this.$M_1["RenamePage"]=this.$2q;a=this.$2u;this.$M_1["WikiEditWebPart"]=a},changeWikiPageMode:function(a){ULS04Z:;a&&!SP.Ribbon.WikiPageComponent.$D()&&this.$1V_1("PageStateGroupEdit",{},0)},revertToRead:function(){ULS04Z:;SP.Ribbon.SaveConflictHandler.$14()},$6Z_1:function(){ULS04Z:;var a=SP.UI.$create_DialogOptions();a.html=SP.Ribbon.WikiPageComponent.$4p_1();a.title=SP.Res.saveChangeDialogTitle;a.dialogReturnValueCallback=this.$3S;SP.UI.ModalDialog.showModalDialog(a);window.setTimeout(Function.createDelegate(this,function(){ULS04Z:;$get("SaveDlgYes")&&$get("SaveDlgYes").focus()}),0)},$6Q_1:function(a,b){ULS04Z:;a===1&&this.$1V_1(b,null,0)}};SP.Ribbon.FetchedDocLibItemInfo=function(){};SP.Ribbon.FetchedDocLibItemInfo.prototype={itemIsCheckedout:false,moderationStatus:0};SP.Ribbon.DocLibAspxPageComponent=function(b){ULS04Z:;this.$2x=Function.createDelegate(this,this.$58_1);this.$2z=Function.createDelegate(this,this.$5B_1);this.$37=Function.createDelegate(this,this.$5K_1);this.$2y=Function.createDelegate(this,this.$5A_1);this.$31=Function.createDelegate(this,this.$5D_1);this.$3A=Function.createDelegate(this,this.$5O_1);this.$38=Function.createDelegate(this,this.$5L_1);this.$33=Function.createDelegate(this,this.$5F_1);this.$30=Function.createDelegate(this,this.$5C_1);this.$2i=Function.createDelegate(this,this.$4t_1);this.$2s=Function.createDelegate(this,this.$53_1);this.$2m=Function.createDelegate(this,this.$4w_1);this.$2n=Function.createDelegate(this,this.$4y_1);this.$2v=Function.createDelegate(this,this.$56_1);this.$2p=Function.createDelegate(this,this.$50_1);this.$21=Function.createDelegate(this,this.$4x_1);this.$2l=Function.createDelegate(this,this.$4v_1);this.$2t=Function.createDelegate(this,this.$54_1);SP.Ribbon.DocLibAspxPageComponent.initializeBase(this);this.$1_1=b;var a=this.$1_1.itemPermMasks;if(!SP.BasePermissions.isInstanceOfType(a)){this.$1_1.itemPermMasks=new SP.BasePermissions;!this.$1_1.itemPermMasks.customFromJson(a)&&this.$1_1.itemPermMasks.fromJson(a)}a=this.$1_1.listPermMasks;if(!SP.BasePermissions.isInstanceOfType(a)){this.$1_1.listPermMasks=new SP.BasePermissions;!this.$1_1.listPermMasks.customFromJson(a)&&this.$1_1.listPermMasks.fromJson(a)}};SP.Ribbon.DocLibAspxPageComponent.registerWithPageManager=function(a){ULS04Z:;if(!SP.Ribbon.DocLibAspxPageComponent.$3_1){SP.Ribbon.DocLibAspxPageComponent.$3_1=new SP.Ribbon.DocLibAspxPageComponent(a);SP.Ribbon.PageManager.get_instance().addPageComponent(SP.Ribbon.DocLibAspxPageComponent.$3_1)}};SP.Ribbon.DocLibAspxPageComponent.get_instance=function(){ULS04Z:;return SP.Ribbon.DocLibAspxPageComponent.$3_1};SP.Ribbon.DocLibAspxPageComponent.$5M_1=function(){ULS04Z:;SP.Ribbon.WebPartComponent.$4Z(4,false);return true};SP.Ribbon.DocLibAspxPageComponent.$59_1=function(){ULS04Z:;if(SP.Ribbon.PageState.ImportedNativeData&&SP.Ribbon.PageState.ImportedNativeData.PageState&&SP.Ribbon.PageState.ImportedNativeData.PageState["DocLibCheckoutRequired"]&&!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsCheckedOutToCurrentUser"]&&!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsCheckedOutToOtherUser"]){var a=document.URL;a=a.split("?")[0].split("#")[0];a=window.unescapeProperly(a);var b=window.location.protocol+"//"+window.location.host+SP.PageContextInfo.get_webServerRelativeUrl();if(b.endsWith("/"))b=b.substring(0,b.length-1);if(!CheckoutAlertBeforeNavigate(null,true,false,a,b))return true}SP.Ribbon.WebPartComponent.$4Z(6,true);return true};SP.Ribbon.DocLibAspxPageComponent.$3l_1=function(){ULS04Z:;SP.Ribbon.WebPartComponent.$6C();return true};SP.Ribbon.DocLibAspxPageComponent.$3h=function(){ULS04Z:;return SP.Ribbon.Utility.get_$U()&&SP.Ribbon.Utility.get_$U().has(31)};SP.Ribbon.DocLibAspxPageComponent.$3k=function(){ULS04Z:;window.SetHomePage(SP.PageContextInfo.get_webServerRelativeUrl());return true};SP.Ribbon.DocLibAspxPageComponent.prototype={$1_1:null,get_allowInsertNewList:function(){ULS04Z:;return SP.Ribbon.Utility.get_$U()&&SP.Ribbon.Utility.get_$U().has(12)},$6L:function(){ULS04Z:;this.$j_1=null;this.$2P_1=false;this.$3s_1()},$3s_1:function(){ULS04Z:;if(this.$2P_1)return;this.$2P_1=true;var a=new SP.ClientContext,c=a.get_web().get_lists().getById(new SP.Guid(this.$1_1.listId)),b=c.getItemById(this.$1_1.itemId);a.load(b,"_ModerationStatus","CheckoutUser");a.executeQueryAsync(Function.createDelegate(this,function(){ULS04Z:;this.$j_1=new SP.Ribbon.FetchedDocLibItemInfo;if(b.get_item("CheckoutUser"))this.$j_1.itemIsCheckedout=true;else this.$j_1.itemIsCheckedout=false;this.$j_1.moderationStatus=b.get_item("_ModerationStatus");window.setTimeout(Function.createDelegate(this,function(){ULS04Z:;SP.Ribbon.PageManager.get_instance().get_commandDispatcher().executeCommand(Commands.CommandIds.ApplicationStateChanged,null)}),0)}))},$j_1:null,$2P_1:false,get_$1X:function(){ULS04Z:;!this.$j_1&&this.$3s_1();return this.$j_1},getGlobalCommands:function(){ULS04Z:;if(!SP.Ribbon.DocLibAspxPageComponent.$R_1)SP.Ribbon.DocLibAspxPageComponent.$R_1=["editPageProperties","pagePropertiesMenuOpen","viewPageProperties","webPartPageWorkflow","webPartPageManageWorkflow","webPartPageVerions","webPartPagePermissions","IncomingLinks","AlertMePage","EditTitleBar","ManageGroup","WikiEditProperties","LibrarySettingsGroup","PageActionsGroup","PagePropertiesMenuOpen","Permissions","SetHomePage","ShareGroup","VersionHistory","VersionsMenuOpen","VersionDiff","ViewAllPages","WikiViewProperties","WikiLibraryPermissions","WikiLibrarySettings","WorkflowGroup"];return SP.Ribbon.DocLibAspxPageComponent.$R_1},canHandleCommand:function(a){ULS04Z:;this.$5w_1();var b=this.$9_1[a];if(b)return b();var c=this.get_$57_1()[a];if(c)return true;return false},handleCommand:function(a,c,d){ULS04Z:;this.$47_1();var b=this.$A_1[a];if(b)return b(a,c,d);return true},getId:function(){ULS04Z:;return "DocLibAspxPageComponent"},$1f_1:null,get_$57_1:function(){ULS04Z:;if(!this.$1f_1){this.$1f_1={};for(var a=this.getGlobalCommands(),c=a.length,b=0;b<a.length;b++)this.$1f_1[a[b]]=true}return this.$1f_1},$9_1:null,$5w_1:function(){ULS04Z:;if(!this.$9_1){this.$9_1={};var a=this.$2t;this.$9_1["PagePropertiesMenuOpen"]=a;this.$9_1["WikiViewProperties"]=a;this.$9_1["pagePropertiesMenuOpen"]=a;this.$9_1["viewPageProperties"]=a;a=this.$2l;this.$9_1["WikiEditProperties"]=a;this.$9_1["editPageProperties"]=a;this.$9_1["LibraryPermissions"]=this.$21;this.$9_1["WikiLibraryPermissions"]=this.$21;a=this.$2p;this.$9_1["Permissions"]=a;this.$9_1["webPartPagePermissions"]=a;this.$9_1["WikiLibrarySettings"]=this.$2v;a=this.$2n;this.$9_1["ManageWorkflow"]=a;this.$9_1["webPartPageManageWorkflow"]=a;a=SP.Ribbon.DocLibAspxPageComponent.$3h;this.$9_1["SetHomePage"]=a;a=this.$2m;this.$9_1["EditTitleBar"]=a;a=this.$2s;this.$9_1["VersionDiff"]=a;this.$9_1["VersionHistory"]=a;this.$9_1["VersionsMenuOpen"]=a;this.$9_1["webPartPageVerions"]=a;this.$9_1["AlertMePage"]=this.$2i}},$A_1:null,$47_1:function(){ULS04Z:;if(!this.$A_1){this.$A_1={};var a=SP.Ribbon.DocLibAspxPageComponent.$3l_1;this.$A_1["VersionHistory"]=a;a=SP.Ribbon.DocLibAspxPageComponent.$5M_1;this.$A_1["WikiViewProperties"]=a;this.$A_1["viewPageProperties"]=a;a=SP.Ribbon.DocLibAspxPageComponent.$59_1;this.$A_1["WikiEditProperties"]=a;this.$A_1["editPageProperties"]=a;a=this.$30;this.$A_1["WikiLibraryPermissions"]=a;a=this.$33;this.$A_1["Permissions"]=a;this.$A_1["webPartPagePermissions"]=a;this.$A_1["ViewAllPages"]=this.$38;this.$A_1["WikiLibrarySettings"]=this.$3A;a=this.$31;this.$A_1["ManageWorkflow"]=a;this.$A_1["webPartPageManageWorkflow"]=a;a=SP.Ribbon.DocLibAspxPageComponent.$3k;this.$A_1["SetHomePage"]=a;a=this.$2y;this.$A_1["EditTitleBar"]=a;a=SP.Ribbon.DocLibAspxPageComponent.$3l_1;this.$A_1["VersionHistory"]=a;this.$A_1["webPartPageVerions"]=a;a=this.$37;this.$A_1["VersionDiff"]=a;this.$A_1["IncomingLinks"]=this.$2z;this.$A_1["AlertMePage"]=this.$2x}},$54_1:function(){ULS04Z:;return !this.$1_1.doNotShowProperties},$4v_1:function(){ULS04Z:;var a=SP.Ribbon.PageState.ImportedNativeData&&SP.Ribbon.PageState.ImportedNativeData.PageState,b=!a||a&&!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsCheckedOutToOtherUser"];return !this.$1_1.doNotShowProperties&&this.$1_1.editable&&b&&this.$1_1.itemPermMasks.has(3)},$56_1:function(){ULS04Z:;return this.$1_1.listPermMasks.has(12)},$5O_1:function(){ULS04Z:;var a=SP.Utilities.Utility.getLayoutsPageUrl("listedit.aspx");a=a+"?List="+this.$1_1.listId;SP.Utilities.HttpUtility.navigateTo(a);return true},$50_1:function(){ULS04Z:;if(this.$1_1.itemPermMasks.has(63))return true;return false},$5F_1:function(){ULS04Z:;var a=SP.Utilities.Utility.getLayoutsPageUrl("User.aspx"),b=new SP.Utilities.UrlBuilder(a),c=new SP.Guid(this.$1_1.listId);b.addKeyValueQueryString("obj",c.toString("B")+","+this.$1_1.itemId.toString()+",LISTITEM");b.addKeyValueQueryString("List",c.toString("B"));a=b.get_url()+"&Source"+GetSource();SP.Utilities.HttpUtility.navigateTo(a);return true},$4x_1:function(){ULS04Z:;if(this.$1_1.listPermMasks.has(63))return true;return false},$5C_1:function(){ULS04Z:;var a=SP.Utilities.Utility.getLayoutsPageUrl("User.aspx"),b=new SP.Utilities.UrlBuilder(a),c=new SP.Guid(this.$1_1.listId);b.addKeyValueQueryString("obj",c.toString("B")+",doclib");b.addKeyValueQueryString("List",c.toString("B"));a=b.get_url()+"&Source"+GetSource();SP.Utilities.HttpUtility.navigateTo(a);return true},$5L_1:function(){ULS04Z:;this.$6A_1();return true},$6A_1:function(){ULS04Z:;var b=SP.Utilities.Utility.getLayoutsPageUrl("listform.aspx"),a=new SP.Utilities.UrlBuilder(b),c=new SP.Guid(this.$1_1.listId);a.addKeyValueQueryString("ListId",c.toString("B"));a.addKeyValueQueryString("PageType","0");SP.Utilities.HttpUtility.navigateTo(a.get_url())},$5B_1:function(){ULS04Z:;var b=SP.Utilities.Utility.getLayoutsPageUrl("BackLinks.aspx"),a=new SP.Utilities.UrlBuilder(b);a.addKeyValueQueryString("List",(new SP.Guid(this.$1_1.listId)).toString());a.addKeyValueQueryString("ID",this.$1_1.itemId.toString());SP.Utilities.HttpUtility.navigateTo(a.get_url());return true},$5K_1:function(){ULS04Z:;var b=SP.Utilities.Utility.getLayoutsPageUrl("VersionDiff.aspx"),a=new SP.Utilities.UrlBuilder(b),c=new SP.Guid(this.$1_1.listId);a.addKeyValueQueryString("List",c.toString("B"));a.addKeyValueQueryString("ID",this.$1_1.itemId.toString());SP.Utilities.HttpUtility.navigateTo(a.get_url());return true},$53_1:function(){ULS04Z:;if(SP.Ribbon.SU.$0(this.$1_1.itemId))return false;if(!this.$1_1.itemPermMasks.has(7))return false;return this.$1_1.enableVersioning},$5D_1:function(){ULS04Z:;var a=new SP.Utilities.UrlBuilder(SP.Utilities.Utility.getLayoutsPageUrl("Workflow.aspx")),b=new SP.Guid(this.$1_1.listId);a.addKeyValueQueryString("ID",this.$1_1.itemId.toString());a.addKeyValueQueryString("List",b.toString("B"));var c=a.get_url()+"&Source"+GetSource();SP.Utilities.HttpUtility.navigateTo(c);return true},$4y_1:function(){ULS04Z:;return !SP.Ribbon.SU.$0(this.$1_1.itemId)&&this.$1_1.workflowsAssociated&&this.$1_1.itemPermMasks.has(3)},$4w_1:function(){ULS04Z:;return this.$1_1.editable},$5A_1:function($p0,$p1,$p2){var $v_0=window.document.getElementById($p0);if(!$v_0)return false;var $v_1=$v_0.getAttribute("href");if($v_1&&$v_1.length>0){if($v_1.startsWith("javascript:"))$v_1=$v_1.substr(11);eval($v_1);SP.Ribbon.PageManager.get_instance().get_commandDispatcher().executeCommand(Commands.CommandIds.ApplicationStateChanged,null);return true}return false},$4t_1:function(){ULS04Z:;if(this.$1_1.itemPermMasks.has(40))return true;return false},$58_1:function(){ULS04Z:;var a=SP.Utilities.Utility.getLayoutsPageUrl("SubNew.aspx"),b=new SP.Utilities.UrlBuilder(a);b.addKeyValueQueryString("List",this.$1_1.listId);b.addKeyValueQueryString("ID",this.$1_1.itemId.toString());a=b.get_url()+"&Source"+GetSource();var c=SP.UI.$create_DialogOptions();c.url=a;SP.UI.ModalDialog.showModalDialog(c);return true}};SP.Ribbon.WebPartComponent=function(){ULS04Z:;this.$3Q=Function.createDelegate(this,this.$6K_1);this.$3L=Function.createDelegate(this,this.$6B_1);SP.Ribbon.WebPartComponent.initializeBase(this);this.$4L_1=new SP.Ribbon.RelatedFieldsHelper(false);this.$4K_1=new SP.Ribbon.RelatedFieldsHelper(true)};SP.Ribbon.WebPartComponent.get_instance=function(){ULS04Z:;return SP.Ribbon.WebPartComponent.$3_1};SP.Ribbon.WebPartComponent.registerWithPageManager=function(a){ULS04Z:;if(!SP.Ribbon.WebPartComponent.$3_1){SP.Ribbon.WebPartComponent.$3_1=new SP.Ribbon.WebPartComponent;SP.Ribbon.WebPartComponent.$3_1.$1w(a);SP.Ribbon.PageManager.get_instance().addPageComponent(SP.Ribbon.WebPartComponent.$3_1);SP.Ribbon.UtilityInternal.$4n("click",SP.Ribbon.WebPartComponent.$69_1)}else SP.Ribbon.WebPartComponent.$3_1.$1w(a)};SP.Ribbon.WebPartComponent.$69_1=function(a){ULS04Z:;if(SP.UI.UIUtility.focusValidOnThisNode(a.target)&&SP.Ribbon.WebPartComponent.$3_1){CUI.PMetrics.perfMark(7186);SP.Ribbon.WebPartComponent.$3_1.$5Y(a.target);CUI.PMetrics.perfMark(7187)}};SP.Ribbon.WebPartComponent.$1Y_1=function(b){ULS04Z:;var a=window._spWebPartComponents;if(SP.Ribbon.SU.$0(a))return null;return a[b]};SP.Ribbon.WebPartComponent.$6C=function(){ULS04Z:;var a=new Sys.StringBuilder;SP.Ribbon.WebPartComponent.$2A_1("versions.aspx",a);a.append("list=");a.append(SP.PageContextInfo.get_pageListId());a.append("&ID=");a.append(SP.PageContextInfo.get_pageItemId().toString());SP.Utilities.HttpUtility.navigateTo(a.toString())};SP.Ribbon.WebPartComponent.$2A_1=function(c,a){ULS04Z:;var b=SP.PageContextInfo.get_webServerRelativeUrl();a.append(b);!b.endsWith("/")&&a.append("/");a.append("_layouts/");a.append(c);a.append("?");return};SP.Ribbon.WebPartComponent.$4Z=function(b,c){ULS04Z:;var a=new Sys.StringBuilder;SP.Ribbon.WebPartComponent.$2A_1("listform.aspx",a);a.append("PageType=");a.append(b.toString());a.append("&ListId=");a.append(SP.PageContextInfo.get_pageListId());a.append("&ID=");a.append(SP.PageContextInfo.get_pageItemId().toString());if(c)if(b===6)SP.Utilities.HttpUtility.navigateTo(a.toString());else SP.Utilities.HttpUtility.appendSourceAndNavigateTo(a.toString());else window.OpenPopUpPage(a.toString())};SP.Ribbon.WebPartComponent.$1W=function(){ULS04Z:;var a=window.document.getElementById("_wpSelected");if(!SP.Ribbon.SU.$0(a)&&!SP.Ribbon.SU.$0(a.value)){var b=SP.Ribbon.PageManager.get_instance().getPageComponentById(SP.Ribbon.WebPartComponent.$40_1(a.value));!SP.Ribbon.SU.$0(b)&&SP.Ribbon.PageManager.get_instance().get_focusManager().releaseFocusFromComponent(b)}};SP.Ribbon.WebPartComponent.$3t=function(){ULS04Z:;var a=window.document.getElementById("_wpSelected");if(!SP.Ribbon.SU.$0(a)&&!SP.Ribbon.SU.$0(a.value)){var b=SP.Ribbon.PageManager.get_instance().getPageComponentById(SP.Ribbon.WebPartComponent.$40_1(a.value));!SP.Ribbon.SU.$0(b)&&SP.Ribbon.PageManager.get_instance().get_focusManager().requestFocusForComponent(b)}};SP.Ribbon.WebPartComponent.$40_1=function(a){ULS04Z:;if(!SP.Ribbon.SU.$0(a)&&a.length>12){var c=a.substring(12,a.length),b=SP.Ribbon.WebPartComponent.$1Y_1(c);if(b&&!SP.Ribbon.SU.$2(b.pageComponentId))return b.pageComponentId}return a};SP.Ribbon.WebPartComponent.getWebPartAdder=function(){ULS04Z:;return window.WPAdder};SP.Ribbon.WebPartComponent.get_$63=function(){ULS04Z:;var b=$get("MSOLayout_InDesignMode");if(b&&b.value==="1")return false;var a=$get("MSOSPWebPartManager_DisplayModeName");if(a&&a.value&&a.value.toUpperCase()!=="BROWSE")return false;return true};SP.Ribbon.WebPartComponent.get_$1B=function(){ULS04Z:;var a=$get("MSOSPWebPartManager_DisplayModeName");if(a&&a.value&&a.value.toUpperCase()==="EDIT")return true;return false};SP.Ribbon.WebPartComponent.get_activeWebPartId=function(){ULS04Z:;var a=null;if(SP.Ribbon.WebPartComponent.$3_1&&!SP.Ribbon.SU.$2(SP.Ribbon.WebPartComponent.$3_1.get_$K()))return SP.Ribbon.WebPartComponent.$3_1.get_$K();if(window.document.getElementById("_wpSelected")){a=window.document.getElementById("_wpSelected").value;if(!SP.Ribbon.SU.$2(a))return a.substr(12)}return null};SP.Ribbon.WebPartComponent.get_pageComponentIdOfActiveWebPart=function(){ULS04Z:;var a=SP.Ribbon.WebPartComponent.get_activeWebPartId();if(SP.Ribbon.SU.$2(a))return null;var b=SP.Ribbon.WebPartComponent.$1Y_1(a);if(!b||SP.Ribbon.SU.$2(b.pageComponentId))return a;return b.pageComponentId};SP.Ribbon.WebPartComponent.get_activeWebPartZoneId=function(){ULS04Z:;if(SP.Ribbon.WebPartComponent.$3_1&&!SP.Ribbon.SU.$2(SP.Ribbon.WebPartComponent.$3_1.get_$X()))return SP.Ribbon.WebPartComponent.$3_1.get_$X();return null};SP.Ribbon.WebPartComponent.fetchListViewWebPartPageComponent=function(b,a,d,e){ULS04Z:;var c=new SP.Ribbon.FetchListViewWebPartPageComponentWorker(b,a,d,e);c.fetch()};SP.Ribbon.WebPartComponent.$3r=function(b){ULS04Z:;var a=document.createElement("SCRIPT");a.setAttribute("type","text/javascript");if(Sys.Browser.agent===Sys.Browser.Safari||Sys.Browser.agent===Sys.Browser.AppleWebKit)a.innerHTML=b;else a.text=b;var c=document.getElementsByTagName("HEAD")[0];c.appendChild(a)};SP.Ribbon.WebPartComponent.prototype={$1:null,$4L_1:null,$4K_1:null,$1w:function(b){ULS04Z:;this.$1=b;var a=this.$1.itemPermissions;if(!SP.Ribbon.SU.$0(a)&&!SP.BasePermissions.isInstanceOfType(a)){this.$1.itemPermissions=new SP.BasePermissions;!this.$1.itemPermissions.customFromJson(a)&&this.$1.itemPermissions.fromJson(a)}},$5Y:function(a){ULS04Z:;var b=null,c=null;while(a&&a!==document.body){if(a.tagName==="A"||a.tagName==="INPUT")return;if(!b&&(SP.Ribbon.Utility.$F(a,"s4-wpActive")||SP.Ribbon.Utility.$F(a,"s4-wpcell")))b=a;else if(!c&&SP.Ribbon.Utility.$F(a,"ms-SPZone")&&a.getAttribute("zoneID"))c=a;a=a.parentNode}this.deselectWebPartAndZone(b,c)},deselectWebPartAndZone:function(c,b){ULS04Z:;if(this.get_$4_1()&&!SP.Ribbon.SU.$0(this.get_$4_1().getAttribute("WPToolPaneOpen")))return;var a=false;if(this.$6e(c))a=true;if(this.$6f(b))a=true;a&&SP.Ribbon.UtilityInternal.$e()},$6e:function(c){ULS04Z:;if(!c&&this.get_$4_1()&&c!==this.get_$4_1()){var a=this.$5r_1(this.get_$4_1());if(a&&a.isDefaultWebPart)return false;Sys.UI.DomElement.removeCssClass(this.get_$4_1(),"s4-wpActive");!SP.Ribbon.Utility.$F(this.get_$4_1(),"s4-wpcell-plain")&&Sys.UI.DomElement.addCssClass(this.get_$4_1(),"s4-wpcell");DeselectAllWPItems();var d="SelectionCbx"+this.$q_1(this.get_$4_1()),b=$get(d);if(!SP.Ribbon.SU.$0(b))b.checked=false;SP.Ribbon.WebPartComponent.$1W();this.$r_1=null;this.$2Z_1(null);return true}return false},$6f:function(a){ULS04Z:;if(this.get_$J_1()&&!a&&this.get_$E_1()){Sys.UI.DomElement.removeCssClass(this.get_$E_1(),"s4-wzActive");this.$i_1=null;this.$4T_1(null);return true}return false},selectWebPartById:function(c,a){ULS04Z:;var b=$get("MSOZoneCell_"+c);return this.selectWebPart(b,a)},selectWebPart:function(a,b){ULS04Z:;if(SP.Ribbon.SU.$0(a))return false;if(this.get_$4_1()&&this.get_$4_1()!==a&&!SP.Ribbon.SU.$0(this.get_$4_1().getAttribute("WPToolPaneOpen")))return false;this.$4c_1(a,b);SP.Ribbon.UtilityInternal.$e();return true},selectWebPartZone:function(b,d){ULS04Z:;if(this.get_$4_1()&&!SP.Ribbon.SU.$0(this.get_$4_1().getAttribute("WPToolPaneOpen")))return;if(!b){var a=GetElementsByName("MSOZone");if(a&&a.length>0)for(var c=0;c<a.length;c++){var e=a[c].getAttribute("zoneId");if(d===e){b=a[c];break}}}if(b){this.$4d_1(b);this.$4T_1(b)}},isFocusable:function(){ULS04Z:;return false},receiveFocus:function(){ULS04Z:;return true},yieldFocus:function(){ULS04Z:;return true},getGlobalCommands:function(){ULS04Z:;this.$49_1();var a=[];Array.addRange(a,SP.Ribbon.WebPartComponent.$R_1);Array.addRange(a,this.$1i_1);return a},$1i_1:null,$1E_1:null,$49_1:function(){ULS04Z:;if(this.$1i_1)return;this.$1i_1=[];this.$1E_1={};var f=window._spWebPartComponents;if(SP.Ribbon.SU.$0(f))return;var a=f;for(var b in a)for(var g={key:b,value:a[b]},e=g.value,c=0;c<e.contextualGroupCommands.length;c++){var d=this.$1E_1[e.contextualGroupCommands[c]];if(SP.Ribbon.SU.$0(d)){d=[];this.$1E_1[e.contextualGroupCommands[c]]=d}Array.add(d,g.key)}var a=this.$1E_1;for(var b in a){var h={key:b,value:a[b]};Array.add(this.$1i_1,h.key)}},$5r_1:function(b){ULS04Z:;var a=this.$q_1(b);if(SP.Ribbon.SU.$2(a))return null;return SP.Ribbon.WebPartComponent.$1Y_1(a)},get_$1X_1:function(){ULS04Z:;if(SP.Ribbon.DocLibAspxPageComponent.$3_1)return SP.Ribbon.DocLibAspxPageComponent.$3_1.get_$1X();return null},canHandleCommand:function(a){ULS04Z:;switch(a){case "MSOMenu_Minimize":case "MSOMenu_Restore":case "MSOMenu_Close":case "MSOMenu_Edit":case "MSOMenu_Delete":if(!this.get_$4_1())return false;return this.$4s_1(a);case "webPartPageApproval":case "approveWebpartPage":case "rejectWebpartPage":if(!SP.Ribbon.SU.$0(this.$1.itemId)&&this.$1.enableModeration&&this.$1.itemPermissions.has(3)&&this.$1.itemPermissions.has(5)&&this.get_$1X_1()&&(this.get_$1X_1().moderationStatus===2||!this.$1.enableMinorVersioning)&&!this.get_$1X_1().itemIsCheckedout)return true;return false;case "WebPartContextualGroup":return (SP.Ribbon.WikiPageComponent.$D()||this.get_$J_1()||SP.Ribbon.WebPartComponent.get_$1B())&&!SP.Ribbon.SU.$0(this.get_$4_1());case "insertTextWebPart":case "insertImageWebPart":return this.$2f_1(a,true,null)&&!SP.Ribbon.SU.$0(this.get_$E_1());case "insertExistingList":return this.$2f_1(a,true,null);case "EditMobileSharedPage":if(SP.Ribbon.WikiPageComponent.$4B()||!this.$1.editable)return false;return this.$3f_1();case "EditMobilePersonalPage":if(SP.Ribbon.WikiPageComponent.$4B()||!this.$1.editable)return false;return this.$3e_1();case "webPartPageDelete":if(SP.Ribbon.SU.$0(this.$1.itemId))return false;if(!this.$1.itemPermissions.has(4))return false;return true;case "webPartPageEdit":return this.$1.editable||this.$1.isEditMode;case "webPartPageStartEdit":if(this.get_$J_1()||SP.Ribbon.WebPartComponent.get_$1B())return false;return this.$1.editable;case "webPartPageStopEdit":if(!this.get_$J_1()&&!SP.Ribbon.WebPartComponent.get_$1B())return false;return true;case "Ribbon.WebPartOption":return (SP.Ribbon.WikiPageComponent.$D()||this.get_$J_1()||SP.Ribbon.WebPartComponent.get_$1B())&&!SP.Ribbon.SU.$0(this.get_$4_1());case "InsertRelatedWebPartToListViewMenuAnchor":case "InsertRelatedWebPartToListView":return (SP.Ribbon.WikiPageComponent.$D()||this.get_$J_1())&&!SP.Ribbon.SU.$0(this.get_$4_1())&&!SP.Ribbon.SU.$0(this.get_$3Y_1());case "InsertRelatedWebPartToListFormMenuAnchor":case "InsertRelatedWebPartToListForm":return this.get_$J_1();case "WebPartInsertContextualGroup":return !SP.Ribbon.SU.$0(this.get_$E_1())&&this.$1.allowWebPartAdder;case "EditMobilePageMenuOpen":return this.$3f_1()||this.$3e_1();case "makeHomePage":return SP.Ribbon.DocLibAspxPageComponent.$3h();case "EditInDesigner":return !SP.Ribbon.WikiPageComponent.$D()&&this.$1.editable&&!this.get_$J_1()&&!SP.Ribbon.WebPartComponent.get_$1B();default:this.$49_1();var b=this.$1E_1[a];if(!SP.Ribbon.SU.$0(b))return Array.contains(b,this.get_$K())}return true},handleCommand:function(b,a,e){ULS04Z:;switch(b){case "MSOMenu_Minimize":case "MSOMenu_Restore":case "MSOMenu_Close":case "MSOMenu_Edit":case "MSOMenu_Delete":this.$4e_1(b,a,e);break;case "InsertRelatedWebPartToListView":!SP.Ribbon.SU.$0(a)&&SP.Ribbon.RelatedFieldsHelper.addAndConnectRelatedWebPart(a,this.get_$X(),this.get_$4h_1(),SP.Ribbon.WikiPageComponent.$D());break;case "GetRelatedFieldsToListViewMenuXml":if(!SP.Ribbon.SU.$0(a)){var f=a;f=this.$4L_1.getRelatedFieldsMenuXml(f,this.get_$3Y_1(),this.get_$4g_1())}break;case "InsertRelatedWebPartToListForm":!SP.Ribbon.SU.$0(a)&&SP.Ribbon.RelatedFieldsHelper.addAndConnectRelatedWebPart(a,"Main",null,false);break;case "GetRelatedFieldsToListFormMenuXml":if(!SP.Ribbon.SU.$0(a)){var g=a;g=this.$4K_1.getRelatedFieldsMenuXml(g,null,null)}break;case "approveWebpartPage":this.$4P_1(true);break;case "rejectWebpartPage":this.$4P_1(false);break;case "webPartPageDelete":this.$5X_1();break;case "webPartPageEdit":switch(a["CommandValueId"]){case "Ribbon.WebPartPage.Edit.Edit.Menu.Actions.Edit":this.handleCommand("webPartPageStartEdit",null,e);break;case "Ribbon.WebPartPage.Edit.Edit.Menu.Actions.Stop":this.handleCommand("webPartPageStopEdit",null,e)}break;case "webPartPageStartEdit":if(this.$1.itemId>0&&this.$1.forceCheckout)window.EnsureCheckoutAndChangeLayoutModeToEdit(this.$1.listId,this.$1.itemId,false);else window.ChangeLayoutMode(false,false);break;case "webPartPageStopEdit":window.ChangeLayoutMode(null,true);break;case "webPartPageEditQuery":var h=window.document.getElementById("MSOLayout_InDesignMode"),i=window.document.getElementById("MSOSPWebPartManager_DisplayModeName");if(h&&h.value!=="1"&&(!i||i.value!=="Edit"))a["SelectedItemId"]="Ribbon.WebPartPage.Edit.Edit.Menu.Actions.Edit";else a["SelectedItemId"]="Ribbon.WebPartPage.Edit.Edit.Menu.Actions.Stop";break;case "insertWebPart":case "insertExistingList":this.$6a_1(b);break;case "insertTextWebPart":case "insertImageWebPart":this.$2f_1(b,false,null);break;case "CommandContextChanged":this.$6G_1(a);break;case "EditMobileSharedPage":var c=SP.Utilities.HttpUtility.urlPathEncode(SP.PageContextInfo.get_webServerRelativeUrl());if(!c.endsWith("/"))c+="/";c+=SP.Utilities.HttpUtility.urlPathEncode("_layouts/mwpsettings.aspx?pageview=shared&url=");c+=SP.Utilities.HttpUtility.urlPathEncode(document.URL);window.location=c;break;case "EditMobilePersonalPage":var d=SP.Utilities.HttpUtility.urlPathEncode(SP.PageContextInfo.get_webServerRelativeUrl());if(!d.endsWith("/"))d+="/";d+=SP.Utilities.HttpUtility.urlPathEncode("_layouts/mwpsettings.aspx?pageview=personal&url=");d+=SP.Utilities.HttpUtility.urlPathEncode(document.URL);window.location=d;break;case "makeHomePage":SP.Ribbon.DocLibAspxPageComponent.$3k(b,a,e);break;case "EditInDesigner":EditInSPD(document.URL,false)}return true},$3f_1:function(){ULS04Z:;return SP.Ribbon.Utility.get_$U()&&SP.Ribbon.Utility.get_$U().has(19)},$3e_1:function(){ULS04Z:;return SP.Ribbon.Utility.get_$U()&&SP.Ribbon.Utility.get_$U().has(30)},$6G_1:function(a){ULS04Z:;if(a.ChangedByUser&&(this.get_$J_1()&&a.OldContextCommand==="Ribbon.WebPartInsert.Tab"||SP.Ribbon.WikiPageComponent.$D()&&a.OldContextCommand==="InsertTab")){var b=window.WPAdder;b&&b.hide()}},$6a_1:function(e){ULS04Z:;var a=SP.Ribbon.WebPartComponent.getWebPartAdder();if(!a){window.LoadWPAdderOnDemand();return}var b=this.$42_1(a,e);if(a){var c=true;if(b){var d=b;a.selectCategoryByTitle(d);c=false}a._showCategoryColumn(c);a._setZone(this.get_$X());a.show()}},$42_1:function(c,d){ULS04Z:;var a=null;if(c){var b=c._ribbonMap;if(b)a=b[d]}return a},$2f_1:function(g,h,f){ULS04Z:;var a=SP.Ribbon.WebPartComponent.getWebPartAdder();!a&&window.LoadWPAdderOnDemand();a=SP.Ribbon.WebPartComponent.getWebPartAdder();if(!a)return false;var b=false,c=this.$42_1(a,g);if(a&&c){var d=c;b=d.length>0;if(!h){if(f){var e=a._getHiddenField("wpVal");if(e)e.value=f}a.addItemToPageByItemIdAndZoneId(d,this.get_$X())}}return b},$5X_1:function(){ULS04Z:;var b=this.$1.recycleBinEnabled,a;if(b)a=SP.Res.webPartPageRecycleConfirmation;else a=SP.Res.webPartPageDeleteConfirmation;if(confirm(a)){var c=new SP.ClientContext,d=c.get_web().get_lists().getById(new SP.Guid(this.$1.listId)).getItemById(this.$1.itemId);if(b)d.recycle();else d.deleteObject();c.executeQueryAsync(this.$3L)}},$6B_1:function(){ULS04Z:;var a=this.$1.rootFolderUrl;if(!a)window.navigate(SP.PageContextInfo.get_webServerRelativeUrl());else window.navigate(a)},$4P_1:function(b){ULS04Z:;var a=new Sys.StringBuilder;SP.Ribbon.WebPartComponent.$2A_1("approve.aspx",a);a.append("&List=");a.append(SP.PageContextInfo.get_pageListId());a.append("&ID=");a.append(SP.PageContextInfo.get_pageItemId().toString());a.append("&action=");if(b)a.append("0");else a.append("1");window.OpenPopUpPage(a.toString(),this.$3Q)},$6K_1:function(a){ULS04Z:;if(a===1)SP.Ribbon.DocLibAspxPageComponent.$3_1&&SP.Ribbon.DocLibAspxPageComponent.$3_1.$6L()},$r_1:null,$i_1:null,get_$E_1:function(){ULS04Z:;if(this.$i_1)return this.$i_1;if(this.get_$4_1()){var a=this.get_$4_1();while(a&&a!==document.body){if(SP.Ribbon.Utility.$F(a,"ms-SPZone")&&!SP.Ribbon.SU.$0(a.getAttribute("zoneID"))){this.$i_1=a;break}a=a.parentNode}}return this.$i_1},set_$E_1:function(a){ULS04Z:;this.$i_1=a;return a},get_$4_1:function(){ULS04Z:;if(!this.$r_1){var a=$get("_wpSelected");if(a){var b=a.value;if(!SP.Ribbon.SU.$2(b))this.$r_1=window.document.getElementById(b)}}return this.$r_1},set_$4_1:function(a){ULS04Z:;this.$i_1=null;this.$r_1=a;return a},$5a_1:function(b){ULS04Z:;var a=SP.Ribbon.WebPartComponent.$1Y_1(b);if(SP.Ribbon.SU.$0(a))return false;return a.hasNonPromotedContextualGroups},$4c_1:function($p0,$p1){var $v_0=window._spWebPartComponents;if(this.get_$4_1()!==$p0&&this.get_$4_1()){Sys.UI.DomElement.removeCssClass(this.get_$4_1(),"s4-wpActive");!SP.Ribbon.Utility.$F(this.get_$4_1(),"s4-wpcell")&&!SP.Ribbon.Utility.$F(this.get_$4_1(),"s4-wpcell-plain")&&Sys.UI.DomElement.addCssClass(this.get_$4_1(),"s4-wpcell");DeselectAllWPItems();var $v_2="SelectionCbx"+this.$q_1(this.get_$4_1()),$v_3=$get($v_2);if(!SP.Ribbon.SU.$0($v_3))$v_3.checked=false}this.set_$4_1($p0);if(!SP.Ribbon.SU.$0($v_0)&&$p1){var $v_4=$v_0[this.get_$K()];if(!SP.Ribbon.SU.$0($v_4)){var $v_5=$v_4["firstTabId"];if(!SP.Ribbon.SU.$0($v_5))window._spNextRibbonTabId=$v_5}}if(SP.Ribbon.WikiPageComponent.$D()||this.get_$J_1()||this.$5a_1(this.get_$K())){if(!SP.Ribbon.Utility.$F($p0,"s4-wpActive")){Sys.UI.DomElement.addCssClass($p0,"s4-wpActive");SP.Ribbon.Utility.$F($p0,"s4-wpcell")&&Sys.UI.DomElement.removeCssClass($p0,"s4-wpcell")}var $v_6="SelectionCbx"+this.$q_1($p0),$v_7=$get($v_6);if(!SP.Ribbon.SU.$0($v_7))$v_7.checked=true}SP.Ribbon.WebPartComponent.$1W();this.$2Z_1($p0);SP.Ribbon.WebPartComponent.$3t();if(this.get_$J_1()){var $v_8=GetElementsByName("MSOZone");if($v_8&&$v_8.length>0){for(var $v_B=0;$v_B<$v_8.length;$v_B++)Sys.UI.DomElement.removeCssClass($v_8[$v_B],"s4-wzActive");var $v_9=this.get_$E_1();$v_9&&!SP.Ribbon.Utility.$F($v_9,"s4-wzActive")&&Sys.UI.DomElement.addCssClass(this.get_$E_1(),"s4-wzActive");var $v_A=SP.Ribbon.WebPartComponent.getWebPartAdder();$v_A&&$v_A._setZone(this.get_$X())}}if(SP.Ribbon.SU.$0($v_0))return;var $v_1=$v_0[this.get_$K()];if(SP.Ribbon.SU.$0($v_1))return;if(!SP.Ribbon.SU.$2($v_1.initPageComponentScript)&&!this.get_$4_1()._wpRibbonFetched){this.get_$4_1()._wpRibbonFetched="1";eval($v_1.initPageComponentScript)}else SP.Ribbon.UtilityInternal.$e()},$2Z_1:function(b){ULS04Z:;var a=window.document.getElementById("_wpSelected");if(a)if(b){var c=b.id;a.value=c}else a.value=""},$4T_1:function(c){ULS04Z:;var a=window.document.getElementById("_wzSelected");if(a)if(c){var b=c.getAttribute("zoneID");if(SP.Ribbon.SU.$0(b))b="";a.value=b}else a.value=""},$4d_1:function(b){ULS04Z:;var c=SP.Ribbon.WebPartComponent.getWebPartAdder();if(this.get_$E_1()===b){this.get_$J_1()&&!SP.Ribbon.Utility.$F(this.get_$E_1(),"s4-wzActive")&&Sys.UI.DomElement.addCssClass(this.get_$E_1(),"s4-wzActive");c&&c._setZone(this.get_$X());return}this.get_$E_1()&&Sys.UI.DomElement.removeCssClass(this.get_$E_1(),"s4-wzActive");this.set_$E_1(b);if(this.get_$J_1())!SP.Ribbon.Utility.$F(b,"s4-wzActive")&&Sys.UI.DomElement.addCssClass(b,"s4-wzActive");c&&c._setZone(this.get_$X());if(this.get_$4_1()){var a=this.get_$4_1();while(a&&a!==document.body&&a!==b)a=a.parentNode;if(a!==b){Sys.UI.DomElement.removeCssClass(this.get_$4_1(),"s4-wpActive");!SP.Ribbon.Utility.$F(this.get_$4_1(),"s4-wpcell")&&!SP.Ribbon.Utility.$F(this.get_$4_1(),"s4-wpcell-plain")&&Sys.UI.DomElement.addCssClass(this.get_$4_1(),"s4-wpcell");DeselectAllWPItems();var e="SelectionCbx"+this.$q_1(this.get_$4_1()),d=$get(e);if(!SP.Ribbon.SU.$0(d))d.checked=false;SP.Ribbon.WebPartComponent.$1W();this.$r_1=null;this.$2Z_1(null)}}SP.Ribbon.UtilityInternal.$e()},get_$X:function(){ULS04Z:;if(!this.get_$E_1())return null;return this.get_$E_1().attributes.getNamedItem("ZoneID").value},get_$4f_1:function(){ULS04Z:;if(!this.get_$4_1())return null;return window.document.getElementById(this.get_$K()+"_MenuLink")},get_$3Y_1:function(){ULS04Z:;if(!this.get_$4_1())return null;var a=this.get_$4_1().attributes.getNamedItem(this.get_$K()+"_RelatedListId");if(!a)return null;return a.value},get_$4g_1:function(){ULS04Z:;if(!this.get_$4_1())return null;var a=this.get_$4_1().attributes.getNamedItem(this.get_$K()+"_RelatedWebId");if(!a)return null;return a.value},get_$4h_1:function(){ULS04Z:;if(!this.get_$4_1())return null;var a=this.get_$4_1().attributes.getNamedItem(this.get_$K()+"_WebPartStorageKey");if(!a)return null;return a.value},get_$J_1:function(){ULS04Z:;var a=$get("MSOLayout_InDesignMode");if(a){var c=a.attributes.getNamedItem("value");if(c&&c.value==="1")return true}var b=$get("MSOSPWebPartManager_DisplayModeName");if(b){var d=b.attributes.getNamedItem("value");if(d&&d.value.toUpperCase()==="DESIGN")return true}return false},get_$1R_1:function(){ULS04Z:;var a=this.get_$4f_1();if(!a)return null;return a.getAttribute("menuid")},get_$K:function(){ULS04Z:;var a=this.get_$4_1();if(a)return this.$q_1(this.get_$4_1());return null},$q_1:function(a){ULS04Z:;if(!a)return null;return a.id.substr(12)},$4s_1:function(c){ULS04Z:;if(SP.Ribbon.SU.$2(this.get_$1R_1()))return false;try{window.MSOWebPartPage_OpenMenu(this.get_$1R_1(),null,this.get_$K(),false,false);var a=this.$3v_1(c);return a&&a.style.display!=="none"}catch(b){window.OpenWebPartMenu(this.get_$1R_1(),null,this.get_$K(),false,true);return false}},$3v_1:function(f){ULS04Z:;var e=this.get_$1R_1();if(SP.Ribbon.SU.$2(e))return null;var d=$get(e);if(!d)return null;for(var a=d.getElementsByTagName("ie:menuitem"),b=0;b<a.length;b++)if(a[b].id===f)return a[b];a=d.getElementsByTagName("menuitem");for(var c=0;c<a.length;c++)if(a[c].id===f)return a[c];return null},$4e_1:function($p0,$p1,$p2){var $v_0=this.$3v_1($p0);if(!$v_0)return false;var $v_1=$v_0.getAttribute("onmenuclick");if($v_1&&$v_1.length>0){if($v_1.startsWith("javascript:"))$v_1=$v_1.substr(11);eval($v_1);switch($p0){case "MSOMenu_Minimize":case "MSOMenu_Restore":break;default:SP.Ribbon.PageManager.get_instance().get_commandDispatcher().executeCommand(Commands.CommandIds.ApplicationStateChanged,null)}return true}return false}};SP.Ribbon.FetchListViewWebPartPageComponentWorker=function(b,a,c,d){ULS04Z:;this.$3F=Function.createDelegate(this,this.$5e_0);this.$3G=Function.createDelegate(this,this.$5f_0);this.$4O_0=b;this.$4J_0=a;this.$k_0=c;this.$2W_0=d};SP.Ribbon.FetchListViewWebPartPageComponentWorker.prototype={$m_0:null,$4O_0:null,$4J_0:null,$k_0:null,$2W_0:null,fetch:function(){ULS04Z:;this.$m_0=SP.UI.Notify.addNotification(SP.Utilities.HttpUtility.htmlEncode(SP.Res.genericLoading),false);var d=null,e=SP.Ribbon.NativeUtility.getCtxForView("{"+this.$2W_0.toUpperCase()+"}");if(e)d=e.HttpRoot;if(SP.ScriptUtility.isNullOrUndefined(d))d=SP.PageContextInfo.get_webServerRelativeUrl();var c=new SP.Utilities.UrlBuilder(d);c.combinePath("_layouts/wpribbon.aspx");c.addKeyValueQueryString("WebPartId",this.$4O_0);c.addKeyValueQueryString("PageComponentId",this.$4J_0);c.addKeyValueQueryString("List",this.$k_0);c.addKeyValueQueryString("View",this.$2W_0);var a=document.URL,f=GetUrlKeyValue("RootFolder",false,a);!SP.ScriptUtility.isNullOrEmptyString(f)&&c.addKeyValueQueryString("RootFolder",f);var g=GetUrlKeyValue("FolderCTID",false,a);!SP.ScriptUtility.isNullOrEmptyString(g)&&c.addKeyValueQueryString("FolderCTID",g);var h=GetUrlKeyValue("Source",false,a);!SP.ScriptUtility.isNullOrEmptyString(h)&&c.addKeyValueQueryString("Source",h);var b=a.indexOf("?");if(b>0)a=a.substr(0,b);b=a.indexOf("#");if(b>0)a=a.substr(0,b);b=a.indexOf("//");if(b>0){a=a.substr(b+2);b=a.indexOf("/");if(b<0)throw Error.invalidOperation();a=a.substr(b)}a=unescape(a);c.addKeyValueQueryString("FileUrl",a);SP.PageRequest.doGet(c.get_url(),"text/html",this.$3G,this.$3F)},$5f_0:function(f,e){ULS04Z:;SP.UI.Notify.removeNotification(this.$m_0);var b=e.get_executor().get_responseData(),a=b.indexOf("function _initTRA");if(a<0)return;var c=b.indexOf("</script>",a);if(c<0)return;var d=b.substring(a,c);SP.Ribbon.WebPartComponent.$3r(d);a=c+9;while((a=b.indexOf("<script ",a))>0){a=b.indexOf(">",a);if(a<0)break;a++;c=b.indexOf("</script>",a);if(c<0)break;d=b.substring(a,c);SP.Ribbon.WebPartComponent.$3r(d);a=c+9}SP.Ribbon.WebPartComponent.$1W();SP.Ribbon.WebPartComponent.$3t();SP.Ribbon.UtilityInternal.$e()},$5e_0:function(){ULS04Z:;SP.UI.Notify.removeNotification(this.$m_0)}};SP.Ribbon.BlogPostWebPartPageComponent=function(b,a){ULS04Z:;SP.Ribbon.BlogPostWebPartPageComponent.initializeBase(this,[b,a]);this.$b_5=a.ViewId};SP.Ribbon.BlogPostWebPartPageComponent.prototype={$b_5:null,handleCommand:function(a,b,c){ULS04Z:;var d=this.get_ctx(),e=this.getCountOfSelectedItems();if(a==="NewListItem"){this.executeClickScript(this.getDefaultNewMenuItemScript());return true}return SP.Ribbon.BlogPostWebPartPageComponent.callBaseMethod(this,"handleCommand",[a,b,c])},get_alwaysEnabledCommands:function(){ULS04Z:;this._alwaysEnabledCommands=SP.Ribbon.BlogPostWebPartPageComponent.callBaseMethod(this,"get_alwaysEnabledCommands");this._alwaysEnabledCommands["Ribbon.Blog.Posts"]=true;this._alwaysEnabledCommands["Ribbon.Blog.Posts.NewGroup"]=true;this._alwaysEnabledCommands["Ribbon.Blog.Posts.PostsGroup"]=true;this._alwaysEnabledCommands["Ribbon.Blog.Posts.StateGroup"]=true;this._alwaysEnabledCommands["NewListItem"]=true;this._alwaysEnabledCommands["Ribbon.Blog.Comments"]=true;this._alwaysEnabledCommands["Ribbon.Blog.Comments.CommentsGroup"]=true;this._alwaysEnabledCommands["Ribbon.Blog.Comments.StateGroup"]=true;this._alwaysEnabledCommands["Ribbon.Blog.Categories"]=true;this._alwaysEnabledCommands["Ribbon.Blog.Categories.NewGroup"]=true;this._alwaysEnabledCommands["Ribbon.Blog.Categories.CategoriesGroup"]=true;this._alwaysEnabledCommands["Ribbon.Blog.Categories.StateGroup"]=true;this._alwaysEnabledCommands["Ribbon.Blog.Lists"]=true;this._alwaysEnabledCommands["Ribbon.Blog.Lists.Settings.SettingsGroup"]=true;this._alwaysEnabledCommands["Ribbon.Blog.Lists.Actions.ActionsGroup"]=true;return this._alwaysEnabledCommands},canHandleCommand:function(a){ULS04Z:;return SP.Ribbon.BlogPostWebPartPageComponent.callBaseMethod(this,"canHandleCommand",[a])},getGlobalCommands:function(){ULS04Z:;var a=SP.Ribbon.BlogPostWebPartPageComponent.callBaseMethod(this,"getGlobalCommands");return a},getFocusedCommands:function(){ULS04Z:;return SP.Ribbon.BlogPostWebPartPageComponent.callBaseMethod(this,"getFocusedCommands")}};SP.Ribbon.PageManager=function(){ULS04Z:;SP.Ribbon.PageManager.initializeBase(this)};SP.Ribbon.PageManager.get_instance=function(){ULS04Z:;if(SP.ScriptUtility.isNullOrUndefined(SP.Ribbon.PageManager.$12_2)){SP.Ribbon.PageManager.$12_2=new SP.Ribbon.PageManager;SP.Ribbon.PageManager.$12_2.initializeInternal()}return SP.Ribbon.PageManager.$12_2};SP.Ribbon.PageManager.prototype={executeRootCommand:function(e,d,c,g){ULS04Z:;var f;if(!SP.ScriptUtility.isNullOrUndefined(c)&&e!=="RibbonEvent"&&(e!=="CommandContextChanged"||!SP.ScriptUtility.isNullOrUndefined(d)&&d["ChangedByUser"])){var h=new Date;f=SP.Ribbon.PageManager.callBaseMethod(this,"executeRootCommand",[e,d,c,g]);var i=new Date,a=h.getTime(),b=i.getTime()-a;a=a&4294967295;b=b&4294967295;if(a<0)a+=4294967296;if(b<0)b+=4294967296;SP.Ribbon.NativeUtility.addCommandStreamToWSA(c,a,b)}else f=SP.Ribbon.PageManager.callBaseMethod(this,"executeRootCommand",[e,d,c,g]);return f}};SP.Ribbon.PageStateActionButton=function(){};SP.Ribbon.PageStateActionButton.updateState=function(){ULS04Z:;var c=SP.Ribbon.PageManager.get_instance(),d=window._spPageStateActionControlId;if(c&&!SP.Ribbon.SU.$2(d)){var a=$get(d);if(a){var b=null,e=a.getElementsByTagName("span")[0];if(e)b=e.getElementsByTagName("img")[0];if(c.get_commandDispatcher().isCommandEnabled("PageStateGroupEdit")){a.setAttribute("_action","edit");a.title=a.getAttribute("_edittooltip").toString();if(b){b.style.left="-"+a.getAttribute("_editoffsetx")+"px";b.style.top="-"+a.getAttribute("_editoffsety")+"px";b.alt=a.getAttribute("_edittooltip").toString()}}else if(c.get_commandDispatcher().isCommandEnabled("PageStateGroupSaveAndStop")){a.setAttribute("_action","save");a.title=a.getAttribute("_savetooltip").toString();if(b){b.style.left="-"+a.getAttribute("_saveoffsetx")+"px";b.style.top="-"+a.getAttribute("_saveoffsety")+"px";b.alt=a.getAttribute("_savetooltip").toString()}}}}};SP.Ribbon.PageStateActionButton.sendCommand=function(){ULS04Z:;var a=SP.Ribbon.PageManager.get_instance();if(a)if(a.get_commandDispatcher().isCommandEnabled("PageStateGroupEdit"))a.get_commandDispatcher().executeCommand("PageStateGroupEdit",null);else a.get_commandDispatcher().isCommandEnabled("PageStateGroupSaveAndStop")&&a.get_commandDispatcher().executeCommand("PageStateGroupSaveAndStop",null)};SP.Ribbon.RelatedFieldsFetcher=function(a,b){ULS04Z:;this.$3D=Function.createDelegate(this,this.fetchFailure);this.$3E=Function.createDelegate(this,this.fetchSuccess);this.$2M_0=a;this.$2N_0=b};SP.Ribbon.RelatedFieldsFetcher.prototype={$2V_0:null,$k_0:null,$1D_0:null,$O_0:null,$2M_0:null,$2N_0:null,getSelectedListValue:function(){ULS04Z:;var a=null;if(this.$O_0.getIsListForm()){var b=$get("currentListForRelationshipsRibbon");if(!SP.Ribbon.SU.$0(b))a=b.value}else if(!SP.Ribbon.SU.$0(this.$2M_0))a=this.$2M_0;return a},fetchRelatedFieldsBegin:function(e){ULS04Z:;if(this.$O_0);this.$O_0=e;var b=this.getSelectedListValue();if(SP.Ribbon.SU.$2(b)){this.$O_0.fetchRelatedFieldsFailure(SP.Utilities.HttpUtility.htmlEncode(SP.Res.relationships_UnknownError));return true}if(!this.$1D_0)this.$1D_0=new SP.ClientContext;var a=null;if(!this.$O_0.getIsListForm()&&!SP.Ribbon.SU.$0(this.$2N_0))a=this.$1D_0.get_site().openWebById(new SP.Guid(this.$2N_0));else a=this.$1D_0.get_web();var c=new SP.Guid(b);this.$k_0=a.get_lists().getById(c);this.$k_0.retrieve(SP.ListPropertyNames.title,SP.ListPropertyNames.baseType);this.$2V_0=this.$k_0.getRelatedFieldsExtendedData();var d=this.$2V_0.retrieveItems();d.retrieve([SP.RelatedFieldExtendedDataPropertyNames.webId,SP.RelatedFieldExtendedDataPropertyNames.listId,SP.RelatedFieldExtendedDataPropertyNames.fieldId,SP.RelatedFieldExtendedDataPropertyNames.resolvedListTitle,SP.RelatedFieldExtendedDataPropertyNames.toolTipDescription,SP.RelatedFieldExtendedDataPropertyNames.listImageUrl]);this.$1D_0.executeQueryAsync(this.$3E,this.$3D);return false},fetchSuccess:function(){ULS04Z:;if(!SP.Ribbon.SU.$0(this.$O_0)){var a=this.$k_0.get_baseType()===1;this.$O_0.fetchRelatedFieldsSuccess(this.$k_0.get_title(),a,this.$2V_0)}this.$O_0=null},fetchFailure:function(b,a){ULS04Z:;if(a&&!SP.Ribbon.SU.$0(a.get_message()));!SP.Ribbon.SU.$0(this.$O_0)&&this.$O_0.fetchRelatedFieldsFailure(SP.Utilities.HttpUtility.htmlEncode(SP.Res.relationships_RelatedFieldsFetchFailed));this.$O_0=null}};SP.Ribbon.RelatedFieldsHelper=function(a){ULS04Z:;this.$s_0=-1;this.$4C_0=a;if(a)this.$T_0="ListForm";else this.$T_0="ListView"};SP.Ribbon.RelatedFieldsHelper.addAndConnectRelatedWebPart=function(properties,activeZoneId,activeStorageKeyId,bInWikiEditMode){ULS04Z:;var $v_0=properties.CommandValueId,$v_1=$v_0.split(";");if($v_1.length>=2){var $v_2=$v_1[0],$v_3=$v_1[1],$v_4=$v_1[2],$v_5=activeZoneId,$v_6=activeStorageKeyId,$v_7=bInWikiEditMode&&!$v_5,$v_8=String.format("RelatedAdder_addItemAndConnect('{0}', '{1}', '{2}', '{3}', '{4}', {5})",$v_5,$v_2,$v_3,$v_4,$v_6,$v_7);eval($v_8)}};SP.Ribbon.RelatedFieldsHelper.prototype={$a_0:null,$1G_0:false,$4D_0:null,$m_0:null,$T_0:null,$4C_0:false,getIsListForm:function(){ULS04Z:;return this.$4C_0},$41_0:function(){ULS04Z:;return '\r\n                <Menu Id="Ribbon.Page.InsertRelatedDataTo'+this.$T_0+'.RelatedWebPart.Menu">\r\n                  <MenuSection Id="Ribbon.Page.InsertRelatedDataTo'+this.$T_0+'.RelatedWebPart.Menu.MS" Scrollable="false" DisplayMode="Menu16">\r\n                    <Controls Id="Ribbon.Page.InsertRelatedDataTo'+this.$T_0+'.RelatedWebPart.Menu.MS.Controls">\r\n                  '},$4S_0:"\r\n                    </Controls>\r\n                  </MenuSection>\r\n                </Menu>\r\n        ",fetchRelatedFieldsSuccess:function(g,f,c){ULS04Z:;if(!SP.Ribbon.SU.$0(this.$a_0))return;this.$1G_0=false;var b=new Sys.StringBuilder;b.append(this.$41_0());if(!c||!c.get_count()){var e=null;if(f)e=SP.Res.relationships_DocLibHasNoRelatedLists;else e=SP.Res.relationships_ListHasNoRelatedLists;var h=String.format(e,g);b.append('\r\n                    <Button \r\n                        Id="Ribbon.Page.InsertRelatedDataTo'+this.$T_0+'.RelatedWebPart.Menu.MS.InsertRelatedPartMessage"\r\n                        Image16by16="/_layouts/images/edit.gif"\r\n                        Image32by32="/_layouts/images/placeholder32x32.png"\r\n                        LabelText="'+SP.Utilities.HttpUtility.htmlEncode(h)+'"\r\n                    />')}else for(var i=c.get_count(),d=0;d<i;++d){var a=c.itemAt(d),j=a.get_webId().toString("B"),k=a.get_listId().toString("B"),l=a.get_fieldId().toString("B"),m=j+";"+k+";"+l;b.append('\r\n                        <Button \r\n                            Id="Ribbon.Page.InsertRelatedDataTo'+this.$T_0+".RelatedWebPart.Menu.MS.InsertRelatedPart"+d+'"\r\n                            CommandValueId="'+SP.Utilities.HttpUtility.htmlEncode(m)+'"\r\n                            Command="InsertRelatedWebPartTo'+this.$T_0+'"\r\n                            Image16by16="'+a.get_listImageUrl()+'"\r\n                            Image32by32="/_layouts/images/placeholder32x32.png"\r\n                            LabelText="'+SP.Utilities.HttpUtility.htmlEncode(a.get_resolvedListTitle())+'" \r\n                            ToolTipTitle="'+SP.Utilities.HttpUtility.htmlEncode(a.get_resolvedListTitle())+'"\r\n                            ToolTipDescription="'+SP.Utilities.HttpUtility.htmlEncode(a.get_toolTipDescription())+'"\r\n                        />')}b.append(this.$4S_0);this.$a_0=b.toString()},fetchRelatedFieldsFailure:function(b){ULS04Z:;if(!SP.Ribbon.SU.$0(this.$a_0))return;this.$1G_0=false;var a=new Sys.StringBuilder;a.append(this.$41_0());a.append('\r\n                <Button \r\n                    Id="Ribbon.Page.InsertRelatedDataTo'+this.$T_0+'.RelatedWebPart.Menu.MS.InsertRelatedPartMessage"\r\n                    Image16by16="/_layouts/images/edit.gif"\r\n                    Image32by32="/_layouts/images/placeholder32x32.png"\r\n                    LabelText="'+SP.Utilities.HttpUtility.htmlEncode(b)+'"\r\n                />');a.append(this.$4S_0);this.$a_0=a.toString()},getRelatedFieldsMenuXml:function(a,b,c){ULS04Z:;this.$s_0>=200&&this.fetchRelatedFieldsFailure(SP.Utilities.HttpUtility.htmlEncode(SP.Res.relationships_RelatedFetchFieldsTookTooLong));if(SP.Ribbon.SU.$0(this.$a_0)){this.$s_0=this.$s_0+1;if(!this.$1G_0){this.$1G_0=true;this.$4D_0=new SP.Ribbon.RelatedFieldsFetcher(b,c);var d=this.$4D_0.fetchRelatedFieldsBegin(this);if(d){a.PopulationXML=this.$a_0;this.$4V_0();return a}}if(SP.Ribbon.SU.$0(this.$m_0)&&this.$s_0>5)this.$m_0=SP.UI.Notify.addNotification(SP.Utilities.HttpUtility.htmlEncode(SP.Res.genericLoading),true);a.PollAgainInterval=100;return a}else{a.PopulationXML=this.$a_0;this.$4V_0();!SP.Ribbon.SU.$0(this.$m_0)&&SP.UI.Notify.removeNotification(this.$m_0);return a}},$4V_0:function(){ULS04Z:;this.$a_0=null;this.$s_0=0;this.$1G_0=false}};SP.Ribbon.UsageReportPageComponent=function(){ULS04Z:;SP.Ribbon.UsageReportPageComponent.initializeBase(this)};SP.Ribbon.UsageReportPageComponent.initialize=function(){ULS04Z:;var a=SP.Ribbon.PageManager.get_instance();a&&a.addPageComponent(SP.Ribbon.UsageReportPageComponent.$1u_1)};SP.Ribbon.UsageReportPageComponent.prototype={init:function(){},getFocusedCommands:function(){ULS04Z:;return []},getGlobalCommands:function(){ULS04Z:;return getGlobalCommands()},isFocusable:function(){ULS04Z:;return true},receiveFocus:function(){ULS04Z:;return true},yieldFocus:function(){ULS04Z:;return true},canHandleCommand:function(a){ULS04Z:;return commandEnabled(a)},handleCommand:function(b,a,c){ULS04Z:;return handleCommand(b,a,c)}};SP.Ribbon.GroupBoardWebPartPageComponent=function(b,a){ULS04Z:;this.$5_5={};SP.Ribbon.GroupBoardWebPartPageComponent.initializeBase(this,[b,a]);this.$6W_5()};SP.Ribbon.GroupBoardWebPartPageComponent.prototype={$6W_5:function(){ULS04Z:;var a;a=Function.createDelegate(this,function(){ULS04Z:;return this.$4a_5("CirculationConfirm.aspx")});this.$5_5["CirculationConfirm"]=a;this.$5_5["CirculationDisconfirm"]=a;a=Function.createDelegate(this,function(){ULS04Z:;return this.$4a_5("CalltrackMark.aspx")});this.$5_5["CallTrackResolve"]=a;this.$5_5["CallTrackUnresolve"]=a},handleCommand:function(a,b,c){ULS04Z:;if(this.$5_5[a]){var d=this.$5_5[a];return d(a,b,c)}return SP.Ribbon.GroupBoardWebPartPageComponent.callBaseMethod(this,"handleCommand",[a,b,c])},$4a_5:function(h){ULS04Z:;if(this.getCountOfSelectedItems()!==1)return false;var c=this.get_ctx(),d=this.$18_5(c),g=this.$3z_5(c,d),e=window.location,b=e.pathname,f=e.search;if(!SP.ScriptUtility.isNullOrEmptyString(f))b+=f;b=SP.Utilities.HttpUtility.urlKeyValueEncode(b);var a=new Sys.StringBuilder;a.append('SubmitFormPost("');a.append(SP.Utilities.Utility.getLayoutsPageUrl(h));a.append("?List=");a.append(c.listName);a.append("&Cmd=");a.append(g);a.append("&ID=");a.append(d);a.append("&Source=");a.append(b);a.append('")');this.executeClickScript(a.toString());return true},canHandleCommand:function(b){ULS04Z:;if(this.$5_5[b]){var c=this.get_ctx();if(this.getCountOfSelectedItems()===1){var a=this.$3z_5(c,this.$18_5(c));if(!SP.Ribbon.SU.$0(a))switch(b){case "CirculationConfirm":return a==="Confirm";case "CirculationDisconfirm":return a==="Disconfirm";case "CallTrackResolve":return a==="Resolve";case "CallTrackUnresolve":return a==="Unresolve"}}}return SP.Ribbon.GroupBoardWebPartPageComponent.callBaseMethod(this,"canHandleCommand",[b])},$18_5:function(f){ULS04Z:;var c=GetSelectedItemsDict(f);if(!SP.Ribbon.SU.$0(c)){var a=c;for(var b in a){var d={key:b,value:a[b]},e=d.key.split(",");return e[1]}}return null},$3z_5:function(c,d){ULS04Z:;var b="Action#"+c.listName+"#"+d,a=$get(b);if(SP.Ribbon.SU.$0(a))return null;else return a.value},getGlobalCommands:function(){ULS04Z:;var a=SP.Ribbon.GroupBoardWebPartPageComponent.callBaseMethod(this,"getGlobalCommands");Array.add(a,"CirculationConfirm");Array.add(a,"CirculationDisconfirm");Array.add(a,"CallTrackResolve");Array.add(a,"CallTrackUnresolve");return a},getFocusedCommands:function(){ULS04Z:;return SP.Ribbon.GroupBoardWebPartPageComponent.callBaseMethod(this,"getFocusedCommands")},addAlwaysEnabledCommands:function(){ULS04Z:;SP.Ribbon.GroupBoardWebPartPageComponent.callBaseMethod(this,"addAlwaysEnabledCommands");var a=this.get_alwaysEnabledCommands();a["TimecardTab"]=true;a["TimecardActions"]=true;a["TimecardManage"]=true;a["TimecardSettings"]=true;a["CirculationMenuOpen"]=true;a["CallTrackMenuOpen"]=true}};SP.Ribbon.CalendarPageComponentData=function(){ULS04Z:;SP.Ribbon.CalendarPageComponentData.initializeBase(this)};SP.Ribbon.CalendarPageComponentData.prototype={CurrentUserInfo:null,EnablePeopleSelector:false,EnableResourceSelector:false};SP.Ribbon.CalendarListPageComponent=function(c,a){ULS04Z:;this.$3V=Function.createDelegate(this,this.$6T_5);this.$2r=Function.createDelegate(this,this.$52_5);this.$2w=Function.createDelegate(this,this.$2D_5);this.$3J=Function.createDelegate(this,this.$5u_5);this.$3K=Function.createDelegate(this,this.$5v_5);this.$3I=Function.createDelegate(this,this.$5t_5);this.$3N=Function.createDelegate(this,this.$6E_5);this.$3M=Function.createDelegate(this,this.$6D_5);this.$3P=Function.createDelegate(this,this.$6J_5);this.$3T=Function.createDelegate(this,this.$6R_5);this.$3C=Function.createDelegate(this,this.$5d_5);this.$3U=Function.createDelegate(this,this.$6S_5);this.$2g=Function.createDelegate(this,this.$4i_5);this.$3B=Function.createDelegate(this,this.$5W_5);this.$3H=Function.createDelegate(this,this.$5h_5);this.$5g_5="/_layouts/"+SP.Res.lcid+"/images/formatmap32x32.png";this.$8_5={};this.$5_5={};SP.Ribbon.CalendarListPageComponent.initializeBase(this,[c,a]);var b=this.get_ctx();if(!b)return;this.$1A_5=b.ctxId;this.$I_5=a.CurrentUserInfo;this.$o_5=a.EnablePeopleSelector;this.$h_5=a.EnableResourceSelector;this.$N_5="106"===this.get_ctx().listTemplate;this.$5z_5();this.$5y_5()};SP.Ribbon.CalendarListPageComponent.prototype={$2B_5:null,$1A_5:null,$2c_5:null,$u_5:null,$I_5:null,$h_5:false,$o_5:false,$N_5:false,get_$Y_5:function(){ULS04Z:;if(!this.$2B_5)this.$2B_5=SP.UI.ApplicationPages.CalendarInstanceRepository.lookupInstance(this.$1A_5);return this.$2B_5},$5y_5:function(){ULS04Z:;if(!this.get_ctx())return;var a;a=this.$3H;this.$5_5["Subscribe"]=a;this.$5_5["ViewProperties"]=a;this.$5_5["EditProperties"]=a;this.$5_5["ManagePermissions"]=a;this.$5_5["ViewVersions"]=a;this.$5_5["Moderate"]=a;this.$5_5["ViewWorkflows"]=a;this.$5_5["AttachFile"]=a;this.$5_5["Delete"]=this.$3B;this.$5_5["CalendarAddCalendar"]=this.$2g;a=this.$3U;this.$5_5["CalendarPeopleSelect"]=a;this.$5_5["CalendarResourceSelect"]=a;a=this.$3C;this.$5_5["CalendarExpand"]=a;this.$5_5["CalendarCollapse"]=a;a=this.$3T;this.$5_5["CalendarScopeDay"]=a;this.$5_5["CalendarScopeWeek"]=a;this.$5_5["CalendarScopeMonth"]=a;this.$5_5["CalendarScopeWeekGroup"]=a;this.$5_5["CalendarScopeDayGroup"]=a;a=this.$3P;this.$5_5["QueryCalendarScopeWeekGroup"]=a;this.$5_5["QueryCalendarScopeDayGroup"]=a;this.$5_5["QueryCalendarScopeDay"]=a;this.$5_5["QueryCalendarScopeWeek"]=a;this.$5_5["QueryCalendarScopeMonth"]=a;if(this.$N_5)a=this.$3M;else a=this.$3N;this.$5_5["NewListItem"]=a;this.$5_5["NewDefaultListItem"]=a;this.$5_5["PopulateNewDocumentMenu"]=Function.createDelegate(this,function(b,a){ULS04Z:;a.PopulationJSON=this.getNewMenuXml("NewDocument","Ribbon.Document.All.NewDocument");return true});this.$5_5["NewDocument"]=Function.createDelegate(this,function(c,a){ULS04Z:;var b=a["CommandValueId"];this.executeClickScript(b);return true});this.$5_5["NewDefaultDocument"]=Function.createDelegate(this,function(){ULS04Z:;this.executeClickScript(this.getDefaultNewMenuItemScript());return true});if(this.$N_5)this.$5_5["ConnectToClient"]=this.$3I;this.$5_5["PopulatePeopleMenu"]=this.$3K;this.$5_5["CalendarPeopleMenuSelect"]=this.$3J},$4i_5:function(){ULS04Z:;var a=this.get_ctx(),b=String.format("STSNavigate('{0}/_layouts/aggregationsettings.aspx?List={1}&View={2}&Source={3}')",a.HttpRoot,a.listName,a.view,GetSource());SP.Ribbon.NativeUtility.executeECBCommand(b,a);return true},$5u_5:function(f,e){ULS04Z:;for(var d=e["CommandValueId"],a=0;a<this.$I_5.length;a++)if(this.$I_5[a]["id"]===d){var c=SP.UI.ApplicationPages.CalendarSelector.instance().getSelector(3,this.$1A_5);if(!SP.Ribbon.SU.$0(c)){var b=new SP.UI.ApplicationPages.ResolveEntity;b.entityType=SP.UI.ApplicationPages.ResolveEntity.typE_USER;b.displayName=this.$I_5[a]["displayName"];b.id=this.$I_5[a]["id"];if(a){b.needResolve=true;b.isGroup=true}else{b.email=this.$I_5[a]["email"];b.accountName=this.$I_5[a]["accountName"]}c.setEntity(b)}break}return true},$5v_5:function(d,c){ULS04Z:;var a=new Sys.StringBuilder;a.append("<Menu Id='");a.append(SP.Utilities.HttpUtility.htmlEncode("Ribbon.Calendar.Selector.People"));a.append(".Menu'>");a.append("<MenuSection Id='");a.append("Ribbon.Calendar.Selector.People");a.append(".Menu.ContentTypes'>");a.append("<Controls Id='");a.append(SP.Utilities.HttpUtility.htmlEncode("Ribbon.Calendar.Selector.People"));a.append(".Menu.ContentTypes.Controls'>");this.$3b_5(a,"Ribbon.Calendar.Selector.People.Menu.Entities.AddPerson","CalendarPeopleSelect","CalendarPeopleSelect","CalendarPeopleSelect",SP.Res.cui_AddPerson);if(!SP.Ribbon.SU.$0(this.$I_5))for(var b=0;b<this.$I_5.length;b++)this.$3b_5(a,"Ribbon.Calendar.Selector.People.Menu.Entities."+b.toString(),"CalendarPeopleMenuSelect",this.$I_5[b]["id"],this.$I_5[b]["id"],this.$I_5[b]["displayName"]);a.append("</Controls>");a.append("</MenuSection>");a.append("</Menu>");c.PopulationXML=a.toString();return true},$3b_5:function(a,b,c,d,e,f){ULS04Z:;a.append("<Button Id='");a.append(SP.Utilities.HttpUtility.htmlEncode(b));a.append("' Command='");a.append(SP.Utilities.HttpUtility.htmlEncode(c));a.append("' MenuItemId='");a.append(SP.Utilities.HttpUtility.htmlEncode(d));a.append("' CommandValueId='");a.append(SP.Utilities.HttpUtility.htmlEncode(e));a.append("' CommandType='OptionSelection' LabelText='");a.append(SP.Utilities.HttpUtility.htmlEncode(f));a.append("'/>")},$5t_5:function(e){ULS04Z:;if(SP.Ribbon.SU.$0(this.$u_5)){var f=this._controlData[e];this.executeClickScript(f.ClickScript)}else{window.self.offlineBtnUser=this.$u_5.id;var d=this._controlData[e];if(!SP.Ribbon.SU.$0(d)){for(var c=d.ClickScript.split("','"),a=new Sys.StringBuilder(c[0]),b=1;b<c.length;b++){a.append("','");if(b===4)a.append(SP.Utilities.HttpUtility.ecmaScriptStringLiteralEncode(EEDecodeSpecialChars(this.$u_5.displayName)));else a.append(c[b])}this.executeClickScript(a.toString())}}return true},$5h_5:function(e){ULS04Z:;var a=this.get_ctx(),b=this.$18_5(a);if(!b||!this.$2D_5(e))return true;var c=b;if(b.indexOf(".0.")!==-1||b.indexOf(".1.")!==-1)c=b.substr(0,b.indexOf("."));var d=null;switch(e){case "AttachFile":AttachFile(a);break;case "Subscribe":this.$1r_5(String.format("{0}/_layouts/SubNew.aspx?List={1}&ID={2}&Source={3}",a["HttpRoot"],SP.Utilities.HttpUtility.urlKeyValueEncode(a["listName"]),SP.Utilities.HttpUtility.urlKeyValueEncode(c),GetSource()),false);break;case "ViewProperties":this.$1r_5(String.format("{0}&ID={1}",a["displayFormUrl"],SP.Utilities.HttpUtility.urlKeyValueEncode(b)),true);break;case "EditProperties":this.$1r_5(String.format("{0}&ID={1}",a["editFormUrl"],SP.Utilities.HttpUtility.urlKeyValueEncode(b)),true);break;case "ManagePermissions":d=String.format("NavigateToManagePermsPage('{0}','{1}','{2}')",a["HttpRoot"],SP.Utilities.HttpUtility.urlKeyValueEncode(a["listName"]),SP.Utilities.HttpUtility.urlKeyValueEncode(c));break;case "ViewVersions":d=String.format("NavigateToVersionsAspxV4(event,'{0}','List={1}&ID={2}')",a["HttpRoot"],SP.Utilities.HttpUtility.urlKeyValueEncode(a["listName"]),SP.Utilities.HttpUtility.urlKeyValueEncode(c));break;case "Moderate":d=String.format("NavigateToApproveRejectAspx(event,'{0}/_layouts/approve.aspx?List={1}&ID={2}&Source={3}')",a["HttpRoot"],SP.Utilities.HttpUtility.urlKeyValueEncode(a["listName"]),SP.Utilities.HttpUtility.urlKeyValueEncode(c),GetSource());break;case "ViewWorkflows":d=String.format("STSNavigate('{0}/_layouts/Workflow.aspx?List={1}&ID={2}&Source={3}')",a["HttpRoot"],SP.Utilities.HttpUtility.urlKeyValueEncode(a["listName"]),SP.Utilities.HttpUtility.urlKeyValueEncode(c),GetSource())}d&&SP.Ribbon.NativeUtility.executeECBCommand(d,a);return true},$1r_5:function(b,c){ULS04Z:;var a=SP.UI.$create_DialogOptions();a.url=b;if(c&&this.get_$Y_5())a.dialogReturnValueCallback=Function.createDelegate(this,function(a){ULS04Z:;a===1&&this.get_$Y_5().refreshItems()});SP.UI.ModalDialog.showModalDialog(a)},$5W_5:function(d){ULS04Z:;var a=this.get_$Y_5(),c=this.get_ctx(),b=this.$18_5(c);if(!b||!this.$2D_5(d)||!a)return true;a.deleteItem(b);return true},$6D_5:function(c,b){ULS04Z:;var a=this.get_$Y_5();a&&a.newItemDialog(this.$3w_5(b["CommandValueId"]));return true},$6E_5:function(e,d){ULS04Z:;var c=this.get_ctx(),a=new SP.Utilities.UrlBuilder(c["newFormUrl"]),b=this.$3w_5(d["CommandValueId"]);!SP.Ribbon.SU.$2(b)&&a.addKeyValueQueryString("ContentTypeId",b);this.$1r_5(a.get_url(),true);return true},$3w_5:function(c){ULS04Z:;var d=null;if(!SP.Ribbon.SU.$0(c)){var e=c.toUpperCase(),a=e.lastIndexOf("CONTENTTYPEID="),b=e.lastIndexOf("')");if(a!==-1&&b!==-1&&a+14<b)d=c.substring(a+14,b)}return d},$6R_5:function(c){ULS04Z:;var b=this.$3m_5(c),a=this.get_$Y_5();a&&a.moveToView(b);return true},$5d_5:function(b){ULS04Z:;var a=this.get_$Y_5();if(!a)return true;if(b==="CalendarExpand")a.expandAll();else b==="CalendarCollapse"&&a.collapseAll();return true},$6S_5:function(f){ULS04Z:;var c=this.get_$Y_5();if(!c)return true;var b;if(f==="CalendarPeopleSelect")b=2;else b=1;var d=c.getActiveScope(),e=d===5||d===2,a=new Sys.StringBuilder;a.append("__spPickerDialogFunc(");a.append(b.toString());a.append(",'");a.append(this.$1A_5);a.append("',");a.append(e?"true":"false");a.append(");");this.executeClickScript(a.toString());return true},$6J_5:function(b,c){ULS04Z:;var a=this.$3m_5(b);c["On"]=this.$3u_5()===a;return true},$3m_5:function(a){ULS04Z:;switch(a){case "QueryCalendarScopeDayGroup":case "CalendarScopeDayGroup":return 5;case "QueryCalendarScopeWeekGroup":case "CalendarScopeWeekGroup":return 2;case "QueryCalendarScopeDay":case "CalendarScopeDay":return 3;case "QueryCalendarScopeWeek":case "CalendarScopeWeek":return 4;case "QueryCalendarScopeMonth":case "CalendarScopeMonth":return 1}return 0},$2D_5:function(k){ULS04Z:;var b=this.get_ctx(),c=this.$18_5(b);if(!c)return false;var d=c.indexOf(".0.")!==-1,g=c.indexOf(".1.")!==-1,h=GetSelectedItemsDict(b),e=h;for(var f in e){var i={key:f,value:e[f]},j=i.value,a=this.$5U_5(j["Permissions"]);switch(k){case "Subscribe":if(!d)return a.has(40);break;case "ViewProperties":return a.has(1)&&a.has(13);case "Delete":return a.has(4)&&this.$N_5;case "EditProperties":return a.has(3)&&this.$N_5;case "AttachFile":return a.has(3)&&this.$N_5&&!d&&!g;case "ManagePermissions":if(!d&&!g)return a.has(63)&&this.$N_5;break;case "ViewVersions":return b["verEnabled"]===1&&a.has(7)&&this.$N_5;case "Moderate":return b["isModerated"]&&a.has(3)&&a.has(5)&&a.has(18)&&a.has(13)&&this.$N_5;case "ViewWorkflows":return b["WorkflowsAssociated"]&&a.has(3)&&this.$N_5}return false}return false},$5U_5:function(b){ULS04Z:;var c=new SP.BasePermissions;if(SP.Ribbon.SU.$2(b))return c;var d=0,a=0,e=b.length;if(e<8)a=parseInt(b,16);else{a=parseInt(b.substr(e-8),16);d=parseInt(b.substr(0,e-8),16)}for(var f=1;a>0;f++,a>>>=1)(a&1)===1&&c.set(f);for(var g=33;d>0;g++,d>>>=1)(d&1)===1&&c.set(g);return c},$5z_5:function(){ULS04Z:;if(!this.get_ctx())return;var a=this.$2w,f=Function.createDelegate(this,function(){ULS04Z:;var a=this.$3u_5();return a===1||a===2}),b=Function.createDelegate(this,function(){ULS04Z:;return false}),c=Function.createDelegate(this,function(){ULS04Z:;return true});this.$8_5["CalendarAddCalendar"]=this.$N_5?c:b;this.$8_5["CalendarScopeDayGroup"]=this.$o_5|this.$h_5?c:b;this.$8_5["CalendarScopeWeekGroup"]=this.$o_5|this.$h_5?c:b;this.$8_5["QueryCalendarScopeDayGroup"]=this.$o_5|this.$h_5?c:b;this.$8_5["QueryCalendarScopeWeekGroup"]=this.$o_5|this.$h_5?c:b;this.$8_5["Subscribe"]=a;this.$8_5["ViewProperties"]=a;this.$8_5["Delete"]=a;this.$8_5["EditProperties"]=a;this.$8_5["ManagePermissions"]=a;this.$8_5["ViewVersions"]=a;this.$8_5["Moderate"]=a;this.$8_5["ViewWorkflows"]=a;this.$8_5["AttachFile"]=a;this.$8_5["UploadDocumentMenuOpen"]=this.$2r;var d=Function.createDelegate(this,function(){ULS04Z:;return !SP.Ribbon.SU.$0(this.get_newMenuData())&&this.get_newMenuData().length>0});this.$8_5["NewDefaultDocument"]=d;this.$8_5["PopulateNewDocumentMenu"]=d;this.$8_5["NewDocument"]=d;this.$8_5["NewDocumentMenuOpen"]=d;this.$8_5["CalendarExpand"]=f;this.$8_5["CalendarCollapse"]=f;var e=SP.Ribbon.SU.$1C(this.$I_5)?b:c;this.$8_5["CalendarPeopleSelect"]=e;this.$8_5["PopulatePeopleMenu"]=e;this.$8_5["CalendarPeopleMenuOpen"]=e;this.$8_5["CalendarPeopleMenuSelect"]=e;this.$8_5["CalendarResourceSelect"]=this.$h_5?c:b;if(this.$o_5|this.$h_5){this.$8_5["ConnectToClient"]=this.$3V;var g=SP.UI.ApplicationPages.CalendarSelector.instance();g.addHandler(this.$1A_5,true,true,Function.createDelegate(this,function(b,a){ULS04Z:;this.$2c_5=a.get_entities();SP.Ribbon.UtilityInternal.$e()}))}},$6T_5:function(){ULS04Z:;for(var b=[],e=this.$2c_5.length,d=0;d<e;d++){var a=this.$2c_5[d];if(a.entityType!==SP.UI.ApplicationPages.ResolveEntity.typE_USER)return false;if(a.isGroup){if(a.needResolve)return false;for(var c=0;c<a.members.length;c++)a.members[c]&&Array.add(b,a.members[c])}else Array.add(b,a)}if(b.length===1){this.$u_5=b[0];if(this.$u_5.id)return true}this.$u_5=null;return false},$52_5:function(){ULS04Z:;return SP.Ribbon.CalendarListPageComponent.callBaseMethod(this,"canHandleCommand",["UploadDocument"])},handleCommand:function(a,b,c){ULS04Z:;var d=this.$5_5[a];if(!SP.Ribbon.SU.$0(d)&&d(a,b,c))return true;return SP.Ribbon.CalendarListPageComponent.callBaseMethod(this,"handleCommand",[a,b,c])},canHandleCommand:function(a){ULS04Z:;var b=this.$8_5[a];if(!SP.Ribbon.SU.$0(b))return b(a);return SP.Ribbon.CalendarListPageComponent.callBaseMethod(this,"canHandleCommand",[a])},getGlobalCommands:function(){ULS04Z:;var a=SP.Ribbon.CalendarListPageComponent.callBaseMethod(this,"getGlobalCommands");Array.add(a,"CalendarPeopleSelect");Array.add(a,"CalendarResourceSelect");Array.add(a,"CalendarPeopleMenuOpen");Array.add(a,"PopulatePeopleMenu");Array.add(a,"CalendarPeopleMenuSelect");Array.add(a,"CalendarExpand");Array.add(a,"CalendarCollapse");Array.add(a,"CalendarAddCalendar");Array.add(a,"CalendarScopeDayGroup");Array.add(a,"CalendarScopeWeekGroup");Array.add(a,"QueryCalendarScopeDayGroup");Array.add(a,"QueryCalendarScopeWeekGroup");Array.add(a,"NewDocument");Array.add(a,"PopulateNewDocumentMenu");Array.add(a,"NewDefaultDocument");Array.add(a,"UploadDocumentMenuOpen");Array.add(a,"NewDocumentMenuOpen");return a},getFocusedCommands:function(){ULS04Z:;return SP.Ribbon.CalendarListPageComponent.callBaseMethod(this,"getFocusedCommands")},addAlwaysEnabledCommands:function(){ULS04Z:;SP.Ribbon.CalendarListPageComponent.callBaseMethod(this,"addAlwaysEnabledCommands");var a=this.get_alwaysEnabledCommands();a["CalendarTab"]=true;a["DocumentTab"]=true;a["LibraryTab"]=true;a["DocumentNewGroup"]=true;a["DocumentManageGroup"]=true;a["CalendarSelectorGroup"]=true;a["CalendarScopeGroup"]=true;a["CalendarExpanderGroup"]=true;a["CalendarScopeDay"]=true;a["CalendarScopeWeek"]=true;a["CalendarScopeMonth"]=true;a["QueryCalendarScopeDay"]=true;a["QueryCalendarScopeWeek"]=true;a["QueryCalendarScopeMonth"]=true},$3u_5:function(){ULS04Z:;var a=this.get_$Y_5();if(a)return a.getActiveScope();else return 0},$18_5:function(f){ULS04Z:;var c=GetSelectedItemsDict(f);if(!SP.Ribbon.SU.$0(c)){var a=c;for(var b in a){var d={key:b,value:a[b]},e=d.key.split(",");return e[1]}}return null}};SP.Ribbon.HelpCommandNames=function(){};SP.Ribbon.HelpPageComponent=function(){ULS04Z:;SP.Ribbon.HelpPageComponent.initializeBase(this)};SP.Ribbon.HelpPageComponent.get_instance=function(){ULS04Z:;if(!SP.Ribbon.HelpPageComponent.$3_1)SP.Ribbon.HelpPageComponent.$3_1=new SP.Ribbon.HelpPageComponent;return SP.Ribbon.HelpPageComponent.$3_1};SP.Ribbon.HelpPageComponent.registerWithPageManager=function(){ULS04Z:;SP.Ribbon.PageManager.get_instance().addPageComponent(SP.Ribbon.HelpPageComponent.get_instance())};SP.Ribbon.HelpPageComponent.unregisterWithPageManager=function(){ULS04Z:;SP.Ribbon.HelpPageComponent.$3_1&&SP.Ribbon.PageManager.get_instance().removePageComponent(SP.Ribbon.HelpPageComponent.get_instance())};SP.Ribbon.HelpPageComponent.prototype={$4E_1:null,$1j_1:null,init:function(){ULS04Z:;this.$4E_1=["RequestContextualHelp"];this.$1j_1=["RequestContextualHelp"]},getFocusedCommands:function(){ULS04Z:;return this.$4E_1},getGlobalCommands:function(){ULS04Z:;return this.$1j_1},canHandleCommand:function(a){ULS04Z:;if(a==="RequestContextualHelp")return true;else return false},getId:function(){ULS04Z:;return "HelpComponent"},$1k_1:false,handleCommand:function(b,a,c){ULS04Z:;if(SP.Ribbon.SU.$2(b)||SP.Ribbon.SU.$0(a)||SP.Ribbon.SU.$0(c))return false;if(b==="RequestContextualHelp"){this.$1k_1=true;HelpWindowKey(a["HelpKeyword"]);this.$1k_1=false}else return false;return true},isFocusable:function(){ULS04Z:;return true},receiveFocus:function(){ULS04Z:;return true},yieldFocus:function(){ULS04Z:;return true}};SP.Ribbon.SaveConflictHandler=function(){};SP.Ribbon.SaveConflictHandler.$14=function(){ULS04Z:;if(!SP.Ribbon.SU.$2(SP.Ribbon.SaveConflictHandler.$w_0)){SP.UI.Status.removeStatus(SP.Ribbon.SaveConflictHandler.$w_0);SP.Ribbon.SaveConflictHandler.$w_0=null}if(!SP.Ribbon.SU.$2(SP.Ribbon.SaveConflictHandler.$x_0)){SP.UI.Status.removeStatus(SP.Ribbon.SaveConflictHandler.$x_0);SP.Ribbon.SaveConflictHandler.$x_0=null}if(!SP.Ribbon.SU.$2(SP.Ribbon.SaveConflictHandler.$y_0)){SP.UI.Status.removeStatus(SP.Ribbon.SaveConflictHandler.$y_0);SP.Ribbon.SaveConflictHandler.$y_0=null}};SP.Ribbon.SaveConflictHandler.$6Y=function(a){ULS04Z:;SP.Ribbon.SaveConflictHandler.$y_0=SP.UI.Status.addStatus(SP.Utilities.HttpUtility.htmlEncode(SP.Res.saveConflictStatusBarTitle),a,true);SP.UI.Status.setStatusPriColor(SP.Ribbon.SaveConflictHandler.$y_0,"yellow")};SP.Ribbon.SaveConflictHandler.showSaveConflictDialog=function(lastModifiedUserId,continueStatusHtml,mergeChangesUrl,mergeChangesStatusHtml,discardScript,overwriteScript){ULS04Z:;var $v_0=SP.Utilities.Utility.getLayoutsPageUrl("saveconflict.aspx"),$v_1=new SP.Utilities.UrlBuilder($v_0);$v_1.addKeyValueQueryString("UserId",lastModifiedUserId.toString());var $v_2=SP.UI.$create_DialogOptions();$v_2.args=mergeChangesUrl;$v_2.url=$v_1.get_url();$v_2.showClose=false;$v_2.dialogReturnValueCallback=function($p1_0,$p1_1){if($p1_0===1){var $v_4=$p1_1;switch($v_4){case "continue":SP.Ribbon.SaveConflictHandler.$14();SP.Ribbon.SaveConflictHandler.$w_0=SP.UI.Status.addStatus(SP.Utilities.HttpUtility.htmlEncode(SP.Res.saveConflictStatusBarTitle),continueStatusHtml,true);SP.UI.Status.setStatusPriColor(SP.Ribbon.SaveConflictHandler.$w_0,"red");break;case "merge":SP.Ribbon.SaveConflictHandler.$14();SP.Ribbon.SaveConflictHandler.$x_0=SP.UI.Status.addStatus(SP.Utilities.HttpUtility.htmlEncode(SP.Res.saveConflictStatusBarTitle),mergeChangesStatusHtml,true);SP.UI.Status.setStatusPriColor(SP.Ribbon.SaveConflictHandler.$x_0,"red");break;case "discard":SP.Ribbon.SaveConflictHandler.$14();!SP.Ribbon.SU.$2(discardScript)&&window.setTimeout(function(){ULS04Z:;eval(discardScript)},0);break;case "overwrite":SP.Ribbon.SaveConflictHandler.$14();!SP.Ribbon.SU.$2(overwriteScript)&&window.setTimeout(function(){ULS04Z:;eval(overwriteScript)},0)}}};var $v_3=SP.UI.ModalDialog.showModalDialog($v_2);return $v_3};SP.Ribbon.TrackTabPageComponent=function(){ULS04Z:;SP.Ribbon.TrackTabPageComponent.initializeBase(this)};SP.Ribbon.TrackTabPageComponent.registerWithPageManager=function(){ULS04Z:;if(!SP.Ribbon.TrackTabPageComponent.$3_1){SP.Ribbon.TrackTabPageComponent.$3_1=new SP.Ribbon.TrackTabPageComponent;SP.Ribbon.PageManager.get_instance().addPageComponent(SP.Ribbon.TrackTabPageComponent.$3_1)}};SP.Ribbon.TrackTabPageComponent.prototype={getGlobalCommands:function(){ULS04Z:;if(!SP.Ribbon.TrackTabPageComponent.$1t_1)SP.Ribbon.TrackTabPageComponent.$1t_1=["EmailPageUrl","EmailPageLink","ShareGroup","ManageAlerts"];return SP.Ribbon.TrackTabPageComponent.$1t_1},canHandleCommand:function(a){ULS04Z:;if(a==="ManageAlerts")if(window._spPageContextInfo&&window._spPageContextInfo.userId)return true;else return false;return true},handleCommand:function(b){ULS04Z:;var a=false;switch(b){case "EmailPageUrl":SP.Ribbon.EMailLink.openMailerWithUrl(document.URL);a=true;break;case "EmailPageLink":window.navigateMailToLink(document.URL);a=true;break;case "ManageAlerts":SP.Utilities.HttpUtility.navigateTo(SP.Utilities.Utility.getLayoutsPageUrl("MySubs.aspx"));a=true}return a}};SP.Ribbon.UserInterfacePageComponent=function(){ULS04Z:;SP.Ribbon.UserInterfacePageComponent.initializeBase(this);var a=window.g_spribbon;this.$68_1=a.minimizedHeight;this.$66_1=a.maximizedHeight};SP.Ribbon.UserInterfacePageComponent.get_instance=function(){ULS04Z:;if(!SP.Ribbon.UserInterfacePageComponent.$3_1)SP.Ribbon.UserInterfacePageComponent.$3_1=new SP.Ribbon.UserInterfacePageComponent;return SP.Ribbon.UserInterfacePageComponent.$3_1};SP.Ribbon.UserInterfacePageComponent.registerWithPageManager=function(){ULS04Z:;SP.Ribbon.PageManager.get_instance().addPageComponent(SP.Ribbon.UserInterfacePageComponent.get_instance())};SP.Ribbon.UserInterfacePageComponent.unregisterWithPageManager=function(){ULS04Z:;SP.Ribbon.UserInterfacePageComponent.$3_1&&SP.Ribbon.PageManager.get_instance().removePageComponent(SP.Ribbon.UserInterfacePageComponent.get_instance())};SP.Ribbon.UserInterfacePageComponent.prototype={$1j_1:null,$68_1:null,$66_1:null,$2Q_1:null,init:function(){ULS04Z:;this.$1j_1=["RibbonEvent","CommandContextChanged"]},getGlobalCommands:function(){ULS04Z:;return this.$1j_1},canHandleCommand:function(a){ULS04Z:;if(a==="RibbonEvent"||a==="CommandContextChanged")return true;else return false},getId:function(){ULS04Z:;return "UIComponent"},$1k_1:false,handleCommand:function(c,b,e){ULS04Z:;var d=false;this.$1k_1=true;if(SP.Ribbon.SU.$2(c)||SP.Ribbon.SU.$0(b)||SP.Ribbon.SU.$0(e))return false;if(c==="RibbonEvent"){MenuHtc_hide();var f=b;d=this.$46_1(f.Minimized||this.$2Q_1==="Ribbon.Read")}else if(c==="CommandContextChanged"){var a=b;!SP.Ribbon.SU.$0(a.ChangedByUser)&&a.ChangedByUser&&MenuHtc_hide();if(!SP.Ribbon.SU.$0(a.NewContextId)&&a.NewContextId==="Ribbon.Read"||this.$2Q_1==="Ribbon.Read")d=this.$46_1(a.NewContextId==="Ribbon.Read");this.$2Q_1=a.NewContextId}this.$1k_1=false;return d},isFocusable:function(){ULS04Z:;return false},$46_1:function(a){ULS04Z:;OnRibbonMinimizedChanged(a);return true}};SP.Ribbon.EMailLink=function(){};SP.Ribbon.EMailLink.get_$3c_0=function(){ULS04Z:;if(!SP.Ribbon.SU.$2(SP.Ribbon.EMailLink.$1e_0))return SP.Ribbon.EMailLink.$1e_0;return SP.Res.emailDefaultBody};SP.Ribbon.EMailLink.openMailerWithUrl=function(a){ULS04Z:;SP.Ribbon.EMailLink.$1h_0=new SP.ClientContext;SP.Ribbon.EMailLink.$1p_0=SP.Utilities.Utility.createEmailBodyForInvitation(SP.Ribbon.EMailLink.$1h_0,a);SP.Ribbon.EMailLink.$1h_0.executeQueryAsync(SP.Ribbon.EMailLink.onSucceededEmailBody,SP.Ribbon.EMailLink.onFailed)};SP.Ribbon.EMailLink.onSucceededEmailBody=function(){ULS04Z:;if(SP.Ribbon.EMailLink.$1p_0)SP.Ribbon.EMailLink.$1e_0=SP.Ribbon.EMailLink.$1p_0.get_value();window.navigateMailToLinkWithMessage("",SP.Ribbon.EMailLink.get_$3c_0())};SP.Ribbon.EMailLink.onFailed=function(){ULS04Z:;window.navigateMailToLinkWithMessage("",SP.Ribbon.EMailLink.get_$3c_0())};Type.registerNamespace("SP.Ribbon.PageState");SP.Ribbon.PageState.PageStateStrings=function(){};SP.Ribbon.PageState.PageStateCommands=function(){};SP.Ribbon.PageState.PageStateHandler=function(){ULS04Z:;SP.Ribbon.PageState.PageStateHandler.initializeBase(this)};SP.Ribbon.PageState.PageStateHandler.getButtonId=function(a){ULS04Z:;if(!SP.Ribbon.PageState.PageStateHandler.$c_1){SP.Ribbon.PageState.PageStateHandler.$c_1={};SP.Ribbon.PageState.PageStateHandler.$c_1["PageStateGroupPublish"]="Publish";SP.Ribbon.PageState.PageStateHandler.$c_1["PageStateGroupUnpublish"]="Unpublish";SP.Ribbon.PageState.PageStateHandler.$c_1["PageStateGroupSubmitForApproval"]="SubmitForApproval";SP.Ribbon.PageState.PageStateHandler.$c_1["PageStateGroupCancelApproval"]="CancelApproval"}return SP.Ribbon.PageState.PageStateHandler.$c_1[a]};SP.Ribbon.PageState.PageStateHandler.setHandleSaveMenu=function(a){ULS04Z:;SP.Ribbon.PageState.PageStateHandler.$1Z_1=a};SP.Ribbon.PageState.PageStateHandler.$5n_1=function($p0){var $v_0=null,$v_1=false;if(!SP.Ribbon.SU.$0(SP.Ribbon.PageState.PageStateHandler.$13_1[$p0]))for(var $v_2=SP.Ribbon.PageState.PageStateHandler.$13_1[$p0],$v_3=0;$v_3<$v_2.length&&!$v_1;$v_3++)if(eval(SP.Ribbon.PageState.ImportedNativeData.EnabledHandlers[$v_2[$v_3]]))if(!$v_0)$v_0=$v_2[$v_3];else{$v_0=null;$v_1=true}return $v_0};SP.Ribbon.PageState.PageStateHandler.$5o_1=function(c){ULS04Z:;var a=c[CUI.Controls.DropDownCommandProperties.SelectedItemId],b=a.lastIndexOf(".");if(b<0)return null;return a.substring(0,b+1)};SP.Ribbon.PageState.PageStateHandler.$6X_1=function(){ULS04Z:;var a=false;if(SP.Ribbon.PageState.ImportedNativeData.PageState["DocLibMinorVersionsEnabled"]&&SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsMinorVersion"]||SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsRejected"]||SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsPendingApproval"]||SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsScheduled"]||SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsCheckedOutToCurrentUser"]||SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsCheckedOutToOtherUser"])a=true;return a};SP.Ribbon.PageState.PageStateHandler.showPageStatus=function(){ULS04Z:;if(SP.Ribbon.PageState.PageStateHandler.$6X_1()){for(var b="",a=0;a<SP.Ribbon.PageState.ImportedNativeData.StatusBody.length;a++)if(!SP.Ribbon.SU.$2(SP.Ribbon.PageState.ImportedNativeData.StatusTitle[a])&&!SP.Ribbon.SU.$2(SP.Ribbon.PageState.ImportedNativeData.StatusBody[a]))if(!SP.Ribbon.SU.$2(SP.Ribbon.PageState.PageStateHandler.$C_1[a])&&$get(SP.Ribbon.PageState.PageStateHandler.$C_1[a]+"_body")){SP.UI.Status.updateStatus(SP.Ribbon.PageState.PageStateHandler.$C_1[a],SP.Ribbon.PageState.ImportedNativeData.StatusBody[a]);SP.UI.Status.setStatusPriColor(SP.Ribbon.PageState.PageStateHandler.$C_1[a],SP.Ribbon.PageState.ImportedNativeData.StatusPriority);if(SP.Ribbon.SU.$2(b))b=SP.Ribbon.PageState.PageStateHandler.$C_1[a]}else{if(SP.Ribbon.SU.$2(b)){SP.Ribbon.PageState.PageStateHandler.$C_1[a]=SP.UI.Status.addStatus(SP.Ribbon.PageState.ImportedNativeData.StatusTitle[a],SP.Ribbon.PageState.ImportedNativeData.StatusBody[a],false);b=SP.Ribbon.PageState.PageStateHandler.$C_1[a]}else SP.Ribbon.PageState.PageStateHandler.$C_1[a]=SP.UI.Status.appendStatus(b,SP.Ribbon.PageState.ImportedNativeData.StatusTitle[a],SP.Ribbon.PageState.ImportedNativeData.StatusBody[a]);SP.UI.Status.setStatusPriColor(SP.Ribbon.PageState.PageStateHandler.$C_1[a],SP.Ribbon.PageState.ImportedNativeData.StatusPriority)}else if(!SP.Ribbon.SU.$2(SP.Ribbon.PageState.PageStateHandler.$C_1[a])){SP.UI.Status.removeStatus(SP.Ribbon.PageState.PageStateHandler.$C_1[a]);SP.Ribbon.PageState.PageStateHandler.$C_1[a]=null}}else for(var c=0;c<SP.Ribbon.PageState.PageStateHandler.$C_1.length;c++)if(!SP.Ribbon.SU.$2(SP.Ribbon.PageState.PageStateHandler.$C_1[c])){SP.UI.Status.removeStatus(SP.Ribbon.PageState.PageStateHandler.$C_1[c]);SP.Ribbon.PageState.PageStateHandler.$C_1[c]=null}};SP.Ribbon.PageState.PageStateHandler.showErrorDialog=function(){ULS04Z:;if(SP.Ribbon.SU.$2(SP.Ribbon.PageState.NativeErrorState.ShowErrorDialogScript)){for(var $v_0="<p>"+SP.Ribbon.PageState.NativeErrorState.Message+"</p><center><ul class='ms-dlgErrList'>",$v_3=0;$v_3<SP.Ribbon.PageState.NativeErrorState.ButtonCount;$v_3++)$v_0+='<li class="ms-dlgErrItem"><input type="button" onclick="'+SP.Ribbon.PageState.NativeErrorState.ButtonCommand[$v_3]+'" value="'+SP.Ribbon.PageState.NativeErrorState.ButtonText[$v_3]+'" /></li>';$v_0+="</ul></center>";var $v_1=document.createElement("DIV");$v_1.className="s4-dlg-err-itm";$v_1.style.paddingLeft="11px";$v_1.style.paddingRight="11px";$v_1.style.paddingTop="11px";$v_1.style.paddingBottom="0px";$v_1.style.minWidth="200px";$v_1.innerHTML=$v_0;var $v_2=SP.UI.$create_DialogOptions();$v_2.html=$v_1;$v_2.title=SP.Ribbon.PageState.NativeErrorState.Title;$v_2.dialogReturnValueCallback=null;SP.Ribbon.PageState.PageStateHandler.ignoreNextUnload=true;SP.Ribbon.PageState.NativeErrorState.ErrorDialog=SP.UI.ModalDialog.showModalDialog($v_2)}else SP.Ribbon.PageState.NativeErrorState.ErrorDialog=eval(SP.Ribbon.PageState.NativeErrorState.ShowErrorDialogScript)};SP.Ribbon.PageState.PageStateHandler.dismissErrorDialog=function(){ULS04Z:;!SP.Ribbon.SU.$0(SP.Ribbon.PageState.NativeErrorState.ErrorDialog)&&SP.Ribbon.PageState.NativeErrorState.ErrorDialog.close(1)};SP.Ribbon.PageState.PageStateHandler.popupWaitScreen=function(a,b){ULS04Z:;SP.Ribbon.PageState.PageStateHandler.ignoreNextUnload=true;SP.Ribbon.PageState.ImportedNativeData.WaitScreen=SP.UI.ModalDialog.showWaitScreenWithNoClose(a,b,100,200);SP.Ribbon.PageState.PageStateHandler.ignoreNextUnload=false};SP.Ribbon.PageState.PageStateHandler.dismissWaitScreen=function(){ULS04Z:;!SP.Ribbon.SU.$0(SP.Ribbon.PageState.ImportedNativeData.WaitScreen)&&SP.Ribbon.PageState.ImportedNativeData.WaitScreen.close(1)};SP.Ribbon.PageState.PageStateHandler.EnableSaveBeforeNavigate=function(d){ULS04Z:;if(d){if(!SP.Ribbon.PageState.PageStateHandler.$1H_1){SP.Ribbon.Utility.$4o("beforeunload",SP.Ribbon.PageState.PageStateHandler.$2b_1);SP.Ribbon.PageState.PageStateHandler.$1H_1=true;var a=Sys.WebForms.PageRequestManager.getInstance();a&&a.add_pageLoaded(SP.Ribbon.PageState.PageStateHandler.$2a_1);SP.Ribbon.PageState.PageStateHandler.ignoreNextUnload=false}}else try{if(SP.Ribbon.PageState.PageStateHandler.$1H_1){SP.Ribbon.PageState.PageStateHandler.$1H_1=false;var b=Sys.WebForms.PageRequestManager.getInstance();b&&b.remove_pageLoaded(SP.Ribbon.PageState.PageStateHandler.$2a_1);SP.Ribbon.Utility.$5Z("beforeunload",SP.Ribbon.PageState.PageStateHandler.$2b_1)}}catch(c){}};SP.Ribbon.PageState.PageStateHandler.$6H_1=function(){ULS04Z:;SP.Ribbon.PageState.PageStateHandler.ignoreNextUnload=false};SP.Ribbon.PageState.PageStateHandler.pageStateOnSubmit=function(){ULS04Z:;SP.Ribbon.PageState.PageStateHandler.ignoreNextUnload=true};SP.Ribbon.PageState.PageStateHandler.SaveBeforeNavigateCallback=function(callbackResponse){ULS04Z:;eval(callbackResponse);SP.Ribbon.PageState.PageStateHandler.saveCallbackError=SP.Ribbon.PageState.NativeErrorState.Message};SP.Ribbon.PageState.PageStateHandler.WikiSaveBeforeNavigateCallback=function(a,b){ULS04Z:;if(b)SP.Ribbon.PageState.PageStateHandler.saveCallbackError=a};SP.Ribbon.PageState.PageStateHandler.$6I_1=function(){ULS04Z:;if(SP.Ribbon.SU.$1C(SP.Ribbon.PageState.ImportedNativeData.PageState))return true;else return SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsWikiPage"]||!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsWikiPage"]&&!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsCheckedOutToCurrentUser"]};SP.Ribbon.PageState.PageStateHandler.$4Q_1=function(){ULS04Z:;if(SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsWikiPage"])return eval("SPAutoSaveIsPageDirty();");else return true};SP.Ribbon.PageState.PageStateHandler.$4Y_1=function($p0,$p1){if(!SP.Ribbon.SU.$1C(window.event))if(!SP.Ribbon.SU.$2($p1))eval("window.event.returnValue = '"+$p1+"';");else eval("window.event.returnValue = undefined;");else if(!SP.Ribbon.SU.$2($p1))$p0.rawEvent.returnValue=$p1};SP.Ribbon.PageState.PageStateHandler.saveBeforeNavigate=function(evt){ULS04Z:;if(!SP.Ribbon.PageState.PageStateHandler.ignoreNextUnload&&SP.Ribbon.PageState.Handlers.isInEditMode()&&SP.Ribbon.PageState.PageStateHandler.$4Q_1()){if(SP.Ribbon.PageState.PageStateHandler.$6I_1())if(!confirm(SP.Res.pageStateSaveBeforeNavigateNotCheckedOutWarning)){SP.Ribbon.PageState.PageStateHandler.$4Y_1(evt,SP.Res.pageStateSaveBeforeNavigateLastChanceWarning);return SP.Res.pageStateSaveBeforeNavigateLastChanceWarning;return}SP.Ribbon.PageState.PageStateHandler.saveCallbackError=SP.Res.pageStateSaveBeforeNavigateUnknownError;eval("\r\n                var __xmlHttpRequest = window.XMLHttpRequest;\r\n                window.XMLHttpRequest = XMLHttpRequest = function() {ULS04Z:;\r\n                    var _xmlHttp = null;\r\n                    if (!__xmlHttpRequest) {\r\n                        try {\r\n                            _xmlHttp = new ActiveXObject('Microsoft.XMLHTTP');\r\n                        }\r\n                        catch(ex) {}\r\n                    }\r\n                    else {\r\n                        _xmlHttp = new __xmlHttpRequest();\r\n                    }\r\n                    \r\n                    if (!_xmlHttp) return null;\r\n                    \r\n                    this.abort = function() {ULS04Z:;return _xmlHttp.abort();}\r\n\r\n                    this.getAllResponseHeaders = function() {ULS04Z:;return _xmlHttp.getAllResponseHeaders();}\r\n                    this.getResponseHeader = function(header) {ULS04Z:;return _xmlHttp.getResponseHeader(header);}\r\n                    this.open = function(method, url, async, user, password) {ULS04Z:;\r\n                        return _xmlHttp.open(method, url, false, user, password);\r\n                    }\r\n                    this.send = function(body) {ULS04Z:;\r\n                        if (_xmlHttp.timeout != undefined)\r\n                        {\r\n                            _xmlHttp.timeout = 15000;\r\n                        }\r\n                        _xmlHttp.send(body);\r\n                        this.readyState = _xmlHttp.readyState;\r\n                        if (this.readyState == 4)\r\n                        {\r\n                            this.responseBody = _xmlHttp.responseBody;\r\n                            this.responseStream = _xmlHttp.responseStream;\r\n                            this.responseText = _xmlHttp.responseText;\r\n                            this.responseXML = _xmlHttp.responseXML;\r\n                            this.status = _xmlHttp.status;\r\n                            this.statusText = _xmlHttp.statusText;\r\n                        }\r\n                        this.onreadystatechange();\r\n                    }\r\n                    this.setRequestHeader = function(name, value) {ULS04Z:;return _xmlHttp.setRequestHeader(name, value);}\r\n                }");eval(SP.Ribbon.PageState.ImportedNativeData.CommandHandlers["PageStateSaveBeforeNavigate"]);eval("window.XMLHttpRequest = __xmlHttpRequest;");SP.Ribbon.PageState.PageStateHandler.$4Y_1(evt,SP.Ribbon.PageState.PageStateHandler.saveCallbackError);SP.Ribbon.PageState.PageStateHandler.ignoreNextUnload=false;if(!SP.Ribbon.SU.$2(SP.Ribbon.PageState.PageStateHandler.saveCallbackError))return SP.Ribbon.PageState.PageStateHandler.saveCallbackError}else SP.Ribbon.PageState.PageStateHandler.ignoreNextUnload=false};SP.Ribbon.PageState.PageStateHandler.updatePageState=function(){ULS04Z:;var $v_0="PageStateUpdatePageState";if(!SP.Ribbon.PageState.ImportedNativeData||!SP.Ribbon.PageState.ImportedNativeData.CommandHandlers||!SP.Ribbon.PageState.ImportedNativeData.CommandHandlers[$v_0])return;eval(SP.Ribbon.PageState.ImportedNativeData.CommandHandlers[$v_0])};SP.Ribbon.PageState.PageStateHandler.prototype={getFocusedCommands:function(){ULS04Z:;return null},getGlobalCommands:function(){ULS04Z:;return [Commands.CommandIds.ApplicationStateChanged,"CPEditTab","EditAndCheckoutGroup","WikiPageTab","PublishTab","ApproveGroup","PageStateGroupOpenMenuSave","PageStateGroupOpenMenuCheckin","PageStateGroupOpenMenuPublish","PageStateGroupQuerySaveMenu","PageStateGroupQueryCheckinMenu","PageStateGroupQueryPublishMenu","PageStateGroupSaveSplit","PageStateGroupCheckinSplit","PageStateGroupPublishSplit","PageStateGroupSave","PageStateGroupSaveAndStop","PageStateGroupEdit","PageStateGroupDontSaveAndStop","PageStateGroupCheckin","PageStateGroupCheckout","PageStateGroupDiscardCheckout","PageStateGroupOverrideCheckout","PageStateGroupPublish","PageStateGroupUnpublish","PageStateGroupSubmitForApproval","PageStateGroupCancelApproval","PageStateGroupApprove","PageStateGroupReject","ManageGroup","DeletePage","PageStateGroupStopEditing"]},canHandleCommand:function(commandId){ULS04Z:;if(!SP.Ribbon.PageState.PageStateHandler.$1Z_1&&(commandId==="PageStateGroupSaveSplit"||commandId==="PageStateGroupOpenMenuSave"||commandId==="PageStateGroupQuerySaveMenu"||commandId==="PageStateGroupSave"||commandId==="PageStateGroupSaveAndStop"||commandId==="PageStateGroupEdit"||commandId==="PageStateGroupDontSaveAndStop"||commandId==="PageStateGroupStopEditing"))return false;if("PageStateGroupStopEditing"===commandId)commandId="PageStateGroupSaveAndStop";if(!SP.Ribbon.SU.$0(SP.Ribbon.PageState.ImportedNativeData.EnabledHandlers[commandId]))return eval(SP.Ribbon.PageState.ImportedNativeData.EnabledHandlers[commandId]);else if(!SP.Ribbon.SU.$0(SP.Ribbon.PageState.PageStateHandler.$13_1[commandId])){for(var $v_0=false,$v_1=SP.Ribbon.PageState.PageStateHandler.$13_1[commandId],$v_2=0;$v_2<$v_1.length&&!$v_0;$v_2++)$v_0=eval(SP.Ribbon.PageState.ImportedNativeData.EnabledHandlers[$v_1[$v_2]]);return $v_0}return true},handleCommand:function(c,a){ULS04Z:;if(!SP.Ribbon.PageState.PageStateHandler.$1Z_1&&(c==="PageStateGroupSaveSplit"||c==="PageStateGroupOpenMenuSave"||c==="PageStateGroupQuerySaveMenu"||c==="PageStateGroupSave"||c==="PageStateGroupSaveAndStop"||c==="PageStateGroupEdit"||c==="PageStateGroupDontSaveAndStop"||c==="PageStateGroupStopEditing"))return false;if(Commands.CommandIds.ApplicationStateChanged===c){SP.Ribbon.PageStateActionButton.updateState();return true}if("PageStateGroupStopEditing"===c)if(confirm(SP.Res.pageStateSaveBeforeNavigateNotCheckedOutWarning))c="PageStateGroupSaveAndStop";else c="PageStateGroupDontSaveAndStop";if(c.startsWith("PageStateGroupQuery")){var b=SP.Ribbon.PageState.PageStateHandler.$5o_1(a),d=null;if(!b)return false;switch(c){case "PageStateGroupQuerySaveMenu":if(SP.Ribbon.PageState.Handlers.isInEditMode())a[CUI.Controls.DropDownCommandProperties.SelectedItemId]=b+"SaveAndStop";else a[CUI.Controls.DropDownCommandProperties.SelectedItemId]=b+"Edit";break;case "PageStateGroupQueryCheckinMenu":if(SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsCheckedOutToOtherUser"])a[CUI.Controls.DropDownCommandProperties.SelectedItemId]=b+"OverrideCheckout";else if(!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsCheckedOutToCurrentUser"])a[CUI.Controls.DropDownCommandProperties.SelectedItemId]=b+"Checkout";else a[CUI.Controls.DropDownCommandProperties.SelectedItemId]=b+"Checkin";break;case "PageStateGroupQueryPublishMenu":if(d=SP.Ribbon.PageState.PageStateHandler.$5n_1("PageStateGroupPublishSplit"))a[CUI.Controls.DropDownCommandProperties.SelectedItemId]=b+SP.Ribbon.PageState.PageStateHandler.getButtonId(d);else if(SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsMajorVersion"])if(SP.Ribbon.PageState.ImportedNativeData.PageState["UserHasApproverRights"])a[CUI.Controls.DropDownCommandProperties.SelectedItemId]=b+"Unpublish";else a[CUI.Controls.DropDownCommandProperties.SelectedItemId]=b+"Publish";else if(SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsPendingApproval"]&&SP.Ribbon.PageState.ImportedNativeData.PageState["DocLibWorkflowEnabled"])a[CUI.Controls.DropDownCommandProperties.SelectedItemId]=b+"CancelApproval";else if(SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsCheckedOutToCurrentUser"]||SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsRejected"])if(!SP.Ribbon.PageState.ImportedNativeData.PageState["DocLibWorkflowEnabled"]&&(!SP.Ribbon.PageState.ImportedNativeData.PageState["DocLibApprovalEnabled"]||SP.Ribbon.PageState.ImportedNativeData.PageState["UserHasApproverRights"]))a[CUI.Controls.DropDownCommandProperties.SelectedItemId]=b+"Publish";else a[CUI.Controls.DropDownCommandProperties.SelectedItemId]=b+"SubmitForApproval";else if(SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsCheckedOutToOtherUser"])a[CUI.Controls.DropDownCommandProperties.SelectedItemId]=b+"Publish";else if(SP.Ribbon.PageState.ImportedNativeData.PageState["ItemHasCheckedInVersion"])if(!SP.Ribbon.PageState.ImportedNativeData.PageState["DocLibWorkflowEnabled"]&&(!SP.Ribbon.PageState.ImportedNativeData.PageState["DocLibApprovalEnabled"]||SP.Ribbon.PageState.ImportedNativeData.PageState["UserHasApproverRights"]))a[CUI.Controls.DropDownCommandProperties.SelectedItemId]=b+"Publish";else a[CUI.Controls.DropDownCommandProperties.SelectedItemId]=b+"SubmitForApproval";else if(SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsPendingApproval"])if(!SP.Ribbon.PageState.ImportedNativeData.PageState["DocLibWorkflowEnabled"]&&SP.Ribbon.PageState.ImportedNativeData.PageState["UserHasApproverRights"])a[CUI.Controls.DropDownCommandProperties.SelectedItemId]=b+"Publish";else a[CUI.Controls.DropDownCommandProperties.SelectedItemId]=b+"CancelApproval";else if(SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsScheduled"])a[CUI.Controls.DropDownCommandProperties.SelectedItemId]=b+"Unpublish";else return false}return true}else if(!SP.Ribbon.SU.$0(SP.Ribbon.PageState.ImportedNativeData.CommandHandlers[c]))return SP.Ribbon.PageState.Handlers.showStateChangeDialog(c,SP.Ribbon.PageState.ImportedNativeData.CommandHandlers[c]);else if(a&&!SP.Ribbon.SU.$2(a["CommandValueId"]))return SP.Ribbon.PageState.Handlers.showStateChangeDialog(a["CommandValueId"],SP.Ribbon.PageState.ImportedNativeData.CommandHandlers[a["CommandValueId"]]);return false},isFocusable:function(){ULS04Z:;return false},receiveFocus:function(){ULS04Z:;return true},yieldFocus:function(){ULS04Z:;return true},init:function(){ULS04Z:;(SP.Ribbon.PageState.NativeErrorState.ButtonCount>0||!SP.Ribbon.SU.$2(SP.Ribbon.PageState.NativeErrorState.ShowErrorDialogScript))&&SP.Ribbon.PageState.PageStateHandler.showErrorDialog();SP.Ribbon.PageState.PageStateHandler.showPageStatus()},getId:function(){ULS04Z:;return "PageState"}};SP.Ribbon.PageState.StateChangeDialogHandler=function(){};SP.Ribbon.PageState.StateChangeDialogHandler.prototype={enabled:null,initialize:null,abort:null,validate:null};SP.Ribbon.PageState.Handlers=function(){};SP.Ribbon.PageState.Handlers.isInEditMode=function(){ULS04Z:;var a=SP.Ribbon.WikiPageComponent.$D();if(SP.Ribbon.SU.$1C(SP.Ribbon.PageState.ImportedNativeData)||SP.Ribbon.SU.$1C(SP.Ribbon.PageState.ImportedNativeData.PageState))return a;else return SP.Ribbon.PageState.ImportedNativeData.PageState["ViewModeIsEdit"]||SP.Ribbon.PageState.ImportedNativeData.PageState["ViewModeIsWebPartDesign"]||a};SP.Ribbon.PageState.Handlers.isSaveEnabled=function(){ULS04Z:;if(SP.Ribbon.PageState.Handlers.isInEditMode()&&SP.Ribbon.PageState.ImportedNativeData.PageState["UserHasContributorRights"]&&SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsInSharedView"]&&!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsFormsPage"]&&!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsCheckedOutToOtherUser"])return true;return false};SP.Ribbon.PageState.Handlers.isEditEnabled=function(){ULS04Z:;if(!SP.Ribbon.PageState.Handlers.isInEditMode()&&SP.Ribbon.PageState.ImportedNativeData.PageState["UserHasContributorRights"]&&!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsFormsPage"]&&SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsInSharedView"]&&!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsCheckedOutToOtherUser"])return true;return false};SP.Ribbon.PageState.Handlers.isDontSaveAndStopEnabled=function(){ULS04Z:;if(SP.Ribbon.PageState.ImportedNativeData.PageState["ViewModeIsEdit"]&&!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsFormsPage"]&&!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsCheckedOutToOtherUser"])return true;return false};SP.Ribbon.PageState.Handlers.isSaveAndStopEditEnabled=function(){ULS04Z:;if(SP.Ribbon.PageState.Handlers.isInEditMode()&&!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsFormsPage"]&&!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsCheckedOutToOtherUser"]&&SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsInSharedView"])return true;return false};SP.Ribbon.PageState.Handlers.isCheckoutEnabled=function(){ULS04Z:;if(!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsCheckedOutToCurrentUser"]&&!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsFormsPage"]&&SP.Ribbon.PageState.ImportedNativeData.PageState["UserHasContributorRights"]&&!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsCheckedOutToOtherUser"]&&SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsInLibrary"]&&SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsInSharedView"])return true;return false};SP.Ribbon.PageState.Handlers.isCheckinEnabled=function(){ULS04Z:;if(SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsCheckedOutToCurrentUser"]&&!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsCheckedOutToOtherUser"]&&!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsFormsPage"]&&SP.Ribbon.PageState.ImportedNativeData.PageState["UserHasContributorRights"]&&SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsInLibrary"]&&SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsInSharedView"])return true;return false};SP.Ribbon.PageState.Handlers.isDiscardCheckoutEnabled=function(){ULS04Z:;if(SP.Ribbon.PageState.ImportedNativeData.PageState["ItemHasCheckedInVersion"]&&!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsFormsPage"]&&SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsInSharedView"]&&!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsCheckedOutToOtherUser"]&&SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsCheckedOutToCurrentUser"])return true;return false};SP.Ribbon.PageState.Handlers.isOverrideCheckoutEnabled=function(){ULS04Z:;if(SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsCheckedOutToOtherUser"]&&!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsFormsPage"]&&!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsCheckedOutToCurrentUser"]&&!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsCheckedOutToSystemUser"]&&SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsInLibrary"]&&SP.Ribbon.PageState.ImportedNativeData.PageState["UserHasOverrideCheckoutRights"])return true;return false};SP.Ribbon.PageState.Handlers.isPublishEnabled=function(){ULS04Z:;if(!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsMajorVersion"]&&!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsFormsPage"]&&!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsCheckedOutToOtherUser"]&&!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsPendingApproval"]&&!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsScheduled"]&&SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsInLibrary"]&&SP.Ribbon.PageState.ImportedNativeData.PageState["DocLibMinorVersionsEnabled"]&&!SP.Ribbon.PageState.ImportedNativeData.PageState["DocLibWorkflowEnabled"]&&SP.Ribbon.PageState.ImportedNativeData.PageState["UserHasContributorRights"]&&(SP.Ribbon.PageState.ImportedNativeData.PageState["UserHasApproverRights"]||!SP.Ribbon.PageState.ImportedNativeData.PageState["DocLibApprovalEnabled"])&&SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsInSharedView"])return true;return false};SP.Ribbon.PageState.Handlers.isUnpublishEnabled=function(){ULS04Z:;if(!SP.Ribbon.PageState.Handlers.isInEditMode()&&!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsFormsPage"]&&!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsScheduled"]&&SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsInLibrary"]&&SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsMajorVersion"]&&SP.Ribbon.PageState.ImportedNativeData.PageState["DocLibMinorVersionsEnabled"]&&SP.Ribbon.PageState.ImportedNativeData.PageState["UserHasApproverRights"]&&SP.Ribbon.PageState.ImportedNativeData.PageState["UserHasContributorRights"]&&SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsInSharedView"]&&!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsCheckedOutToSystemUser"])return true;return false};SP.Ribbon.PageState.Handlers.isSubmitForApprovalEnabled=function(){ULS04Z:;if(!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsMajorVersion"]&&!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsFormsPage"]&&!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsCheckedOutToOtherUser"]&&SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsInSharedView"]&&!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsPendingApproval"]&&SP.Ribbon.PageState.ImportedNativeData.PageState["DocLibApprovalEnabled"]&&SP.Ribbon.PageState.ImportedNativeData.PageState["UserHasContributorRights"])return true;return false};SP.Ribbon.PageState.Handlers.isCancelApprovalEnabled=function(){ULS04Z:;if(!SP.Ribbon.PageState.ImportedNativeData.PageState["ViewModeIsEdit"]&&!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsFormsPage"]&&SP.Ribbon.PageState.ImportedNativeData.PageState["UserHasContributorRights"]&&SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsPendingApproval"]&&!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsCheckedOutToOtherUser"]&&SP.Ribbon.PageState.ImportedNativeData.PageState["DocLibMinorVersionsEnabled"]&&SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsInSharedView"])return true;return false};SP.Ribbon.PageState.Handlers.isApproveEnabled=function(){ULS04Z:;if(!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsMajorVersion"]&&!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsFormsPage"]&&!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsCheckedOutToOtherUser"]&&SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsInSharedView"]&&SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsPendingApproval"]&&SP.Ribbon.PageState.ImportedNativeData.PageState["UserHasApproverRights"]&&SP.Ribbon.PageState.ImportedNativeData.PageState["UserHasContributorRights"])return true;return false};SP.Ribbon.PageState.Handlers.isRejectEnabled=function(){ULS04Z:;if(!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsMajorVersion"]&&!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsFormsPage"]&&!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsCheckedOutToOtherUser"]&&SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsInSharedView"]&&SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsPendingApproval"]&&SP.Ribbon.PageState.ImportedNativeData.PageState["UserHasApproverRights"]&&SP.Ribbon.PageState.ImportedNativeData.PageState["UserHasContributorRights"])return true;return false};SP.Ribbon.PageState.Handlers.isDeleteEnabled=function(){ULS04Z:;if(SP.Ribbon.PageState.ImportedNativeData.PageState["UserHasDeleteRights"]&&!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsCheckedOutToOtherUser"]&&!SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsDefaultPage"])return true;return false};SP.Ribbon.PageState.Handlers.GenericCompleteHandler=function(cbr){ULS04Z:;SP.Ribbon.PageState.PageStateHandler.dismissWaitScreen();eval(cbr);SP.Ribbon.PageManager.get_instance().get_commandDispatcher().executeCommand("appstatechanged",null);var $v_0=SP.Ribbon.PageState.ImportedNativeData.CallbackResult["Notification"];if(!SP.Ribbon.SU.$2($v_0)){SP.UI.Notify.addNotification($v_0,false);SP.Ribbon.PageState.ImportedNativeData.CallbackResult["Notification"]=""}SP.Ribbon.PageState.PageStateHandler.showPageStatus();SP.Ribbon.PageState.NativeErrorState.ButtonCount>0&&SP.Ribbon.PageState.PageStateHandler.showErrorDialog()};SP.Ribbon.PageState.Handlers.GenericError=function(){ULS04Z:;alert("callback failed")};SP.Ribbon.PageState.Handlers.addStateChangeDialogHandler=function(a){ULS04Z:;SP.Ribbon.PageState.Handlers.$1z_0.push(a)};SP.Ribbon.PageState.Handlers.setStateChangeDialogFocusOnNode=function(a){ULS04Z:;if(a)SP.Ribbon.PageState.Handlers.$2d_0=a};SP.Ribbon.PageState.Handlers.onOkButton=function(){ULS04Z:;SP.Ribbon.PageState.Handlers.$6d_0()};SP.Ribbon.PageState.Handlers.onCancelButton=function(){ULS04Z:;SP.Ribbon.PageState.Handlers.$6c_0()};SP.Ribbon.PageState.Handlers.showStateChangeDialog=function(commandId,func){ULS04Z:;SP.Ribbon.PageState.Handlers.$L_0=new Array(0);for(var $v_4=0;$v_4<SP.Ribbon.PageState.Handlers.$1z_0.length;$v_4++){var $v_5=true,$v_6=SP.Ribbon.PageState.Handlers.$1z_0[$v_4];if($v_6.enabled)$v_5=$v_6.enabled(commandId);$v_5&&SP.Ribbon.PageState.Handlers.$L_0.push($v_6)}if(!SP.Ribbon.PageState.Handlers.$L_0.length)return eval(func);SP.Ribbon.PageState.PageStateHandler.ignoreNextUnload=true;SP.Ribbon.PageState.Handlers.$2e_0=func;for(var $v_0=document.createElement("DIV"),$v_1=0,$v_7=0;$v_7<SP.Ribbon.PageState.Handlers.$L_0.length;$v_7++){var $v_8=SP.Ribbon.PageState.Handlers.$L_0[$v_7];$v_1+=$v_8.initialize(commandId,$v_0)}var $v_2=document.createElement("DIV");$v_2.style.textAlign=SP.Res.alignRight;var $v_9=document.createElement("INPUT");$v_9.value=SP.Res.continueButtonText;$v_9.type="button";$addHandler($v_9,"click",SP.Ribbon.PageState.Handlers.onOkButton);$v_9.style.width=SP.Res.okCancelButtonWidth;$v_9.style.margin="4px";$v_9.id="statechangedialog_okbutton";var $v_A=document.createElement("INPUT");$v_A.value=SP.Res.cancelButtonText;$v_A.type="button";$addHandler($v_A,"click",SP.Ribbon.PageState.Handlers.onCancelButton);$v_A.style.width=SP.Res.okCancelButtonWidth;$v_A.style.margin="4px";$v_A.id="statechangedialog_cancelbutton";$v_2.appendChild($v_9);$v_2.appendChild($v_A);$v_0.appendChild($v_2);$v_1+=32;var $v_3=SP.UI.$create_DialogOptions();$v_3.html=$v_0;$v_3.width=400;$v_3.height=$v_1;$v_3.title=SP.Ribbon.PageState.Handlers.$5q_0(commandId);$v_3.dialogReturnValueCallback=SP.Ribbon.PageState.Handlers.$6b_0;SP.Ribbon.PageState.Handlers.$1y_0=SP.UI.ModalDialog.showModalDialog($v_3);SP.Ribbon.PageState.Handlers.$2d_0.focus();$v_0.parentNode.parentNode.id="statechangedialog";return true};SP.Ribbon.PageState.Handlers.$5q_0=function(a){ULS04Z:;if(!SP.Ribbon.PageState.Handlers.$20_0)SP.Ribbon.PageState.Handlers.$20_0={PageStateGroupApprove:SP.Res.pageStateApproveLabel,PageStateGroupCancelApproval:SP.Res.pageStateCancelApprovalLabel,PageStateGroupCheckin:SP.Res.pageStateCheckinLabel,PageStateGroupCheckout:SP.Res.pageStateCheckoutLabel,PageStateGroupDiscardCheckout:SP.Res.pageStateDiscardCheckoutLabel,PageStateGroupDontSaveAndStop:SP.Res.pageStateDontSaveLabel,PageStateGroupEdit:SP.Res.pageStateEditLabel,PageStateGroupOverrideCheckout:SP.Res.pageStateOverrideCheckoutLabel,PageStateGroupPublish:SP.Res.pageStatePublishLabel,PageStateGroupReject:SP.Res.pageStateRejectLabel,PageStateGroupSave:SP.Res.pageStateSaveLabel,PageStateGroupSaveAndStop:SP.Res.pageStateSaveAndStopEditingLabel,PageStateGroupSubmitForApproval:SP.Res.pageStateSubmitForApprovalLabel,PageStateGroupUnpublish:SP.Res.pageStateUnpublishLabel};return SP.Ribbon.PageState.Handlers.$20_0[a]};SP.Ribbon.PageState.Handlers.$6b_0=function($p0,$p1){if($p0===1){for(var $v_0=0;$v_0<SP.Ribbon.PageState.Handlers.$L_0.length;$v_0++){var $v_1=SP.Ribbon.PageState.Handlers.$L_0[$v_0];if($v_1.validate)if(!$v_1.validate())return}for(var $v_2=0;$v_2<SP.Ribbon.PageState.Handlers.$L_0.length;$v_2++){var $v_3=SP.Ribbon.PageState.Handlers.$L_0[$v_2];$v_3.abort&&$v_3.abort()}eval(SP.Ribbon.PageState.Handlers.$2e_0)}else if(!$p0)for(var $v_4=0;$v_4<SP.Ribbon.PageState.Handlers.$L_0.length;$v_4++){var $v_5=SP.Ribbon.PageState.Handlers.$L_0[$v_4];$v_5.abort&&$v_5.abort()}};SP.Ribbon.PageState.Handlers.$6d_0=function(){ULS04Z:;SP.Ribbon.PageState.Handlers.$1y_0.close(1)};SP.Ribbon.PageState.Handlers.$6c_0=function(){ULS04Z:;SP.Ribbon.PageState.Handlers.$1y_0.close(0)};SP.Ribbon.PageState.Handlers.$5Q=function(e,d){ULS04Z:;if(!d)return 0;var a=document.createElement("DIV");d.appendChild(a);a.style.margin="8px";var c=document.createElement("DIV");a.appendChild(c);var b=document.createElement("LABEL");b.innerText=SP.Res.checkInComments;c.appendChild(b);SP.Ribbon.PageState.Handlers.$Q_0=document.createElement("TEXTAREA");SP.Ribbon.PageState.Handlers.$Q_0.style.margin="6px";SP.Ribbon.PageState.Handlers.$Q_0.style.width="95%";SP.Ribbon.PageState.Handlers.$Q_0.rows=6;SP.Ribbon.PageState.Handlers.$Q_0.id="checkincomments";a.appendChild(SP.Ribbon.PageState.Handlers.$Q_0);SP.Ribbon.PageState.Handlers.setStateChangeDialogFocusOnNode(SP.Ribbon.PageState.Handlers.$Q_0);b.htmlFor=SP.Ribbon.PageState.Handlers.$Q_0.id;return 148};SP.Ribbon.PageState.Handlers.$5R_0=function(){ULS04Z:;var a=$get("InputComments");a.value=SP.Ribbon.PageState.Handlers.$Q_0.value;return true};SP.Ribbon.PageState.Handlers.$5P_0=function(a){ULS04Z:;return (a==="PageStateGroupCheckin"||a==="PageStateGroupSubmitForApproval"||a==="PageStateGroupPublish")&&SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsCheckedOutToCurrentUser"]||(a==="PageStateGroupApprove"||a==="PageStateGroupReject")&&SP.Ribbon.PageState.ImportedNativeData.PageState["ItemIsPendingApproval"]};SP.Ribbon.PageState.Handlers.registerCommentsHandler=function(){ULS04Z:;var a=new SP.Ribbon.PageState.StateChangeDialogHandler;a.initialize=SP.Ribbon.PageState.Handlers.$5Q;a.enabled=SP.Ribbon.PageState.Handlers.$5P_0;a.validate=SP.Ribbon.PageState.Handlers.$5R_0;SP.Ribbon.PageState.Handlers.addStateChangeDialogHandler(a)};Type.registerNamespace("SP.Ribbon.TenantAdmin");SP.Ribbon.TenantAdmin.TenantAdminPageComponent=function(){ULS04Z:;SP.Ribbon.TenantAdmin.TenantAdminPageComponent.initializeBase(this)};SP.Ribbon.TenantAdmin.TenantAdminPageComponent.initialize=function(){ULS04Z:;var a=SP.Ribbon.PageManager.get_instance();null!==a&&a.addPageComponent(SP.Ribbon.TenantAdmin.TenantAdminPageComponent.$1u_1)};SP.Ribbon.TenantAdmin.TenantAdminPageComponent.$5b_1=function(a){ULS04Z:;__doPostBack("__Page",a);return true};SP.Ribbon.TenantAdmin.TenantAdminPageComponent.$6F_1=function(){ULS04Z:;location.reload(null)};SP.Ribbon.TenantAdmin.TenantAdminPageComponent.prototype={canHandleCommand:function(a){ULS04Z:;if(a==="SiteCollectionsTab"||a==="SiteCollectionsContributeGroup"||a==="CreateSiteCollectionClick"||a==="SiteCollectionsReviewGroup"||a==="SiteCollectionsManageGroup")return true;return commandEnabled(a)},getGlobalCommands:function(){ULS04Z:;return ["SiteCollectionsTab","SiteCollectionsContributeGroup","CreateSiteCollectionClick","DeleteSiteCollectionsClick","SiteCollectionsReviewGroup","ViewPropertiesClick","SiteCollectionsManageGroup","OwnersClick","DiskQuotaClick"]},handleCommand:function(a){ULS04Z:;if(a==="CreateSiteCollectionClick"){var b=SP.UI.$create_DialogOptions();b.url="TA_CreateSiteCollection.aspx";b.width=850;b.height=480;b.title=SP.Res.tenantAdmin_SiteCollectionNewDialogTitle;b.dialogReturnValueCallback=SP.Ribbon.TenantAdmin.TenantAdminPageComponent.$6F_1;SP.UI.ModalDialog.showModalDialog(b);return true}if(a==="DeleteSiteCollectionsClick"){var c=SP.UI.$create_DialogOptions();c.url="TA_DeleteSiteCollectionDialog.aspx";c.width=600;c.height=200;c.title=SP.Res.tenantAdmin_SiteCollectionDeleteDialogTitle;c.dialogReturnValueCallback=null;SP.UI.ModalDialog.showModalDialog(c);return true}if(a==="ViewPropertiesClick"){var f=SP.UI.$create_DialogOptions(),g=document.getElementById("ctl00_PlaceHolderMain_singleSelectedSite");f.url="TA_ViewSiteCollectionPropertiesDialog.aspx?site="+g.getAttribute("value");f.title=SP.Res.tenantAdmin_SiteCollectionPropertiesDialogTitle;f.dialogReturnValueCallback=null;SP.UI.ModalDialog.showModalDialog(f);return true}if(a==="OwnersClick"){var d=SP.UI.$create_DialogOptions(),h=document.getElementById("ctl00_PlaceHolderMain_singleSelectedSite");d.url="TA_SiteCollectionOwnersDialog.aspx?site="+h.getAttribute("value");d.width=640;d.height=340;d.title=SP.Res.tenantAdmin_SiteCollectionOwnersDialogTitle;d.dialogReturnValueCallback=null;SP.UI.ModalDialog.showModalDialog(d);return true}if(a==="DiskQuotaClick"){var e=SP.UI.$create_DialogOptions(),i=document.getElementById("ctl00_PlaceHolderMain_singleSelectedSite");e.url="TA_SiteCollectionDiskQuotaDialog.aspx?site="+i.getAttribute("value");e.width=640;e.height=280;e.title=SP.Res.tenantAdmin_SiteCollectionDiskQuotaDialogTitle;e.dialogReturnValueCallback=null;SP.UI.ModalDialog.showModalDialog(e);return true}return SP.Ribbon.TenantAdmin.TenantAdminPageComponent.$5b_1(a)}};SP.BWsaConfig.registerClass("SP.BWsaConfig");SP.Ticks.registerClass("SP.Ticks");SP.TimerResetCheck.registerClass("SP.TimerResetCheck");SP.StreamRowCounters.registerClass("SP.StreamRowCounters");SP.BWsaDatapoint.registerClass("SP.BWsaDatapoint");SP.WsaStreamRow.registerClass("SP.WsaStreamRow");SP.BWsaStream.registerClass("SP.BWsaStream");SP.BWsaHeader.registerClass("SP.BWsaHeader");SP.BWsaData.registerClass("SP.BWsaData");SP.BWsaClient.registerClass("SP.BWsaClient");SP.Ribbon.Utility.registerClass("SP.Ribbon.Utility");SP.Ribbon.UtilityInternal.registerClass("SP.Ribbon.UtilityInternal");SP.Ribbon.SQMUtility.registerClass("SP.Ribbon.SQMUtility");SP.Ribbon.SU.registerClass("SP.Ribbon.SU");SP.Ribbon.CommandUIExtensionPageComponent.registerClass("SP.Ribbon.CommandUIExtensionPageComponent",CUI.Page.PageComponent);SP.Ribbon.ToolbarRibbonAdapterData.registerClass("SP.Ribbon.ToolbarRibbonAdapterData");SP.Ribbon.ToolbarRibbonAdapter.registerClass("SP.Ribbon.ToolbarRibbonAdapter",CUI.Page.PageComponent);SP.Ribbon.WebPartPageComponentData.registerClass("SP.Ribbon.WebPartPageComponentData",SP.Ribbon.ToolbarRibbonAdapterData);SP.Ribbon.WebPartPageComponent.registerClass("SP.Ribbon.WebPartPageComponent",SP.Ribbon.ToolbarRibbonAdapter);SP.Ribbon.ListViewWebPartPageComponentData.registerClass("SP.Ribbon.ListViewWebPartPageComponentData",SP.Ribbon.WebPartPageComponentData);SP.Ribbon.PagingInformation.registerClass("SP.Ribbon.PagingInformation");SP.Ribbon.ECBMenuItem.registerClass("SP.Ribbon.ECBMenuItem",Object);SP.Ribbon.CLVP.registerClass("SP.Ribbon.CLVP");SP.Ribbon.ListViewWebPartData.registerClass("SP.Ribbon.ListViewWebPartData",SP.Ribbon.ToolbarRibbonAdapterData);SP.Ribbon.ListViewWebPartPageComponent.registerClass("SP.Ribbon.ListViewWebPartPageComponent",SP.Ribbon.WebPartPageComponent,SP.Application.UI.ViewInformationRequestor,SP.Application.UI.DefaultFormsInformationRequestor);SP.Ribbon.ListFormWebPartPageComponentData.registerClass("SP.Ribbon.ListFormWebPartPageComponentData",SP.Ribbon.WebPartPageComponentData);SP.Ribbon.ListFormWebPartPageComponent.registerClass("SP.Ribbon.ListFormWebPartPageComponent",SP.Ribbon.WebPartPageComponent);SP.Ribbon.DocLibWebPartPageComponent.registerClass("SP.Ribbon.DocLibWebPartPageComponent",SP.Ribbon.ListViewWebPartPageComponent);SP.Ribbon.GenericListWebPartPageComponentData.registerClass("SP.Ribbon.GenericListWebPartPageComponentData",SP.Ribbon.ListViewWebPartPageComponentData);SP.Ribbon.GenericListWebPartPageComponent.registerClass("SP.Ribbon.GenericListWebPartPageComponent",SP.Ribbon.ListViewWebPartPageComponent);SP.Ribbon.SolutionsPageComponent.registerClass("SP.Ribbon.SolutionsPageComponent",SP.Ribbon.ListViewWebPartPageComponent);SP.Ribbon.WikiPageComponent.registerClass("SP.Ribbon.WikiPageComponent",CUI.Page.PageComponent);SP.Ribbon.FetchedDocLibItemInfo.registerClass("SP.Ribbon.FetchedDocLibItemInfo");SP.Ribbon.DocLibAspxPageComponent.registerClass("SP.Ribbon.DocLibAspxPageComponent",CUI.Page.PageComponent);SP.Ribbon.WebPartComponent.registerClass("SP.Ribbon.WebPartComponent",CUI.Page.PageComponent);SP.Ribbon.FetchListViewWebPartPageComponentWorker.registerClass("SP.Ribbon.FetchListViewWebPartPageComponentWorker");SP.Ribbon.BlogPostWebPartPageComponent.registerClass("SP.Ribbon.BlogPostWebPartPageComponent",SP.Ribbon.DocLibWebPartPageComponent);SP.Ribbon.PageManager.registerClass("SP.Ribbon.PageManager",CUI.Page.PageManager);SP.Ribbon.PageStateActionButton.registerClass("SP.Ribbon.PageStateActionButton");SP.Ribbon.RelatedFieldsFetcher.registerClass("SP.Ribbon.RelatedFieldsFetcher");SP.Ribbon.RelatedFieldsHelper.registerClass("SP.Ribbon.RelatedFieldsHelper",null,SP.Ribbon.IRelatedFieldsInfoRequestor);SP.Ribbon.UsageReportPageComponent.registerClass("SP.Ribbon.UsageReportPageComponent",CUI.Page.PageComponent);SP.Ribbon.GroupBoardWebPartPageComponent.registerClass("SP.Ribbon.GroupBoardWebPartPageComponent",SP.Ribbon.GenericListWebPartPageComponent);SP.Ribbon.CalendarPageComponentData.registerClass("SP.Ribbon.CalendarPageComponentData",SP.Ribbon.GenericListWebPartPageComponentData);SP.Ribbon.CalendarListPageComponent.registerClass("SP.Ribbon.CalendarListPageComponent",SP.Ribbon.GenericListWebPartPageComponent);SP.Ribbon.HelpCommandNames.registerClass("SP.Ribbon.HelpCommandNames");SP.Ribbon.HelpPageComponent.registerClass("SP.Ribbon.HelpPageComponent",CUI.Page.PageComponent);SP.Ribbon.SaveConflictHandler.registerClass("SP.Ribbon.SaveConflictHandler");SP.Ribbon.TrackTabPageComponent.registerClass("SP.Ribbon.TrackTabPageComponent",CUI.Page.PageComponent);SP.Ribbon.UserInterfacePageComponent.registerClass("SP.Ribbon.UserInterfacePageComponent",CUI.Page.PageComponent);SP.Ribbon.EMailLink.registerClass("SP.Ribbon.EMailLink");SP.Ribbon.PageState.PageStateStrings.registerClass("SP.Ribbon.PageState.PageStateStrings");SP.Ribbon.PageState.PageStateCommands.registerClass("SP.Ribbon.PageState.PageStateCommands");SP.Ribbon.PageState.PageStateHandler.registerClass("SP.Ribbon.PageState.PageStateHandler",CUI.Page.PageComponent,CUI.Page.ICommandHandler);SP.Ribbon.PageState.StateChangeDialogHandler.registerClass("SP.Ribbon.PageState.StateChangeDialogHandler");SP.Ribbon.PageState.Handlers.registerClass("SP.Ribbon.PageState.Handlers");SP.Ribbon.TenantAdmin.TenantAdminPageComponent.registerClass("SP.Ribbon.TenantAdmin.TenantAdminPageComponent",CUI.Page.PageComponent);SP.BWsaConfig.defaultMaxStreamRows=1e3;SP.BWsaConfig.defaultMaxInt32=4294967295;SP.BWsaConfig.defaultRibbonStreamWidth=8;SP.Ticks.$1x_0=0;SP.TimerResetCheck.$1c_0=0;SP.StreamRowCounters.maxRowCount=0;SP.StreamRowCounters.maxOverwritten=0;SP.BWsaClient.$1J_0=3*4;SP.Ribbon.Utility.$z_0=null;SP.Ribbon.UtilityInternal.$1s_0=0;SP.Ribbon.UtilityInternal.$4W_0=SP.Ribbon.UtilityInternal.$6U;SP.Ribbon.CommandUIExtensionPageComponent.$1I_1=null;SP.Ribbon.CommandUIExtensionPageComponent.$25_1=false;SP.Ribbon.ListViewWebPartPageComponent._LibraryNavigationGroup="LibraryNavigationGroup";SP.Ribbon.ListViewWebPartPageComponent.$4R_3=new RegExp("[?&]IsDlg=1");SP.Ribbon.ListFormWebPartPageComponent._DispFormActionsGroup="Ribbon.ListForm.Display.ActionsGroup";SP.Ribbon.WikiPageComponent.$P_1=false;SP.Ribbon.WikiPageComponent.$S_1=null;SP.Ribbon.WikiPageComponent.$3_1=null;SP.Ribbon.WikiPageComponent.$R_1=null;SP.Ribbon.WikiPageComponent.$v_1=null;SP.Ribbon.WikiPageComponent.$1v_1=false;SP.Ribbon.DocLibAspxPageComponent.$3_1=null;SP.Ribbon.DocLibAspxPageComponent.$R_1=null;SP.Ribbon.WebPartComponent.$3_1=null;SP.Ribbon.WebPartComponent.$6P_1=[];SP.Ribbon.WebPartComponent.$R_1=["approveWebpartPage","EditInDesigner","EditMobileSharedPage","EditMobilePersonalPage","EditMobilePageMenuOpen","insertExistingList","insertImageWebPart","insertTextWebPart","insertWebPart","makeHomePage","MSOMenu_Close","MSOMenu_Delete","MSOMenu_Edit","MSOMenu_Minimize","MSOMenu_Restore","rejectWebpartPage","Ribbon.WebPartInsert.Tab","Ribbon.WebPartOption","Ribbon.WebPartPage","webPartCommands","WebPartContextualGroup","WebPartInsertContextualGroup","webPartInsertMedia","webPartInserts","webPartInsertText","webPartPageActions","webPartPageApproval","webPartPageDelete","webPartPageEdit","webPartPageEditConsole","webPartPageEditMenuOpen","webPartPageEditQuery","webPartPageManage","webPartPageStartEdit","webPartPageStopEdit","webPartProperties","RelatedDataToListViewGroup","InsertRelatedWebPartToListViewMenuAnchor","InsertRelatedWebPartToListView","GetRelatedFieldsToListViewMenuXml","RelatedDataToListFormGroup","InsertRelatedWebPartToListFormMenuAnchor","InsertRelatedWebPartToListForm","GetRelatedFieldsToListFormMenuXml","CommandContextChanged"];SP.Ribbon.PageManager.$12_2=null;SP.Ribbon.UsageReportPageComponent.$1u_1=new SP.Ribbon.UsageReportPageComponent;SP.Ribbon.HelpCommandNames.requestContextualHelp="RequestContextualHelp";SP.Ribbon.HelpPageComponent.$3_1=null;SP.Ribbon.SaveConflictHandler.$y_0=null;SP.Ribbon.SaveConflictHandler.$w_0=null;SP.Ribbon.SaveConflictHandler.$x_0=null;SP.Ribbon.TrackTabPageComponent.$3_1=null;SP.Ribbon.TrackTabPageComponent.$1t_1=null;SP.Ribbon.UserInterfacePageComponent.$3_1=null;SP.Ribbon.EMailLink.$1p_0=null;SP.Ribbon.EMailLink.$1e_0=null;SP.Ribbon.EMailLink.$1h_0=null;SP.Ribbon.PageState.PageStateStrings.itemIsWebPartPageStateName="ItemIsWebPartPage";SP.Ribbon.PageState.PageStateStrings.itemIsWikiPageStateName="ItemIsWikiPage";SP.Ribbon.PageState.PageStateStrings.itemIsFormsPageStateName="ItemIsFormsPage";SP.Ribbon.PageState.PageStateStrings.itemIsInLibraryStateName="ItemIsInLibrary";SP.Ribbon.PageState.PageStateStrings.itemIsMajorVersionStateName="ItemIsMajorVersion";SP.Ribbon.PageState.PageStateStrings.itemIsMinorVersionStateName="ItemIsMinorVersion";SP.Ribbon.PageState.PageStateStrings.itemHasCheckedInVersionStateName="ItemHasCheckedInVersion";SP.Ribbon.PageState.PageStateStrings.itemIsCheckedOutToCurrentUserStateName="ItemIsCheckedOutToCurrentUser";SP.Ribbon.PageState.PageStateStrings.itemIsCheckedOutToOtherUserStateName="ItemIsCheckedOutToOtherUser";SP.Ribbon.PageState.PageStateStrings.itemIsCheckedOutToSystemUserStateName="ItemIsCheckedOutToSystemUser";SP.Ribbon.PageState.PageStateStrings.itemIsRejectedStateName="ItemIsRejected";SP.Ribbon.PageState.PageStateStrings.itemHasWorkflowRunningStateName="ItemHasWorkflowRunning";SP.Ribbon.PageState.PageStateStrings.itemIsPendingApprovalStateName="ItemIsPendingApproval";SP.Ribbon.PageState.PageStateStrings.itemIsScheduledStateName="ItemIsScheduled";SP.Ribbon.PageState.PageStateStrings.itemIsInPersonalViewStateName="ItemIsInPersonalView";SP.Ribbon.PageState.PageStateStrings.itemIsInSharedViewStateName="ItemIsInSharedView";SP.Ribbon.PageState.PageStateStrings.itemIsDefaultPageStateName="ItemIsDefaultPage";SP.Ribbon.PageState.PageStateStrings.itemIsMasterPageGalleryFileStateName="ItemIsMasterPageGalleryFile";SP.Ribbon.PageState.PageStateStrings.itemCancelWorkflowEnabledStateName="ItemCancelWorkflowEnabled";SP.Ribbon.PageState.PageStateStrings.itemHasFieldControlsStateName="ItemHasFieldControls";SP.Ribbon.PageState.PageStateStrings.itemHasPersonalizableZonesStateName="ItemHasPersonalizableZones";SP.Ribbon.PageState.PageStateStrings.itemHasCustomizableZonesStateName="ItemHasCustomizableZones";SP.Ribbon.PageState.PageStateStrings.userHasContributorRightsStateName="UserHasContributorRights";SP.Ribbon.PageState.PageStateStrings.userHasOverrideCheckoutRightsStateName="UserHasOverrideCheckoutRights";SP.Ribbon.PageState.PageStateStrings.userHasApproverRightsStateName="UserHasApproverRights";SP.Ribbon.PageState.PageStateStrings.userHasDeleteRightsStateName="UserHasDeleteRights";SP.Ribbon.PageState.PageStateStrings.docLibVersioningEnabledStateName="DocLibVersioningEnabled";SP.Ribbon.PageState.PageStateStrings.docLibCheckoutRequiredStateName="DocLibCheckoutRequired";SP.Ribbon.PageState.PageStateStrings.docLibMinorVersionsEnabledStateName="DocLibMinorVersionsEnabled";SP.Ribbon.PageState.PageStateStrings.docLibApprovalEnabledStateName="DocLibApprovalEnabled";SP.Ribbon.PageState.PageStateStrings.docLibWorkflowEnabledStateName="DocLibWorkflowEnabled";SP.Ribbon.PageState.PageStateStrings.viewModeIsEditStateName="ViewModeIsEdit";SP.Ribbon.PageState.PageStateStrings.viewModeHasSaveConflictStateName="ViewModeHasSaveConflict";SP.Ribbon.PageState.PageStateStrings.viewModeIsWebPartDesignStateName="ViewModeIsWebPartDesign";SP.Ribbon.PageState.PageStateStrings.save="Save";SP.Ribbon.PageState.PageStateStrings.edit="Edit";SP.Ribbon.PageState.PageStateStrings.saveAndStop="SaveAndStop";SP.Ribbon.PageState.PageStateStrings.overrideCheckout="OverrideCheckout";SP.Ribbon.PageState.PageStateStrings.checkout="Checkout";SP.Ribbon.PageState.PageStateStrings.checkin="Checkin";SP.Ribbon.PageState.PageStateStrings.publish="Publish";SP.Ribbon.PageState.PageStateStrings.unpublish="Unpublish";SP.Ribbon.PageState.PageStateStrings.submit="SubmitForApproval";SP.Ribbon.PageState.PageStateStrings.cancelApproval="CancelApproval";SP.Ribbon.PageState.PageStateCommands.pageStateGroupReject="PageStateGroupReject";SP.Ribbon.PageState.PageStateCommands.pageStateGroupApprove="PageStateGroupApprove";SP.Ribbon.PageState.PageStateCommands.pageStateGroupCancelApproval="PageStateGroupCancelApproval";SP.Ribbon.PageState.PageStateCommands.pageStateGroupSubmitForApproval="PageStateGroupSubmitForApproval";SP.Ribbon.PageState.PageStateCommands.pageStateGroupUnpublish="PageStateGroupUnpublish";SP.Ribbon.PageState.PageStateCommands.pageStateGroupPublish="PageStateGroupPublish";SP.Ribbon.PageState.PageStateCommands.pageStateGroupOverrideCheckout="PageStateGroupOverrideCheckout";SP.Ribbon.PageState.PageStateCommands.pageStateGroupDiscardCheckout="PageStateGroupDiscardCheckout";SP.Ribbon.PageState.PageStateCommands.pageStateGroupCheckout="PageStateGroupCheckout";SP.Ribbon.PageState.PageStateCommands.pageStateGroupCheckin="PageStateGroupCheckin";SP.Ribbon.PageState.PageStateCommands.pageStateGroupDontSaveAndStop="PageStateGroupDontSaveAndStop";SP.Ribbon.PageState.PageStateCommands.pageStateGroupEdit="PageStateGroupEdit";SP.Ribbon.PageState.PageStateCommands.pageStateGroupSaveAndStop="PageStateGroupSaveAndStop";SP.Ribbon.PageState.PageStateCommands.pageStateGroupSave="PageStateGroupSave";SP.Ribbon.PageState.PageStateCommands.pageStateGroupStopEditing="PageStateGroupStopEditing";SP.Ribbon.PageState.PageStateHandler.$13_1={PageStateGroupSaveSplit:["PageStateGroupSave","PageStateGroupSaveAndStop","PageStateGroupEdit","PageStateGroupDontSaveAndStop","PageStateGroupStopEditing"],PageStateGroupCheckinSplit:["PageStateGroupCheckin","PageStateGroupCheckout","PageStateGroupDiscardCheckout","PageStateGroupOverrideCheckout"],PageStateGroupPublishSplit:["PageStateGroupPublish","PageStateGroupUnpublish","PageStateGroupSubmitForApproval","PageStateGroupCancelApproval"]};SP.Ribbon.PageState.PageStateHandler.$c_1=null;SP.Ribbon.PageState.PageStateHandler.$1Z_1=true;SP.Ribbon.PageState.PageStateHandler.$C_1=[];SP.Ribbon.PageState.PageStateHandler.$2b_1=SP.Ribbon.PageState.PageStateHandler.saveBeforeNavigate;SP.Ribbon.PageState.PageStateHandler.$2a_1=SP.Ribbon.PageState.PageStateHandler.$6H_1;SP.Ribbon.PageState.PageStateHandler.$1H_1=false;SP.Ribbon.PageState.PageStateHandler.ignoreNextUnload=false;SP.Ribbon.PageState.PageStateHandler.saveCallbackError=null;SP.Ribbon.PageState.Handlers.$1z_0=new Array(0);SP.Ribbon.PageState.Handlers.$L_0=null;SP.Ribbon.PageState.Handlers.$2d_0=null;SP.Ribbon.PageState.Handlers.$20_0=null;SP.Ribbon.PageState.Handlers.$1y_0=null;SP.Ribbon.PageState.Handlers.$2e_0=null;SP.Ribbon.PageState.Handlers.$Q_0=null;SP.Ribbon.TenantAdmin.TenantAdminPageComponent.$1u_1=new SP.Ribbon.TenantAdmin.TenantAdminPageComponent;SP.Ribbon.NativeUtility=function(){};SP.Ribbon.NativeUtility.getCtxForView=function(b){ULS04Z:;var a=g_ViewIdToViewCounterMap[b];if(typeof a!="undefined"&&a!=null)return window["ctx"+a];return null};SP.Ribbon.NativeUtility.executeClickScript=function(script,viewId){ULS04Z:;script=script.replace(/javascript:return false/g,"");script=script.replace(/return false/g,"");var currentCtxId=g_ViewIdToViewCounterMap[viewId],strCode="var event = new Object(); event.fromRibbon=true; ";if(!SP.ScriptUtility.isNullOrUndefined(currentCtxId))strCode+="event.currentCtx = eval('ctx' + currentCtxId); ";eval(strCode+script+";")};SP.Ribbon.NativeUtility.executeClickScriptSimple=function(script){ULS04Z:;script=script.replace(/javascript:return false/g,"");script=script.replace(/return false/g,"");eval(script)};SP.Ribbon.NativeUtility.createXMLDocFromString=CUI.NativeUtility.createXMLDocFromString;SP.Ribbon.NativeUtility.createXMLDocFromStringCore=CUI.NativeUtility.createXMLDocFromStringCore;SP.Ribbon.NativeUtility.getWSA=function(){ULS04Z:;return GetWSA()};SP.Ribbon.NativeUtility.addCommandStreamToWSA=function(a,i,j){ULS04Z:;if(typeof a=="undefined"||!a)return;if(!WSAEnabled())return;var g=GetWSA();if(!g)return;var e=0;if(a.CommandId)e=SP.Ribbon.SQMUtility.calcActionId(a.CommandId);else return;var f=0;if(a.TabId)f=SP.Ribbon.SQMUtility.calcActionId(a.TabId);var d=SP.BWsaClient.getSQMLocationFromCUICommandInfo(a);if(d==0)return;var b=0,c=0;if(g_wsaListTemplateId){b=1;c=g_wsaListTemplateId}var h=(0<<0)+(0<<5)+(d<<9)+(b<<16);g.addToStreamDw8(8327,h,f,e,c,i,j,0,0)};SP.Ribbon.NativeUtility.ffClick=function(b){ULS04Z:;var a=document.createEvent("MouseEvents");a.initMouseEvent("click",true,true,window,0,0,0,0,0,false,false,false,false,0,null);b.dispatchEvent(a)};SP.Ribbon.NativeUtility.executeECBCommand=function(code,myctx){ULS04Z:;eval("var event = new Object();event.fromRibbon = true; event.currentCtx = myctx;"+code+";")};typeof Sys!="undefined"&&Sys&&Sys.Application&&Sys.Application.notifyScriptLoaded();function DeselectWpWz(){ULS04Z:;var a=SP.Ribbon.WebPartComponent.get_instance();a&&a.deselectWebPartAndZone(null,null)}function SelectWp(b){ULS04Z:;var a=SP.Ribbon.WebPartComponent.get_instance();a&&a.selectWebPart(b,true)}function SelectWz(c,b){ULS04Z:;var a=SP.Ribbon.WebPartComponent.get_instance();a&&a.selectWebPartZone(c,b)}function ChangeWikiPageMode(b){ULS04Z:;var a=SP.Ribbon.WikiPageComponent.get_instance();a&&a.changeWikiPageMode(b)}function showSaveConflictDialog(c,b,d,a,f,e){ULS04Z:;var g=SP.Ribbon.SaveConflictHandler.showSaveConflictDialog(c,b,d,a,f,e);return g}var ribbon={SelectWp:SelectWp,SelectWz:SelectWz,DeselectWpWz:DeselectWpWz,ChangeWikiPageMode:ChangeWikiPageMode,showSaveConflictDialog:showSaveConflictDialog};function WSAEnabled(){ULS04Z:;return typeof g_wsaEnabled!="undefined"&&g_wsaEnabled}function SendWSA(){ULS04Z:;try{WSAEnabled()&&g_thewsa.uploadWsaData()}catch(a){}}function GetWSA(){ULS04Z:;if(typeof g_thewsa=="undefined"||!g_thewsa)if(SP)if(SP.BWsaClient){if(!WSAEnabled())g_wsaEnabled=false;g_thewsa=new SP.BWsaClient("/_layouts/WsaUpload.ashx",g_wsaEnabled);var a=g_thewsa;a.createStream(8327,1,8,200);a.addCommonDatapoint(59);a.setDw(59,89);if(g_wsaSiteTemplateId){a.addCommonDatapoint(8492);a.setDw(8492,SP.Ribbon.SQMUtility.calcActionId(g_wsaSiteTemplateId))}if(g_wsaLCID){a.addCommonDatapoint(8491);a.setDw(8491,g_wsaLCID)}if(typeof addEventListener!="undefined")addEventListener("beforeunload",SendWSA,false);else attachEvent("onbeforeunload",SendWSA)}return g_thewsa}typeof Sys!="undefined"&&Sys&&Sys.Application&&Sys.Application.notifyScriptLoaded();typeof NotifyScriptLoadedAndExecuteWaitingJobs=="function"&&NotifyScriptLoadedAndExecuteWaitingJobs("sp.ribbon.js");SP.Ribbon.TrackTabPageComponent.registerWithPageManager();