function ULSrLq(){var o=new Object;o.ULSTeamName="Microsoft SharePoint Foundation";o.ULSFileName="core.js";return o;}
function GetXMLHttpRequestObject(){ULSrLq:;return new XMLHttpRequest}function insertAdjacentElement(a,c,b){ULSrLq:;if(a.insertAdjacentElement)return a.insertAdjacentElement(c,b);switch(c){case "beforeBegin":return a.parentNode.insertBefore(b,a);break;case "afterBegin":return a.insertBefore(b,a.firstChild);break;case "beforeEnd":return a.appendChild(b);break;case "afterEnd":if(a.nextSibling)return a.parentNode.insertBefore(b,a.nextSibling);else return a.parentNode.appendChild(b)}}function insertAdjacentHTML(a,c,b){ULSrLq:;if(a.insertAdjacentHTML)return a.insertAdjacentHTML(c,b);var d=a.ownerDocument.createRange();d.setStartBefore(a);var e=d.createContextualFragment(b);return insertAdjacentElement(a,c,e)}function insertAdjacentText(a,c,b){ULSrLq:;if(a.insertAdjacentText)return a.insertAdjacentText(c,b);var d=document.createTextNode(b);return insertAdjacentElement(a,c,d)}function contains(c,a){ULSrLq:;var b=false;do{if(b=c==a)break;a=a.parentNode}while(a!=null);return b}function getFirstElementByName(b,c){ULSrLq:;if(b.name==c)return b;var a=b.firstChild;while(a){var d=getFirstElementByName(a,c);if(d)return d;a=a.nextSibling}}function documentGetElementsByName(c){ULSrLq:;if(!browseris.ie&&document.getElementsByName)return document.getElementsByName(c);for(var d=[],b=document.getElementsByTagName("*"),e=b.length,a=0;a<e;a++)(b[a].name==c||typeof b[a].getAttribute!="unknown"&&b[a].getAttribute&&b[a].getAttribute("name")==c)&&d.push(b[a]);return d}function getFirstChild(b){ULSrLq:;var a=b.firstChild;while(a&&a.nodeType==3)a=a.nextSibling;return a}var IsMenuShown=false,ChevronContainer=null,itemTableDeferred=null,imageCell=null,onKeyPress=false,downArrowText=null,currentEditMenu=null,currentItemID=null,currentItemAppName=null,currentItemProgId=null,currentItemIcon=null,currentItemOpenControl=null,currentItemFileUrl=null,currentItemFSObjType=null,currentItemContentTypeId=null,currentItemCheckedOutUserId=null,currentItemCheckoutExpires=null,currentItemModerationStatus=null,currentItemUIString=null,currentItemCheckedoutToLocal=null,bIsCheckout=0,currentItemCanModify=null,currentItemPermMaskH=null,currentItemPermMaskL=null,currentItemEvtType=0,currentItemIsEventsExcp=null,currentItemIsEventsDeletedExcp=null,currentItemContentTypeId=null;String.prototype.trim=function(){ULSrLq:;return this.replace(/^\s\s*/,"").replace(/\s\s*$/,"")};var L_Edit_Text="Edit",L_SharepointSearch_Text="Search this site...",L_CreateWebPageDialogWidth_Text="400",L_CreateWebPageDialogHeight_Text="250",g_MaximumSelectedItemsAllowed=100,L_BulkSelection_TooManyItems="You cannot select more than 100 items at once.",g_ExpGroupWPState=new LRUCache,DocOpen={CLIENT:0,BROWSER:1};function FilterNoteField(b,d,e,j){ULSrLq:;if(j!=13)return;event.returnValue=false;var a=window.location.href;pagedPart=/&Paged=TRUE&p_[^&]*&PageFirstRow=[^&]*/gi;a=a.replace(pagedPart,"");viewGuid=GetUrlKeyValue("View",true);if(viewGuid==""){a=StURLSetVar2(a,"View",b);viewGuid=b}if(b.toUpperCase()!=viewGuid.toUpperCase()){var g=escapeProperly(b);if(g.toUpperCase()!=viewGuid.toUpperCase()){var k=/\?[^?]*/i,f=a.indexOf("?");if(f!=-1)a=a.replace(k,"?View="+b);else a=a+"?View="+b}}var c=a.match("FilterField([0-9]+)="+d);if(!c){var f=a.indexOf("?");if(f!=-1)a=a+"&";else a=a+"?";i=0;do{i++;FilterArray=a.match("FilterField"+i+"=[^&]*&FilterValue"+i+"=[^&]*")}while(FilterArray);a=a+"FilterField"+i+"="+d+"&FilterValue"+i+"="+escapeProperly(e);a=a.replace("Filter=1&","")}else{filterNo=parseInt(c[1]);var h=a.match("&FilterValue"+filterNo+"=[^&]*");strTemp="&"+c[0]+h[0];strNewFilter="&FilterField"+c[1]+"="+d+"&FilterValue"+c[1]+"="+escapeProperly(e);a=a.replace(strTemp,strNewFilter);a=a.replace("Filter=1&","")}window.location.href=STSPageUrlValidation(a)}function _SelectField(b,k){ULSrLq:;var a=window.location.href,g=window.location.hash,c=false,f=/\#.*/i;a=a.replace(f,"");viewGuid=GetUrlKeyValue("View",true);pageView=GetUrlKeyValue("PageView",true);var h=GetUrlKeyValue("ID",true),e=GetUrlKeyValue("ContentTypeId",true);if(b.toUpperCase()!=viewGuid.toUpperCase()){var i=escapeProperly(b);if(i.toUpperCase()!=viewGuid.toUpperCase()){var f=/\?[^?]*/i,j=a.indexOf("?");if(j!=-1)a=a.replace(f,"?View="+b);else a=a+"?View="+b;c=true}}if(!c&&GetUrlKeyValue("SelectedID")!=""){var d=/&SelectedID=[^&]*/gi;a=a.replace(d,"");d=/\?SelectedID=[^&]*&?/;a=a.replace(d,"?")}a=a+"&SelectedID=";a=a+k;if(c&&pageView!="")a=a+"&PageView="+pageView;if(h!="")a=a+"&ID="+h;if(e!="")a=a+"&ContentTypeId="+e;if(g!="")a=a+g;_SubmitFormPost(a);return false}function _FilterField(d,b,a,c){ULSrLq:;return FilterFieldV3(d,b,a,c,false)}function FilterFieldV3(e,k,o,q,u){ULSrLq:;var a=CanonicalizeUrlEncodingCase(window.location.href),l=new CUrl(a);a=l.query;var b=a.match("[&?]Paged=TRUE[^&]*");if(b){var c=/&p_[^&]*/gi;a=a.replace(c,"");c=/&PageFirstRow=[^&]*/gi;a=a.replace(c,"");c=/&PageLastRow=[^&]*/gi;a=a.replace(c,"");c=/&PagedPrev=TRUE[^&]*/i;a=a.replace(c,"");b=a.match("[?]Paged=TRUE[^&]*");if(b){var f=a.substr(b["index"]).indexOf("&");if(f!=-1)a=a.substr(0,b["index"]+1)+a.substr(f+b["index"]+1);else a=a.substr(0,b["index"])}else{c=/&Paged=TRUE[^&]*/i;a=a.replace(c,"")}}viewGuid=GetUrlKeyValue("View",true);if(viewGuid==""){a=StURLSetVar2(a,"View",e);viewGuid=e}if(e.toUpperCase()!=viewGuid.toUpperCase()){var t=escapeProperly(e);if(t.toUpperCase()!=viewGuid.toUpperCase()){var v=/\?[^?]*/i,f=a.indexOf("?");if(f!=-1)a=a.replace(v,"?View="+e);else a=a+"?View="+e}}b=a.match("FilterField([0-9]+)="+k+"&");if(!b)if(0==q){a=a.replace("Filter=1&","");a=a.replace("?Filter=1","")}else{var f=a.indexOf("?");if(f!=-1)a=a+"&";else a=a+"?";i=0;do{i++;FilterArray=a.match("FilterField"+i+"=[^&]*")}while(FilterArray);a=a+"FilterField"+i+"="+k+"&FilterValue"+i+"="+escapeProperly(o);a=a.replace("Filter=1&","")}else{filterNo=parseInt(b[1]);var h=a.match("FilterValue"+filterNo+"=[^&]*"),r=a.match("&FilterOp"+filterNo+"=[^&]*"),n=a.match("&FilterLookupId"+filterNo+"=[^&]*"),p=a.match("&FilterData"+filterNo+"=[^&]*"),d="&"+b[0]+h[0];if(0==q){if(a.indexOf(d)==-1)d=b[0]+h[0]+"&";a=a.replace(d,"");if(r)a=a.replace(r[0],"");if(n)a=a.replace(n[0],"");if(p)a=a.replace(p[0],"");j=filterNo+1;FilterArray=a.match("FilterField"+j+"=[^&]*");for(i=filterNo;FilterArray;i++){strNew="FilterField"+i;strOld="FilterField"+j;a=a.replace(strOld,strNew);strNew="FilterValue"+i;strOld="FilterValue"+j;a=a.replace(strOld,strNew);strNew="FilterOp"+i;strOld="FilterOp"+j;a=a.replace(strOld,strNew);strNew="FilterLookupId"+i;strOld="FilterLookupId"+j;a=a.replace(strOld,strNew);strNew="FilterData"+i;strOld="FilterData"+j;a=a.replace(strOld,strNew);j++;FilterArray=a.match("FilterField"+j+"=[^&]*")}a=a.replace("Filter=1&","");a=a.replace("?Filter=1","");a=a.replace("&Filter=1","")}else{var g;if(a.indexOf(d)==-1){d="?"+b[0]+h[0];g="?"}else g="&";var s=g+"FilterField"+b[1]+"="+k+"&FilterValue"+b[1]+"="+escapeProperly(o);a=a.replace(d,s);a=a.replace("Filter=1&","");a=a.replace("&Filter=1","")}}b=a.match("FilterField([0-9]+)=");if(!b)a=a+"&FilterClear=1";else a=a.replace("&FilterClear=1","");l.query=a;a=l.ToString();if(u){var m=a.indexOf("?");m=a.substr(m+1).indexOf("?");if(m>=0)debugger;return a}else _SubmitFormPost(a)}function CanonicalizeUrlEncodingCase(c){ULSrLq:;for(var b="",a=0;a<c.length;a++){var d=c.charAt(a);if(d=="%"&&a+2<c.length){b+=d;a++;b+=c.charAt(a).toString().toUpperCase();a++;b+=c.charAt(a).toString().toUpperCase()}else b+=d}return b}function _SetControlValue(b,c){ULSrLq:;var a=document.getElementById(b);if(a!=null)a.value=c}var bValidSearchTerm=false;function SetSearchView(){ULSrLq:;if(typeof bValidSearchTerm!="undefined")bValidSearchTerm=true}function GroupCollapse(){ULSrLq:;return typeof _groupCollapse!="undefined"&&_groupCollapse}function HandleFilter(c,b){ULSrLq:;if(FV4UI()){var a;try{a=typeof inplview.HandleFilterReal}catch(g){a="undefined"}if(a!="undefined")inplview.HandleFilterReal(c,b);else{var f="inplview.HandleFilterReal",d=f.split(".");if(d.length>1){var e=function(){ULSrLq:;inplview.HandleFilterReal(c,b)};EnsureScript(d[0],a,e)}}return}_SubmitFormPost(b)}function _SubmitFormPost(a,d,c){ULSrLq:;if(typeof MSOWebPartPageFormName!="undefined"){var b=document.forms[MSOWebPartPageFormName];if(null!=b)if(d!=undefined&&d==true||!b.onsubmit||b.onsubmit()!=false){typeof WebForm_OnSubmit=="function"&&WebForm_OnSubmit();if(window.location.search.match("[?&]IsDlg=1"))a+=a.indexOf("?")==-1?"?IsDlg=1":"&IsDlg=1";if(FV4UI())try{currentTabId=SP.Ribbon.PageManager.get_instance().get_ribbon().get_selectedTabId();if(currentTabId){a=StURLSetVar2(a,"InitialTabId",escapeProperly(currentTabId));a=StURLSetVar2(a,"VisibilityContext","WSSTabPersistence")}}catch(e){}if(c!=undefined&&c==true){a=DemoteIntoFormBody(b,a,"owsfileref");a=DemoteIntoFormBody(b,a,"NextUsing")}b.action=STSPageUrlValidation(a);b.method="POST";if(isPortalTemplatePage(a))b.target="_top";!bValidSearchTerm&&_ClearSearchTerm("");b.submit()}}}function DemoteIntoFormBody(e,c,b){ULSrLq:;var d=GetUrlKeyValue(b,false,c);if(d.length>0){var a=document.createElement("INPUT");if(a!=null){a.setAttribute("type","hidden");a.setAttribute("id",b);a.setAttribute("name",b);a.setAttribute("value",d);e.appendChild(a);return RemoveUrlKeyValue(b,c)}}return c}function RemoveUrlKeyValue(c,a){ULSrLq:;var b=new RegExp(c+"=[^&]*&");a=a.replace(b,"");b=new RegExp(c+"=[^&]*");a=a.replace(b,"");return a}function _RefreshPageTo(c,b,a){ULSrLq:;return _SubmitFormPost(b,a)}var g_varSkipRefreshOnFocus=0;function RefreshOnFocus(){ULSrLq:;(typeof g_varSkipRefreshOnFocus=="undefined"||!g_varSkipRefreshOnFocus)&&_RefreshPage(1)}function RefreshOnFocusForOneRow(){ULSrLq:;RefreshOnFocus()}function DisableRefreshOnFocus(){ULSrLq:;g_varSkipRefreshOnFocus=1}function SetWindowRefreshOnFocus(){ULSrLq:;window.onbeforeunload=DisableRefreshOnFocus;window.onfocus=RefreshOnFocus}function RemoveParametersFromUrl(a){ULSrLq:;var b=a.indexOf("?");if(b==-1)return a;else return a.substr(0,b)}function _GoToPageRelative(a){ULSrLq:;if(a.substr(0,4)!="http"&&a.substr(0,1)!="/"){var b=RemoveParametersFromUrl(window.location.href),c=b.lastIndexOf("/");if(c>0)a=b.substring(0,c+1)+a}GoToPage(a)}function _EnterFolder(c){ULSrLq:;var b=RemoveParametersFromUrl(window.location.href),a=RemoveParametersFromUrl(c),d=a!=null&&a.length>0&&a.charAt(0)=="/"&&a.length<b.length&&b.indexOf(a)==b.length-a.length;if(!d&&a.toLowerCase()!=b.toLowerCase())STSNavigate(c);else _SubmitFormPost(c)}function _HandleFolder(q,e,r,k,g,j,c,f,d,a,b,m,n,l,i,p){ULSrLq:;var o=a&&a!="",h=b&&b!="";if(o&&h){if(f=="0"&&a=="OneNote.Notebook"&&c=="FALSE"&&Boolean(d))c=d;return DispEx(q,e,k,g,j,c,f,d,a,b,m,n,l,i,p)}else{e&&CancelEvent(e);_EnterFolder(r);return false}}function UseDialogsForFormsPages(c){ULSrLq:;if(!FV4UI())return false;var b=null,a=GetUrlKeyValue("LISTID",false,c.toUpperCase());if(a=="")a=GetUrlKeyValue("LIST",false,c.toUpperCase());if(a!=""&&g_ctxDict!=null)for(var e in g_ctxDict){var d=g_ctxDict[e];if(d.listName.toUpperCase()==a.toUpperCase()){b=d;break}}if(b==null||!b.NavigateForFormsPages)return true;return false}function _EditItemWithCheckoutAlert(c,a,b,d,g,h,f,e){ULSrLq:;if(CheckoutAlertBeforeNavigate(a,b,d,g,h,f,e))if(b&&UseDialogsForFormsPages(a))NewOrEditV4Core(c,a,true);else _EditItem2(c,a)}function _STSNavigateWithCheckoutAlert(a,g,b,e,f,d,c){ULSrLq:;CheckoutAlertBeforeNavigate(a,g,b,e,f,d,c)&&STSNavigate(a)}function ShowInPopUI(b,a,c){ULSrLq:;var d=function(){ULSrLq:;if(a==null&&b.fromRibbon&&b.currentCtx)a=b.currentCtx;if(typeof a!="undefined"&&a!=null&&a.clvp!=null){var d=a.clvp;GetFocusInfo(b,d);d.ShowPopup(c)}else STSNavigate(c)};EnsureScript("inplview",typeof inplview,d)}function TakeOfflineToClientReal(d,c,h,b,a,g,f){ULSrLq:;try{if(TakeOfflineDisabled(d,c,b,a))return;g_OfflineClient!=null&&g_OfflineClient.TakeOffline(d,c,h,b,a,g,f)}catch(e){alert(e.message)}}function CheckoutAlertBeforeNavigate(g,f,d,c,e,a,b){ULSrLq:;if(typeof a=="undefined"||a==null||a=="")a=currentItemCheckedOutUserId;if((typeof b=="undefined"||b==null||b=="")&&typeof ctx!="undefined")b=ctx.CurrentUserId;if(d=="1"){alert(L_CannotEditPropertyForLocalCopy_Text);return false}if(a!=null&&a!=""&&b!=null&&a!=b){alert(L_CannotEditPropertyCheckout_Text);return false}if(f=="1")if(confirm(L_ConfirmCheckout_Text)){if(c.charAt(0)=="/"||c.substr(0,3).toLowerCase()=="%2f")c=document.location.protocol+"//"+document.location.host+c;return CheckoutviaXmlhttp(e,c)}else return false;return true}function CheckoutviaXmlhttp(c,b){ULSrLq:;var a,e;a=new XMLHttpRequest;if(a==null)return false;a.open("POST",c+"/_vti_bin/lists.asmx",false);a.setRequestHeader("Content-Type","text/xml; charset=utf-8");a.setRequestHeader("SOAPAction","http://schemas.microsoft.com/sharepoint/soap/CheckOutFile");var d='<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><CheckOutFile xmlns="http://schemas.microsoft.com/sharepoint/soap/"><pageUrl>'+b+"</pageUrl></CheckOutFile></soap:Body></soap:Envelope>";a.send(d);if(a.status==200&&a.responseText.indexOf("true")!=0)return true;else return false}var g_ExtensionNotSupportCheckoutToLocal=["ascx","asp","aspx","htm","html","master","odc","exe","bat","com","cmd","onetoc2"],g_ExtensionDefaultForRead=["jpg","jpeg","bmp","png","gif","onetoc2","one","odc"];function FSupportCheckoutToLocal(a){ULSrLq:;var c=true;if(a==null||a=="")return false;a=a.toLowerCase();for(var b=0,b=0;b<g_ExtensionNotSupportCheckoutToLocal.length;b++)if(a==g_ExtensionNotSupportCheckoutToLocal[b])return false;return true}function FDefaultOpenForReadOnly(a){ULSrLq:;var c=false;if(a==null||a=="")return true;a=a.toLowerCase();for(var b=0,b=0;b<g_ExtensionDefaultForRead.length;b++)if(a==g_ExtensionDefaultForRead[b])return true;return false}function CheckoutDocument(g,a,e){ULSrLq:;var d=null,b=true,c=false;if(a.charAt(0)=="/"||a.substr(0,3).toLowerCase()=="%2f")a=document.location.protocol+"//"+document.location.host+a;var f=SzExtension(unescapeProperly(a));if(FSupportCheckoutToLocal(f)&&e=="SharePoint.OpenDocuments.3")d=StsOpenEnsureEx2(e);if(d!=null)try{b=d.CheckoutDocumentPrompt(unescapeProperly(a),false,"");b&&RefreshOnFocus();c=b;if(c||!(IsSupportedMacBrowser()||IsSupportedFirefoxOnWin()))return b}catch(i){}if(!c){var h="FileName="+escapeProperly(unescapeProperly(a))+"&Checkout=true";NavigateToCheckinAspx(g,h)}return true}function NewOrEditV4Core(a,b,c){ULSrLq:;if(a!=null){var d=function(){ULSrLq:;var b=CLVPFromEventReal(a);GetFocusInfo(a,b)};EnsureScript("inplview",typeof InitAllClvps,d)}if(c)_OpenPopUpPage(b,RefreshOnDialogClose);else _OpenPopUpPage(b,RefreshPage);return false}function _NewItem2(b,a){ULSrLq:;if(UseDialogsForFormsPages(a))return NewOrEditV4Core(b,a);else _NewItem(a)}function _NewItem(a){ULSrLq:;GoToPage(a)}function _EditItem2(b,a){ULSrLq:;if(UseDialogsForFormsPages(a))return NewOrEditV4Core(b,a);_EditItem(a)}function _EditItem(a){ULSrLq:;GoToPage(a)}function _AddQueryString(b,a){ULSrLq:;var d=GetUrlKeyValue(b,true,a),c=GetUrlKeyValue(b,true);if(""==d&&""!=c)a+="&"+b+"="+c;return a}function _CorrectUrlForRefreshPageSubmitForm(){ULSrLq:;var a=window.location.hash;if(a.indexOf("ServerFilter=")==1){a=a.replace(/-/g,"&").replace(/&&/g,"-");a=_AddQueryString("RootFolder",a);a=_AddQueryString("ShowWebPart",a);a=_AddQueryString("PageView",a);var b=new CUrl(window.location.href);b.hash="";b.query="?"+a.substr("ServerFilter=".length+1);return b.ToString()}else return window.location.href}function _RefreshPage(a){ULSrLq:;if(a==1)_SubmitFormPost(_CorrectUrlForRefreshPageSubmitForm());else{var b=function(){ULSrLq:;SetFocusBack(a)};EnsureScript("inplview",typeof InitAllClvps,b)}}function RefreshOnDialogClose(){ULSrLq:;_RefreshPage(SP.UI.DialogResult.OK)}function OpenPopUpPageWithTitle(f,b,e,c,d){ULSrLq:;var g=function(){ULSrLq:;var a={url:f,args:null,title:d,dialogReturnValueCallback:b,width:e,height:c},g=SP.UI.ModalDialog.showModalDialog(a)},a;try{a=typeof SP.UI.ModalDialog.showModalDialog}catch(h){a="undefined"}EnsureScript("SP.UI.Dialog.js",a,g)}function _OpenPopUpPage(d,a,c,b){ULSrLq:;OpenPopUpPageWithTitle(d,a,c,b,null)}function _RemoveQueryStringsAndHash(a){ULSrLq:;if(a){var b=a.indexOf("#");if(b>=0)a=a.substr(0,b);b=a.indexOf("?");if(b>=0)a=a.substr(0,b)}return a}function _OpenCreateWebPageDialog(a){ULSrLq:;if(!a&&typeof _spPageContextInfo!="undefined"&&_spPageContextInfo.webServerRelativeUrl){a=_spPageContextInfo.webServerRelativeUrl;if(a.charAt(a.length-1)!="/")a=a+"/";a=a+"_layouts/createwebpage.aspx"}var b=window.location.href;b=_RemoveQueryStringsAndHash(b);a=StURLSetVar2(a,"Url",escapeProperly(b));if(FV4UI()){var d=parseInt(L_CreateWebPageDialogWidth_Text),c=parseInt(L_CreateWebPageDialogHeight_Text);if(isNaN(d))d=400;if(isNaN(c))c=250;_OpenPopUpPage(a,null,d,c)}else GoToPage(a)}function PreventDefaultNavigation(){ULSrLq:;var a=window.event;if(a)if(!a.preventDefault)a.returnValue=false;else a.preventDefault()}function _EditLink2(a,b){ULSrLq:;var c=function(){ULSrLq:;var d=GetGotoLinkUrl(a);if(d==null)return;var c=window["ctx"+b];if(c!=null&&c.clvp!=null){var e=c.clvp;if(FV4UI()&&!c.NavigateForFormsPages){PreventDefaultNavigation();e.ShowPopup(d);return false}}GoToLink(a)};EnsureScript("inplview",typeof inplview,c)}function EditLink(a,b){ULSrLq:;if(FV4UI())EditLink2(a,b);else GotoLink(a)}function _GoBack(a){ULSrLq:;window.location.href=unescapeProperly(GetSource(a))}function _ReplyItem(a,b,d,c){ULSrLq:;if(b.length>=504){var L_ReplyLimitMsg_Text="Cannot reply to this thread. The reply limit has been reached.";alert(L_ReplyLimitMsg_Text)}else{a+="?Threading="+b;a+="&Guid="+d;a+="&Subject="+c;GoToPage(a)}}function GoBacktoCurrentIssue(a,b){ULSrLq:;a+="?ID="+b;GoToPage(a)}function _ExportToDatabase(d,e,f,c){ULSrLq:;if(g_expDatabase==null){var a=GetCookie("databaseBtnText");if(a!=null&&a!="0")try{g_expDatabase=new ActiveXObject("SharePoint.ExportDatabase")}catch(b){return null}else if(a==null)GetDataBaseInstalled();else return null}if(g_expDatabase!=null){var L_NoWSSClient_Text="To export a list, you must have a Microsoft SharePoint Foundation-compatible application and Microsoft Internet Explorer 7.0 or greater.",L_ExportDBFail_Text="Export to database failed. To export a list, you must have a Microsoft SharePoint Foundation-compatible application.";if(browseris.ie5up&&browseris.win32)try{g_expDatabase.SiteUrl=makeAbsUrl(d);g_expDatabase.ListID=e;g_expDatabase.ViewID=f;g_expDatabase.DoExport(c)}catch(b){alert(L_ExportDBFail_Text);return}else alert(L_NoWSSClient_Text)}}function _ExportList(a){ULSrLq:;g_ssImporterObj==null&&EnsureSSImporter();if(g_ssImporterObj==null)(g_fSSImporter||GetCookie("EnsureSSImporter")==null)&&EnsureSSImporter(true);var L_ExportListSpreadsheet_Text="To export a list, you must have a Microsoft SharePoint Foundation-compatible application.";if(IsSupportedMacBrowser()){if(g_fSSImporter&&g_ssImporterObj.IqyExportEnabled){var b=g_ssImporterObj.IqyExport(makeAbsUrl(a));if(!b)window.location.href=STSPageUrlValidation(makeAbsUrl(a))}else if(confirm(L_ExportListSpreadsheet_Text))window.location.href=STSPageUrlValidation(makeAbsUrl(a))}else if(g_fSSImporter&&g_ssImporterObj.IqyImportEnabled()||confirm(L_ExportListSpreadsheet_Text))window.location.href=STSPageUrlValidation(makeAbsUrl(a))}function ExportDiagram(m,f,l,g,i,h){ULSrLq:;if(g_objDiagramLaunch==null){var a=GetCookie("digInstalled");if(a!=null&&a!="0")try{g_objDiagramLaunch=new ActiveXObject("DiagramLaunch.DiagramLauncher")}catch(b){return null}else if(a==null)GetDiagramLaunchInstalled();else return null}try{var d="",j=m,e=h,c=f,k=l;g_objDiagramLaunch.CreateDiagram(d,j,e,c,g,i,k)}catch(b){var L_DiagramLaunchFail_Text="Unable to create diagram.";alert(L_DiagramLaunchFail_Text)}}function OpenTasks(m,f,l,g,i,h){ULSrLq:;if(g_objProjectTaskLaunch==null){var a=GetCookie("projInstalled");if(a!=null&&a!="0")try{g_objProjectTaskLaunch=new ActiveXObject("TaskLaunch.TaskLauncher")}catch(b){return null}else if(a==null)GetProjectTaskLaunchInstalled();else return null}if(g_objProjectTaskLaunch!=null)try{var d="",j=m,e=h,c=f,k=l;g_objProjectTaskLaunch.OpenTasks(d,j,e,c,g,i,k)}catch(b){var L_OpenTasksFail_Text="Unable to open tasks.";alert(L_OpenTasksFail_Text)}}var ListCtrlObj,fListControl=false,fListErrorShown=false,L_EditInGrid_Text="The list cannot be displayed in Datasheet view for one or more of the following reasons: \n\n- A datasheet component compatible with Microsoft SharePoint Foundation is not installed.\n- Your Web browser does not support ActiveX controls. \n- A component is not properly configured for 32-bit or 64-bit support.";function CatchListCreateError(){ULSrLq:;alert(L_EditInGrid_Text);fListErrorShown=true;return false}function EnsureListControl(){ULSrLq:;if(!fListControl){fListErrorShown=false;if(browseris.ie5up&&browseris.win32){var b='try{    ListCtrlObj=new ActiveXObject("ListNet.ListNet");    if (ListCtrlObj)        fListControl=true;} catch (e){    fListControl=false;};',a=new Function(b);a()}else{window.onerror=CatchListCreateError;ListCtrlObj=new ActiveXObject("ListNet.ListNet");if(ListCtrlObj)fListControl=true}}ListCtrlObj=null;return fListControl}var L_NoQuestion_Text="The survey contains no questions.",L_NoVoteAllowed_Text="You are not allowed to respond again to this survey.";function IsVoteOK(a){ULSrLq:;if(1==a)alert(L_NoQuestion_Text);else if(2==a)alert(L_NoVoteAllowed_Text);else return true}function hasHighChar(b){ULSrLq:;for(var a=0,a=0;a<b.length;a++)if(b.charCodeAt(a)>127)return true;return false}function _ClearSearchTerm(a){ULSrLq:;if(typeof MSOWebPartPageFormName!="undefined"){var c=document.forms[MSOWebPartPageFormName];if(null!=c)if(a!=null){var b=c["SearchString"+a];if(b!=null)b.value=""}}bValidSearchTerm=true}function _SubmitSearchRedirect(a){ULSrLq:;var b=document.forms["frmSiteSearch"];if(b==null)if(typeof MSOWebPartPageFormName!="undefined")b=document.forms[MSOWebPartPageFormName];if(b!=null){var c=b.elements["SearchString"].value.trim();if(c===L_SharepointSearch_Text||c==="")return false;a=a+"?k="+escapeProperly(c);var e=b.elements["SearchScope"];if(e!=null){var d=e.value;if(d)a=a+"&u="+escapeProperly(d)}window.location.href=a}return false}function ShowGridUrlInHTML(a){ULSrLq:;if(a.indexOf("?")>0)a=a+"&";else a=a+"?";a=a+"ShowInGrid=HTML";return a}function SearchOnBodyLoad(){ULSrLq:;var a=document.getElementById("idSearchString");if(a!=null&&(a.value.trim()===L_SharepointSearch_Text||a.value.trim()===""))a.className="ms-sharepointsearchtext"}function SearchOnBlur(){ULSrLq:;var a=document.getElementById("idSearchString");if(a!=null&&a.value.trim()===""){a.value=L_SharepointSearch_Text;a.className="ms-sharepointsearchtext"}}function SearchOnFocus(){ULSrLq:;var a=document.getElementById("idSearchString");if(a!=null&&a.value.trim()===L_SharepointSearch_Text){a.value="";a.className="ms-searchtext"}}function SubmitSearch(){ULSrLq:;_SubmitSearchForView("")}function _SubmitSearchForView(e){ULSrLq:;var a=document.forms[0],c="SearchString"+e,d=a.elements[c].value;if(""==d){var L_Enter_Text="Please enter one or more search words.";alert(L_Enter_Text);a.elements[c].focus()}else{var b;b=RemovePagingArgs(a.action);if(typeof bGridViewPresent!="undefined"&&bGridViewPresent)b=ShowGridUrlInHTML(b);a.action=b;a.submit()}}function IsKeyDownSubmit(a){ULSrLq:;if(a!=null){var c,b;if(browseris.ie){c=a.keyCode;b=a.altKey||a.ctrlKey}else{c=a.which;b=a.modifers&(a.ALT_MASK|a.CONTROL_MASK)}if(c==13&&!b)return true}return false}function SearchViewKeyDown(a){ULSrLq:;IsKeyDownSubmit(event)&&_SubmitSearchForView(a)}function SearchKeyDown(b,a){ULSrLq:;if(IsKeyDownSubmit(b)){_SubmitSearchRedirect(a);return false}return true}function SearchKeyDownGoSearch(a){ULSrLq:;if(IsKeyDownSubmit(a)){GoSearch();return false}return true}function _AlertAndSetFocus(b,a){ULSrLq:;a.focus();a.select();window.alert(b)}function _AlertAndSetFocusForDropdown(b,a){ULSrLq:;a.focus();window.alert(b)}function setElementValue(c,b){ULSrLq:;var a=document.getElementsByName(c).item(0);if(a==null)return false;a.value=b;return true}function GetMultipleSelectedText(b){ULSrLq:;if(b){var a;a="";for(var c=0;c<b.options.length;c++)if(b.options[c].selected)a+=","+b.options[c].text;if(a.length>0)a=a.substring(1);return a}else return ""}function GetCBSelectedValues(c){ULSrLq:;if(c==null)return;var a={};a.strList="";a.fAllChecked=true;for(var d=0;d<c.elements.length;d++){var b=c.elements[d];if(b.type=="checkbox"&&!b.disabled)if(b.checked){if(a.strList!="")a.strList+=",";a.strList+=b.value}else a.fAllChecked=false}return a}var fNewDoc=false,fNewDoc2=false,fNewDoc3=false,L_EditDocumentProgIDError_Text="'Edit Document' requires a Microsoft SharePoint Foundation-compatible application and web browser.",L_EditDocumentRuntimeError_Text="The document could not be opened for editing.  A Microsoft SharePoint Foundation compatible application could not be found to edit the document.",L_SPDesignerDownloadWindow_Text="Microsoft SharePoint Designer",SPDesignerDownloadUrl="http://r.office.microsoft.com/r/rlidBrowserToSPD",SPDesignerProgID="SharePoint.WebPartPage.Document";function editDocumentWithProgID(a,b){ULSrLq:;if(fNewDoc){if(a.charAt(0)=="/"||a.substr(0,3).toLowerCase()=="%2f")a=document.location.protocol+"//"+document.location.host+a;if(!fNewDoc2&&!fNewDoc3)!EditDocumentButton.EditDocument(a,b)&&alert(L_EditDocumentRuntimeError_Text);else!EditDocumentButton.EditDocument2(window,a,b)&&alert(L_EditDocumentRuntimeError_Text)}else alert(L_EditDocumentProgIDError_Text)}function GetSPDDownLoadUrl(){ULSrLq:;var a=navigator.userLanguage;if(!a)a=navigator.browserLanguage;return SPDesignerDownloadUrl+"?clid="+a}function EditInSPD(a,d){ULSrLq:;var b=GetSPDDownLoadUrl();if(a.charAt(0)=="/")a=document.location.protocol+"//"+document.location.host+a;var c=StsOpenEnsureEx2("SharePoint.OpenDocuments.3");if(c!=null){if(!c.EditDocument3(window,a,false,SPDesignerProgID))OpenPopUpPageWithTitle(b,null,null,null,L_SPDesignerDownloadWindow_Text);else if(d)window.onfocus=RefreshOnNextFocus}else OpenPopUpPageWithTitle(b,null,null,null,L_SPDesignerDownloadWindow_Text)}function editDocumentWithProgID2(a,c,h,g,f,d){ULSrLq:;var b=editDocumentWithProgIDNoUI(a,c,h,g,f,d);if(b==1){if(c==SPDesignerProgID){var e=GetSPDDownLoadUrl();OpenPopUpPageWithTitle(e,null,null,null,L_SPDesignerDownloadWindow_Text)}else if(browseris.ie8standard)STSNavigate(a);else alert(L_EditDocumentRuntimeError_Text);window.onfocus=RefreshOnNextFocus}else b==2&&alert(L_EditDocumentProgIDError_Text)}function editDocumentWithProgIDNoUI(a,c,d,h,k,i){ULSrLq:;var b,l,g=false;d=d.replace(/(?:\.\d+)$/,"");if(a.charAt(0)=="/"||a.substr(0,3).toLowerCase()=="%2f")a=document.location.protocol+"//"+document.location.host+a;var j=SzExtension(unescapeProperly(a));if(FSupportCheckoutToLocal(j))try{b=StsOpenEnsureEx2(d+".3");if(b!=null){if(h=="1"){if(!b.CheckoutDocumentPrompt(a,true,c))return 1}else{if(i=="1")g=true;if(!b.EditDocument3(window,a,g,c))return 1}var f=false;f=b.PromptedOnLastOpen();if(f)window.onfocus=RefreshOnNextFocus;else SetWindowRefreshOnFocus();return}}catch(e){}if(h=="1")if(confirm(L_ConfirmCheckout_Text))NavigateToCheckinAspx(k,"FileName="+escapeProperly(unescapeProperly(a))+"&Checkout=true");else return;b=StsOpenEnsureEx2(d);if(b!=null){try{if(!b.EditDocument2(window,a,c))return 1;if(d=="SharePoint.OpenXMLDocuments")SetWindowRefreshOnFocus();else window.onfocus=RefreshOnNextFocus;return}catch(e){}try{window.onfocus=null;if(SzExtension(a)=="ppt"&&c=="")c="PowerPoint.Slide";if(!b.EditDocument(a,c))return 1;SetWindowRefreshOnFocus();return}catch(e){return 2}}return 1}function RefreshOnNextFocus(){ULSrLq:;SetWindowRefreshOnFocus()}function createNewDocumentWithProgID2Ex(f,b,a,d,c,e){ULSrLq:;createNewDocumentWithProgID2(b,a,d,c,e)}function createNewDocumentWithProgID2(b,a,e,d,c){ULSrLq:;!createNewDocumentWithProgIDCore(b,a,e,c,false)&&createNewDocumentWithProgIDCore(b,a,d,c,true)}function createNewDocumentWithProgIDEx(e,b,a,c,d){ULSrLq:;createNewDocumentWithProgID(b,a,c,d)}function createNewDocumentWithProgID(b,a,c,d){ULSrLq:;createNewDocumentWithProgIDCore(b,a,c,d,true)}function createNewDocumentWithProgIDCore(d,c,e,h,g){ULSrLq:;var a,L_NewDocumentRuntimeError_Text,L_NewDocumentError_Text,b=false;if(h)var L_NewDocumentRuntimeError_Text=L_NewFormLibTb1_Text,L_NewDocumentError_Text=L_NewFormLibTb2_Text;else var L_NewDocumentRuntimeError_Text=L_NewDocLibTb1_Text,L_NewDocumentError_Text=L_NewDocLibTb2_Text;try{a=StsOpenEnsureEx2(e+".2");!a.CreateNewDocument2(window,d,c)&&alert(L_NewDocumentRuntimeError_Text);b=a.PromptedOnLastOpen();if(b)window.onfocus=RefreshOnNextFocus;else SetWindowRefreshOnFocus();return true}catch(f){}try{a=StsOpenEnsureEx2(e+".1");window.onfocus=null;!a.CreateNewDocument(d,c)&&alert(L_NewDocumentRuntimeError_Text);SetWindowRefreshOnFocus();return true}catch(f){g&&alert(L_NewDocumentError_Text)}}function createNewDocumentWithRedirect2(h,d,b,e,f,c,g,a){ULSrLq:;createNewDocumentWithRedirect(d,b,e,f,c,g,a)}function createNewDocumentWithRedirect(e,b,a,f,d,g,c){ULSrLq:;if(g)if(IsClientAppInstalled(a))createNewInClient(e,b,a,f);else createNewInBrowser(d,b,a,c);else if(IsClientAppInstalled(a)&&c!=1)createNewInClient(e,b,a,f);else createNewInBrowser(d,b,a,c)}function createNewInClient(c,b,d,e){ULSrLq:;var a=d.replace(/(?:\.\d+)$/,"");createNewDocumentWithProgID(c,b,a,e)}function createNewInBrowser(a,c,d,b){ULSrLq:;a=a+"&SaveLocation="+makeAbsUrl(escapeProperly(c));a=AddClientInstalledToUrl(a,d);a=AddSourceToUrl(a);a=a+"&DefaultItemOpen="+b;STSNavigate(a)}function LRUCache(){ULSrLq:;this.state=[];this.ageStack=[];this.count=0}function LRUCache_Add(a,b){ULSrLq:;if(!a)return;oldAge=a.state[b];if(oldAge!=null)a.ageStack[oldAge]=null;else a.count++;age=a.ageStack.length;a.state[b]=age;a.ageStack.push(b)}function LRUCache_Remove(a,b){ULSrLq:;if(!a)return;age=a.state[b];if(age!=null){a.ageStack[age]=null;a.state[b]=null;a.count--}}function _AddGroupToCookie(c){ULSrLq:;var a=ExpGroupFetchWebPartID(c);if(a==null)return;LRUCache_Add(g_ExpGroupWPState,a);if(g_ExpGroupTable[a]==null)g_ExpGroupTable[a]=new LRUCache;var b=ExpGroupFetchGroupString(c);if(b==null)return;LRUCache_Add(g_ExpGroupTable[a],b);ExpGroupRenderCookie()}function _RemoveGroupFromCookie(d){ULSrLq:;var a=ExpGroupFetchWebPartID(d);if(a==null)return;if(g_ExpGroupTable[a]==null)return;LRUCache_Add(g_ExpGroupWPState,a);var c=ExpGroupFetchGroupString(d);if(c==null)return;var b;for(b in g_ExpGroupTable[a].state)g_ExpGroupTable[a].state[b]!=null&&b.substring(0,c.length)==c&&LRUCache_Remove(g_ExpGroupTable[a],b);ExpGroupRenderCookie()}function ExpGroupRenderCookie(){ULSrLq:;if(!g_ExpGroupWPState)return;for(var c=ExpGroupWPListName+"=",a=0,d=g_ExpGroupWPState.ageStack.length-1;d>=0;d--)if(g_ExpGroupWPState.ageStack[d]!=null){var b=g_ExpGroupWPState.ageStack[d];if(a==ExpGroupMaxWP){DeleteCookie(ExpGroupCookiePrefix+b);break}else if(g_ExpGroupTable[b]==null){a++;if(a>1)c+=escape(ExpGroupCookieDelimiter);c+=escape(b)}else if(g_ExpGroupTable[b].count==0)DeleteCookie(ExpGroupCookiePrefix+b);else if(a<ExpGroupMaxWP){a++;ExpGroupRenderCookieForWebPart(b);if(a>1)c+=escape(ExpGroupCookieDelimiter);c+=escape(b)}}if(a==0)DeleteCookie(ExpGroupWPListName);else document.cookie=c}function ExpGroupRenderCookieForWebPart(a){ULSrLq:;if(!g_ExpGroupTable[a].ageStack)return;for(var d=ExpGroupCookiePrefix+a+"=",e=true,c=g_ExpGroupTable[a].ageStack.length-1;c>=0;c--)if(g_ExpGroupTable[a].ageStack[c]!=null){var f=g_ExpGroupTable[a].ageStack[c],b="";if(!e)b+=escape(ExpGroupCookieDelimiter);b+=escape(f);if(d.length+b.length<=ExpGroupMaxCookieLength){d+=b;e=false}}document.cookie=d+";"}function ExpDataViewGroupOnPageLoad(){ULSrLq:;ExpGroupOnPageLoad("PageLoad")}function ExpGroupOnPageLoad(a){ULSrLq:;if(typeof g_ExpGroupSeparateQueuesGlobal!="undefined"&&g_ExpGroupSeparateQueuesGlobal)g_ExpGroupSeparateQueues=true;flag=document.getElementById("GroupByColFlag");if(flag!=null){g_ExpGroupNeedsState=true;ExpGroupParseCookie(a)}}function ExpGroupParseCookie(a){ULSrLq:;var d=GetCookie(ExpGroupWPListName);if(d==null)return;g_ExpGroupParseStage=true;for(var e=d.split(ExpGroupCookieDelimiter),c=e.length-1;c>=0;c--){var b=e[c];LRUCache_Add(g_ExpGroupWPState,b);if(g_ExpGroupTable[b]==null)document.getElementById("GroupByCol"+b)!=null&&ExpGroupParseCookieForWebPart(b,a)}g_ExpGroupParseStage=false;if(g_ExpGroupSeparateQueues)if(a&&g_ExpGroupXSLTQueue.length>0)ExpGroupFetchData(g_ExpGroupXSLTQueue.shift(),a);else!a&&g_ExpGroupCAMLQueue.length>0&&ExpGroupFetchData(g_ExpGroupCAMLQueue.shift(),a);else g_ExpGroupQueue.length>0&&ExpGroupFetchData(g_ExpGroupQueue.shift(),a)}function ExpGroupParseCookieForWebPart(c,e){ULSrLq:;var m=GetCookie(ExpGroupCookiePrefix+c);if(m==null)return;var n=m.split(ExpGroupCookieDelimiter),b;g_ExpGroupTable[c]=new LRUCache;for(b=n.length-1;b>=0;b--){var i=n[b];LRUCache_Add(g_ExpGroupTable[c],i)}var d=[],o=document.getElementById("GroupByCol"+c).parentNode;tbodyTags=o.getElementsByTagName("TBODY");for(b=0;b<tbodyTags.length;b++){var i=tbodyTags[b].getAttribute("groupString");if(i!=null){var j=tbodyTags[b].id;if(j==null)continue;var a=j.substring(4,j.length);if(g_ExpGroupSeparateQueues){var p=a.substring(0,a.indexOf("-")),l=g_ctxDict["ctx"+p];if(!l||!l.isXslView&&e||l.isXslView&&!e){g_ExpGroupTable[c]=null;break}}if(g_ExpGroupTable[c].state[i]!=null&&d[a]==null){ExpCollGroup(a,"img_"+a,e);d[a]=true;tbody=document.getElementById("tbod"+a+"_");if(tbody!=null){isLoaded=tbody.getAttribute("isLoaded");if(isLoaded=="false")if(g_ExpGroupSeparateQueues)if(e)g_ExpGroupXSLTQueue.push(a);else g_ExpGroupCAMLQueue.push(a);else g_ExpGroupQueue.push(a)}}}}var f;for(f in d){var k=f.indexOf("_");if(k!=f.length-1&&k!=-1){var g=f.substring(0,k+1);if(d[g]==null){var h=ExpGroupFetchGroupString(g);if(h!=null){LRUCache_Add(g_ExpGroupWPState,h);ExpCollGroup(g,"img_"+g,e);d[h]=true}}}}}function _ExpGroupBy(e){ULSrLq:;if(browseris.w3c&&!browseris.ie)document.all=document.getElementsByTagName("*");docElts=document.all;numElts=docElts.length;images=e.getElementsByTagName("IMG");img=images[0];srcPath=img.src;index=srcPath.lastIndexOf("/");imgName=srcPath.slice(index+1);var b="auto";if(imgName=="plus.gif"){b="";img.src="/_layouts/images/minus.gif"}else{b="none";img.src="/_layouts/images/plus.gif"}oldName=img.name;img.name=img.alt;img.alt=oldName;spanNode=img;while(spanNode!=null){spanNode=spanNode.parentNode;if(spanNode!=null&&spanNode.id!=null&&spanNode.id.length>5&&spanNode.id.substr(0,5)=="group")break}parentNode=spanNode;while(parentNode!=null){parentNode=parentNode.parentNode;if(parentNode!=null&&parentNode.tagName=="TABLE")break}lastNode=null;if(parentNode!=null){lastNode=parentNode.lastChild;if(lastNode!=null&&lastNode.tagName=="TBODY")lastNode=lastNode.lastChild;if(lastNode!=null&&lastNode.tagName=="TR"&&lastNode.lastChild!=null)lastNode=lastNode.lastChild}for(var c=0;c<numElts;c++){var a=docElts.item(c);if(a==spanNode)break}ID=spanNode.id.slice(5);displayStyle=b;for(var d=c+1;d<numElts;d++){var a=docElts.item(d);if(a.id.length>5&&a.id.substr(0,5)=="group"){curID=a.id.slice(5);if(curID<=ID)return}parentNode=a;while(parentNode!=null){parentNode=parentNode.parentNode;if(parentNode==spanNode)break}if(parentNode==spanNode)continue;if(a.id!=null&&a.id.substring(0,5)=="group")b=displayStyle;if(a.id!=null&&a.id.substring(0,8)=="footer"+ID)b=displayStyle;if(displayStyle!="none"&&a!=img&&a.tagName=="IMG"&&a.src!=null)if(a.src.slice(a.src.length-25)=="/_layouts/images/plus.gif")b="none";else if(a.src.slice(a.src.length-26)=="/_layouts/images/minus.gif")b="";if(a.tagName==spanNode.tagName&&a.id!="footer")a.style.display=b;if(a.tagName=="TABLE"&&lastNode==null||a==lastNode)break}}function SzExtension(a){ULSrLq:;var c=new String(a),b=/^.*\.([^\.]*)$/;return c.replace(b,"$1").toLowerCase()}function SzServer(a){ULSrLq:;var c=new String(a),b=/^([^:]*):\/\/([^\/]*).*$/;return c.replace(b,"$1://$2")}var v_stsOpenDoc=null,v_strStsOpenDoc=null;function NavigateParentOrSelf(b,a){ULSrLq:;if(b.target=="_top")window.frameElement.navigateParent(a);else STSNavigate(a)}function StsOpenEnsureEx(a){ULSrLq:;if(v_stsOpenDoc==null||v_strStsOpenDoc!=a)if(window.ActiveXObject)try{v_stsOpenDoc=new ActiveXObject(a);v_strStsOpenDoc=a}catch(b){v_stsOpenDoc=null;v_strStsOpenDoc=null}return v_stsOpenDoc}function _DispDocItem(b,a){ULSrLq:;return _DispDocItemEx(b,"FALSE","FALSE","FALSE",a)}function _DispDocItemExWithServerRedirect(f,c,j,g,i,e,k,b){ULSrLq:;var d=b!=null&&b!="",h=IsClientAppInstalled(e)&&HasRights(16,0);if(d){b=b.substring(1);d=b!=""}if(d)if(k==1||!h){var a=b;a=AddClientInstalledToUrl(a,e);a=AddSourceToUrl(a);a=a+"&DefaultItemOpen="+DocOpen.BROWSER;if(window.location.search.match("[?&]IsDlg=1"))window.frameElement.navigateParent(a);else if(c.shiftKey||c.ctrlKey)return true;else NavigateParentOrSelf(f,a);c.cancelBubble=true;c.returnValue=false;return false}return DispDocItemExWithEvent(f,c,j,g,i,e)}var L_OpenDocumentLocalError_Text="This document was being edited offline, but there is no application configured to open the document from SharePoint.  The document can only be opened for reading.";function _DispDocItemEx(e,c,a,b,d){ULSrLq:;return DispDocItemExWithEvent(e,null,c,a,b,d)}function DispDocItemExWithEvent(g,e,p,m,o,a){ULSrLq:;itemTable=FindSTSMenuTable(g,"CTXName");if((!browseris.ie||!browseris.win32)&&!IsSupportedMacBrowser()&&!IsSupportedFirefoxOnWin()){if(browseris.ie)event.cancelBubble=false;var k=g.href;if(window.location.search.match("[?&]IsDlg=1"))window.frameElement.navigateParent(k);else STSNavigate(k);return false}var d,c,h,b=true,s=itemTable!=null?GetAttributeFromItemTable(itemTable,"Ext","FileType"):"",j="",r=document.getElementById("FileDialogViewTable");if(r!=null){if(browseris.ie){event.cancelBubble=false;event.returnValue=false}return true}c=itemTable!=null?GetAttributeFromItemTable(itemTable,"Url","ServerUrl"):"";if(c==null||c=="")c=g.href;else c=SzServer(g.href)+c;h=SzExtension(c);if(currentItemProgId==null&&itemTable!=null)currentItemProgId=GetAttributeFromItemTable(itemTable,"Type","HTMLType");if(currentItemProgId!=null)j=currentItemProgId;if(FDefaultOpenForReadOnly(h)){if(a.indexOf("SharePoint.OpenDocuments")>=0)a="SharePoint.OpenDocuments.3"}else if(!FSupportCheckoutToLocal(h))a="";if(currentItemCheckedOutUserId==null&&itemTable!=null)currentItemCheckedOutUserId=itemTable.COUId;if(currentItemCheckedoutToLocal==null&&itemTable!=null)currentItemCheckedoutToLocal=GetAttributeFromItemTable(itemTable,"COut","IsCheckedoutToLocal ");if(currentItemCheckedOutUserId!=null&&currentItemCheckedOutUserId!=""&&currentItemCheckedOutUserId==ctx.CurrentUserId&&(a==""||a.indexOf("SharePoint.OpenDocuments")>=0)&&FSupportCheckoutToLocal(h)||a=="SharePoint.OpenDocuments")a="SharePoint.OpenDocuments.3";var i=2;if(a!=""&&HasRights(16,0)){if(a.indexOf(".3")>=0)i=3;d=StsOpenEnsureEx2(a);if(d==null&&i==3){a=a.replace(".3",".2");d=StsOpenEnsureEx2(a);i=2}}if(d!=null)if(i==2||itemTable==null&&currentItemCheckedOutUserId==null||ctx.isVersions==1&&(itemTable==null||itemTable.isMostCur=="0")){try{if(currentItemCheckedOutUserId!=null&&currentItemCheckedOutUserId!=""&&(currentItemCheckedOutUserId==ctx.CurrentUserId||ctx.CurrentUserId==null))if(currentItemCheckedoutToLocal=="1"){alert(L_OpenDocumentLocalError_Text);b=false}else b=d.EditDocument2(window,c,j);else b=d.ViewDocument2(window,c,j)}catch(l){b=false}if(b)window.onfocus=RefreshOnNextFocus}else{var f=0;if(currentItemCheckedOutUserId!="")if(currentItemCheckedOutUserId!=ctx.CurrentUserId&&ctx.CurrentUserId!=null)f=1;else if(currentItemCheckedoutToLocal==null||currentItemCheckedoutToLocal!="1")f=2;else f=4;else if(!HasRights(0,4)||FDefaultOpenForReadOnly(h))f=1;else if(ctx.isForceCheckout==true)f=3;try{b=d.ViewDocument3(window,c,f,j)}catch(l){b=false}if(b){var n=d.PromptedOnLastOpen();if(n)window.onfocus=RefreshOnNextFocus;else SetWindowRefreshOnFocus()}}else currentItemCheckedoutToLocal=="1"&&alert(L_OpenDocumentLocalError_Text);if(d==null||!b){if(p=="TRUE"&&m=="TRUE"&&o=="TRUE"){if(itemTable==null)return b;if(browseris.ie){event.cancelBubble=true;event.returnValue=false}else if(IsSupportedMacBrowser()||IsSupportedFirefoxOnWin()){e.preventDefault&&e.preventDefault();e.stopPropagation&&e.stopPropagation()}var q=new Function("return "+itemTable.getAttribute("CTXName")+".HttpRoot;"),k=q()+"/_layouts/htmltrverify.aspx?doc="+escapeProperly(c);if(window.location.search.match("[?&]IsDlg=1"))window.frameElement.navigateParent(k);else GoToPage(k)}else if(window.location.search.match("[?&]IsDlg=1"))window.frameElement.navigateParent(g.href);else STSNavigate(g.href);return false}if(browseris.ie){event.cancelBubble=true;event.returnValue=false}else if(IsSupportedMacBrowser()||IsSupportedFirefoxOnWin()){if(d!=null&&b){e.preventDefault&&e.preventDefault();e.stopPropagation&&e.stopPropagation()}return true}return b}function DispDocItemEx2(d,c,i,f,h,l,k,b,e){ULSrLq:;var n=false,m=e!=null&&e!="",g=IsClientAppInstalled(b)&&HasRights(16,0);if(m)if(k==1||!g){var a=e;a=AddClientInstalledToUrl(a,b);a=AddSourceToUrl(a);a=a+"&DefaultItemOpen="+DocOpen.BROWSER;if(window.location.search.match("[?&]IsDlg=1"))window.frameElement.navigateParent(a);else if(c.shiftKey||c.ctrlKey)return true;else NavigateParentOrSelf(d,a);c.cancelBubble=true;c.returnValue=false;return false}else if(g)if(b==""||b.indexOf("SharePoint.OpenDocuments")>=0)return DispDocItemExWithEvent(d,c,i,f,h,l);else{if(!ViewDoc(d.href,b)){var j=editDocumentWithProgIDNoUI(d.href,currentItemProgId,b,false,ctx.HttpRoot,"0");if(j==1||j==2){var a=AddClientInstalledToUrl(e,b);a=AddSourceToUrl(e);if(window.location.search.match("[?&]IsDlg=1"))window.frameElement.navigateParent(a);else NavigateParentOrSelf(d,a)}}c.cancelBubble=true;c.returnValue=false;return false}return DispDocItemExWithEvent(d,c,i,f,h,b)}function DispDocItemExWithOutContext(o,n,e,a,d,i,g,m,k,b,h,j,f,c,l){ULSrLq:;DispEx(o,n,e,a,d,i,g,m,k,b,h,j,f,c,l)}function AddSourceToUrl(a){ULSrLq:;var b=GetSource(),c=a.length+b.length;if(c>1950)return a;else{var d=a.indexOf("?")>=0?"&":"?";return a+d+"Source="+b}}function AddClientInstalledToUrl(a,b){ULSrLq:;if(b!=null&&(b.startsWith("SharePoint.OpenXMLDocuments")||b.startsWith("SharePoint.OpenXmlDocuments"))){var c=IsClientAppInstalled(b)&&HasRights(16,0),d="ClientInstalled=",e=a.length+c.length+d.length+1;if(e>1950)return a;else{var f=a.indexOf("?")>=0?"&":"?";return a+f+d+c}}else return a}function _VerifyFolderHref(d,i,m,l,j,k,g,b){ULSrLq:;var f=g!=null&&g!=""&&b!=null&&b!="";if(f){b=b.substring(1);f=b!=""}if(f)if(g=="OneNote.Notebook"&&j=="0"){var h="RootFolder",c=d.href.indexOf(h);if(c>0){var e=d.href.substring(c+h.length+1);c=e.indexOf("&");if(c>0){e=e.substring(0,c);d.href=unescapeProperlyInternal(e)}}}else{var a=b;a=AddClientInstalledToUrl(a,k);a=AddSourceToUrl(a);a=a+"&DefaultItemOpen="+DocOpen.BROWSER;d.href=STSPageUrlValidation(a);i.cancelBubble=true;i.returnValue=true;DetachEvent("mousedown",VerifyFolderHref,d)}return false}function _VerifyHref(f,e,h,c,b){ULSrLq:;var d=b!=null&&b!="",g=IsClientAppInstalled(c)&&HasRights(16,0);if(d){b=b.substring(1);d=b!=""}if(d){if(h==1||!g){var a=b;a=AddSourceToUrl(a);a=a+"&DefaultItemOpen="+DocOpen.BROWSER;if(c!=null&&c.startsWith("SharePoint.OpenXMLDocuments")){a=AddClientInstalledToUrl(a,c);a=AddSourceToUrl(a)}a=a+"&DefaultItemOpen="+DocOpen.BROWSER;f.href=STSPageUrlValidation(a);e.cancelBubble=true;e.returnValue=true}DetachEvent("mousedown",VerifyHref,f)}return false}function _DispEx(p,a,h,e,g,k,c,o,m,b,j,l,i,f,d){ULSrLq:;if(a.shiftKey||a.ctrlKey)return true;var n=document.getElementById("FileDialogViewTable");if(n!=null){a.cancelBubble=false;a.returnValue=false;return true}if(typeof ctx=="undefined"||ctx==null)ctx=new ContextInfo;ctx.CurrentUserId=l;if(i=="1")ctx.isForceCheckout=true;else ctx.isForceCheckout=false;currentItemCheckedOutUserId=j;currentItemCheckedoutToLocal=f;currentItemProgId=m;if(d!=null&&d!=""){SetCurrentPermMaskFromString(d,null);if(c=="0"&&!HasRights(0,32))c="1"}a.cancelBubble=true;if(b!=null&&b!="")b=b.substring(1);return DispDocItemEx2(p,a,h,e,g,k,c,o,b)}function IsClientAppInstalled(a){ULSrLq:;var b=null;if(a!="")b=StsOpenEnsureEx2(a);return b!=null}function ViewDoc(d,c){ULSrLq:;var b=StsOpenEnsureEx2(c),a=false;if(b!=null)try{a=b.ViewDocument2(window,d)}catch(e){a=false}return a}function _PortalPinToMyPage(a,c,b){ULSrLq:;a.action=c+"_vti_bin/portalapi.aspx?Cmd=PinToMyPage";a.ReturnUrl.value=window.location.href;a.ListViewUrl.value=MakeMtgInstanceUrl(a.ListViewUrl.value,b);a.submit()}function _PortalPinToMyPage(a,g,e,f,b,d,h,c){ULSrLq:;a.action=g+"_vti_bin/portalapi.aspx?Cmd=PinToMyPage";SetFieldValue(a,"ReturnUrl",window.location.href);SetFieldValue(a,"ListViewUrl",MakeMtgInstanceUrl(d,e));SetFieldValue(a,"ListTitle",f);SetFieldValue(a,"ListDescription",b);SetFieldValue(a,"BaseType",h);SetFieldValue(a,"ServerTemplate",c);a.submit()}function SetFieldValue(c,b,d){ULSrLq:;var a=c[b];if(a==null){a=document.createElement("INPUT");a.setAttribute("type","hidden");a.setAttribute("name",b);c.appendChild(a)}a.value=d}function _MoveToViewDate(b,a,c){ULSrLq:;if(FV4UI()&&typeof _fV4Calendar!="undefined"&&_fV4Calendar){var d=function(){ULSrLq:;var d;if(c)d=SP.UI.ApplicationPages.CalendarInstanceRepository.lookupInstance(c);else d=SP.UI.ApplicationPages.CalendarInstanceRepository.firstInstance();if(d)if(a!=null)d.moveToViewType(a);else d.moveToDate(b)};AjaxCalendarCall(d)}else MoveToViewDatePostBack(b,a)}function MoveToViewDatePostBack(c,b){ULSrLq:;var a=window.location.href;if(c!=null)a=StURLSetVar2(a,"CalendarDate",escapeProperly(c));if(b!=null)a=StURLSetVar2(a,"CalendarPeriod",b);_SubmitFormPost(a,true)}function AjaxCalendarCall(b){ULSrLq:;var a;try{a=typeof SP.UI.ApplicationPages.CalendarInstanceRepository}catch(c){a="undefined"}EnsureScript("SP.js",a,b)}function _MoveToDate(a,b){ULSrLq:;_MoveToViewDate(a,null,b)}function MoveToToday(){ULSrLq:;_MoveToViewDate("",null)}function MoveView(a){ULSrLq:;_MoveToViewDate(null,a)}function _ClickDay(a){ULSrLq:;_MoveToDate(a)}function GetIframe(){ULSrLq:;return null}function _GetMonthView(c){ULSrLq:;var b=window.location.href,a=document.getElementById("ExpandedWeeksId");if(a!=null)a.value=c;else return;_SubmitFormPost(b,true)}function NewItemDT(a,c,b){ULSrLq:;if(a==null)return;if(b!=null)a=StURLSetVar2(a,"CalendarTime",b);if(c!=null)a=StURLSetVar2(a,"CalendarDate",c);_NewItem(a,false)}function ClickTime(b,a){ULSrLq:;NewItemDT(b,null,a)}function NewItemDay(b,a){ULSrLq:;NewItemDT(b,a,null)}function ScrollToAnchorInInnerScrollPane(k,h,j){ULSrLq:;try{var l=document.getElementById(k),b=document.getElementById(l[h].value);if(typeof b=="undefined"||b==null)throw"";var d=b.parentNode.previousSibling;if(typeof d!="undefined"&&d!=null){var e=d.previousSibling;if(typeof e!="undefined"&&e!=null)b=e;else b=d}else throw""}catch(n){for(var f=null,i=document.anchors.length,g=0;g<i;g++){f=document.anchors[g];var m=f.href;if(m.search(j)!=-1){b=f;break}}}if(typeof b!="undefined"&&b!=null){var c=b.parentNode;while(c!=null&&c.tagName!="TABLE")c=c.parentNode;if(typeof c!="undefined"&&c!=null){var a=c.parentNode;while(a!=null&&(a.tagName!="DIV"||a.style.overflow!="auto"))a=a.parentNode;if(typeof a!="undefined"&&a!=null){var o=b.offsetLeft;a.scrollLeft=o;a.scrollTop=c.offsetTop-a.clientHeight+c.offsetHeight}}}}function FilterChoice(e,d,C,s){ULSrLq:;if(d.parentNode!=null&&d.parentNode.tagName=="SPAN")d.parentNode.style.position="relative";var a,h=0,g=false,l="",u=e.id,t=e.name,j="",q="",B=d.choices,c=B.split("|"),x=0,y=d.offsetHeight,A=d.optHid,v=c.length-1,m=-1,p=false,o="";if(e!=null&&e.selectedIndex>=0){g=true;o=e.options[e.selectedIndex].innerText}for(a=0;a<c.length;a=a+2){var b=c[a];while(a<v-1&&c[a+1].length==0){b=b+"|";a++;if(a<v-1)b=b+c[a+1];a++}var k=c[a+1],i=b.toLocaleLowerCase(),z=C.toLocaleLowerCase();if(s.length!=0)g=true;if(i.indexOf(z)==0){var n=s.toLocaleLowerCase();if(n.length!=0&&i.indexOf(n)==0&&j.length==0)g=false;if(i.length>20)p=true;if(!g||i==o){l+='<option selected value="'+k+'">'+STSHtmlEncode(b)+"</option>";g=true;j=b;q=k;m=a}else l+='<option value="'+k+'">'+STSHtmlEncode(b)+"</option>";h++}}var r=' ondblclick="HandleOptDblClick()" onkeydown="HandleOptKeyDown()"',f="";if(p)f='<select tabIndex="-1" ctrl="'+d.id+'" name="'+t+'" id="'+u+'"'+r;else f='<select class="ms-lookuptypeindropdown" tabIndex="-1" ctrl="'+d.id+'" name="'+t+'" id="'+u+'"'+r;if(h==0)f+=' style="display:none;position:absolute;z-index:2;left:'+x+"px;top:"+y+'px" onfocusout="OptLoseFocus(this)"></select>';else f+=' style="position:absolute;z-index:2;left:'+x+"px;top:"+y+'px" size="'+(h<=8?h:8)+'"'+(h==1?'multiple="true"':"")+' onfocusout="OptLoseFocus(this)">'+l+"</select>";e.outerHTML=f;var w=document.getElementById(A);if(m!=0||c[1]!="0")w.value=q;else w.value="0";if(m!=0||c[1]!="0")return j;else return ""}function _OptLoseFocus(a){ULSrLq:;var b=document.getElementById(a.ctrl);a.selectedIndex>=0&&_SetCtrlFromOpt(b,a);a.style.display="none"}function SetCtrlMatch(b,a){ULSrLq:;var c=document.getElementById(b.optHid);c.value=a.options[a.selectedIndex].value;if(c.value!=0)b.match=a.options[a.selectedIndex].innerText;else b.match=""}function _SetCtrlFromOpt(b,a){ULSrLq:;var c=document.getElementById(b.optHid);c.value=a.options[a.selectedIndex].value;if(a.options[a.selectedIndex].value==0){b.value=a.options[a.selectedIndex].innerText;b.match=""}else{b.value=a.options[a.selectedIndex].innerText;b.match=b.value}}function HandleOptDblClick(){ULSrLq:;var a=event.srcElement,b=document.getElementById(a.ctrl);_SetCtrlFromOpt(b,a);SetCtrlMatch(b,a);a.style.display="none"}function HandleOptKeyDown(){ULSrLq:;var a=event.srcElement,b=document.getElementById(a.ctrl),c=event.keyCode;switch(c){case 13:case 9:_SetCtrlFromOpt(b,a);event.returnValue=false;a.style.display="none";return}return}function CommitInlineEditChange(tr,cancel){ULSrLq:;if(tr.cells.length>0){c=tr.cells[0];if(c.width=="1%")eval(cancel==true?c.firstChild.lastChild.href:c.firstChild.firstChild.href);else if(tr.cells.length>1){c=tr.cells[1];if(c.width="1%")eval(cancel==true?c.firstChild.lastChild.href:c.firstChild.firstChild.href)}}}function InlineEditNextTR(tr,nextTr,element,down){ULSrLq:;if(nextTr!=null){_inlineEditString=tr.getAttribute("automode")+"#";var index=null;while(element!=null&&element.nodeType==1&&element.getAttribute("automode")==null){var siblingCount=0,sibling=element.previousSibling;while(sibling!=null){siblingCount++;sibling=sibling.previousSibling}if(index==null)index=siblingCount;else index=siblingCount+","+index;element=element.parentNode}_inlineEditString+=index;var tab=nextTr;while(tab!=null&&tab.tagName!="TABLE")tab=tab.parentNode;if(tab!=null&&nextTr!=null&&nextTr.getAttribute("iid")!=null){var inlineEditString=tab.getAttribute("inlineedit");if(inlineEditString!=null){inlineEditString=inlineEditString.replace("{@ID}","{"+IdFromRow(nextTr)+"}");inlineEditString=inlineEditString.replace("__cancel;","__commit;dvt_inlineedit={"+_inlineEditString+"};");eval(inlineEditString)}}else if(down==true&&nextTr!=null)if(nextTr.cells.length>0){var inlineEditString=null;c=nextTr.cells[0];if(c.width=="1%")inlineEditString=c.firstChild.href;else if(nextTr.cells.length>1){c=nextTr.cells[1];if(c.width="1%")inlineEditString=c.firstChild.href}if(inlineEditString!=null){inlineEditString=inlineEditString.replace("__cancel;","__commit;dvt_inlineedit={"+_inlineEditString+"};");eval(inlineEditString)}}}}function HandleInlineEditKeyDown(c){ULSrLq:;var b=event.srcElement;if(b.tagName!="INPUT")return;var e=event.keyCode,a=c.parentNode;switch(e){case 27:CommitInlineEditChange(a,true);break;case 38:var d=a.previousSibling;InlineEditNextTR(a,d,b);break;case 13:case 40:var d=a.nextSibling;InlineEditNextTR(a,d,b,true)}if(window.event)window.event.cancelBubble=true;else c!=null&&c.stopPropagation()}function EnsureSelectElement(c,b){ULSrLq:;var a=document.getElementById(b);if(a==null){a=document.createElement("SELECT");c.parentNode.appendChild(a);a.outerHTML='<select id="'+b+'" ctrl="'+c.id+'" class="ms-lookuptypeindropdown" name="'+b+'" style="display:none" onfocusout="OptLoseFocus(this)"></select>';FilterChoice(a,c,c.value,"")}return document.getElementById(b)}function HandleKey(){ULSrLq:;var g=event.keyCode,b=event.srcElement,c=b.value,a=EnsureSelectElement(b,b.opt),d=false,f,e;switch(g){case 8:if(c.length>0)c=c.substr(0,c.length-1);d=true;break;case 16:case 17:case 18:return;case 9:case 16:case 17:case 18:return;case 13:f=b.value.toLocaleLowerCase();e=b.match.toLocaleLowerCase();if(e.indexOf(f)!=0)b.match=FilterChoice(a,b,b.value,"");if(a.style.display!="none"){b.value=b.match;a.style.display="none";event.returnValue=false}return;case 27:a.style.display="none";event.returnValue=false;return;case 38:if(a.style.display!="none"){if(a.selectedIndex>0)a.selectedIndex=a.selectedIndex-1;else a.selectedIndex=a.options.length-1;SetCtrlMatch(b,a);event.returnValue=false}return;case 40:if(a.style.display!="none"&&a.selectedIndex<a.options.length-1){a.selectedIndex=a.selectedIndex+1;SetCtrlMatch(b,a);event.returnValue=false;return}d=true}if(d);b.match=FilterChoice(a,b,c,"")}function ShowDropdown(b){ULSrLq:;var a=document.getElementById(b),d=a.value,c=EnsureSelectElement(a,a.opt);a.match=FilterChoice(c,a,"",a.value);a.focus()}function HandleChar(){ULSrLq:;var a=event.srcElement,b=a.value,d=document.getElementById(a.opt),c=event.keyCode;if(c==13)return;b=b+String.fromCharCode(c).toLocaleLowerCase();a.match=FilterChoice(d,a,b,"")}function HandleLoseFocus(){ULSrLq:;var b=event.srcElement,a=document.getElementById(b.opt);a!=null&&a.style.display!="none"&&document.activeElement!=a&&_OptLoseFocus(a)}function HandleChange(){ULSrLq:;var a=event.srcElement,c=a.value,b=document.getElementById(a.opt);a.match=FilterChoice(b,a,c,"")}function IsSafeHref(a){ULSrLq:;return a.match(new RegExp("^http://","i"))||a.match(new RegExp("^https://","i"))||a.match(new RegExp("^ftp://","i"))||a.match(new RegExp("^file://","i"))||a.match(new RegExp("^mailto:","i"))||a.match(new RegExp("^news:","i"))||a.match(new RegExp("^pnm://","i"))||a.match(new RegExp("^mms://","i"))||a.match(new RegExp("^/","i"))||a.match(new RegExp("^#","i"))||a.match(new RegExp("^\\\\\\\\","i"))}var L_UnknownProtocolUrlError_Text="Hyperlinks must begin with http://, https://, mailto:, news:, ftp://, file://, /, # or \\\\. Check the address and try again.",L_UrlTooLongError_Text="The URL for the location must be no longer than 256 characters without the query parameters. The query parameters start at the question mark (?).";function IsSafeHrefAlert(a,b){ULSrLq:;if(a.match("^[^?]{257}")){alert(L_UrlTooLongError_Text);return false}else if(IsSafeHref(a))return true;else if(a.match("^[a-zA-Z]*:")){alert(L_UnknownProtocolUrlError_Text);return false}else if(true==b)return true;else{alert(L_UnknownProtocolUrlError_Text);return false}}function Discuss(a){ULSrLq:;var L_IE5upRequired_Text="'Discuss' requires a Microsoft SharePoint Foundation-compatible application and Microsoft Internet Explorer 7.0 or greater.";if(browseris.ie5up&&browseris.win32)window.parent.location.href=a;else alert(L_IE5upRequired_Text)}var g_AdditionalNavigateHierarchyQString="";function GetAdditionalNavigateHierarchyQString(){ULSrLq:;return g_AdditionalNavigateHierarchyQString}function SetAdditionalNavigateHierarchyQString(a){ULSrLq:;g_AdditionalNavigateHierarchyQString=a}function ProcessDefaultNavigateHierarchy(g,e,d,b,c,j,i,h,f){ULSrLq:;if(typeof _spCustomNavigateHierarchy=="function")_spCustomNavigateHierarchy(g,e,d,b,c,j);else if(c==false)top.location=b;else{var a=document.createElement("INPUT");a.type="hidden";a.name="_spTreeNodeClicked";a.value=d;i.appendChild(a);var k="?RootFolder="+escapeProperly(b)+h+"&"+g_AdditionalNavigateHierarchyQString;_SubmitFormPost(f+k);return false}}function ParseMultiColumnValue(b,d){ULSrLq:;var f=[];if(d==null)d=";#";var o=d.charCodeAt(0),n=d.charCodeAt(1);if(b==null||b.length==0)return f;var h=d.charAt(0),m=h+h,k=new RegExp(m,"g"),j=d.charAt(0),c=0;if(b.substr(0,2)==d)c=2;var a=c,g=false,i=b.length;while(a<i){var l=b.indexOf(h,a);if(l>=0){a=l;a++;if(b.charCodeAt(a)==n){if(a-1>c){var e=b.substr(c,a-c-1);if(g)e=e.replace(k,j);f.push(e);g=false}else f.push("");a++;c=a;continue}else if(b.charCodeAt(a)==o){a++;g=true;continue}else throw"ArgumentException"}else a=i}if(a>c){var e=b.substr(c,a-c);if(g)e=e.replace(k,j);f.push(e)}return f}function ConvertMultiColumnValueToString(f,b,c){ULSrLq:;if(b==null)b=";#";if(c==null)c=true;for(var h=b.charAt(0),i=h+h,j=new RegExp(b.charAt(0),"g"),g=false,d="",e=0;e<f.length;e++){var a=f[e];if(a!=null&&a.length>0)a=a.replace(j,i);if(a!=null&&a.length>0)g=true;if(c||e!=0)d+=b;d+=a}if(g){if(c)d+=b;return d}else return ""}var httpFolderTarget=null,httpFolderSource=null,httpFolderDiv=null;function NavigateHttpFolderCore(){ULSrLq:;if(httpFolderDiv==null){httpFolderDiv=document.createElement("DIV");document.body.appendChild(httpFolderDiv);httpFolderDiv.onreadystatechange=NavigateHttpFolderCore;httpFolderDiv.addBehavior("#default#httpFolder")}if(httpFolderDiv.readyState=="complete"){httpFolderDiv.onreadystatechange=null;try{var a=document.frames.item(httpFolderTarget);if(a!=null)a.document.body.innerText=L_WebFoldersRequired_Text}catch(c){}var b=false;try{var d="";d=httpFolderDiv.navigateFrame(httpFolderSource,httpFolderTarget);if(d=="OK")b=true}catch(c){}if(!b&&0==httpFolderSource.search("http://[a-zA-Z0-9-.]+(:80)?/")){var e=httpFolderSource.replace(/http:\/\/([a-zA-Z0-9\-\.]+)(:80)?[\/]/,"//$1/").replace(/[\/]/g,"\\");try{var a=document.frames.item(httpFolderTarget);if(a!=null){a.onload=null;a.document.location.href=e;b=true}}catch(c){}}!b&&alert(L_WebFoldersError_Text)}}function NavigateHttpFolder(a,b){ULSrLq:;if("/"==a.charAt(0))a=document.location.protocol+"//"+document.location.host+a;httpFolderSource=a;httpFolderTarget=b;NavigateHttpFolderCore()}function NavigateHttpFolderIfSupported(b,a){ULSrLq:;if(a=="_blank")if(SupportsNavigateHttpFolder())NavigateHttpFolder(b,a);else alert(L_WebFoldersError_Text);else alert(L_NoExplorerView_Text)}function AutoIndexForRelationshipsConfirmation(){ULSrLq:;var L_Lookup_AutoIndexForRelationships_Confirm_Text="To enable relationship behaviors on this column, it needs to be indexed. Do you want this column to be indexed?",a=L_Lookup_AutoIndexForRelationships_Confirm_Text;return confirm(a)}function SetHomePage2(d){ULSrLq:;if(!window.confirm(SP.Res.confirmWelcomePage))return;var e=new SP.ClientContext,c=e.get_web().get_rootFolder(),a="";if(d.length>0){var a=(new CUrl(document.URL)).path,b=a.indexOf("//");a=a.substr(b+2);b=a.indexOf("/");a=a.substr(b);a=unescapeProperly(a);a=a.substr(d.length);if(a.indexOf("/")==0)a=a.substr(1);var b=a.indexOf("?");if(b>0)a=a.substr(0,b)}c.set_welcomePage(a);c.update();var f=STSHtmlEncode(SP.Res.sending),g=addNotification(f,true);e.executeQueryAsync(function(){ULSrLq:;removeNotification(g);addNotification(STSHtmlEncode(SP.Res.pageIsSiteHomePage),false)})}function SetHomePage(b){ULSrLq:;var a=function(){ULSrLq:;SetHomePage2(b)};if(typeof SP!="undefined")EnsureScript("SP.js",typeof SP.ClientContext,a);else EnsureScript("SP.js",typeof SP,a)}function SendEmail(b){ULSrLq:;var a;try{a=typeof SP.Ribbon.EMailLink.openMailerWithUrl}catch(f){a="undefined"}if(a!="undefined")SP.Ribbon.EMailLink.openMailerWithUrl(b);else{var e="SP.Ribbon.EMailLink.openMailerWithUrl",c=e.split(".");if(c.length>1){var d=function(){ULSrLq:;SP.Ribbon.EMailLink.openMailerWithUrl(b)};EnsureScript(c[0],a,d)}}}function TryCopyStringToClipboard(b){ULSrLq:;if(window.clipboardData&&clipboardData.setData)clipboardData.setData("Text",b);else{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");var c=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);if(!c)return false;c.data=b;var a=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!a)return false;a.addDataFlavor("text/unicode");a.setTransferData("text/unicode",c,b.length*2);var d=Components.interfaces.nsIClipboard,e=Components.classes["@mozilla.org/widget/clipboard;1"].getService(d);if(!e)return false;e.setData(a,null,d.kGlobalClipboard)}return true}function CopyStringToClipboard(c){ULSrLq:;var a=false;try{a=TryCopyStringToClipboard(c)}catch(b){a=false}!a&&alert(SP.Res.clipboardNoAccess)}function CopyPageAddressToClipboard(){ULSrLq:;CopyStringToClipboard(window.location.href)}function showViewSelector(b,a,d){ULSrLq:;if(b==null)b=window.event;CancelEvent(b);a=EnsureValidPositioningElement(b,a);a=AdjustViewSelectorParentInTitleArea(a);var e=function(){ULSrLq:;SP.Application.UI.ViewSelectorMenuBuilder.showMenu(a,d)},c;try{c=typeof SP.Application.UI.ViewSelectorMenuBuilder.showMenu}catch(f){c="undefined"}EnsureScript("SP.js",c,e)}function EnsureValidPositioningElement(d,c){ULSrLq:;if(c!=null)return c;var b=GetEventSrcElement(d),a=b;while(a!=null&&a.tagName!="BODY"){if(a.tagName=="TD"&&(a.className=="ms-viewselector"||a.className=="ms-viewselectorhover"))return a;a=a.parentNode}return b}function AdjustViewSelectorParentInTitleArea(a){ULSrLq:;if(a&&a.className=="ms-ltviewselectormenuheader"&&a.childNodes)for(var d=a.childNodes,c=0;c<d.length;c++){var b=d[c];if(b&&b.id&&b.id.indexOf("ListTitleViewSelectorMenu")>=0)return b}return a}function EnsureCheckoutAndChangeLayoutModeToEdit(f,e,d){ULSrLq:;var a,c=function(){ULSrLq:;var a;try{a=typeof browserScript.MSOLayout_ChangeLayoutMode}catch(f){a="undefined"}if(a!="undefined")browserScript.MSOLayout_ChangeLayoutMode(d);else{var e="browserScript.MSOLayout_ChangeLayoutMode",b=e.split(".");if(b.length>1){var c=function(){ULSrLq:;browserScript.MSOLayout_ChangeLayoutMode(d)};EnsureScript(b[0],a,c)}}},g=function(){ULSrLq:;var g=a.get_item("CheckoutUser");if(!g){if(confirm(L_ConfirmCheckout_Text)){var b=new SP.ClientContext,d=b.get_web().get_lists().getById(new SP.Guid(f));a=d.getItemById(e);a.get_file().checkOut();b.executeQueryAsync(c)}}else c()},h=function(){ULSrLq:;var b=new SP.ClientContext,c=b.get_web().get_lists().getById(new SP.Guid(f));a=c.getItemById(e);b.load(a,"CheckoutUser");b.executeQueryAsync(g)},b;try{b=typeof SP.ClientContext}catch(i){b="undefined"}EnsureScript("SP.js",b,h)}function _ChangeLayoutMode(b,c){ULSrLq:;var a;try{a=typeof browserScript.MSOLayout_ChangeLayoutMode}catch(g){a="undefined"}if(a!="undefined")browserScript.MSOLayout_ChangeLayoutMode(b,c);else{var f="browserScript.MSOLayout_ChangeLayoutMode",d=f.split(".");if(d.length>1){var e=function(){ULSrLq:;browserScript.MSOLayout_ChangeLayoutMode(b,c)};EnsureScript(d[0],a,e)}}}function OpenWebPartMenuFromLink(b,a,c,d){ULSrLq:;while(a!=null&&a.parentNode!=null&&a.tagName!="TD")a=a.parentNode;OpenWebPartMenu(b,a,c,d)}function OpenWebPartMenu(b,c,d,e,f){ULSrLq:;var a;try{a=typeof browserScript.MSOWebPartPage_OpenMenu}catch(j){a="undefined"}if(a!="undefined")browserScript.MSOWebPartPage_OpenMenu(b,c,d,e,f);else{var i="browserScript.MSOWebPartPage_OpenMenu",g=i.split(".");if(g.length>1){var h=function(){ULSrLq:;browserScript.MSOWebPartPage_OpenMenu(b,c,d,e,f)};EnsureScript(g[0],a,h)}}return true}function UpdateWebPartMenuFocus(a,d,c){ULSrLq:;if(a)a.className=d;var b=null;if(a&&a.childNodes){b=a.childNodes[0];if(b&&b.tagName=="SPAN")b.className=c}}function _WebPartMenuKeyboardClick(e,b,c,d){ULSrLq:;var a;try{a=typeof browserScript.MSOMenu_KeyboardClick}catch(i){a="undefined"}if(a!="undefined")browserScript.MSOMenu_KeyboardClick(e,b,c,d);else{var h="browserScript.MSOMenu_KeyboardClick",f=h.split(".");if(f.length>1){var g=function(){ULSrLq:;browserScript.MSOMenu_KeyboardClick(e,b,c,d)};EnsureScript(f[0],a,g)}}}function _ShowToolPane2Wrapper(b,c,d){ULSrLq:;var a;try{a=typeof browserScript.MSOTlPn_ShowToolPane2Wrapper}catch(h){a="undefined"}if(a!="undefined")browserScript.MSOTlPn_ShowToolPane2Wrapper(b,c,d);else{var g="browserScript.MSOTlPn_ShowToolPane2Wrapper",e=g.split(".");if(e.length>1){var f=function(){ULSrLq:;browserScript.MSOTlPn_ShowToolPane2Wrapper(b,c,d)};EnsureScript(e[0],a,f)}}}function ChangeWebPartPageView(b){ULSrLq:;var a;try{a=typeof browserScript.MSOLayout_ToggleView}catch(f){a="undefined"}if(a!="undefined")browserScript.MSOLayout_ToggleView(b);else{var e="browserScript.MSOLayout_ToggleView",c=e.split(".");if(c.length>1){var d=function(){ULSrLq:;browserScript.MSOLayout_ToggleView(b)};EnsureScript(c[0],a,d)}}}function _SetupFixedWidthWebParts(){ULSrLq:;var a;try{a=typeof browserScript.MSOWebPartPage_SetupFixedWidthWebParts}catch(e){a="undefined"}if(a!="undefined")browserScript.MSOWebPartPage_SetupFixedWidthWebParts();else{var d="browserScript.MSOWebPartPage_SetupFixedWidthWebParts",b=d.split(".");if(b.length>1){var c=function(){ULSrLq:;browserScript.MSOWebPartPage_SetupFixedWidthWebParts()};EnsureScript(b[0],a,c)}}}function EnsureSelectionHandlerOnFocusDeferred(d,c,b){ULSrLq:;var a=c;while(a.tagName!="TABLE")a=a.parentNode;EnsureSelectionHandlerDeferred(d,a,b)}function ChangeWikiPageMode(b){ULSrLq:;var a;try{a=typeof ribbon.ChangeWikiPageMode}catch(f){a="undefined"}if(a!="undefined")ribbon.ChangeWikiPageMode(b);else{var e="ribbon.ChangeWikiPageMode",c=e.split(".");if(c.length>1){var d=function(){ULSrLq:;ribbon.ChangeWikiPageMode(b)};EnsureScript(c[0],a,d)}}}function EnsureSelectionHandlerDeferred(m,d,i){ULSrLq:;var b=window["ctx"+i];if(!FV4UI()||!b){d.onmouseover=null;return}ctxInitItemState(b);for(var j=d.rows,g=0;g<j.length;g++){var a=j[g];if(HasCssClass(a,"ms-viewheadertr")){var f=a.cells[0];if(f){var e=f.getElementsByTagName("INPUT")[0];if(e!=null){b.SelectAllCbx=e;b.TableCbxFocusHandler=e.onfocus;e.onfocus=null;e.className="s4-selectAllCbx"}}}var k=a.getAttribute("iid");if(k!=null){var h=false;if(ItemIsCurrentlySelected(b,k)){h=true;b.CurrentSelectedItems++}if(ItemIsCurrentlyVisible(a)){b.TotalListItems++;b.LastSelectableRowIdx=g}if(a.cells.length>0){f=a.cells[0];var c=f.getElementsByTagName("INPUT")[0];if(c){if(!h)c.checked=false;if(!c._setup){c._setup=true;var l=TooltipOfRow(a);if(l!=null)c.title=l;c.onblur=HideItemCbx;c.onfocus=DisplayItemCbx;c.onclick=ToggleItemRowSelection;f.onclick=ToggleItemRowSelection}if(a.getAttribute("automode")==null)a.onclick=a.getAttribute("isEcb")=="TRUE"?ToggleItemRowSelectionForSingleSelect:SingleItemSelect}UpdateAutoMode(a);AddSpaceToEmptyTDs(a);AddBorderToLastCell(a)}}}b.TableMouseoverHandler=d.onmouseover;d.onmouseover=null;if(d.getAttribute("handleDeleteInit")==null){d.setAttribute("handleDeleteInit","true");$addHandler(d,"keydown",function(a){ULSrLq:;HandleItemDelete(a,i)})}}function ItemIsSelectable(a){ULSrLq:;if(!a||!ItemHasiid(a)||!ItemIsCurrentlyVisible(a))return false;return true}function ItemIsCurrentlyVisible(a){ULSrLq:;if(!a||!a.parentNode)return false;if(GetCurrentEltStyle(a.parentNode,"display")=="none"||GetCurrentEltStyle(a,"display")=="none")return false;return true}function ItemIsCurrentlySelected(b,c){ULSrLq:;if(!b||!c)return false;var a=GetSelectedItemsDict(b);if(a==null||a[c]==null)return false;return true}function ItemHasiid(a){ULSrLq:;if(!a||a.getAttribute("iid")==null)return false;return true}function HandleItemDelete(g,d){ULSrLq:;if(g.keyCode==Sys.UI.Key.del){var b=window["ctx"+d],a;try{a=typeof inplview.DeleteSelectedItems}catch(h){a="undefined"}if(a!="undefined")inplview.DeleteSelectedItems(b);else{var f="inplview.DeleteSelectedItems",c=f.split(".");if(c.length>1){var e=function(){ULSrLq:;inplview.DeleteSelectedItems(b)};EnsureScript(c[0],a,e)}}return false}}function GetItemRow2(b){ULSrLq:;var a=b;while(a!=null&&a.nodeType==1&&a.tagName!="BODY"&&a.getAttribute("iid")==null){if(typeof a.parentNode=="undefined"||a.parentNode==null||typeof a.parentNode.tagName=="undefined"){a=null;break}a=a.parentNode}if(a!=null&&a.nodeType==1&&a.tagName=="TR")return a;return null}function GetItemRow(a){ULSrLq:;if(a==null)a=window.event;var b=GetEventSrcElement(a);return GetItemRow2(b)}function TooltipOfRow(d){ULSrLq:;for(var c=d.cells,a=0,a=0;a<c.length;a++){var e=c[a];if(HasCssClass(e,"ms-vb-title"))return e.innerText}var b=d.getAttribute("iid");if(b!=null){var f=b.split(",");if(f.length>2)return ""+f[1]}return null}function AlertCheckOut(){ULSrLq:;alert(L_MustCheckout_Text)}function UpdateAutoModeImage(a){ULSrLq:;if(a==null)a=window.event;if(a!=null){var b=a.srcElement!=null?a.srcElement:a.currentTarget;if(b&&b.tagName=="A")if(a.type=="blur")RemoveCssClassFromElement(b,"ms-inlineEditLink");else a.type=="focus"&&AddCssClassToElement(b,"ms-inlineEditLink")}}function AddAutoModeTag(f,e,g){ULSrLq:;var a=document.createElement("A");a.onblur=UpdateAutoModeImage;a.onfocus=UpdateAutoModeImage;var c=e;while(c.tagName!="TABLE")c=c.parentNode;if(f.getAttribute("requiresCheckout")!=null)a.onclick=AlertCheckOut;else{var d=c.getAttribute("inlineedit");if(d!=null)a.href=d.replace("{@ID}","{"+IdFromRow(e)+"}")}var b=document.createElement("IMG");b.className="s4-itm-inlineedit";b.src=g;b.border=0;b.alt=L_Edit_Text;a.appendChild(b);f.appendChild(a)}function GetItemRowCbx(a){ULSrLq:;var b=null;if(a!=null&&a.cells&&a.cells.length>0){var c=a.cells[0];b=c.getElementsByTagName("INPUT")[0]}return b}function UpdateAutoMode(b){ULSrLq:;if(b!=null){var c=CtxFromRow(b);if(!c||!c.InlineEdit)return;if(b.cells&&b.cells.length>0){var a=b.cells[0];if(a.innerHTML==""&&a.width=="1%"){if(a.getAttribute("requiresCheckout")==null)a.onclick=ClickToEdit;AddAutoModeTag(a,b,"/_layouts/images/edititem.gif")}else if(b.cells.length>1){a=b.cells[1];if(a.innerHTML==""&&a.width=="1%"){if(a.getAttribute("requiresCheckout")==null)a.onclick=ClickToEdit;AddAutoModeTag(a,b,"/_layouts/images/edititem.gif")}}}}}function ClickToEdit(a){ULSrLq:;var d=GetItemRow(a);if(d!=null&&d.cells.length>1){c=d.cells[1];var e=c.firstChild;if(e!=null){var b=e.firstChild;if(b!=null&&b.tagName=="IMG")b.src="/_layouts/images/spinnyrefresh.gif"}}if(window.event)window.event.cancelBubble=true;else a!=null&&a.stopPropagation()}function HideItemCbx(b){ULSrLq:;if(b==null)b=window.event;var c=GetItemRow(b),a=GetItemRowCbx(c);if(a&&a.tagName=="INPUT"){a.style.top="";a.style.position="";a.onmouseout=null}}function DisplayItemCbx(b){ULSrLq:;if(b==null)b=window.event;var c=GetItemRow(b),a=GetItemRowCbx(c);if(a&&a.tagName=="INPUT"){a.style.top="0px";a.style.position="relative";a.onmouseout=HideItemCbx}}function Log(b){ULSrLq:;var a=document.createElement("DIV");a.innerHTML=b;document.body.appendChild(a)}function _ToggleAllItems(a,b,c){ULSrLq:;IsFullNameDefined("CUI.PMetrics.perfMark")&&CUI.PMetrics.perfMark(CUI.PMarker.perfWSSSelectOrDeselectAllStart);if(a==null)a=window.event;MenuHtc_hide();ToggleAllItems2(b,c,b.checked);if(window.event)window.event.cancelBubble=true;else a.stopPropagation();IsFullNameDefined("CUI.PMetrics.perfMark")&&CUI.PMetrics.perfMark(CUI.PMarker.perfWSSSelectOrDeselectAllEnd);return false}function ToggleAllItems2(b,f,g){ULSrLq:;var a=window["ctx"+f];if(!a){b.checked=false;return}var c=b;while(c.tagName!="TABLE")c=c.parentNode;var e=c.rows,d=CountTotalItems(a);if(d==0){b.checked=false;return}if(g){if(d>g_MaximumSelectedItemsAllowed){b.checked=false;alert(L_BulkSelection_TooManyItems);return}SelectAllItems(a,e)}else DeselectAllItems(a,e,true)}function SelectAllItems(a,b){ULSrLq:;if(!a||!b)return;for(var e=a.LastSelectableRowIdx,c=1;c<e;c++){var d=b[c],f=d.getAttribute("iid");if(f!=null)ItemIsCurrentlyVisible(d)&&ToggleItemRowSelection2(a,d,true,false)}ToggleItemRowSelection2(a,b[e],true,true)}function DeselectAllItems(a,d,f){ULSrLq:;if(!a||!d)return;for(var g=a.LastSelectableRowIdx,c=1;c<=g;c++){var e=d[c],b=e.getAttribute("iid");if(b!=null){var h=b.split(",");SelectListItem(a,b,h,e,false)}}f&&RefreshCommandUI()}function DeselectCollapsedGroup(e,b){ULSrLq:;if(!b)return;var c=b.rows,a=GetLastSelectableRowIdx(b,ItemHasiid);if(c&&a!=-1){for(var d=0;d<a;d++){var f=c[d];ItemHasiid(f)&&ToggleItemRowSelection2(e,f,false,false)}ToggleItemRowSelection2(e,c[a],false,true)}}function HandleSingleGroupByRow(a,b,d){ULSrLq:;if(!a||!b)return;var c=b.getAttribute("iid");if(c==null)return;if(!d){a.TotalListItems--;ItemIsCurrentlySelected(a,c)&&ToggleItemRowSelection2(a,b,false,true)}else a.TotalListItems++}function RefreshCommandUI(){ULSrLq:;if(IsFullNameDefined("SP.Ribbon.PageManager")){var a=SP.Ribbon.PageManager.get_instance();a&&a.get_commandDispatcher().executeCommand(Commands.CommandIds.ApplicationStateChanged,null)}}function _CommandUIExecuteCommand(b){ULSrLq:;if(IsFullNameDefined("SP.Ribbon.PageManager")){var a=SP.Ribbon.PageManager.get_instance();a&&a.get_commandDispatcher().executeCommand(b,null)}}function OnItemSelectionChanged(e,a,c){ULSrLq:;var b=e;if(FV4UI()){var d=function(){ULSrLq:;var d=[];if(typeof _ribbon!="undefined"&&_ribbon)if(c)b.clvp.EnsureEcbInfo(RefreshCommandUI,d,a);else b.clvp.EnsureEcbInfo(null,null,a)};EnsureScript("inplview",typeof InitAllClvps,d)}}function IdFromRow(c){ULSrLq:;var b=c.getAttribute("iid"),a=b.split(",");return a[1]}function CtxFromRow(d){ULSrLq:;var c=d.getAttribute("iid"),b=c.split(","),a=b[0];return window["ctx"+a]}function GroupNameFromRow(d){ULSrLq:;var b=d.parentNode,a=b.id;if(a==null||a==""){siblingNode=b.previousSibling;if(siblingNode!=null&&siblingNode.childNodes.length==0&&siblingNode.tagName==b.tagName)a=siblingNode.id}if(a==null||a=="")return null;var c=a.substr(4,a.length-6);return c==""?null:c}function GroupStringFromGroupName(a){ULSrLq:;if(a==null||a=="")return null;var c=document.getElementById("titl"+a+"_");if(c==null)return null;var b=c.getAttribute("groupString");return b==""?null:b}function SingleItemSelect(a){ULSrLq:;if(a==null)a=window.event;var g=GetEventSrcElement(a);if(g!=null&&ElementContainsLink(g))return;if(clearECBMenu(g)){CancelEvent(a);return false}var d=GetItemRow(a),c=d;while(c.tagName!="TABLE")c=c.parentNode;var h=c.rows,b=CtxFromRow(d),i=d.getAttribute("iid"),k=i.split(","),e=false;if(!ItemIsCurrentlySelected(b,i)){e=true;if(CountSelectedItems(b)>0)for(var f=0;f<h.length;f++){var j=h[f];ItemIsSelectable(j)&&ToggleItemRowSelection2(b,j,false,false)}}ToggleItemRowSelection2(b,d,e,true);UpdateSelectAllCbx(b,e);CancelEvent(a);return true}function ElementContainsLink(a){ULSrLq:;while(a!=null&&a.tagName!="TD"){if(a.tagName=="A")return true;a=a.parentNode}return false}function clearECBMenu(b){ULSrLq:;if(g_menuHtc_lastMenu==null)return false;if(b!=null){var a=b;while(a!=null&&a.tagName!="TD")a=a.parentNode;var c=GetItemRow2(a);MenuHtc_hide();tdHasEcbMenu(a)&&OnChildItem(a)}return true}function tdHasEcbMenu(d){ULSrLq:;for(var b=0;b<d.childNodes.length;b++){var a=d.childNodes[b];if(a.nodeType==1&&a.tagName=="DIV"){var c=a.getAttribute("CTXName");if(c!=null&&c!="")return true}}return false}var showECB=false;function ToggleItemRowSelectionForSingleSelect(a){ULSrLq:;if(a==null)a=window.event;var b=GetEventSrcElement(a);if(b!=null&&ElementContainsLink(b))return;return ToggleItemRowSelection(a)}function ToggleItemRowSelection(b){ULSrLq:;IsFullNameDefined("CUI.PMetrics.perfMark")&&CUI.PMetrics.perfMark(CUI.PMarker.perfWSSSelectItemStart);if(b==null)b=window.event;MenuHtc_hide();var a=GetItemRow(b),d=CtxFromRow(a),g=a.getAttribute("iid"),c=!ItemIsCurrentlySelected(d,g);if(c&&CountSelectedItems(d)==g_MaximumSelectedItemsAllowed){var f=GetItemRowCbx(a);f.checked=false;alert(L_BulkSelection_TooManyItems);CancelEvent(b);return true}ToggleItemRowSelection2(d,a,c,true);UpdateSelectAllCbx(d,c);if(a.getAttribute("isEcb")=="TRUE")for(i=0;i<a.childNodes.length;i++){var e=a.childNodes[i];if(tdHasEcbMenu(e)){showECB=c;OnChildItem(e,true);break}}if(window.event)window.event.cancelBubble=true;else b.stopPropagation();IsFullNameDefined("CUI.PMetrics.perfMark")&&CUI.PMetrics.perfMark(CUI.PMarker.perfWSSSelectItemEnd);return true}function ToggleItemRowSelection2(b,a,f,e){ULSrLq:;var d=a.getAttribute("iid"),c=d.split(",");if(c[1]=="")return;SelectListItem(b,d,c,a,f);OnItemSelectionChanged(b,GroupNameFromRow(a),e);return true}function UpdateSelectAllCbx(a,c){ULSrLq:;if(!a||!a.SelectAllCbx)return;a.SelectAllCbx.checked=false;if(c){var d=CountTotalItems(a),b=CountSelectedItems(a);if(b==d&&b>0)a.SelectAllCbx.checked=true}}function SelectListItem(a,b,e,c,d){ULSrLq:;var f=GetItemRowCbx(c);f.checked=d;if(typeof a.dictSel=="undefined")a.dictSel=[];if(d){AddCssClassToElement(c,"s4-itm-selected");if(a.dictSel[b]==null){a.CurrentSelectedItems++;a.dictSel[b]={id:e[1],fsObjType:e[2]}}}else{RemoveCssClassFromElement(c,"s4-itm-selected");if(a.dictSel[b]!=null){delete a.dictSel[b];a.CurrentSelectedItems--}}}function CountTotalItems(a){ULSrLq:;if(a.TotalListItems==null)a.TotalListItems=0;return a.TotalListItems}function CountSelectedItems(a){ULSrLq:;if(a.CurrentSelectedItems==null)a.CurrentSelectedItems=0;return a.CurrentSelectedItems}function GetCtxRgiidFromIid(c){ULSrLq:;if(c==null)return null;var b=c.split(",");if(b.length!=3)return null;if(b[1]=="")return null;var d=b[0],a=window["ctx"+d];if(a==null)return null;if(typeof a.dictSel=="undefined")a.dictSel=[];if(a.CurrentSelectedItems==null)a.CurrentSelectedItems=0;return {ctx:a,rgiid:b}}function SelectListItemNative(b,e){ULSrLq:;var c=GetCtxRgiidFromIid(b);if(c==null)return false;var a=c.ctx,d=c.rgiid;if(e){if(a.CurrentSelectedItems==g_MaximumSelectedItemsAllowed)return false;if(a.dictSel[b]==null){a.CurrentSelectedItems++;a.dictSel[b]={id:d[1],fsObjType:d[2]}}}else if(a.dictSel[b]!=null){delete a.dictSel[b];a.CurrentSelectedItems--}OnItemSelectionChanged(a,null,true);return true}function DeselectAllListItemsNative(c){ULSrLq:;var b=GetCtxRgiidFromIid(c);if(b==null)return false;var a=b.ctx;a.dictSel=[];a.CurrentSelectedItems=0;OnItemSelectionChanged(a,null,true);return true}function GetSelectedItemsNative(){ULSrLq:;var a=GetCurrentCtx();if(a==null||typeof a.dictSel=="undefined")return [];var d=0,b=[];for(var c in a.dictSel){b[d]={id:a.dictSel[c].id,fsObjType:a.dictSel[c].fsObjType};d++}return b}function GetSelectedListNative(){ULSrLq:;var a=GetCurrentCtx();if(a==null)return null;return a.listName}function GetCurrentCtx(){ULSrLq:;var c=document.getElementById("_wpSelected");if(c==null)return null;var a=c.getAttribute("value");if(a==null||a=="")return null;a=a.substr(12);c=document.getElementById(a);if(c==null)return null;var b;if(window._spWebPartComponents&&_spWebPartComponents[a]&&_spWebPartComponents[a].storageId)b=_spWebPartComponents[a].storageId;else b=c.getAttribute("WebPartID");if(b==null)return null;b=b.toUpperCase();var d=g_ViewIdToViewCounterMap["{"+b+"}"];if(d==null)return null;var e=window["ctx"+d];return e}function GetLastSelectableRowIdx(c,d){ULSrLq:;if(!c||!d)return;for(var b=c.rows,a=b.length-1;a>=0;a--){var e=b[a];if(d(e))return a}return -1}function UpdateCtxLastSelectableRow(a,c){ULSrLq:;if(!a||!c)return;a.LastSelectableRowIdx=0;var b=GetLastSelectableRowIdx(c,ItemIsSelectable);if(b!=-1)a.LastSelectableRowIdx=b}function DeselectAllWPItems(){ULSrLq:;var a=GetCurrentCtx();if(!a||!a.clvp||!a.clvp.tab)return;var c=a.clvp.tab,b=getSelectAllCbxFromTable(c);if(!b)return;b.checked=false;CountSelectedItems(a)>0&&DeselectAllItems(a,c.rows,false)}function callOpenBreadcrumbMenu(a,g,j,i,c,d,e,f,n,o,h,k){ULSrLq:;IsFullNameDefined("CUI.PMetrics.perfMark")&&CUI.PMetrics.perfMark(CUI.PMarker.perfWSSBreadcrumbStart);if(!a)var a=window.event;a.cancelBubble=true;a.stopPropagation&&a.stopPropagation();var l=function(){ULSrLq:;SP.UI.PopoutMenu.createPopoutMenuInstanceAndLaunch(g,j,i,c,d,e,f,n,o,h,k)},b;try{b=typeof SP.UI.PopoutMenu.createPopoutMenuInstanceAndLaunch}catch(m){b="undefined"}EnsureScript("SP.js",b,l);IsFullNameDefined("CUI.PMetrics.perfMark")&&CUI.PMetrics.perfMark(CUI.PMarker.perfWSSBreadcrumbEnd)}function HasCssClass(d,f,e){ULSrLq:;var c=d.className;if(c==null)return false;for(var a=c.split(" "),b=0;b<a.length;b++)if(a[b]==f){if(e){a.splice(b,1);d.className=a.join(" ")}return true}return false}function AddSpaceToEmptyTDs(b){ULSrLq:;if(browseris.ie7down&&b!=null){if(b.getAttribute("addEmptySpace")==null)b.setAttribute("addEmptySpace","true");else return;for(i=0;i<b.childNodes.length;i++){var a=b.childNodes[i];if(a.nodeType==1&&a.tagName=="TD"&&a.width!="1%")if(a.innerHTML=="")a.innerHTML="&#8203;";else if(a.innerText==""){while(a&&a.nodeType==1&&a.innerHTML!="")a=a.firstChild;if(a&&a.nodeType==1&&a.innerHTML==""&&(a.tagName=="SPAN"||a.tagName=="DIV"||a.tagName=="NOBR"))a.innerHTML="&#8203;"}}}}function AddBorderToLastCell(c){ULSrLq:;if(c.getAttribute("setEdgeBorder")!=null)return;var a=c.cells;if(a&&a.length>0){if(browseris.ie7down)a[0].className+="";var b=a[a.length-1];if(b)if(b.className!="")b.className+=" ms-vb-lastCell";else b.className="ms-vb-lastCell"}c.setAttribute("setEdgeBorder","true")}function AddCssClassToElement(a,b){ULSrLq:;var c=a.className;if(c!=null){if(!HasCssClass(a,b))a.className=a.className+" "+b}else a.className=b}function RemoveCssClassFromElement(b,a){ULSrLq:;HasCssClass(b,a,true)}function AddGallery_TypeOf(c){ULSrLq:;if(c!=null){var b=typeof c;if(b=="object")if(b.constructor!=null){var a=c.constructor.toString(),d=a.indexOf(" "),e=a.indexOf("("),f=a.substr(d+1,e-d-1);return f}return b}return null}function IsLanguageSupportedInSilverlight(a){ULSrLq:;if(a==1025||a==1037||a==1054||a==1081)return false;return true}function IsSilverlightInstalled(b){ULSrLq:;if(b==undefined)b=null;var a=false,m=null;try{var i=null,j=false;if(window.ActiveXObject)try{i=new ActiveXObject("AgControl.AgControl");if(b===null)a=true;else if(i.IsVersionSupported(b))a=true;i=null}catch(l){j=true}else j=true;if(j){var k=navigator.plugins["Silverlight Plug-In"];if(k)if(b===null)a=true;else{var h=k.description;if(h==="1.0.30226.2")h="2.0.30226.2";var c=h.split(".");while(c.length>3)c.pop();while(c.length<4)c.push(0);var e=b.split(".");while(e.length>4)e.pop();var d,g,f=0;do{d=parseInt(e[f]);g=parseInt(c[f]);f++}while(f<e.length&&d===g);if(d<=g&&!isNaN(d))a=true}}}catch(l){a=false}return a}function IsAddGalleryProviderEnabled(c,b){ULSrLq:;var a;try{if(window.XMLHttpRequest)a=new XMLHttpRequest;else a=new ActiveXObject("Microsoft.XMLHTTP");a.open("HEAD",c+b+".deny.xml",false);a.send();if(a.status==200)return false;else return true}catch(d){return true}}function DownloadSolutionHandler(){ULSrLq:;LaunchCreateHandler("Provider:AddGallery.OfficeOnlineProvider")&&STSNavigate("http://r.office.microsoft.com/r/rlidSPTemplates")}function SilverlightBasedCreateHandler(a){ULSrLq:;var k=new Date,f,b,c,i,h;if(typeof _spPageContextInfo!="undefined"){if(_spPageContextInfo.siteServerRelativeUrl){b=_spPageContextInfo.siteServerRelativeUrl;if(b.charAt(b.length-1)!="/")b=b+"/"}else return true;if(_spPageContextInfo.webServerRelativeUrl){c=_spPageContextInfo.webServerRelativeUrl;if(c.charAt(c.length-1)!="/")c=c+"/";f=c+"_layouts/AddGallery.aspx"}else return true;if(_spPageContextInfo.webLanguage)i=_spPageContextInfo.webLanguage;else return true;if(_spPageContextInfo.currentLanguage)h=_spPageContextInfo.currentLanguage;else return true}else return true;if(FV4UI()&&IsSilverlightInstalled("3.0.40624.0")&&IsLanguageSupportedInSilverlight(i)&&IsLanguageSupportedInSilverlight(h)){if(a==null)a="All";if(AddGallery_TypeOf(a)!="string")return true;a=a.toLowerCase();if(a=="page"||a=="publishingpage")return true;var d=[];d=a.split(":");if(d.length==2&&d[0]=="provider")if(!IsAddGalleryProviderEnabled(b+"_layouts/AddGalleryProviders/",d[1]))return true;var g=function(a,b){ULSrLq:;if(FV4UI()){if(a)if(b)window.location=b;else window.location.reload()}else if(a)window.location=a;else window.location.reload()},j=function(){ULSrLq:;var i={scope:a,currentWeb:c,currentSiteCollection:b,clickDateTime:k},e=a=="page"?660:1012,d=a=="page"?360:600;if(FV4UI())var j={width:e,height:d,resizable:true,status:false,menubar:false,help:false,url:f,dialogReturnValueCallback:g,args:i},l=SP.UI.ModalDialog.showModalDialog(j);else{var h;if(window.showModalDialog)h="dialogWidth:"+e+"px;dialogHeight:"+d+"px;resizable:yes;status:no;menubar:no;help:no";else h="width="+e+",height="+d+",resizable=yes,status=no,menubar=no,help=no";var m=commonShowModalDialog(f,h,g,i)}},e;try{e=typeof SP.UI.ModalDialog.showModalDialog}catch(l){e="undefined"}EnsureScript("SP.UI.Dialog.js",e,j);return false}return true}function LaunchCreateHandler(a){ULSrLq:;if(typeof __CreateHandler!="undefined"&&__CreateHandler!=null){var b=__CreateHandler(a);return b}else try{return SilverlightBasedCreateHandler(a)}catch(c){return true}}if(FV4UI()){var isdlg=window.location.search.match("[?&]IsDlg=1");if(_spBodyOnLoadFunctionNames!=null&&typeof _spBodyOnLoadFunctionNames!="undefined"){!isdlg&&_spBodyOnLoadFunctionNames.push("FixRibbonAndWorkspaceDimensions");_spBodyOnLoadFunctionNames.push("SearchOnBodyLoad")}!isdlg&&AddEvtHandler(window,"onresize",FixRibbonAndWorkspaceDimensionsForResize)}function QstringStruct(g){ULSrLq:;this.nonFilterParams={};this.filterParams={};for(var e=g.split("&"),d=0;d<e.length;d++){var a=e[d].split("=");if(a.length==2)if(a[0].search("^Filter")!=-1){var c=a[0].match("[0-9]*$"),b;if(typeof this.filterParams[c]!="undefined")b=this.filterParams[c];else{b={};this.filterParams[c]=b}var f=a[0].match("^Filter[^0-9]*");b[f]=a[1]}else this.nonFilterParams[a[0]]=a[1]}}QstringStruct.prototype.toString=QstringStructToString;function QstringStructToString(){ULSrLq:;for(var c=[],e=1,d=0;d<this.filterParams.length;d++){var f=this.filterParams[d];for(var b in f){var a=[];a.push(b);a.push(e);a.push("=");a.push(f[b]);c.push(a.join(""))}e++}for(var b in this.nonFilterParams){var a=[];a.push(b);a.push("=");a.push(this.nonFilterParams[b]);c.push(a.join(""))}return "?"+c.join("&")}function ReconcileQstringFilters(i,j){ULSrLq:;var c=[];c.push(new QstringStruct(i));c.push(new QstringStruct(j));for(var f=[],a=0;a<c.length;a++)for(var e in c[a].nonFilterParams)if(a==0||typeof c[0].nonFilterParams[e]=="undefined"&&a==1){var b=[];b.push(e);b.push("=");b.push(c[a].nonFilterParams[e]);f.push(b.join(""))}for(var h=1,g={},a=0;a<c.length;a++)for(var k in c[a].filterParams){var d=c[a].filterParams[k];if(typeof g[d.FilterField]=="undefined"){for(var e in d){var b=[];b.push(e);b.push(h);b.push("=");b.push(d[e]);f.push(b.join(""))}h++;g[d.FilterField]=d}}return f.join("&")}function PageActionClick(){ULSrLq:;EnsureScript("ribbon",TypeofFullName("SP.Ribbon.PageStateActionButton"),function(){ULSrLq:;SP.Ribbon.PageStateActionButton.sendCommand()})}function ShowWebPartAdder(a){ULSrLq:;LoadWPAdderOnDemand();ExecuteOrDelayUntilEventNotified(function(){ULSrLq:;var b=window.WPAdder;if(b!=null){b._showCategoryColumn(true);b._setZone(a);b.show()}},"_spEventWebPartAdderReady")}var g_notiIcs=null,g_notiNoti=null,g_notiAnimationInProgress=false,g_notiRetiring=false,g_notiQueue=[],g_notiFrameCount,g_notiAnimationIntervalId,g_notiAnimationRight,g_notiAnimationOpacity,g_notiAnimationSettings,g_notiAnimationSettingsInited=false;function addNotification(g,f,h,d,e){ULSrLq:;!g_notiAnimationSettingsInited&&_initNotiAnimationSettings();var b=document.createElement("span"),c;b.id=c="notification_"+getUniqueIndex();if(g_notiAnimationInProgress){var a={};a.bIsAdd=true;a.id=c;a.elm=b;a.strHtml=g;a.bSticky=f;a.tooltip=h;a.bNoAnimate=e;a.onclickHandler=d;g_notiQueue.push(a)}else{g_notiAnimationInProgress=true;_addNotificationInternal(b,g,f,h,d,e)}return c}function _initNotiAnimationSettings(){ULSrLq:;var a={};if(browseris.ie){a.frames=14;a.interval=20;a.right=4;a.opacity=7.143}else{a.frames=28;a.interval=12;a.right=2;a.opacity=3.572}g_notiAnimationSettings=a;g_notiAnimationSettingsInited=true}function _addNotificationInternal(a,j,l,k,g,h){ULSrLq:;var d=g_notiIcs==null?(g_notiIcs=document.getElementById("notificationArea")):g_notiIcs;if(d!=null){d.setAttribute("aria-live","polite");d.setAttribute("aria-relevant","all");var e=document.createElement("span"),f=document.createElement("span"),b=document.createElement("span");a.className="s4-noti-noti";e.className="s4-noti-in1";f.className="s4-noti-in2";b.className="s4-noti-in3";f.appendChild(b);e.appendChild(f);a.appendChild(e);if(k)a.title=k;if(g){var c=document.createElement("a");c.href="javascript:;";c.onclick=function(){ULSrLq:;g();removeNotification(a.id,h);return false};c.innerHTML=j;b.appendChild(c)}else b.innerHTML=j;a.setAttribute("role","alert");var i=document.getElementById("s4-mainarea");if(i){var m=AbsTop(i);d.style.top=m+1+"px"}_opNotificationInternal(true,a,l,h)}}function retireNotification(){ULSrLq:;if(g_notiRetiring)return;g_notiRetiring=true;for(var c=g_notiIcs==null?(g_notiIcs=document.getElementById("notificationArea")):g_notiIcs,f=c.getElementsByTagName("span"),k,j=new Date,i=j.valueOf(),a=[],e=true,d=0;d<f.length;d++){var b=f[d],g=b.getAttribute("expires");if(g!=null)if(i>g)a.push(b);else e=false}while(a.length>0){var b=a.shift();_opNotificationInternal(false,b)}if(e){var h=c.getAttribute("timerSet");c.setAttribute("timerSet","false");window.clearInterval(h)}g_notiRetiring=false}function removeNotification(e,f){ULSrLq:;var a,d,b=false;for(a=0,d=g_notiQueue.length;a<d;a++)if(e==g_notiQueue[a].id){b=true;break}if(b){g_notiQueue.splice(a,1);return}var g=g_notiIcs==null?(g_notiIcs=document.getElementById("notificationArea")):g_notiIcs;if(g!=null){var c=document.getElementById(e);c!=null&&_opNotificationInternal(false,c,false,f)}}function _opNotificationInternal(e,b,d,c){ULSrLq:;var f=g_notiIcs==null?(g_notiIcs=document.getElementById("notificationArea")):g_notiIcs;if(!e&&g_notiAnimationInProgress){var a={};a.elm=b;a.bIsAdd=false;a.bSticky=d;a.bNoAnimate=c;g_notiQueue.push(a)}else if(e){_doAddNotification(b,c);!d&&_setExpireTimer(b)}else _doRemoveNotification(b,c)}function _setExpireTimer(c){ULSrLq:;var b=g_notiIcs?(g_notiIcs=document.getElementById("notificationArea")):g_notiIcs,e=new Date;c.setAttribute("expires",e.valueOf()+5e3);var a=b.getAttribute("timerSet");if(a==null||a=="false"){var d=window.setInterval(retireNotification,750);b.setAttribute("timerSet",d)}}function _doAddNotification(a,c){ULSrLq:;var b=g_notiIcs?(g_notiIcs=document.getElementById("notificationArea")):g_notiIcs;if(c||IsAccessibilityFeatureEnabled()){a.style.right="32px";b.appendChild(a);g_notiAnimationIntervalId=-1;_onAnimateComplete();return}a.style.right="-24px";_setOpacity(a,0);b.appendChild(a);g_notiNoti=a;g_notiFrameCount=0;g_notiAnimationRight=-24;g_notiAnimationOpacity=0;g_notiAnimationIntervalId=window.setInterval(_animateAddFrame,g_notiAnimationSettings.interval)}function _animateAddFrame(){ULSrLq:;var a=g_notiAnimationSettings;if(++g_notiFrameCount>a.frames){_onAnimateComplete();return}var c=g_notiNoti,d=g_notiAnimationRight+=a.right,b=g_notiAnimationOpacity+=a.opacity;if(b>100)g_notiAnimationOpacity=b=100;c.style.right=d+"px";_setOpacity(c,b)}function _doRemoveNotification(a,b){ULSrLq:;g_notiAnimationInProgress=true;var c=g_notiIcs?(g_notiIcs=document.getElementById("notificationArea")):g_notiIcs;if(b||IsAccessibilityFeatureEnabled()){try{c.removeChild(a)}catch(d){}g_notiAnimationIntervalId=-1;_onAnimateComplete();return}g_notiNoti=a;g_notiFrameCount=0;g_notiAnimationOpacity=100;g_notiAnimationIntervalId=window.setInterval(_animateRemoveFrame,g_notiAnimationSettings.interval)}function _animateRemoveFrame(){ULSrLq:;var c=g_notiNoti,b=g_notiAnimationSettings;if(++g_notiFrameCount>b.frames){var d=g_notiIcs?(g_notiIcs=document.getElementById("notificationArea")):g_notiIcs;try{d.removeChild(c)}catch(e){retireNotification()}_onAnimateComplete();return}var a=g_notiAnimationOpacity-=b.opacity;if(a<0)g_notiAnimationOpacity=a=0;_setOpacity(c,a)}function _onAnimateComplete(){ULSrLq:;g_notiAnimationIntervalId!=-1&&window.clearInterval(g_notiAnimationIntervalId);if(g_notiQueue.length>0){var a=g_notiQueue.shift();if(a.bIsAdd)_addNotificationInternal(a.elm,a.strHtml,a.bSticky,a.tooltip,a.onclickHandler,a.bNoAnimate);else _doRemoveNotification(a.elm,a.bNoAnimate)}else g_notiAnimationInProgress=false}function _setOpacity(b,a){ULSrLq:;if(browseris.ie)b.style.filter="alpha(opacity="+a+")";else b.style.opacity=a/100}cGCMinimumWidth=400;cGCMinimumHeight=200;cGCMaxGCResizeCount=10;var glGCObjectHeight=0,glGCObjectWidth=0;glGCResizeCounter=0;function GCComputeSizing(e){ULSrLq:;if(TestGCObject(e)){var g=document.documentElement.currentStyle.direction=="rtl",d=document.compatMode=="BackCompat"?document.documentElement.scrollWidth:document.documentElement.clientWidth,f=document.compatMode=="BackCompat"?document.documentElement.scrollHeight:document.documentElement.clientHeight,b=0,c=0;if(g){b=-180;c=120}else{b=32;c=-2}var a=e.parentElement;while(a!=document.body){b+=a.offsetLeft;c+=a.offsetTop;a=a.offsetParent;if(a==null)break;if(g)if(a.offsetLeft>0)break}b+=e.parentElement.offsetLeft;c+=e.parentElement.offsetTop;glGCObjectHeight=f-c;if(glGCObjectHeight>f)glGCObjectHeight=f;if(glGCObjectHeight<cGCMinimumHeight)glGCObjectHeight=cGCMinimumHeight;if(g)glGCObjectWidth=d+b;else glGCObjectWidth=d-b;if(glGCObjectWidth>d)glGCObjectWidth=d;if(glGCObjectWidth<cGCMinimumWidth)glGCObjectWidth=cGCMinimumWidth}}function GCResizeGridControl(a){ULSrLq:;if(TestGCObject(a)){var c=glGCObjectHeight,b=glGCObjectWidth;GCComputeSizing(a);if(c!=glGCObjectHeight)a.height=glGCObjectHeight;if(b!=glGCObjectWidth)a.width=glGCObjectWidth}}function GCWindowResize(a){ULSrLq:;if(TestGCObject(a)){glGCResizeCounter=0;GCResizeGridControl(a)}}function GCOnResizeGridControl(a){ULSrLq:;if(TestGCObject(a))if(glGCResizeCounter<cGCMaxGCResizeCount){glGCResizeCounter++;GCResizeGridControl(a)}}function _GCActivateAndFocus(a){ULSrLq:;if(TestGCObject(a)){a.SetActive;a.Focus}}function _GCNavigateToNonGridPage(){ULSrLq:;var a=window.location.href;gridPart=a.match("ShowInGrid=");if(gridPart){gridSet=/ShowInGrid=\w*/;a=a.replace(gridSet,"")}var b=a.indexOf("?");if(b!=-1){var c=a.indexOf("?",b+1);if(c!=-1)a=a.slice(0,c);a=a+"&"}else a=a+"?";a=a+"ShowInGrid=False";document.location.replace(STSPageUrlValidation(a))}function GCAddNewColumn(a,b){ULSrLq:;if(TestGCObject(a)){var h=window.location.href,e=a.Name,g=a.SelectedColumnUniqueName,i=a.RightToLeft,f=a.ViewGUID,c="FldNew.aspx",d=a.ServerTemplate;if(d=="102")c="QstNew.aspx";b=b+"/_layouts/"+c+"?List="+e+"&View="+f+"&Source="+h+"&RelativeToField="+g+"&LTR="+i;window.location=b}}function GCEditDeleteColumn(a,b){ULSrLq:;if(TestGCObject(a)){var g=window.location.href,f=a.SelectedColumnUniqueName,e=a.Name,c="FldEdit.aspx",d=a.ServerTemplate;if(d=="102")c="QstEdit.aspx";b=b+"/_layouts/"+c+"?List="+e+"&Field="+f+"&Source="+g;window.location=b}}var objGCGlobal=null;function GCShowTaskPane(){ULSrLq:;if(objGCGlobal!=null){objGCGlobal.DisplayTaskPane=true;objGCGlobal=null}}function GCShowHideTaskPane(a){ULSrLq:;if(TestGCObject(a)){var b=a.DisplayTaskPane;a.DisplayTaskPane=!b;if(!b){objGCGlobal=a;window.setTimeout("GCShowTaskPane()",5)}}}function GCShowHideTotalsRow(a){ULSrLq:;if(TestGCObject(a)){var b=a.DisplaySheetTotals;a.DisplaySheetTotals=!b}}function GCGridNewRow(a){ULSrLq:;TestGCObject(a)&&a.SelectNewRow()}function GCRefresh(a){ULSrLq:;TestGCObject(a)&&a.Refresh()}function GCNewFolder(a){ULSrLq:;TestGCObject(a)&&a.NewFolder()}var L_Edit_Text="Edit",L_ViewItem_Text="View Item",L_EditItem_Text="Edit Item",L_EditSeriesItem_Text="Edit Series",L_DeleteItem_Text="Delete Item",L_DeleteDocItem_Text="Delete",L_ViewProperties_Text="View Properties",L_EditProperties_Text="Edit Properties",L_ViewResponse_Text="View Response",L_EditResponse_Text="Edit Response",L_DeleteResponse_Text="Delete Response",L_Subscribe_Text="Alert Me",L_CustomizeNewButton_Text="Change New Button Order",L_Review_Text="Send for Review",L_EditIn_Text="Edit in ^1",L_EditInApplication_Text="Edit Document",L_Checkin_Text="Check In",L_Checkout_Text="Check Out",L_DiscardCheckou_Text="Discard Check Out",L_CreateDWS_Text="Create Document Workspace",L_PublishBack_Text="Publish to Source Location",L_Versions_Text="Version History",L_WorkOffline_Text="Outlook",L_Reply_Text="Reply",L_ExportContact_Text="Export Contact",L_ExportEvent_Text="Export Event",L_Reschedule_Text="Rescheduling Options",L_Move_Text="Move",L_Keep_Text="Keep",L_Delete_Text="Delete",L_Open_Text="Open",L_SiteSettings_Text="Change Site Settings",L_ManageUsers_Text="Manage Users",L_DeleteSite_Text="Delete Site",L_SiteStorage_Text="Manage Site Storage",L_MngPerms_Text="Manage Permissions",L_Settings_Text="Settings",L_Remove_Text="Remove from this list",L_ModerateItem_Text="Approve/Reject",L_PublishItem_Text="Publish a Major Version",L_CancelPublish_Text="Cancel Approval",L_UnPublishItem_Text="Unpublish this version",L_DownloadOriginal_Text="Download Picture",L_EditVersion_Text="Edit",L_EditInOIS_Text="Edit Picture",L_Workflows_Text="Workflows",L_OpenMenu_Text="Open Menu",L_Send_Text="Send To",L_ExistingCopies_Text="Existing Copies",L_OtherLocation_Text="Other Location",L_GoToSourceItem_Text="Go to Source Item",L_NotifyThisIsCopy_Text="This item was copied from another location and may be receiving updates from there.  You should make sure that the source stops sending updates or this item may get recreated.\n\n",L_SendToEmail_Text="E-mail a Link",L_DownloadACopy_Text="Download a Copy",L_DocTran_Text="Convert Document",L_AddToMyLinks_Text="Add to My Links",L_AddToCategory_Text="Submit to Portal Area",L_VS_DownArrow_Text="Select a View",L_ModifyView="Modify this view",L_CreateView="Create a new view",L_SubmitFileCopyWarning_Text="Are you sure you want to copy this document to ^1?",L_SubmitFileMoveWarning_Text="Are you sure you want to move this document to ^1?",L_SubmitFileLinkWarning_Text="Are you sure you want to move this document to ^1? A link will be created to the destination document.",SubmitFileConfirmation=[];SubmitFileConfirmation["Copy"]=L_SubmitFileCopyWarning_Text;SubmitFileConfirmation["Move"]=L_SubmitFileMoveWarning_Text;SubmitFileConfirmation["Link"]=L_SubmitFileLinkWarning_Text;var L_ServerBusyError="The server is busy.  Please try again later.",L_ItemGone="This item is no longer available.  It may have been deleted by another user.  Click 'OK' to refresh the page.",L_ActivateSolution_Text="Activate",L_DeactivateSolution_Text="Deactivate",L_UpgradeSolution_Text="Upgrade",L_Notification_Delete="Deleting...",L_Notification_CheckIn="Checking In...",L_Notification_CheckOut="Checking Out...",L_Notification_DiscardCheckOut="Discarding Check Out...";function CUIInfo(a,c,b){ULSrLq:;a.CUICommand=c;a.CUIEnabledCommands=b}function resetExecutionState(){ULSrLq:;IsMenuShown=false;itemTable=null;imageCell=null;onKeyPress=false;currentCtx=null;currentEditMenu=null;currentItemID=null;downArrowText=null;resetItemGlobals()}function resetItemGlobals(){ULSrLq:;currentItemAppName=null;currentItemProgId=null;currentItemIcon=null;currentItemOpenControl=null;currentItemModerationStatus=null;currentItemUIString=null;currentItemCheckedoutToLocal=null;currentItemCanModify=null;currentItemFileUrl=null;currentItemFSObjType=null;currentItemContentTypeId=null;currentItemCheckedOutUserId=null;currentItemCheckoutExpires=null;currentItemPermMaskH=null;currentItemPermMaskL=null;currentItemIsEventsExcp=null;currentItemIsEventsDeletedExcp=null}function IsMenuEnabled(){ULSrLq:;return browseris.ie55up||browseris.nav6up||browseris.safari125up}function GetSelectedElement(a,c,b){ULSrLq:;while(a!=null&&a.tagName!=c&&(b==null||a.tagName!=b))a=a.parentNode;return a}function setupMenuContext(a){ULSrLq:;currentCtx=a}function setupMenuContextName(strCtx){ULSrLq:;try{eval("var ctx="+strCtx+";")}catch(e){eval("var ctx=g_ctxDict['"+strCtx+"'];")}setupMenuContext(ctx)}function FindSTSMenuTable(a,c){ULSrLq:;var b=a.getAttribute(c);while(a!=null&&(b==null||b=="")){a=GetSelectedElement(a.parentNode,"TABLE","DIV");if(a!=null)b=a.getAttribute(c)}return a}function OnLinkDeferCall(a){ULSrLq:;if(!IsMenuEnabled())return false;a.onfocusout=OutItem;a.onkeydown=PopMenu;var b=FindSTSMenuTable(a,"CTXName");if(b==null)return false;OnItem(b,true);return false}function StartDeferItem(a){ULSrLq:;if(a!=itemTable){itemTableDeferred=a;var c=a.tagName=="TABLE";if(c){a.onmouseout=EndDeferItem;a.onclick=DeferredOnItem;a.oncontextmenu=DeferredOnItem}else{var b=a.parentNode;b.onmouseout=EndDeferItem;b.oncontextmenu=DeferredOnItem}}}function IsAjaxMenu(d){ULSrLq:;var a=d.getAttribute("eventtype");if(a!=null&&(a==5||a==3||a==4))return false;var c=d.className;if(c!=null&&c.length>0){var b=c.split(" ");if(b!=null&&b.length>1&&b[b.length-1]=="itx")return true}return false}function DeferredOnItem(b){ULSrLq:;var a=itemTableDeferred;if(a!=null){MenuHtc_hide();OnItem(a);if(IsAjaxMenu(a))CreateAjaxMenu(b);else CreateMenu(b);return false}}function EndDeferItem(){ULSrLq:;var a=itemTableDeferred;if(a!=null){itemTableDeferred=null;var c=a.tagName=="TABLE";if(c){a.onmouseout=null;a.onclick=null;a.oncontextmenu=null}else{var b=a.parentNode;b.onmouseout=null;b.onclick=null;b.oncontextmenu=null}}}function GetLastChildElement(b){ULSrLq:;for(var a=b.childNodes.length-1;a>=0;a--)if(b.childNodes[a].nodeType==1)return b.childNodes[a];return null}function CreateCtxImg(c,h){ULSrLq:;var a=FindCtxImg(c);if(a!=null&&a.shown==true)return a;if(a==null){a=document.createElement("DIV");a.className="s4-ctx";var b=[];b.push("<span>\u00a0</span>");b.push("<a onfocus='");if(c.tagName=="TD")b.push("OnChildItem(this.parentNode.parentNode); return false;'");else if(c.tagName=="TH")b.push("OnChildColumn(this.parentNode.parentNode); return false;'");else b.push("return false;'");b.push("href='javascript:;' onclick='PopMenuFromChevron(event); return false;' title='");b.push(L_OpenMenu_Text+"'></a>");b.push("<span>\u00a0</span>");a.innerHTML=b.join("");delete b;c.appendChild(a)}if(typeof a.shown=="undefined"){for(var g=a.getElementsByTagName("SPAN"),i=g.length,e=0;e<i;e++)if(browseris.ie&&browseris.iever==6)g[e].style.lineHeight="1px";var f=a.getElementsByTagName("A")[0];f.onfocusout=h;var d=document.createElement("img");d.style.visibility="hidden";d.src="/_layouts/images/ecbarw.png";d.alt=L_OpenMenu_Text;f.appendChild(d)}ShowCtxImg(a,true,c);return a}function FindCtxImg(f){ULSrLq:;for(var d=null,c=f.childNodes,e=c.length,b=0;b<e;b++){var a=c[b];if(a.nodeType==1&&a.className.indexOf("s4-ctx")!=-1){d=a;break}}return d}function RemoveCtxImg(b){ULSrLq:;var a=FindCtxImg(b);a!=null&&ShowCtxImg(a,false,b)}function ShowCtxImg(a,e,d){ULSrLq:;var c=null,b=null;if(a!=null)c=a.getElementsByTagName("A")[0];if(c!=null)b=c.getElementsByTagName("IMG")[0];if(b!=null)if(e==true){a.className+=" s4-ctx-show";PositionCtxImg(a,d,b);b.style.visibility="visible";a.shown=true;ChevronContainer=d}else{b.style.visibility="hidden";a.className="s4-ctx";a.shown=false;ChevronContainer=null}}function GetPosition(b){ULSrLq:;if(b==null)return null;var c=0,d=0,h=0,g=0,j=null,f=null;f=b.offsetParent;var e=b,a=b;while(a.parentNode!=null){a=a.parentNode;if(a.offsetParent!=null){var i=true;if(a.scrollTop&&a.scrollTop>0)d-=a.scrollTop;if(a.scrollLeft&&a.scrollLeft>0)c-=a.scrollLeft}if(a==f){c+=b.offsetLeft;if(a.clientLeft&&a.nodeName!="TABLE")c+=a.clientLeft;d+=b.offsetTop;if(a.clientTop&&a.nodeName!="TABLE")d+=a.clientTop;b=a;if(b.offsetParent==null){if(b.offsetLeft)c+=b.offsetLeft;if(b.offsetTop)d+=b.offsetTop}f=b.offsetParent}}if(e.offsetWidth)h=e.offsetWidth;if(e.offsetHeight)g=e.offsetHeight;return {left:c,top:d,width:h,height:g}}function PositionCtxImg(c,b,h){ULSrLq:;var i=GetPosition(b),g=GetPosition(c.offsetParent),e=i.top-g.top,d=i.left-g.left;e=e+b.clientTop;var a=c.style;a.top=e+"px";if(!IsElementRtl(b))d=d+b.offsetWidth-c.offsetWidth;a.left=d+"px";var f=b.clientHeight;if(browseris.ie&&document.compatMode=="BackCompat"&h!=null)f-=h.offsetHeight;a.height=f+"px";a.lineHeight=c.style.height;a.margin="0px"}function IsInCtxImg(a){ULSrLq:;while(a!=null&&a.tagName!="TD"&&a.tagName!="BODY"&&a.className.indexOf("s4-ctx")==-1)a=a.parentNode;if(a!=null&&a.className.indexOf("s4-ctx")!=-1)return a;return null}var ecbElm=null;function OnItemDeferCall(a){ULSrLq:;if(!IsMenuEnabled())return false;if(IsMenuOn()){StartDeferItem(a);return false}var h=a!=null&&a.parentNode.parentNode.getAttribute("isEcb")=="TRUE";if(h&&!showECB){if(ecbElm==a&&!(itemTable!=null&&itemTable!=a)){OutItem();ecbElm=null}return}if(itemTable==a)return;if(itemTable!=null)OutItem();else if(ecbElm!=null){itemTable=ecbElm;OutItem()}itemTable=a;currentItemID=GetAttributeFromItemTable(itemTable,"ItemId","Id");var c=itemTable.tagName=="TABLE",k=new Function("setupMenuContextName('"+itemTable.getAttribute("CTXName")+"');");k();var j=currentCtx,i=IsAjaxMenu(itemTable);if(c){if(browseris.nav6up)itemTable.className="ms-selectedtitlealternative";else itemTable.className="ms-selectedtitle";if(i)itemTable.className=itemTable.className+" itx"}var b=itemTable.parentNode;while(b.tagName!="TD"&&b.tagName!="BODY")b=b.parentNode;var g=null;if(!c)g=CreateCtxImg(b,OutItem);if(browseris.ie5up&&!browseris.ie55up){itemTable.onclick=EditMenuDefaultForOnclick;itemTable.oncontextmenu=EditMenuDefaultForOnclick}else{var d=i?CreateAjaxMenu:CreateMenu;if(c){itemTable.onclick=d;itemTable.oncontextmenu=d}else{if(g!=null)g.onclick=d;b.oncontextmenu=d}}if(c)itemTable.onmouseout=OutItem;else if(!h)b.onmouseout=OutItem;else ecbElm=a;if(c){var f;f=GetFirstChildElement(GetFirstChildElement(itemTable));if(f!=null)imageCell=GetLastChildElement(f);if(j.listTemplate==200){if(itemTable.getAttribute("menuType")=="Orphaned")downArrowText=L_Reschedule_Text}else downArrowText=L_Edit_Text;var e=GetFirstChildElement(imageCell);e.src=j.imagesPath+"menudark.gif";e.alt=downArrowText;e.style.visibility="visible";imageCell.className="ms-menuimagecell"}return false}function OutItem(b){ULSrLq:;if(!IsMenuOn()&&itemTable!=null){var d=itemTable.tagName=="TABLE";if(d){if(IsAjaxMenu(itemTable))itemTable.className="ms-unselectedtitle itx";else itemTable.className="ms-unselectedtitle";itemTable.onclick=null;itemTable.oncontextmenu=null;itemTable.onmouseout=null}else{var a=itemTable.parentNode,c=null;if(b==null)b=window.event;if(b!=null){c=b.toElement!=null?b.toElement:b.relatedTarget;if(a!=null&&c!=null&&IsContained(c,a))return true}if(a!=null){a.onclick=null;a.oncontextmenu=null;a.onmouseout=null;RemoveCtxImg(a)}}if(d&&imageCell!=null){GetFirstChildElement(imageCell).style.visibility="hidden";imageCell.className=""}resetExecutionState()}}function IsContained(a,d){ULSrLq:;if(a==d)return true;for(var c=d.getElementsByTagName(a.tagName),b=0;b<c.length;b++)if(a==c[b])return true;return false}function IsMenuOn(){ULSrLq:;if(!IsMenuShown)return false;var a=false;a=MenuHtc_isOpen(currentEditMenu);if(!a)IsMenuShown=false;return a}function PopMenuFromChevron(b){ULSrLq:;IsFullNameDefined("CUI.PMetrics.perfMark")&&CUI.PMetrics.perfMark(CUI.PMarker.perfWSSFilterSortStart);if(b==null)b=window.event;var e=b.srcElement?b.srcElement:b.target,a=e.parentNode;while(a.tagName!="TD"&&a.tagName!="TH"&&a.tagName!="BODY")a=a.parentNode;if(a.tagName=="TD"){var d=a.getElementsByTagName("DIV")[0];d!=null&&OnItemDeferCall(d)}else if(a.tagName=="TH"){var c=a.getElementsByTagName("DIV")[0];c!=null&&OnMouseOverFilterDeferCall(c)}IsFullNameDefined("CUI.PMetrics.perfMark")&&CUI.PMetrics.perfMark(CUI.PMarker.perfWSSFilterSortEnd);return false}function PopMenu(a){ULSrLq:;if(!IsMenuEnabled())return true;if(a==null)a=window.event;var b;if(a==null)return true;if(browseris.nav6up)b=a.which;else b=a.keyCode;if(!IsMenuOn()&&(a.shiftKey&&b==13||a.altKey&&b==40)){onKeyPress=true;var d=a.srcElement?a.srcElement:a.target,c=FindSTSMenuTable(d,"CTXName");if(c==null)return false;OnItemDeferCall(c);if(IsAjaxMenu(c))CreateAjaxMenu(a);else CreateMenu(a);onKeyPress=false;return false}else return true}function CreateMenuEx(f,a,e){ULSrLq:;IsFullNameDefined("CUI.PMetrics.perfMark")&&CUI.PMetrics.perfMark(CUI.PMarker.perfWSSECBClickStart);if(a==null)return;IsMenuShown=true;document.body.onclick="";var c;c=BuildMenu(f);currentEditMenu=c;a.onmouseout=null;var b=a.tagName=="DIV"?a.parentNode:a,d=FindCtxImg(b);d!=null&&d.shown==false&&ShowCtxImg(d,true,b);OMenu(c,b,null,null,-1);if(itemTable!=null&&itemTable.tagName!="DIV")itemTable=GetSelectedElement(a,"TABLE","DIV");if(b.tagName=="TD")b.onclick=SingleItemSelect;c._onDestroy=OutItem;if(e!=null)e.cancelBubble=true;IsFullNameDefined("CUI.PMetrics.perfMark")&&CUI.PMetrics.perfMark(CUI.PMarker.perfWSSECBClickEnd);return false}function BuildMenuWithInit(a){ULSrLq:;resetItemGlobals();setDocType();currentItemID=GetAttributeFromItemTable(itemTable,"ItemId","Id");currentItemCheckedOutUserId=itemTable.COUId;currentItemCheckedoutToLocal=GetAttributeFromItemTable(itemTable,"COut","IsCheckedoutToLocal ");currentItemModerationStatus=GetAttributeFromItemTable(itemTable,"MS","MStatus");return BuildMenu(a)}function BuildMenu(a){ULSrLq:;var b=CMenu(currentItemID+"_menu");if(!b)return;else if(a.isVersions)AddVersionMenuItems(b,a);else if(a.listTemplate==121)AddSolutionsCatalogMenuItems(b,a);else if(a.listBaseType==1)AddDocLibMenuItems(b,a);else if(a.listTemplate==200)AddMeetingMenuItems(b,a);else AddListMenuItems(b,a);InsertFeatureMenuItems(b,a);return b}function CreateAjaxMenu(a){ULSrLq:;if(!IsContextSet())return;if(a==null)a=window.event;if(itemTable==null&&ecbElm!=null)itemTable=ecbElm;var c=a.srcElement?a.srcElement:a.target;if(itemTable==null||itemTable.tagName=="TABLE"&&imageCell==null||onKeyPress==false&&!IsInCtxImg(c)&&(c.tagName=="A"||c.parentNode.tagName=="A"))return;var b=itemTable,d=b.parentNode;if(d!=null&&d.getAttribute("creatingAjax")==1)return;b.parentNode.setAttribute("creatingAjax","1");var e=currentCtx,f=function(c,a){ULSrLq:;b.parentNode.replaceChild(a,b);a.onclick=b.onclick;a.onmousehover=OnItem;OnItemDeferCall(a);CreateMenuEx(c,a,null);a.parentNode.removeAttribute("creatingAjax")};FetchEcbInfo(e,itemTable.id,itemTable.tagName,f);a.cancelBubble=true;return false}var nidEcbMenu=null;function FetchEcbInfo(b,g,i,h){ULSrLq:;var a=[],d=escapeUrlForCallback(b.HttpRoot);a.push(d);d[d.length-1]!="/"&&a.push("/");a.push("_layouts/inplview.aspx?Cmd=Ctx&List=");a.push(b.listName);b.HasRelatedCascadeLists==1&&b.CascadeDeleteWarningMessage==null&&a.push("&CascDelWarnMessage=1");if(b.view!=null){a.push("&View=");a.push(b.view)}a.push("&ViewCount=");a.push(b.ctxId);if(typeof b.isXslView!="undefined"&&b.isXslView){a.push("&IsXslView=TRUE");a.push("&Field=");if(itemTable!=null)a.push(GetAttributeFromItemTable(itemTable,"Field","Field"));else a.push("LinkFilename")}a.push("&ID=");a.push(g);var f=GetUrlKeyValue("RootFolder",true,document.URL);if(f.length>0){a.push("&RootFolder=");a.push(f)}var e=GetUrlKeyValue("InstanceID",true,document.URL);if(e.length>0){a.push("&InstanceID=");a.push(e)}a.push("&ListViewPageUrl=");var k=new CUrl(document.URL);d=k.path;a.push(d);if(typeof b.overrideScope!="undefined"){a.push("&OverrideScope=");a.push(escapeProperlyCore(b.overrideScope))}var j=a.join("");if(nidEcbMenu==null)nidEcbMenu=addNotification(L_Loading_Text,true);var c;if(window.XMLHttpRequest)c=new XMLHttpRequest;else c=new ActiveXObject("Microsoft.XMLHTTP");c.open("GET",j,true);c.onreadystatechange=function(){ULSrLq:;if(c.readyState!=4)return;if(c.status==601){if(nidEcbMenu!=null){removeNotification(nidEcbMenu);nidEcbMenu=null}alert(c.responseText)}else if(c.status==503){if(nidEcbMenu!=null){removeNotification(nidEcbMenu);nidEcbMenu=null}alert(L_ServerBusyError)}else{var a=c.responseText,j=document.createElement("DIV");j.style.visibility="hidden";if(b.HasRelatedCascadeLists==1&&b.CascadeDeleteWarningMessage==null){var l="<CascadeDeleteWarningMessage>",m="</CascadeDeleteWarningMessage>";if(a.startsWith(l)){var k=a.indexOf(m);if(k!==-1){b.CascadeDeleteWarningMessage=a.substring(l.length,k);a=a.substring(k+m.length)}}}j.innerHTML=a;for(var f=j.getElementsByTagName(i),d,e=0;e<f.length;e++){d=f[e];if(d.id==g)break}if(e==f.length)d=null;if(d!=null){h(b,d);if(nidEcbMenu!=null){removeNotification(nidEcbMenu);nidEcbMenu=null}}else{if(nidEcbMenu!=null){removeNotification(nidEcbMenu);nidEcbMenu=null}alert(L_ItemGone);RefreshPage(1)}}};c.send(null)}function CreateMenu(a){ULSrLq:;if(!IsContextSet())return;var c=currentCtx;if(a==null)a=window.event;var b=a.srcElement?a.srcElement:a.target;if(itemTable==null||itemTable.tagName=="TABLE"&&imageCell==null||onKeyPress==false&&!IsInCtxImg(b)&&(b.tagName=="A"||b.parentNode.tagName=="A"))return;return CreateMenuEx(c,itemTable,a)}function AddSendSubMenu(w,a){ULSrLq:;strDisplayText=L_Send_Text;var v=GetAttributeFromItemTable(itemTable,"Url","ServerUrl"),d,j,e;if(currentItemFileUrl!=null){j=unescapeProperly(currentItemFileUrl);d=escapeProperly(j);e=SzExtension(j);if(e!=null&&e!="")e=e.toLowerCase()}var h=itemTable.getAttribute("SRed"),p=itemTable.getAttribute("DefaultIO");if(p=="0"&&!HasRights(0,32))p="1";var m=currentItemProgId!="SharePoint.WebPartPage.Document"&&(h==null||h==""||HasRights(0,32))&&e!="aspx",n=HasRights(16,0),l=currentItemFSObjType!=1&&a.listBaseType==1&&(h==null||h==""||HasRights(0,32));if(!m&&!n&&!l)return;var c=CASubM(w,strDisplayText,"","",400);CUIInfo(c,"SendTo",["SendTo","PopulateSendToMenu"]);c.IsSubMenu=true;c.id="ID_Send";var b;if(m){if(typeof a.SendToLocationName!="undefined"&&a.SendToLocationName!=null&&a.SendToLocationName!=""&&typeof a.SendToLocationUrl!="undefined"&&a.SendToLocationUrl!=null&&a.SendToLocationUrl!=""){strAction="STSNavigate('"+a.HttpRoot+"/_layouts/copy.aspx?SourceUrl="+d+"&FldUrl="+escapeProperly(a.SendToLocationUrl);strAction=AddSourceToUrl(strAction)+"')";b=CAMOpt(c,a.SendToLocationName,strAction,"");CUIInfo(b,"SendToRecommendedLocation",["SendToRecommendedLocation"])}if(typeof itemTable.getAttribute("HCD")!="undefined"&&itemTable.getAttribute("HCD")=="1"){strDisplayText=L_ExistingCopies_Text;strAction="STSNavigate('"+a.HttpRoot+"/_layouts/updatecopies.aspx?SourceUrl="+d;strAction=AddSourceToUrl(strAction)+"')";strImagePath=a.imagesPath+"existingLocations.gif";b=CAMOpt(c,strDisplayText,strAction,strImagePath);b.id="ID_ExistingCopies";CUIInfo(b,"SendToExistingCopies",["SendToExistingCopies"])}strDisplayText=L_OtherLocation_Text;strAction="NavigateToSendToOtherLocationV4(event, '"+a.HttpRoot+"/_layouts/copy.aspx?SourceUrl="+d;strAction=AddSourceToUrl(strAction)+"')";strImagePath=a.imagesPath+"sendOtherLoc.gif";b=CAMOpt(c,strDisplayText,strAction,strImagePath);b.id="ID_OtherLocation";CUIInfo(b,"SendToOtherLocation",["SendToOtherLocation"]);if(a.OfficialFileNames!=null&&a.OfficialFileNames!=""){var k=a.OfficialFileNames.split("__HOSTSEPARATOR__");if(k!=null)for(var i=0;i<k.length;i++){var u=k[i],f=u.split(",");strDisplayText=f[0];var t=0,s="Copy";if(f.length==3){strDisplayText=f[0].replace(/%2c/g,",").replace(/%25/g,"%");t=f[1];s=f[2]}strAction='if(confirm("'+StBuildParam(SubmitFileConfirmation[s],STSScriptEncode(strDisplayText))+"\")!=0) SubmitFormPost('"+a.HttpRoot+"/_layouts/SendToOfficialFile.aspx?ID="+escapeProperly(strDisplayText)+"&Index="+t+"&SourceUrl="+d;strAction=AddSourceToUrl(strAction)+"')";strImagePath="";b=CAMOpt(c,strDisplayText,strAction,strImagePath);var o="SendToOfficialFile"+i;CUIInfo(b,o,[o])}}CAMSep(c)}if(n){strDisplayText=L_SendToEmail_Text;var v=GetAttributeFromItemTable(itemTable,"Url","ServerUrl"),g=a.HttpRoot.substr(0);if(g[g.length-1]!="/")g+="/";var q=-1,r="";q=g.substring(8).indexOf("/")+8;r=g.substr(0,q)+escapeProperlyCore(unescapeProperly(v),true);strAction="javascript:SendEmail('"+r+"')";strImagePath=a.imagesPath+"gmailnew.gif";b=CAMOpt(c,strDisplayText,strAction,strImagePath);CUIInfo(b,"EmailLink",["EmailLink"]);b.id="ID_SendToEmail"}if(l){a.listTemplate!=109&&a.listTemplate!=119&&AddWorkspaceMenuItem(c,a);if(a.listTemplate!=119){strAction="STSNavigate('"+a.HttpRoot+"/_layouts/download.aspx?SourceUrl="+d+"&FldUrl="+escapeProperly(a.SendToLocationUrl);strAction=AddSourceToUrl(strAction)+"')";b=CAMOpt(c,L_DownloadACopy_Text,strAction,"");CUIInfo(b,"DownloadCopy",["DownloadCopy"]);b.id="ID_DownloadACopy"}}}function AddDocTransformSubMenu(l,h){ULSrLq:;if(typeof rgDocTransformers=="undefined"||rgDocTransformers==null)return;var b=null,c=GetAttributeFromItemTable(itemTable,"Url","ServerUrl"),d;if(currentItemFileUrl!=null)d=escapeProperly(unescapeProperly(currentItemFileUrl));var g=c.lastIndexOf(".");if(g>0)for(var j=c.substring(g+1,c.length).toLowerCase(),e=false,a=0;a<rgDocTransformers.length;a++)if(rgDocTransformers[a].ConvertFrom==j){var f=GetAttributeFromItemTable(itemTable,"CId","ContentTypeId"),k=new RegExp("/|"+f+"|/");if(f&&!k.test(rgDocTransformers[a].ExcludedContentTypes)){if(!e){b=CASubM(l,L_DocTran_Text,h.imagesPath+"ConvertDocument.gif",L_DocTran_Text,500);b.IsSubMenu=true;b.Id="ID_ConvertDocument";e=true}strAction="STSNavigate('"+h.HttpRoot+"/_layouts/"+escapeProperlyCore(rgDocTransformers[a].TransformUIPage,true)+"?FileName="+d+"&TID="+rgDocTransformers[a].Id;strAction=AddSourceToUrl(strAction)+"')";var i;i=CAMOpt(b,rgDocTransformers[a].Name,strAction,"");i.Id="ID_Transform"+rgDocTransformers[a].Id}}}function AddMeetingMenuItems(d,b){ULSrLq:;if(itemTable.getAttribute("menuType")=="Orphaned"){var a,c=GetAttributeFromItemTable(itemTable,"ItemId","Id");strDisplayText=L_Move_Text;strAction="GoToMtgMove('"+b.listUrlDir+"',"+c+",'"+itemTable.getAttribute("DateTime")+"','"+itemTable.getAttribute("DateTimeISO")+"')";strImagePath="";a=CAMOpt(d,strDisplayText,strAction,strImagePath);a.id="ID_Move";strDisplayText=L_Keep_Text;strAction="MtgKeep('"+b.HttpPath+"','"+b.listName+"',"+c+")";strImagePath="";a=CAMOpt(d,strDisplayText,strAction,strImagePath);a.id="ID_Keep";strDisplayText=L_Delete_Text;strAction="MtgDelete('"+b.HttpPath+"','"+b.listName+"',"+c+")";strImagePath=b.imagesPath+"delitem.gif";a=CAMOpt(d,strDisplayText,strAction,strImagePath);a.id="ID_Delete"}}function AddListMenuItems(c,a){ULSrLq:;if(typeof Custom_AddListMenuItems!="undefined")if(Custom_AddListMenuItems(c,a))return;if(currentItemFileUrl==null)currentItemFileUrl=GetAttributeFromItemTable(itemTable,"Url","ServerUrl");var d;if(currentItemFileUrl!=null)d=escapeProperly(unescapeProperly(currentItemFileUrl));var g=currentItemID;if(currentItemIsEventsExcp==null){currentItemIsEventsExcp=false;currentItemIsEventsDeletedExcp=false;currentItemEvtType=itemTable.getAttribute("EventType");if(currentItemEvtType!=null&&(currentItemEvtType==2||currentItemEvtType==3||currentItemEvtType==4)){currentItemIsEventsExcp=true;if(currentItemEvtType==3)currentItemIsEventsDeletedExcp=true;if(currentItemID.indexOf(".")!=-1)g=currentItemID.split(".")[0]}}var b;if(a.listBaseType==3&&a.listTemplate==108){strDisplayText=L_Reply_Text;if(itemTable.getAttribute("Ordering").length>=504){var L_ReplyLimitMsg_Text="Cannot reply to this thread. The reply limit has been reached.";strAction="alert('"+L_ReplyLimitMsg_Text+"')"}else{strAction="STSNavigate('"+a.newFormUrl+"&Threading="+escapeProperly(itemTable.getAttribute("Ordering"))+"&Guid="+escapeProperly(itemTable.getAttribute("ThreadID"))+"&Subject="+escapeProperly(itemTable.getAttribute("Subject"));strAction=AddSourceToUrl(strAction)+"')"}strImagePath=a.imagesPath+"reply.gif";b=CAMOpt(c,strDisplayText,strAction,strImagePath,null,100);b.id="ID_Reply"}AddSharedNamespaceMenuItems(c,a);var f=itemTable.getAttribute("CId");if(f!=null&&f.indexOf("0x0106")==0&&HasRights(16,0)){strDisplayText=L_ExportContact_Text;strAction="STSNavigate('"+a.HttpPath+"&Cmd=Display&CacheControl=1&List="+a.listName+"&ID="+currentItemID+"&Using="+escapeProperly(a.listUrlDir)+"/vcard.vcf')";strImagePath=a.imagesPath+"exptitem.gif";b=CAMOpt(c,strDisplayText,strAction,strImagePath,null,350);CUIInfo(b,"ExportContact",["ExportContact"]);b.id="ID_ExportContact"}CAMSep(c);a.verEnabled==1&&AddVersionsMenuItem(c,a,d);if(a.isModerated==true&&HasRights(0,16)&&HasRights(0,4)&&HasRights(0,135168)&&a.listBaseType!=4&&currentItemID.indexOf(".0.")<0){strDisplayText=L_ModerateItem_Text;strAction="NavigateToApproveRejectAspx(event, '"+a.HttpRoot+"/_layouts/approve.aspx?List="+a.listName+"&ID="+g;strAction=AddSourceToUrl(strAction)+"')";strImagePath=a.imagesPath+"apprj.gif";b=CAMOpt(c,strDisplayText,strAction,strImagePath,null,850);CUIInfo(b,"Moderate",["Moderate"]);b.id="ID_ModerateItem"}CAMSep(c);AddWorkflowsMenuItem(c,a);var e=typeof _spPageContextInfo!="undefined"&&_spPageContextInfo!=null&&_spPageContextInfo.alertsEnabled;if(currentItemID.indexOf(".0.")<0&&HasRights(128,0)&&!a.ExternalDataList&&e){strDisplayText=L_Subscribe_Text;strAction="NavigateToSubNewAspxV4(event, '"+a.HttpRoot+"', 'List="+a.listName+"&ID="+currentItemID+"')";strImagePath="";b=CAMOpt(c,strDisplayText,strAction,strImagePath,null,1100);b.id="ID_Subscribe";CUIInfo(b,"Subscribe",["Subscribe"])}(e||a.WorkflowsAssociated&&HasRights(0,4))&&CAMSep(c);AddManagePermsMenuItem(c,a,a.listName,currentItemID);if(currentItemID.indexOf(".0.")<0&&HasRights(0,8)&&!currentItemIsEventsExcp){if(a.listBaseType==4)strDisplayText=L_DeleteResponse_Text;else strDisplayText=L_DeleteItem_Text;strAction="DeleteListItem()";strImagePath=a.imagesPath+"delitem.gif";b=CAMOpt(c,strDisplayText,strAction,strImagePath,null,1180);CUIInfo(b,"Delete",["Delete"]);b.id="ID_DeleteItem";CUIInfo(b,"Delete",["Delete"])}var h=currentItemProgId!=null&&currentItemProgId!="";if(currentItemFSObjType==1&&!h&&a.ContentTypesEnabled&&a.listTemplate!=108){strDisplayText=L_CustomizeNewButton_Text;strAction="STSNavigate('"+a.HttpRoot+"/_layouts/ChangeContentTypeOrder.aspx?List="+a.listName+"&RootFolder="+d;strAction=AddSourceToUrl(strAction)+"')";strImagePath="";b=CAMOpt(c,strDisplayText,strAction,strImagePath,null,1170);CUIInfo(b,"ChangeNewButton",["ChangeNewButton"]);b.id="ID_CustomizeNewButton"}}function ReplaceUrlTokens(c,d){ULSrLq:;if(c==null||c==undefined||c==""){c="";return c}if(currentItemID!=null)c=c.replace(/{ItemId}/g,currentItemID);var a=null,b=null,f=c.indexOf("?");if(-1!=f&&f+2<c.length){a=c.substr(f+1);b=c.substr(0,f+1)}else b=c;if(currentItemFileUrl!=null){if(null!=a){var e=escapeProperly(unescapeProperly(currentItemFileUrl));a=a.replace(/{ItemUrl}/g,e)}b=b.replace(/{ItemUrl}/g,currentItemFileUrl)}if(d.HttpRoot!=null){if(null!=a){var e=escapeProperly(unescapeProperly(d.HttpRoot));a=a.replace(/{SiteUrl}/g,e)}b=b.replace(/{SiteUrl}/g,d.HttpRoot)}if(d.listName!=null){if(null!=a){var e=escapeProperly(d.listName);a=a.replace(/{ListId}/g,e)}b=b.replace(/{ListId}/g,d.listName)}if(d.listUrlDir!=null){if(null!=a){var e=escapeProperly(unescapeProperly(d.listUrlDir));a=a.replace(/{ListUrlDir}/g,e)}b=b.replace(/{ListUrlDir}/g,d.listUrlDir)}var g=GetSource();b=b.replace(/{Source}/g,g);if(a!=null)if(b.length+a.length+g.length>1950)a=a.replace(/{Source}/g,"");else a=a.replace(/{Source}/g,g);if(null==a)return b;else return b+a}var SYSTEM_ACCOUNT_ID=1073741823;function InsertFeatureMenuItems(r,c){ULSrLq:;CAMSep(r);var f=GetAttributeFromItemTable(itemTable,"Ext","FileType"),i=GetAttributeFromItemTable(itemTable,"Type","HTMLType"),e=GetAttributeFromItemTable(itemTable,"CId","ContentTypeId"),j=null,g=null,o="ECBItems";if(c!=null){j=c.listTemplate;if(null!=c.listName&&0<c.listName.length){g=c.listName.toLowerCase();o=o+"_"+g}}if(f)f=f.toLowerCase();if(i)i=i.toLowerCase();if(e)e=e.toLowerCase();var x,k=document.getElementById(o);if(k!=null)for(var l=0;l<k.childNodes.length;l++){var a=k.childNodes[l],p=parseInt(GetInnerText(a.childNodes[3])),q=parseInt(GetInnerText(a.childNodes[4])),h=GetInnerText(a.childNodes[5]),b=GetInnerText(a.childNodes[6]),d=false;if(b){b=b.toLowerCase();if(h=="FileType")d=f==b.toLowerCase();else if(h=="ProgId")d=i==b.toLowerCase();else if(h=="ContentType")d=e&&e.indexOf(b.toLowerCase())==0;else if(h=="List")if(null!=j&&j==b)d=true;else if(null!=g&&g==b)d=true}if(d&&HasRights(p,q)&&!IsTrimmedBySystem(p,q)){var w=a.childNodes[0],s=a.childNodes[1],u=a.childNodes[2],y=parseInt(GetInnerText(a.childNodes[7])),t=GetInnerText(w),n=ReplaceUrlTokens(GetInnerText(u),c),m;if(n.substr(0,11)=="javascript:")m=n;else m="STSNavigate('"+STSScriptEncode(n)+"')";var v=ReplaceUrlTokens(GetInnerText(s),c);x=CIMOpt(r,t,m,v,null,y)}}}function GetRootFolder2(c){ULSrLq:;var b=GetUrlKeyValue("RootFolder",false);if(c.clvp!=null&&c.clvp.rootFolder!=null)b=c.clvp.rootFolder;if(b==""||bValidSearchTerm){var a;if(itemTable)a=GetAttributeFromItemTable(itemTable,"DRef","FileDirRef");if(a!=null&&a!="")if(a.substring(0,1)=="/")b=a;else b="/"+a;else b=c.listUrlDir}return b}function GetRootFolder(b){ULSrLq:;var a=GetRootFolder2(b);return "&RootFolder="+escapeProperly(a)}function HasRights(a,b){ULSrLq:;if(currentItemPermMaskH==null){if(itemTable==null)return true;var c=GetAttributeFromItemTable(itemTable,"Perm","PermMask");if(c==null)return true;var d=itemTable.getAttribute("Author");SetCurrentPermMaskFromString(c,d)}if(!currentItemCanModify&&(EqualRights(a,b,0,4)||EqualRights(a,b,0,8)||EqualRights(a,b,1073741824,0)))return false;return (b&currentItemPermMaskL)==b&&(a&currentItemPermMaskH)==a}function EqualRights(a,c,b,d){ULSrLq:;return a==b&&c==d}function CheckIfHasRights(a,b,c,d){ULSrLq:;return (b&d)==b&&(a&c)==a}function IsTrimmedBySystem(b,c){ULSrLq:;var a=false;if(CheckIfHasRights(0,4,b,c)&&itemTable!=null){if(currentItemCheckedOutUserId==null)currentItemCheckedOutUserId=itemTable.getAttribute("COUId");a=currentItemCheckedOutUserId==SYSTEM_ACCOUNT_ID&&ctx.CurrentUserId!=SYSTEM_ACCOUNT_ID}return a}function SetCurrentPermMaskFromString(b,c){ULSrLq:;var a=b.length;if(a<=10){currentItemPermMaskH=0;currentItemPermMaskL=parseInt(b)}else{currentItemPermMaskH=parseInt(b.substring(2,a-8),16);currentItemPermMaskL=parseInt(b.substring(a-8,a),16)}currentItemCanModify=c==null||HasRights(0,2048)||ctx.CurrentUserId==c||ctx.CurrentUserId==null||ctx.WriteSecurity==1}function AddSharedNamespaceMenuItems(f,a){ULSrLq:;var g=GetRootFolder(a);setupMenuContext(a);if(currentItemFileUrl==null)currentItemFileUrl=GetAttributeFromItemTable(itemTable,"Url","ServerUrl");if(currentItemFSObjType==null)currentItemFSObjType=GetAttributeFromItemTable(itemTable,"OType","FSObjType");if(currentItemContentTypeId==null)currentItemContentTypeId=GetAttributeFromItemTable(itemTable,"CId","ContentTypeId");if(currentItemModerationStatus==null)currentItemModerationStatus=GetAttributeFromItemTable(itemTable,"MS","MStatus");if(currentItemCheckedOutUserId==null)currentItemCheckedOutUserId=itemTable.getAttribute("COUId");if(currentItemCheckedoutToLocal==null)currentItemCheckedoutToLocal=GetAttributeFromItemTable(itemTable,"COut","IsCheckedoutToLocal ");if(currentItemCheckedoutToLocal!=1)currentItemCheckedoutToLocal=0;var i=currentItemCheckedOutUserId==SYSTEM_ACCOUNT_ID&&a.CurrentUserId!=SYSTEM_ACCOUNT_ID;bIsCheckout=0;if(a.isForceCheckout==true&&currentItemCheckedOutUserId==""&&currentItemFSObjType!=1)bIsCheckout=1;var h;if(currentItemFileUrl!=null)h=escapeProperly(unescapeProperly(currentItemFileUrl));var b;if(a.listBaseType==1)strDisplayText=L_ViewProperties_Text;else if(a.listBaseType==4)strDisplayText=L_ViewResponse_Text;else strDisplayText=L_ViewItem_Text;var d="";if(currentItemContentTypeId!=null&&currentItemContentTypeId!="")d="&ContentTypeID="+currentItemContentTypeId;var c="&";if(a.displayFormUrl.indexOf("?")==-1)c="?";var e=a.displayFormUrl+c+"ID="+currentItemID+d;e=AddSourceToUrl(e)+g;if(301==a.listTemplate)strAction="EditItem('"+e+"')";else strAction="EditItem2(event, '"+e+"')";strImagePath="";b=CAMOpt(f,strDisplayText,strAction,strImagePath,null,200);CUIInfo(b,"ViewProperties",["ViewProperties"]);if(a.listBaseType==1)b.id="ID_ViewProperties";else b.id="ID_ViewItem";if(HasRights(0,4)&&!i&&!currentItemIsEventsDeletedExcp){if(a.listBaseType==1)strDisplayText=L_EditProperties_Text;else if(a.listBaseType==4)strDisplayText=L_EditResponse_Text;else strDisplayText=L_EditItem_Text;c="&";if(a.editFormUrl.indexOf("?")==-1)c="?";if(a.listBaseType==1){strAction="EditItemWithCheckoutAlert(event, '"+a.editFormUrl+c+"ID="+currentItemID+d;strAction=AddSourceToUrl(strAction)+g+"',"+bIsCheckout+",'"+currentItemCheckedoutToLocal+"','"+STSScriptEncode(currentItemFileUrl)+"','"+a.HttpRoot+"')"}else if(FV4UI())strAction="EditItem2(event, '"+a.editFormUrl+c+"ID="+currentItemID+d+"')";else{strAction="EditItem('"+a.editFormUrl+c+"ID="+currentItemID+d;strAction=AddSourceToUrl(strAction)+"')"}strImagePath=a.imagesPath+"edititem.gif";b=CAMOpt(f,strDisplayText,strAction,strImagePath,null,220);if(a.listBaseType==1){b.id="ID_EditProperties";CUIInfo(b,"EditProperties",["EditProperties"])}else{b.id="ID_EditItem";CUIInfo(b,"EditProperties",["EditProperties"])}if(a.listTemplate==106&&currentItemID.indexOf(".0.")>0){var k=currentItemID.indexOf(".0."),j=currentItemID.substr(0,k);strDisplayText=L_EditSeriesItem_Text;strAction="EditItem2(event, '"+a.editFormUrl+c+"ID="+j+d;strAction=AddSourceToUrl(strAction)+"')";strImagePath=a.imagesPath+"recurrence.gif";b=CAMOpt(f,strDisplayText,strAction,strImagePath,null,230);CUIInfo(b,"EditSeriesItem",["EditSeriesItem"]);b.id="ID_EditSeriesItem"}}}function AddSolutionsCatalogMenuItems(a,h){ULSrLq:;if(HasRights(0,4))if(currentItemFSObjType!=1){var b=true,c=GetAttributeFromItemTable(itemTable,"Url",null);if(c.length>4){var i=c.substr(c.length-4).toLowerCase();if(i==".wsp"){var d=GetAttributeFromItemTable(itemTable,"SolutionHash",null),g=GetAttributeFromItemTable(itemTable,"Hash",null),f=GetAttributeFromItemTable(itemTable,"SolutionItemID",null),e=GetAttributeFromItemTable(itemTable,"Status",null),j=GetAttributeFromItemTable(itemTable,"id",null);if(d!="")if(e=="")AddSolutionMenuActivate(a);else if(d==g){if(j==f)if(e=="1"){b=false;AddSolutionMenuDeactivate(a)}else AddSolutionMenuActivate(a)}else AddSolutionMenuUpgrade(a);else b=false}}b&&AddSolutionMenuDelete(a,h)}}function AddSolutionMenuHelper(i,d,f,e,g,b,c){ULSrLq:;var a,h="if(event){event.currentItemID="+currentItemID+';}RunSolutionOperation(event, "'+f+'")';a=CAMOpt(i,d,h,e,null,g);CUIInfo(a,b,[b]);a.id=c}function AddSolutionMenuActivate(a){ULSrLq:;window.SPUserCanManageSolutions==true&&AddSolutionMenuHelper(a,L_ActivateSolution_Text,"ACT","",1210,"ActivateSolution","ID_ActivateSolution")}function AddSolutionMenuDeactivate(a){ULSrLq:;window.SPUserCanManageSolutions==true&&AddSolutionMenuHelper(a,L_DeactivateSolution_Text,"DEA","",1220,"DeactivateSolution","ID_DeactivateSolution")}function AddSolutionMenuUpgrade(a){ULSrLq:;window.SPUserCanManageSolutions==true&&AddSolutionMenuHelper(a,L_UpgradeSolution_Text,"UPG","",1230,"UpgradeSolution","ID_UpgradeSolution")}function AddSolutionMenuDelete(e,b){ULSrLq:;var a,c;currentItemFileUrl=GetAttributeFromItemTable(itemTable,"Url","ServerUrl");if(currentItemFileUrl!=null)c=escapeProperly(unescapeProperly(currentItemFileUrl));strDisplayText=L_DeleteDocItem_Text;var d="false";if(typeof itemTable.getAttribute("CSrc")!="undefined"&&itemTable.getAttribute("CSrc")!=null&&itemTable.getAttribute("CSrc")!="")d="true";strAction="DeleteDocLibItem('"+b.HttpPath+"&Cmd=Delete&List="+b.listName+"&ID="+currentItemID+"&owsfileref="+c+"&NextUsing="+GetSource()+"',"+d+")";strImagePath=b.imagesPath+"delitem.gif";a=CAMOpt(e,strDisplayText,strAction,strImagePath,null,310);a.id="ID_DeleteDocItem";CUIInfo(a,"Delete",["Delete"])}function RunSolutionOperation(b,g){ULSrLq:;if(!b&&!IsContextSet())return;var d=currentCtx?currentCtx:b.currentCtx,e=currentItemID?currentItemID:b.currentItemID,f=d.listUrlDir,i=GetSource(),a=f+"/Forms/Activate.aspx?Op="+g+"&ID="+e+"&Source="+i;if(d.listBaseType==1)a=a+GetRootFolder(d);var h=function(){ULSrLq:;var a=window.location.href,b=a.indexOf("#");if(b==-1)window.location.href=a;else window.location.href=a.substring(0,b)},j=function(){ULSrLq:;var b={url:a,args:null,width:650,height:450,dialogReturnValueCallback:h},c=SP.UI.ModalDialog.showModalDialog(b)},c;try{c=typeof SP.UI.ModalDialog.showModalDialog}catch(k){c="undefined"}EnsureScript("SP.UI.Dialog.js",c,j)}function AddDocLibMenuItems(c,a){ULSrLq:;if(typeof Custom_AddDocLibMenuItems!="undefined")if(Custom_AddDocLibMenuItems(c,a))return;var i=GetRootFolder(a),b;AddSharedNamespaceMenuItems(c,a);CAMSep(c);var d;if(currentItemFileUrl!=null)d=escapeProperly(unescapeProperly(currentItemFileUrl));var e=itemTable.getAttribute("SRed"),f=currentItemCheckedOutUserId==SYSTEM_ACCOUNT_ID&&a.CurrentUserId!=SYSTEM_ACCOUNT_ID;if(HasRights(0,4)&&HasRights(16,0)&&!f&&(e==null||e==""||HasRights(0,32)))if(a.isWebEditorPreview==0&&a.listBaseType==1)if(a.listTemplate==109&&itemTable.getAttribute("IsImage")=="1"){if(currentItemFSObjType!=1){strDisplayText=L_EditInOIS_Text;strAction="EditSingleImage('"+currentItemID+"')";strImagePath=a.imagesPath+"oisweb.gif";b=CAMOpt(c,strDisplayText,strAction,strImagePath,null,260);b.id="ID_EditInOIS";CUIInfo(b,"EditDocument",["EditDocument"])}}else if(a.listTemplate!=119){setDocType();if(currentItemAppName!=""&&currentItemOpenControl!=""){strDisplayText="";if(currentItemAppName!=" ")strDisplayText=StBuildParam(L_EditIn_Text,currentItemAppName);else{var h=StsOpenEnsureEx2(currentItemOpenControl+".3");if(h!=null)strDisplayText=L_EditInApplication_Text}if(strDisplayText!=""){strAction="editDocumentWithProgID2('"+currentItemFileUrl+"', '"+currentItemProgId+"', '"+currentItemOpenControl+"', '"+bIsCheckout+"', '"+a.HttpRoot+"', '"+currentItemCheckedoutToLocal+"')";strImagePath=a.imagesPath+currentItemIcon;b=CAMOpt(c,strDisplayText,strAction,strImagePath,null,260);b.id="ID_EditIn_"+currentItemAppName;CUIInfo(b,"EditDocument",["EditDocument"])}}}CAMSep(c);if(HasRights(0,4))if(currentItemFSObjType!=1)a.listBaseType==1&&AddCheckinCheckoutMenuItem(c,a,d);(a.verEnabled==1||a.isModerated)&&currentItemFSObjType!=1&&AddVersionsMenuItem(c,a,d);if(HasRights(0,4))if(a.isModerated==true&&HasRights(0,16)&&((currentItemModerationStatus==2||!a.EnableMinorVersions)&&currentItemCheckedOutUserId==""||currentItemFSObjType==1)){strDisplayText=L_ModerateItem_Text;strAction="NavigateToApproveRejectAspx(event, '"+a.HttpRoot+"/_layouts/approve.aspx?List="+a.listName+"&ID="+currentItemID;strAction=AddSourceToUrl(strAction)+GetRootFolder(a)+"')";strImagePath=a.imagesPath+"apprj.gif";b=CAMOpt(c,strDisplayText,strAction,strImagePath,null,850);CUIInfo(b,"Moderate",["Moderate"]);b.id="ID_ModerateItem"}CAMSep(c);AddWorkflowsMenuItem(c,a);if(currentItemFSObjType!=1){if(a.PortalUrl!=null){strDisplayText=L_AddToMyLinks_Text;strAction="Portal_Tasks('PinToMyPage')";strImagePath="";b=CAMOpt(c,strDisplayText,strAction,strImagePath,null,1e3);CUIInfo(b,"AddToMyLinks",["AddToMyLinks"]);b.id="ID_AddToMyLinks"}}else a.listBaseType==1&&HasRights(16,0)&&AddWorkOfflineMenuItem(c,a,currentItemFileUrl);if(HasRights(128,0)&&typeof _spPageContextInfo!="undefined"&&_spPageContextInfo!=null&&_spPageContextInfo.alertsEnabled){strDisplayText=L_Subscribe_Text;strAction="NavigateToSubNewAspxV4(event, '"+a.HttpRoot+"', 'List="+a.listName+"&ID="+currentItemID+"')";strImagePath="";b=CAMOpt(c,strDisplayText,strAction,strImagePath,null,1100);CUIInfo(b,"Subscribe",["Subscribe"]);b.id="ID_Subscribe"}if(currentItemFSObjType!=1){AddSendSubMenu(c,a);AddGotoSourceItemMenuItem(c,a,itemTable,currentItemFSObjType);AddDocTransformSubMenu(c,a)}if(currentItemFSObjType!=1&&a.listTemplate==109&&typeof DownloadOriginalImage=="function"){strAction="DownloadOriginalImage("+currentItemID+")";strImagePath=a.imagesPath+"download.gif";strDisplayText=L_DownloadOriginal_Text;b=CAMOpt(c,strDisplayText,strAction,strImagePath,null,550);CUIInfo(b,"DownloadOriginalImage",["DownloadOriginalImage"]);b.id="ID_DownloadOriginal"}CAMSep(c);AddManagePermsMenuItem(c,a,a.listName,currentItemID);if(HasRights(0,8)&&!f){strDisplayText=L_DeleteDocItem_Text;var g="false";if(typeof itemTable.getAttribute("CSrc")!="undefined"&&itemTable.getAttribute("CSrc")!=null&&itemTable.getAttribute("CSrc")!="")g="true";strAction="DeleteDocLibItem('"+a.HttpPath+"&Cmd=Delete&List="+a.listName+"&ID="+currentItemID+"&owsfileref="+d+"&NextUsing="+GetSource()+"',"+g+")";strImagePath=a.imagesPath+"delitem.gif";b=CAMOpt(c,strDisplayText,strAction,strImagePath,null,1190);b.id="ID_DeleteDocItem";CUIInfo(b,"Delete",["Delete"])}if(currentItemFSObjType==1&&a.ContentTypesEnabled&&a.listTemplate!=108){strDisplayText=L_CustomizeNewButton_Text;strAction="STSNavigate('"+a.HttpRoot+"/_layouts/ChangeContentTypeOrder.aspx?List="+a.listName+"&RootFolder="+d;strAction=AddSourceToUrl(strAction)+"')";strImagePath="";b=CAMOpt(c,strDisplayText,strAction,strImagePath,null,1170);CUIInfo(b,"ChangeNewButton",["ChangeNewButton"]);b.id="ID_CustomizeNewButton"}}function AddManagePermsMenuItem(e,a,c,d){ULSrLq:;if(!HasRights(1073741824,0)||currentItemIsEventsExcp||a.ExternalDataList||currentItemEvtType==5)return;strDisplayText=L_MngPerms_Text;strAction="NavigateToManagePermsPage('"+a.HttpRoot+"', '"+c+"','"+d+"')";strImagePath=a.imagesPath+"permissions16.png";var b=CAMOpt(e,strDisplayText,strAction,strImagePath,null,1160);b.id="ID_MngPerms";CUIInfo(b,"ManagePermissions",["ManagePermissions"])}function AddGotoSourceItemMenuItem(e,d,a,c){ULSrLq:;if(c!=1&&typeof a.getAttribute("CSrc")!="undefined"&&a.getAttribute("CSrc")!=null&&a.getAttribute("CSrc")!=""){strDisplayText=L_GoToSourceItem_Text;strAction="NavigateToSourceItem(event, '"+STSScriptEncode(a.getAttribute("CSrc"))+"')";strImagePath=d.imagesPath+"goToOriginal.gif";var b=CAMOpt(e,strDisplayText,strAction,strImagePath,null,440);b.id="ID_GoToSourceItem";CUIInfo(b,"GotoSourceItem",["GotoSourceItem"])}}function CheckoutSingleItemFromECB(b,c){ULSrLq:;var a;try{a=typeof inplview.CheckOutSingleItem}catch(g){a="undefined"}if(a!="undefined")inplview.CheckOutSingleItem(b,c);else{var f="inplview.CheckOutSingleItem",d=f.split(".");if(d.length>1){var e=function(){ULSrLq:;inplview.CheckOutSingleItem(b,c)};EnsureScript(d[0],a,e)}}}function AddCheckinCheckoutMenuItem(d,a,c){ULSrLq:;var b;if(!HasRights(0,4))return;if(currentItemCheckedOutUserId==SYSTEM_ACCOUNT_ID&&a.CurrentUserId!=SYSTEM_ACCOUNT_ID)return;if(currentItemCheckedOutUserId==null)currentItemCheckedOutUserId=itemTable.getAttribute("COUId");if(currentItemCheckedOutUserId!=""){if(currentItemCheckedOutUserId==a.CurrentUserId||a.CurrentUserId==null||HasRights(0,256)){strDisplayText=L_Checkin_Text;if(!FV4UI()||a.listTemplate==109)strAction="NavigateToCheckinAspx('"+a.HttpRoot+"', 'List="+a.listName+"&FileName="+c+"')";else strAction="CheckInSingleItemFromECB_Stub(event, currentCtx, itemTable)";strImagePath=a.imagesPath+"checkin.gif";b=CAMOpt(d,strDisplayText,strAction,strImagePath,null,300);b.id="ID_Checkin";CUIInfo(b,"CheckIn",["CheckIn"]);strDisplayText=L_DiscardCheckou_Text;strAction="UnDoCheckOutwithNotification('"+a.HttpRoot+"', '"+c+"')";strImagePath=a.imagesPath+"unchkout.gif";b=CAMOpt(d,strDisplayText,strAction,strImagePath,null,310);b.id="ID_DiscardCheckou";CUIInfo(b,"DiscardCheckOut",["DiscardCheckOut"])}}else if(typeof g_disableCheckoutInEditMode=="undefined"||!g_disableCheckoutInEditMode){strDisplayText=L_Checkout_Text;currentItemOpenControl==""&&setDocType();var h="";if(a.listTemplate!=109)h=currentItemOpenControl+".3";var g=itemTable.getAttribute("SRed");if(g==null||g==""||HasRights(0,32)){if(!FV4UI()||a.listTemplate==109)strAction="CheckoutDocument('"+a.HttpRoot+"', '"+c+"', '"+h+"')";else strAction="CheckoutSingleItemFromECB(currentCtx, itemTable)";strImagePath=a.imagesPath+"checkout.gif";b=CAMOpt(d,strDisplayText,strAction,strImagePath,null,300);b.id="ID_Checkout";CUIInfo(b,"CheckOut",["CheckOut"])}if(currentItemModerationStatus==null)currentItemModerationStatus=GetAttributeFromItemTable(itemTable,"MS","MStatus");if(a.EnableMinorVersions){if(currentItemUIString==null)currentItemUIString=GetAttributeFromItemTable(itemTable,"UIS","UIString");var i=currentItemUIString%512;if((currentItemModerationStatus==1||currentItemModerationStatus==3)&&a.isModerated||!a.isModerated&&i!=0){strDisplayText=L_PublishItem_Text;strAction="PublishMajorVersion(event, '"+a.HttpRoot+"', 'List="+a.listName+"&FileName="+c+"&Publish=true')";strImagePath=a.imagesPath+"pubmajor.gif";b=CAMOpt(d,strDisplayText,strAction,strImagePath,null,320);CUIInfo(b,"Publish",["Publish"]);b.id="ID_PublishItem"}else{var f,e=false;if(!a.isModerated||currentItemModerationStatus==0){strDisplayText=L_UnPublishItem_Text;f="ID_UnPublishItem";strImagePath=a.imagesPath+"unpub.gif"}else{strDisplayText=L_CancelPublish_Text;f="ID_CancelPublish";strImagePath=a.imagesPath+"unapprv.gif";e=true}strAction="UnPublish('"+a.HttpRoot+"', 'FileName="+c+"&UnPublish=true',"+e+")";b=CAMOpt(d,strDisplayText,strAction,strImagePath,null,330);if(e)CUIInfo(b,"CancelApproval",["CancelApproval"]);else CUIInfo(b,"Unpublish",["Unpublish"]);b.id=f}}}}function AddWorkflowsMenuItem(h,a){ULSrLq:;if(a.WorkflowsAssociated&&HasRights(0,4)){var f=GetAttributeFromItemTable(itemTable,"CId","ContentTypeId");if(f==null||f.substr(0,8)!="0x010801"){var g=a.imagesPath+"workflows.gif",c,d=(""+currentItemID).indexOf(".0.");if(d>0)c=currentItemID.substr(0,d);else c=currentItemID;var b="STSNavigate('"+a.HttpRoot+"/_layouts/Workflow.aspx?ID="+c+"&List="+a.listName;b=AddSourceToUrl(b)+"')";var e=CAMOpt(h,L_Workflows_Text,b,g,null,900);CUIInfo(e,"ViewWorkflows",["ViewWorkflows"]);e.id="ID_Workflows"}}}function AddWorkspaceMenuItem(d,b){ULSrLq:;var a,c=GetAttributeFromItemTable(itemTable,"SUrl","SourceUrl");if(c!=null&&c!=""&&c!="%20"&&c!=" "){if(HasRights(0,135168)){strAction="STSNavigate('"+b.HttpRoot+"/_layouts/publishback.aspx?list="+b.listName+"&item="+currentItemID+GetRootFolder(b)+"')";a=CAMOpt(d,L_PublishBack_Text,strAction,"",null,1140);CUIInfo(a,"PublishBack",["PublishBack"]);a.id="ID_PublishBack"}}else if(HasRights(0,8388608)&&HasRights(0,135168)&&HasRights(0,67108864)){strAction="STSNavigate('"+b.HttpRoot+"/_layouts/createws.aspx?list="+b.listName+"&item="+currentItemID+GetRootFolder(b)+"')";a=CAMOpt(d,L_CreateDWS_Text,strAction,"",null,1140);CUIInfo(a,"CreateDocumentWorkspace",["CreateDocumentWorkspace"]);a.id="ID_CreateDWS"}}function AddVersionsMenuItem(f,a,e){ULSrLq:;if(currentItemID!=null){var d=currentItemID.toString();if(d.indexOf(".0.")>=0)return}var b=currentItemID;if(currentItemIsEventsExcp)if(currentItemID.indexOf(".")!=-1)b=currentItemID.split(".")[0];if(!HasRights(0,64))return;strDisplayText=L_Versions_Text;strAction="NavigateToVersionsAspxV4(event, '"+a.HttpRoot+"', 'list="+a.listName+"&ID="+b+"&FileName="+e+"')";strImagePath=a.imagesPath+"versions.gif";var c=CAMOpt(f,strDisplayText,strAction,strImagePath,null,800);CUIInfo(c,"ViewVersions",["ViewVersions"]);c.id="ID_Versions"}function AddWorkOfflineMenuItem(e,a,d){ULSrLq:;var b=GetStssyncData("documents",L_WorkOffline_Text,a.imagesPath+"tbsprsht.gif",a.imagesPath);if(b){strDisplayText=b.BtnText;strImagePath=b.BtnImagePath;if(strDisplayText){var c="";if(a.SiteTitle!=null)c=STSScriptEncode(a.SiteTitle);strAction="javascript:ExportHailStorm('documents','"+a.HttpRoot+"','"+STSScriptEncode(a.listName)+"','"+STSScriptEncode(c)+"','"+STSScriptEncode(a.ListTitle)+"','"+STSScriptEncode(a.listUrlDir)+"','','"+STSScriptEncode(unescapeProperly(a.listUrlDir))+"'";strAction+=",'"+STSScriptEncode(unescapeProperly(d))+"','"+currentItemID+"')";menuOption=CAMOpt(e,strDisplayText,strAction,strImagePath);CUIInfo(menuOption,"ConnectFolderToClient",["ConnectFolderToClient"]);menuOption.id="ID_WorkOffline"}}}function AddVersionMenuItems(b,a){ULSrLq:;typeof AddVersionMenuItemsCore=="function"&&AddVersionMenuItemsCore(b,a)}function NavigateToApproveRejectAspx(b,a){ULSrLq:;if(FV4UI())ShowInPopUI(b,currentCtx,a);else STSNavigate(a)}function PublishMajorVersion(d,b,c){ULSrLq:;var a=b+"/_layouts/Checkin.aspx?"+c;a=AddSourceToUrl(a);if(FV4UI())ShowInPopUI(d,currentCtx,a);else SubmitFormPost(a)}function _NavigateToSubNewAspx(b,c){ULSrLq:;var a=b+"/_layouts/SubNew.aspx?"+c;a=AddSourceToUrl(a);STSNavigate(a)}function NavigateToSubNewAspxV4(d,b,c){ULSrLq:;var a=b+"/_layouts/SubNew.aspx?"+c;a=AddSourceToUrl(a);if(FV4UI())ShowInPopUI(d,currentCtx,a);else STSNavigate(a)}function NavigateToVersionsAspx(b,c){ULSrLq:;var a=b+"/_layouts/Versions.aspx?"+c;a=AddSourceToUrl(a);STSNavigate(a)}function NavigateToVersionsAspxV4(d,b,c){ULSrLq:;var a=b+"/_layouts/Versions.aspx?"+c;a=AddSourceToUrl(a);if(FV4UI())ShowInPopUI(d,currentCtx,a);else STSNavigate(a)}function NavigateToSendToOtherLocationV4(b,a){ULSrLq:;if(FV4UI())ShowInPopUI(b,currentCtx,a);else STSNavigate(a)}var L_UndoCheckoutWarning_Text="If you discard your check out, you will lose all changes made to the document.  Are you sure you want to discard your check out?",L_UnPublishWarning_Text=" Are you sure you want to unpublish this version of the document?",L_CancleApproval_TEXT=" Are you sure that you want to cancel the approval of this document?";function UnDoCheckOutwithNotification(a,c){ULSrLq:;var b=UnDoCheckOut(a,c);if(b){var d=L_Notification_DiscardCheckOut;addNotification(d,true)}}function UnDoCheckOut(f,c){ULSrLq:;try{var b=null,e=SzExtension(unescapeProperly(c));if(FSupportCheckoutToLocal(e))b=StsOpenEnsureEx2("SharePoint.OpenDocuments.3");if(b!=null){var a=unescapeProperly(c);if(a.charAt(0)=="/")a=document.location.protocol+"//"+document.location.host+a;var d=b.DiscardLocalCheckout(a);if(d){SetWindowRefreshOnFocus();return d}if(IsSupportedMacBrowser()||IsSupportedFirefoxOnWin()){if(!confirm(L_UndoCheckoutWarning_Text))return false}else return d}else if(!confirm(L_UndoCheckoutWarning_Text))return false}catch(g){}NavigateToCheckinAspx(f,"FileName="+c+"&DiscardCheckout=true");return true}function UnPublish(c,d,b){ULSrLq:;var a=L_UnPublishWarning_Text;if(b)a=L_CancleApproval_TEXT;if(!confirm(a))return;NavigateToCheckinAspx(c,d)}function NavigateToCheckinAspx(b,c){ULSrLq:;var a=b+"/_layouts/Checkin.aspx?"+c;a=AddSourceToUrl(a);SubmitFormPost(a)}function CheckInSingleItemFromECB_Stub(c,b,d){ULSrLq:;var a;try{a=typeof inplview.CheckInSingleItemFromECB}catch(h){a="undefined"}if(a!="undefined")inplview.CheckInSingleItemFromECB(c,b,d);else{var g="inplview.CheckInSingleItemFromECB",e=g.split(".");if(e.length>1){var f=function(){ULSrLq:;inplview.CheckInSingleItemFromECB(c,b,d)};EnsureScript(e[0],a,f)}}}function _NavigateToManagePermsPage(a,c,b){ULSrLq:;NavigateToManagePermsPageEx(a,c,b,false)}function NavigateToManagePermsPageEx(c,b,d,f){ULSrLq:;var e=",LISTITEM",a=c+"/_layouts/User.aspx?obj="+b+","+d+e+"&List="+b;a=AddSourceToUrl(a);if(f)window.frameElement.navigateParent(a);else STSNavigate(a)}function NavigateToSourceItem(e,a){ULSrLq:;var d=a.match(/[^\/]*\/\/[^\/]*/g),c=d[0]+_spPageContextInfo.webServerRelativeUrl;a=escapeProperly(a);var b=c+"/_layouts/copyutil.aspx?GoToDispForm=1&Use=url&ItemUrl="+a;b=AddSourceToUrl(b);STSNavigate(b)}function setDocType(){ULSrLq:;var a=GetAttributeFromItemTable(itemTable,"Icon","DocIcon");a=a?a.split("|"):[];currentItemIcon=a[0];currentItemAppName=a[1];currentItemOpenControl=a[2];currentItemProgId=GetAttributeFromItemTable(itemTable,"Type","HTMLType")}function DeleteListItem(){ULSrLq:;if(!IsContextSet())return;var b=currentCtx,e=currentItemID,g=currentItemFSObjType,c=L_STSRecycleConfirm_Text;if(!b.RecycleBinEnabled||b.ExternalDataList)c=L_STSDelConfirm_Text;if(b.HasRelatedCascadeLists&&b.CascadeDeleteWarningMessage!=null)c=b.CascadeDeleteWarningMessage+c;if(confirm(c)){var h=L_Notification_Delete,f=addNotification(h,true),a=b.clvp;if(b.ExternalDataList&&a!=null){a.DeleteItemCore(e,g,false);a.pendingItems=[];a.cctx.executeQueryAsync(function(){ULSrLq:;if(typeof a.rgehs!="undefined"){if(a.rgehs.length==1&&a.rgehs[0].get_serverErrorCode()==SP.ClientErrorCodes.redirect){GoToPage(a.rgehs[0].get_serverErrorValue());return}removeNotification(f);a.ShowErrorDialog(RefreshOnDialogClose)}else RefreshPage(SP.UI.DialogResult.OK)},function(){ULSrLq:;removeNotification(f);typeof a.rgehs!="undefined"&&a.ShowErrorDialog()})}else{var d=b.HttpPath+"&Cmd=Delete&List="+b.listName+"&ID="+e+"&NextUsing="+GetSource();if(null!=currentItemContentTypeId)d+="&ContentTypeId="+currentItemContentTypeId;SubmitFormPost(d)}}}function DeleteDocLibItem(d,e){ULSrLq:;if(!IsContextSet())return;var b=currentCtx,h=currentItemID,g=currentItemFSObjType,a,c=false;if(currentItemFSObjType==1){if(currentItemContentTypeId!=null){d+="&ContentTypeId="+currentItemContentTypeId;if(currentItemContentTypeId.substr(0,8).toLowerCase()=="0x0120d5")c=true}if(c)a=b.RecycleBinEnabled?L_STSRecycleConfirm2_Text:L_STSDelConfirm2_Text;else a=b.RecycleBinEnabled?L_STSRecycleConfirm1_Text:L_STSDelConfirm1_Text}else a=b.RecycleBinEnabled?L_STSRecycleConfirm_Text:L_STSDelConfirm_Text;if(b.HasRelatedCascadeLists&&b.CascadeDeleteWarningMessage!=null)a=b.CascadeDeleteWarningMessage+a;if(e&&currentItemFSObjType!=1)a=L_NotifyThisIsCopy_Text+a;if(confirm(a)){var f=L_Notification_Delete;addNotification(f,true);SubmitFormPost(d,false,true)}}function EditMenuDefaultForOnclick(){ULSrLq:;if(!IsContextSet())return;var a=currentCtx;if(a.isVersions)STSNavigate(itemTable.getAttribute("verUrl"));else if(a.listTemplate==200){var b=currentItemID;MtgNavigate(b)}else EditListItem()}function EditListItem(){ULSrLq:;if(event.srcElement.tagName=="A"||event.srcElement.parentNode.tagName=="A")return;if(!IsContextSet())return;var b=currentCtx,c="&";if(b.editFormUrl.indexOf("?")==-1)c="?";var a=b.editFormUrl+c+"ID="+currentItemID;a=AddSourceToUrl(a);if(b.listBaseType==1)a=a+GetRootFolder(b);STSNavigate2(event,a)}function _DoNavigateToTemplateGallery(a,b){ULSrLq:;document.cookie="MSOffice_AWS_DefSaveLoc="+a;STSNavigate(b)}function Portal_Tasks(j){ULSrLq:;if(!IsContextSet())return;var b=currentCtx,g=unescapeProperly(currentItemFileUrl),c=0,d=0;c=g.lastIndexOf("/");d=g.lastIndexOf(".");if(c<0||d<0||c>d)return;var i=g.substr(c+1,d-c-1),f="";c=b.HttpRoot.indexOf("://");if(c>0){d=b.HttpRoot.indexOf("/",c+3);if(d>0)f=b.HttpRoot.substring(0,d);else f=b.HttpRoot}var e="";if(currentItemFileUrl.charAt(0)=="/"||currentItemFileUrl.substr(0,3).toLowerCase()=="%2f")e=f+currentItemFileUrl;else e=currentItemFileUrl;var a="";if(false==setElementValue("ListViewURL",e))a=a+"&ListViewURL="+escapeProperly(e);if(false==setElementValue("ListTitle",i))a=a+"&ListTitle="+escapeProperly(i);if(false==setElementValue("ListDescription",""))a=a+"&ListDescription=";if(false==setElementValue("ReturnUrl",window.location.href))a=a+"&ReturnUrl="+escapeProperly(window.location.href);if(b.PortalUrl.substr(0,4)!="http")b.PortalUrl=f+b.PortalUrl;var h=b.PortalUrl+"_vti_bin/portalapi.aspx?cmd="+j;h=h+"&IconUrl="+b.imagesPath+currentItemIcon+a;SubmitFormPost(h)}function IsContextSet(){ULSrLq:;if(currentCtx==null)return false;else if(currentCtx.isExplictLogin)return true;else if(currentCtx.HttpPath==null||currentItemID==null)return false;return true}function ChangeContentType(d){ULSrLq:;var b=document.getElementById(d),a=window.location.href,e=a.indexOf("?");if(a.indexOf("?")<=0)a=a+"?ContentTypeId="+b.value;else if(a.indexOf("&ContentTypeId=")<=0)a=a+"&ContentTypeId="+b.value;else{var c=/&ContentTypeId=[^&]*/i;a=a.replace(c,"&ContentTypeId="+b.value)}STSNavigate(a)}function _TopHelpButtonClick(a){ULSrLq:;if(typeof navBarHelpOverrideKey!="undefined")return HelpWindowKey(navBarHelpOverrideKey);if(a!=null)HelpWindowKey(a);else HelpWindowKey("HelpHome")}function HelpWindowHelper(d){ULSrLq:;var c;if(typeof d=="undefined")c="?Lcid="+L_Language_Text;else c="?Lcid="+L_Language_Text+d;var b;if(typeof ctx=="undefined"||ctx==null)if(typeof currentCtx!="undefined"&&currentCtx!=null)ctx=currentCtx;else if(typeof ctxFilter!="undefined"&&ctxFilter!=null)ctx=ctxFilter;if(typeof ctx!="undefined"&&ctx!=null&&typeof ctx.HttpRoot!="undefined"&&ctx.HttpRoot!=null){var a=ctx.HttpRoot;if(a.charAt(a.length-1)!="/")a=a+"/";b=a+"_layouts/help.aspx"}if(b==null&&typeof _spPageContextInfo!="undefined"&&_spPageContextInfo!=null&&typeof _spPageContextInfo.webServerRelativeUrl!="undefined"&&_spPageContextInfo.webServerRelativeUrl!=null){var a=_spPageContextInfo.webServerRelativeUrl;if(a.charAt(a.length-1)!="/")a=a+"/";b=a+"_layouts/help.aspx"}if(b==null){b="/_layouts/help.aspx";c=c+"&Source="+escapeProperly(window.location.href)}var e=window.open(b+c,"STSHELP","height=500,location=no,menubar=no,resizable=yes,scrollbars=no,status=yes,toolbar=no,width=475");e.focus()}function _HelpWindowKey(a){ULSrLq:;if(a!=null)HelpWindowHelper("&Key="+a+"&ShowNav=true");else HelpWindowHelper("&Key=HelpHome&ShowNav=true")}function _HelpWindowUrl(a){ULSrLq:;HelpWindowHelper("&Url="+a)}function _HelpWindow(){ULSrLq:;HelpWindowKey("HelpHome")}var L_EmptySlideShow_Text="No pictures found in the library. Add pictures and try again.",L_NotOurView_Text="This operation cannot be completed within current view. Please select another view and try again.";function EditSelectedImages(){ULSrLq:;if(!IsImgLibJssLoaded()){alert(L_NotOurView_Text);return}_EditSelectedImages()}function DeleteImages(){ULSrLq:;if(!IsImgLibJssLoaded()){alert(L_NotOurView_Text);return}_DeleteImages()}function SendImages(){ULSrLq:;if(!IsImgLibJssLoaded()){alert(L_NotOurView_Text);return}_SendImages()}function DownloadImages(){ULSrLq:;if(!IsImgLibJssLoaded()){alert(L_NotOurView_Text);return}_DownloadImages()}function MtgToggleTimeZone(){ULSrLq:;var b=document.getElementById("TimeZoneSection"),a=document.getElementById("TimeZoneLink"),L_ShowTZ_Text="Show time zone",L_HideTZ_Text="Hide time zone";if(b.style.display=="none"){b.style.display="";a.innerHTML="&lt;&lt;";a.title=L_HideTZ_Text;SetCookie("MtgTimeZone","1","")}else{b.style.display="none";a.innerHTML="&gt;&gt;";a.title=L_ShowTZ_Text;SetCookie("MtgTimeZone","0","")}}function GetPageUrl(a){ULSrLq:;return unescapeProperly(a?g_webUrl:g_pageUrl)}function MtgNavigate(a){ULSrLq:;if(a==g_instanceId)return;var b=!g_fPageGlobal;window.location.href=GetPageUrl(b)+"?InstanceID="+a+"&"+g_thispagedata}function GoToMtgMove(d,c,b,a){ULSrLq:;window.location.href=d+"/movetodt.aspx?FromInstanceID="+c+"&FromInstanceDate="+escapeProperly(b)+"&FromInstanceDateISO="+escapeProperly(a)+"&Source="+escapeProperly(window.location.href)}function MtgKeep(b,c,a){ULSrLq:;var L_MtgKeepConfirm_Text="The information for this meeting date does not match the information in your calendar and scheduling program. If you keep this meeting date, it will continue to appear in the Meeting Series list in the workspace.";confirm(L_MtgKeepConfirm_Text)&&SubmitFormPost(b+"&Cmd=MtgKeep&List="+escapeProperly(c)+"&EditInstanceID="+a+"&NextUsing="+escapeProperly(window.location.href))}function MtgDelete(c,d,a){ULSrLq:;var L_MtgDeleteConfirm_Text="This meeting date and the content associated with it will be deleted from the workspace.";if(confirm(L_MtgDeleteConfirm_Text)){var b=a==g_instanceId;SubmitFormPost(c+"&Cmd=MtgMove&List="+escapeProperly(d)+"&FromInstanceID="+a+"&ToInstanceID=-3&NextUsing="+escapeProperly(b?GetPageUrl(true):window.location.href))}}function SetCookie(b,a,c){ULSrLq:;document.cookie=b+"="+a+";path="+c}function SetAsLastTabVisited(){ULSrLq:;typeof g_pageUrl!="undefined"&&typeof g_webUrl!="undefined"&&SetCookie("MtgLastTabVisited",escapeProperly(unescapeProperly(g_pageUrl)),escapeProperlyCore(unescapeProperly(g_webUrl),true))}function MtgRedirect(){ULSrLq:;var a=GetCookie("MtgLastTabVisited");if(a==null)if(typeof g_webUrl!="undefined")a=g_webUrl;else a="../../";else a=escapeProperlyCore(a,true);window.location.href=a}function MakeMtgInstanceUrl(a,c){ULSrLq:;if(c!="undefined"&&c!=""){var b=a.indexOf("?");if(b==-1||a.indexOf("InstanceID=",b)==-1)a=a+(b==-1?"?":"&")+"InstanceID="+c}return a}var filterTable=null,bIsFilterMenuShown=false,bIsFilterDataLoaded=false,filterImageCell=null,currentFilterMenu=null,loadingFilterMenu=null,ctxFilter=null,bIsFilterKeyPress=false,filterStr=null,strFieldName="",bMenuLoadInProgress=false,strFilteredValue=null,fnOnFilterMouseOut=null,L_NotSortable_Text="This column type cannot be sorted",L_NotFilterable_Text="This column type cannot be filtered",L_AOnTop_Text="A on Top",L_ZOnTop_Text="Z on Top",L_SmallestOnTop_Text="Smallest on Top",L_LargestOnTop_Text="Largest on Top",L_OldestOnTop_Text="Oldest on Top",L_NewestOnTop_Text="Newest on Top",L_AttachmentsOnTop_Text="Attachments on Top",L_BlanksOnTop_Text="Blanks on Top",L_Ascending_Text="Ascending",L_Descending_Text="Descending",L_DontFilterBy_Text="Clear Filter from ^1",L_Loading_Text="Loading....",L_FilterMode_Text="Show Filter Choices",L_OpenMenu_Text="Open Menu",L_FilterThrottled_Text="Cannot show the value of the filter. The field may not be filterable, or the number of items returned exceeds the list view threshold enforced by the administrator.";function resetFilterMenuState(){ULSrLq:;if(bMenuLoadInProgress)return;bIsFilterMenuShown=false;bIsFilterDataLoaded=false;filterTable=null;filterImageCell=null;currentFilterMenu=null;loadingFilterMenu=null;ctxFilter=null;bIsFilterKeyPress=false;fnOnFilterMouseOut!=null&&fnOnFilterMouseOut();fnOnFilterMouseOut=null}function setupFilterMenuContext(a){ULSrLq:;ctxFilter=a}function IsFilterMenuOn(){ULSrLq:;if(!bIsFilterMenuShown)return false;var a=false;a=MenuHtc_isOpen(currentFilterMenu)||MenuHtc_isOpen(loadingFilterMenu);if(!a)bIsFilterMenuShown=false;return a}function IsFilterMenuEnabled(){ULSrLq:;return true}function OnMouseOverFilterDeferCall(a){ULSrLq:;if(!IsFilterMenuEnabled())return false;if(IsFilterMenuOn()||bMenuLoadInProgress)return false;if(window.location.href.search("[?&]Filter=1")!=-1)return false;if(a.FilterDisable=="TRUE")return false;if(IsFieldNotFilterable(a)&&IsFieldNotSortable(a))return false;if(filterTable==a)return;filterTable!=null&&OnMouseOutFilter();filterTable=a;var e=filterTable.tagName=="TABLE",f=new Function("setupFilterMenuContext(ctx"+filterTable.getAttribute("CtxNum")+");");f();if(e){filterTable.className="ms-selectedtitle";filterTable.onclick=CreateFilterMenu;filterTable.oncontextmenu=CreateFilterMenu;filterTable.onmouseout=OnMouseOutFilter}else{var b=filterTable.parentNode;b.onclick=CreateFilterMenu;b.oncontextmenu=CreateFilterMenu;b.onmouseout=OnMouseOutFilter;CreateCtxImg(b,OnMouseOutFilter)}if(e){var d=filterTable.childNodes[0].childNodes[0];filterImageCell=d.childNodes[d.childNodes.length-1];var c=filterImageCell.childNodes[0];c.src=ctxFilter.imagesPath+"menudark.gif";c.alt=L_OpenMenu_Text;c.style.visibility="visible";if(IsElementRtl(filterTable)){filterImageCell.style.right=null;filterImageCell.style.left="1px"}else{filterImageCell.style.left=null;filterImageCell.style.right="1px"}filterImageCell.className="ms-menuimagecell"}return true}function OnMouseOutFilter(b){ULSrLq:;if(!IsFilterMenuOn()&&filterTable!=null&&!bMenuLoadInProgress){var c=filterTable.tagName=="TABLE",a=filterTable.parentNode;if(c||a==null){filterTable.className="ms-unselectedtitle";filterTable.onclick="";filterTable.oncontextmenu="";filterTable.onmouseout=""}else{if(b==null)b=window.event;if(b!=null){var d=b.toElement!=null?b.toElement:b.relatedTarget;if(a!=null&&d!=null&&IsContained(d,a))return}a.onclick="";a.oncontextmenu="";a.onmouseout="";RemoveCtxImg(a)}if(c&&filterImageCell!=null&&filterImageCell.childNodes.length>0){filterImageCell.childNodes[0].style.visibility="hidden";filterImageCell.className=""}resetFilterMenuState()}}function _OnFocusFilter(a){ULSrLq:;if(window.location.href.search("[?&]Filter=1")!=-1)return false;if(!IsFilterMenuEnabled())return false;a.onfocusout=OnMouseOutFilter;a.onkeydown=PopFilterMenu;var b=a.getAttribute("FilterString");if(b!=null)filterStr=b;var c=FindSTSMenuTable(a,"CTXNum");if(c==null)return false;OnMouseOverFilter(c);return false}function PopFilterMenu(a){ULSrLq:;if(!IsFilterMenuEnabled())return true;if(a==null)a=window.event;var b;if(browseris.nav6up)b=a.which;else b=a.keyCode;if(!IsFilterMenuOn()&&(a.shiftKey&&b==13||a.altKey&&b==40)){var d=a.srcElement?a.srcElement:a.target,c=FindSTSMenuTable(d,"CTXNum");if(c==null)return false;OnMouseOverFilterDeferCall(c);CreateFilterMenu(a);return false}else return true}function CreateFilterMenu(b){ULSrLq:;if(filterTable==null||filterTable.tagName=="TABLE"&&filterImageCell==null)return true;var c=filterTable.tagName=="DIV"?filterTable.parentNode:filterTable,a=FindCtxImg(c);a!=null&&a.shown==false&&ShowCtxImg(a,true,c);if(b==null)b=window.event;bIsFilterMenuShown=true;window.document.body.onclick="";currentFilterMenu=CMenu("filter_menu");loadingFilterMenu=CMenu("filter_menu_loading");currentFilterMenu.setAttribute("CompactMode","true");addSortMenuItems(currentFilterMenu,loadingFilterMenu);if(filterStr==null)addFilterMenuItems(currentFilterMenu,loadingFilterMenu);else addAdHocFilterMenuItems(currentFilterMenu,loadingFilterMenu);b.cancelBubble=true;return false}function GetUrlWithNoSortParameters(e){ULSrLq:;var a=window.location.href,h=new CUrl(a);h.hash="";a=h.ToString();var b,f=0,d,g;do{d=e.indexOf("=",f);if(d==-1)return a;b=e.substring(f,d);if(b!="");a=RemoveQueryParameterFromUrl(a,b);if(typeof b=="string"&&b.length>"FilterField".length&&b.substring(0,"FilterField".length)=="FilterField"){var c=b.substring("FilterField".length);a=RemoveQueryParameterFromUrl(a,"FilterValue"+c);a=RemoveQueryParameterFromUrl(a,"FilterLookupId"+c);a=RemoveQueryParameterFromUrl(a,"FilterOp"+c);a=RemoveQueryParameterFromUrl(a,"FilterData"+c)}g=e.indexOf("&",d+1);if(g==-1)return a;f=g+1}while(b!="");return a}function IsFieldNotSortable(a){ULSrLq:;if(a.getAttribute("Sortable")=="FALSE"||a.getAttribute("SortDisable")=="TRUE"||a.getAttribute("FieldType")=="MultiChoice")return true;return false}function addSortMenuItems(b,a){ULSrLq:;if(IsFieldNotSortable(filterTable)){CAMOptFilter(b,a,L_NotSortable_Text,"","",false,"fmi_ns");CAMSep(b);CAMSep(a);return}var c="",e="",d="",f="/_layouts/"+L_Language_Text+"/images/SORTAZLang.gif",g="/_layouts/"+L_Language_Text+"/images/SORTZALang.gif";if(filterStr==null){var i=filterTable.getAttribute("SortFields"),l=new CUrl(i);if(l.query.length>0)i=l.query.substr(1);var q=i.indexOf("&SortDir");if(q==-1){CAMOptFilter(b,a,L_NotSortable_Text,"","",false,"fmi_ns");CAMSep(b);CAMSep(a);return}var p=i.indexOf("&",q+1),s=GetUrlWithNoSortParameters(i);s=RemovePagingArgs(s);l=new CUrl(s);var h=l.query;if(h.length>1)h+="&";else if(h.length==0)h+="?";var w=h;if(p<0)p=i.length;h+=i.substr(0,q)+"&SortDir=Asc"+i.substr(p);l.query=h;c="HandleFilter(event, '"+STSScriptEncode(l.ToString())+"');";h=w;h+=i.substr(0,q)+"&SortDir=Desc"+i.substr(p);l.query=h;e="HandleFilter(event, '"+STSScriptEncode(l.ToString())+"');";if(c.indexOf("?")>=0)if(c.substr(c.indexOf("?")+1).indexOf("?")>=0)debugger;var d=filterTable.getAttribute("FieldType");strFieldName=filterTable.getAttribute("Name")}else{var r=" ",k=filterStr.lastIndexOf(r);d=filterStr.substring(k+1);if(d.substring(0,2)=="x:")d=d.substring(2);var n=filterStr.substring(0,k);k=n.lastIndexOf(r);strFieldName=n.substring(k+1);if(strFieldName.substring(0,1)=="@")strFieldName=strFieldName.substring(1);n=filterStr.substring(0,k);k=n.lastIndexOf(r);if(k>0)strFieldName=n.substring(0,k);var v=filterTable.tagName=="TABLE",j=null;if(v){var u=filterTable.childNodes[0].childNodes[0],j=u.childNodes[0].childNodes[0];if(j.tagName=="TABLE")j=j.childNodes[0].childNodes[0].childNodes[1].childNodes[0]}else j=filterTable.firstChild;if(j.tagName=="DIV")j=j.childNodes[0];var m=j.href;m=m.replace(/%20/g," ");if(m.indexOf("'ascending'")>0){c=m;e=m.replace("'ascending'","'descending'")}else{e=m;c=m.replace("'descending'","'ascending'")}}d=d.toLowerCase();if(d=="dateTime"){CAMOptFilter(b,a,L_OldestOnTop_Text,c,f,true,"fmi_asc");CAMOptFilter(b,a,L_NewestOnTop_Text,e,g,true,"fmi_desc")}else if(d=="integer"||d=="number"||d=="currency"){CAMOptFilter(b,a,L_SmallestOnTop_Text,c,f,true,"fmi_asc");CAMOptFilter(b,a,L_LargestOnTop_Text,e,g,true,"fmi_desc")}else if(d=="text"||d=="user"||d=="string"){CAMOptFilter(b,a,L_AOnTop_Text,c,f,true,"fmi_asc");CAMOptFilter(b,a,L_ZOnTop_Text,e,g,true,"fmi_desc")}else if(d=="calculated"){var o=filterTable.getAttribute("ResultType");if(o=="Number"||o=="Currency"){CAMOptFilter(b,a,L_SmallestOnTop_Text,c,f,true,"fmi_asc");CAMOptFilter(b,a,L_LargestOnTop_Text,e,g,true,"fmi_desc")}else if(o=="dateTime"){CAMOptFilter(b,a,L_OldestOnTop_Text,c,f,true,"fmi_asc");CAMOptFilter(b,a,L_NewestOnTop_Text,e,g,true,"fmi_desc")}else if(o=="boolean"){CAMOptFilter(b,a,L_Ascending_Text,c,f,true,"fmi_asc");CAMOptFilter(b,a,L_Descending_Text,e,g,true,"fmi_desc")}else{CAMOptFilter(b,a,L_AOnTop_Text,c,f,true,"fmi_asc");CAMOptFilter(b,a,L_ZOnTop_Text,e,g,true,"fmi_desc")}}else if(d=="attachments"){CAMOptFilter(b,a,L_BlanksOnTop_Text,c,f,true,"fmi_asc");CAMOptFilter(b,a,L_AttachmentsOnTop_Text,e,g,true,"fmi_desc")}else if(d=="lookup"){var t=filterTable.getAttribute("Name");if(t=="Last_x0020_Modified"||t=="Created_x0020_Date"){CAMOptFilter(b,a,L_OldestOnTop_Text,c,f,true,"fmi_asc");CAMOptFilter(b,a,L_NewestOnTop_Text,e,g,true,"fmi_desc")}else{CAMOptFilter(b,a,L_Ascending_Text,c,f,true,"fmi_asc");CAMOptFilter(b,a,L_Descending_Text,e,g,true,"fmi_desc")}}else{CAMOptFilter(b,a,L_Ascending_Text,c,f,true,"fmi_asc");CAMOptFilter(b,a,L_Descending_Text,e,g,true,"fmi_desc")}CAMSep(b);CAMSep(a)}function CAMOptFilter(h,g,d,f,c,b,e){ULSrLq:;var a;a=CAMOpt(h,d,f,c);a.id=e;!b&&a.setAttribute("enabled","false");a=CAMOpt(g,d,f,c);a.id=e+"_p";!b&&a.setAttribute("enabled","false")}function ShowFilterLoadingMenu(){ULSrLq:;!bIsFilterDataLoaded&&filterTable!=null&&FilterOMenu(loadingFilterMenu,filterTable)}function getFilterQueryParam(){ULSrLq:;var d=document.getElementById("FilterIframe"+filterTable.getAttribute("CtxNum"));if(d==null)return;var e=d.getAttribute("FilterLink"),f=escapeProperly(filterTable.getAttribute("Name")),b="",c=0,a;do{c++;a=e.match("FilterField"+c+"=[^&]*&FilterValue"+c+"=[^&]*");if(a!=null)b=b+"&"+a}while(a);return b}function IsFieldNotFilterable(a){ULSrLq:;if(a.getAttribute("Filterable")=="FALSE"||a.getAttribute("FilterDisable")=="TRUE"||a.getAttribute("FieldType ")=="Note"||a.getAttribute("FieldType ")=="URL")return true;return false}function addFilteringDisabledMenuItem(b){ULSrLq:;var a=filterTable.getAttribute("FilterDisableMessage");if(a==null||a.length==0)a=L_NotFilterable_Text;var c=CAMOpt(b,a,"");c.setAttribute("enabled","false");FilterOMenu(b,filterTable);b._onDestroy=OnMouseOutFilter}function addFilterMenuItems(m,j){ULSrLq:;if(IsFieldNotFilterable(filterTable)){addFilteringDisabledMenuItem(m);return}var d=document.getElementById("FilterIframe"+filterTable.getAttribute("CtxNum"));if(d==null)return;var c=d.getAttribute("FilterLink");if(!c||c=="")c=CanonicalizeUrlEncodingCase(window.location.href);var g=escapeProperly(filterTable.getAttribute("Name"));strFilteredValue=null;var a="",e=0,b,f;do{e++;b=c.match("FilterField"+e+"=[^&#]*");f=c.match("&FilterValue"+e+"=[^&#]*");if(b!=null&&f!=null){if(strFilteredValue==null)strFilteredValue=getFilterValueFromUrl(b.toString()+f.toString(),g);a=a+"&"+b+f;var p=c.match("&FilterOp"+e+"=[^&#]*");if(p!=null)a=a+p;var h=c.match("&FilterLookupId"+e+"=[^&#]*");if(h!=null)a=a+h;var l=c.match("&FilterData"+e+"=[^&#]*");if(l!=null)a=a+l;if(h!=null&&l==null&&strFilteredValue!=null){addFilteringDisabledMenuItem(m);return}}}while(b);var o=strFilteredValue!=null;strDisplayText=StBuildParam(L_DontFilterBy_Text,filterTable.getAttribute("DisplayName"));var q="javascript:HandleFilter(event, '"+STSScriptEncode(FilterFieldV3(ctxFilter.view,g,"",0,true))+"')",k;if(o)k=ctxFilter.imagesPath+"FILTEROFF.gif";else k=ctxFilter.imagesPath+"FILTEROFFDISABLED.gif";CAMOptFilter(m,j,strDisplayText,q,k,o,"fmi_clr");var r=CAMOpt(j,L_Loading_Text,"");r.setAttribute("enabled","false");setTimeout("ShowFilterLoadingMenu()",500);j._onDestroy=OnMouseOutFilter;b=c.match("MembershipGroupId=[^&]*");if(b!=null)a=a+"&"+b;b=c.match("InstanceID=[^&]*");if(b!=null)a=a+"&"+b;if(a!=null&&a.length>0){if(ctxFilter.overrideFilterQstring!=null&&ctxFilter.overrideFilterQstring.length>0)a="&"+ReconcileQstringFilters(a.substring(1),ctxFilter.overrideFilterQstring)}else if(ctxFilter.overrideFilterQstring!=null&&ctxFilter.overrideFilterQstring.length>0)a="&"+ctxFilter.overrideFilterQstring;var i="";if(ctxFilter!=null&&ctxFilter.clvp!=null&&ctxFilter.clvp.rootFolder!=null&&ctxFilter.clvp.rootFolder.length>0)i="&RootFolder="+escapeProperlyCore(ctxFilter.clvp.rootFolder,true);else{b=c.match("RootFolder=[^&]*");if(b!=null)i="&"+b}var n="";b=a.match("OverrideScope=[^&]*");if(ctxFilter!=null&&typeof ctxFilter.overrideScope!="undefined"&&b==null)n="&OverrideScope="+escapeProperlyCore(ctxFilter.overrideScope);if(browseris.safari){d.src="/_layouts/blank.htm";d.style.offsetLeft="-550px";d.style.offsetTop="-550px";d.style.display="block"}d.src=ctxFilter.HttpRoot+"/_layouts/filter.aspx?ListId="+ctxFilter.listName+i+n+"&FieldInternalName="+g+"&ViewId="+ctxFilter.view+"&FilterOnly=1&Filter=1"+a;bMenuLoadInProgress=true}function getFilterValueFromUrl(b,f){ULSrLq:;var a,c,e;a=b.indexOf("=");if(a==-1)return;c=b.indexOf("&");if(c==-1)return;if(c<a)return;b=CanonicalizeUrlEncodingCase(b);e=b.substring(a+1,c);if(e==f){var d;a=b.indexOf("=",c+1);if(a==-1)return;d=b.substr(a+1);d=unescapeProperly(d);return d}return null}function _OnIframeLoad(){ULSrLq:;bMenuLoadInProgress=false;if(filterTable!=null&&filterTable.getAttribute("Name")!=null){var c=null;c=document.getElementById("FilterIframe"+filterTable.getAttribute("CtxNum"));if(c!=null){var a=null,e=filterTable.getAttribute("Name");if(c.contentDocument)a=c.contentDocument;else if(c.contentWindow&&c.contentWindow.document)a=c.contentWindow.document;else if(c.document)a=c.document;if(a!=null){var g=a.getElementById("diidFilterCustomTable");if(g!=null&&(a.parentWindow&&a.parentWindow.CustomPopulateFilterMenu!=null||a.defaultView&&a.defaultView.CustomPopulateFilterMenu!=null))if(a.parentWindow)a.parentWindow.CustomPopulateFilterMenu(currentFilterMenu,g,"FilterIframe"+filterTable.getAttribute("CtxNum"),ctxFilter.view,e);else a.defaultView.CustomPopulateFilterMenu(currentFilterMenu,g,"FilterIframe"+filterTable.getAttribute("CtxNum"),ctxFilter.view,e);else{var h=a.getElementById("diidFilter"+e);e=escapeProperly(e);if(h!=null){var i=h.childNodes.length;if(i>500)addFilterOptionMenuItem();else for(var d=h.childNodes,b=1;b<i;b++){var f;if(d[b].innerText)f=d[b].innerText;else if(d[b].textContent)f=d[b].textContent;else f=d[b].innerHTML;var j="javascript:HandleFilter(event, '"+STSScriptEncode(FilterFieldV3(ctxFilter.view,e,d[b].value,b,true))+"')",k=CAMOpt(currentFilterMenu,f,j);strFilteredValue!=null&&strFilteredValue==d[b].value&&k.setAttribute("checked","true")}}else{alert(L_FilterThrottled_Text);return}}bIsFilterDataLoaded=true;if(loadingFilterMenu!=null)loadingFilterMenu._onDestroy=null;if(currentFilterMenu!=null){currentFilterMenu._onDestroy=OnMouseOutFilter;FilterOMenu(currentFilterMenu,filterTable)}}}}}function addFilterOptionMenuItem(){ULSrLq:;var a=window.location.href;a=StURLSetVar2(a,"Filter","1");a=StURLSetVar2(a,"View",ctxFilter.view);a="javascript:SubmitFormPost('"+a+"')";CAMOpt(currentFilterMenu,L_FilterMode_Text,a)}function OnMouseOverAdHocFilterDeferCall(f,e){ULSrLq:;filterStr=e;if(IsFilterMenuOn())return false;filterTable!=null&&OnMouseOutFilter();filterTable=f;var d=filterTable.tagName=="TABLE";if(d){filterTable.className="ms-selectedtitle";filterTable.onclick=CreateFilterMenu;filterTable.oncontextmenu=CreateFilterMenu;filterTable.onmouseout=OnMouseOutFilter}else{var a=filterTable.parentNode;a.onclick=CreateFilterMenu;a.oncontextmenu=CreateFilterMenu;a.onmouseout=OnMouseOutFilter;CreateCtxImg(a,OnMouseOutFilter)}if(d){var c=filterTable.childNodes[0].childNodes[0];filterImageCell=c.childNodes[c.childNodes.length-1];var b=filterImageCell.childNodes[0];b.src="/_layouts/images/menudark.gif";b.alt=L_OpenMenu_Text;b.style.visibility="visible";if(IsElementRtl(filterTable)){filterImageCell.style.right=null;filterImageCell.style.left="1px"}else{filterImageCell.style.left=null;filterImageCell.style.right="1px"}filterImageCell.className="ms-menuimagecell"}return true}function addAdHocFilterMenuItems(b,a){ULSrLq:;if(IsFieldNotFilterable(filterTable)){addFilteringDisabledMenuItem(b);return}var c=CAMOpt(a,L_Loading_Text,"");c.setAttribute("enabled","false");FilterOMenu(a,filterTable);a._onDestroy=OnMouseOutFilter;DoCallBack("__filter={"+filterStr+"}");filterStr=null}function UpdateFilterCallback(b){ULSrLq:;var i="</OPTION>",a=-1;a=b.indexOf(i,a+1);var c=b.lastIndexOf(">",a),l=StBuildParam(L_DontFilterBy_Text,strFieldName),h,e="";if(c<a-1){var d=b.lastIndexOf('"',a);if(d>0){var g=b.lastIndexOf('"',d-1);if(g>0)e=b.substring(g+1,d)}}if(c==a-1)h="/_layouts/images/FILTEROFFDISABLED.gif";else h="/_layouts/images/FILTEROFF.gif";if(a>0){var j=CAMOpt(currentFilterMenu,l,e,h);j.setAttribute("enabled",c==a-1?"false":"true");var d=a,m='<OPTION href="';a=b.indexOf(i,a+8);while(a>0){c=b.indexOf(m,d+8);c=b.indexOf('"',c+20);if(c>0&&c<a){var k=b.indexOf(">",c),f=b.substring(k+1,a),e="";d=b.lastIndexOf('"',c);if(d>0){var g=b.lastIndexOf('"',d-1);if(g>0){e=b.substring(g+1,d);e=e.replace(/&amp;/g,"&")}}if(f.length>40)f=f.substring(0,40)+"...";if(f.length>0){var j=CAMOpt(currentFilterMenu,f,e);k>c+1&&j.setAttribute("checked","true")}}d=a;a=b.indexOf(i,a+8)}}else{var j=CAMOpt(currentFilterMenu,L_NotFilterable_Text,"");j.setAttribute("enabled","false");FilterOMenu(currentFilterMenu,filterTable);return}loadingFilterMenu._onDestroy=null;FilterOMenu(currentFilterMenu,filterTable);currentFilterMenu._onDestroy=OnMouseOutFilter}function FilterOMenu(c,a){ULSrLq:;if(a==null)return;var b=a.tagName=="DIV"?a.parentNode:a;OMenu(c,b,null,null,-1)}function _OnClickFilter(d,b){ULSrLq:;if(FV4UI()){if(browseris.ie){b.cancelBubble=true;b.returnValue=false}else b.stopPropagation();var c;try{c=typeof inplview.OnClickFilterV4}catch(b){c="undefined"}if(c!="undefined")inplview.OnClickFilterV4(d);else{var i="inplview.OnClickFilterV4",g=i.split(".");if(g.length>1){var h=function(){ULSrLq:;inplview.OnClickFilterV4(d)};EnsureScript(g[0],c,h)}}return false}var e=FindSTSMenuTable(d,"CTXNum");if(e!=null&&e.getAttribute("SortFields")!=null){var f=e.getAttribute("SortFields"),a=GetUrlWithNoSortParameters(f);a=RemovePagingArgs(a);if(a.indexOf("?")<0)a+="?";else a+="&";SubmitFormPost(a+f)}if(!bIsFileDialogView)b.cancelBubble=true;return false}function ToggleSelectionAllUsers(b){ULSrLq:;var a=document.getElementById("spToggleUserSelectionCheckBox_"+b.toString());if(a!=null){var h="spUserSelectionCheckBox_"+b.toString(),e=document.getElementsByName(h);a.checked=!a.checked;for(var d=0;d<e.length;d++){var g=e[d];g.checked=a.checked}var f="cbxUserSelectAll"+b.toString(),c=document.getElementById(f);if(c!=null)if(a.checked)c.src="/_layouts/images/checkall.gif";else c.src="/_layouts/images/unchecka.gif"}}function _UserSelectionOnClick(j,c){ULSrLq:;var g="cbxUserSelectAll"+c.toString(),b=document.getElementById(g),a=document.getElementById("spToggleUserSelectionCheckBox_"+c.toString());if(!j.checked){if(a!=null)a.checked=false;if(b!=null)b.src="/_layouts/images/unchecka.gif"}else{for(var i="spUserSelectionCheckBox_"+c.toString(),f=document.getElementsByName(i),e=true,d=0;d<f.length;d++){var h=f[d];if(!h.checked){e=false;break}}if(e){if(b)b.src="/_layouts/images/checkall.gif";if(a)a.checked=true}}}function initPageRequestManagerForDFWP(){ULSrLq:;var a=Sys.WebForms.PageRequestManager.getInstance();a.add_beginRequest(hideMRBForRequest)}function hideMRBForRequest(d,c){ULSrLq:;var a=c.get_postBackElement();if(a==undefined)return;else if(a.value==undefined||a.value=="")return;var b=$get(a.value);if(b==undefined||b==null)return;hideMRB(b.parentElement)}function hideMRB(b){ULSrLq:;if(b==undefined||b==null)return;var a=b.all;for(i=0;i<a.length;i++)if(a[i].tagName=="IMG"){regEx=new RegExp("ManualRefresh","i");if(a[i].id!=undefined&&regEx.test(a[i].id)){hideElement(a[i]);break}}}function hideElement(a){ULSrLq:;if(a==null||a==undefined)return;a.style.visibility="hidden";a.style.display="none"}function MSOWebPartPage_GetLocalizedStrings(){ULSrLq:;var L_ResetPagePersonalizationDialog_TXT="You are about to reset all personalized Web Parts to their shared values and delete any private Web Parts. Click OK to complete this operation. Click Cancel to keep your personalized Web Part settings and private Web Parts.",L_ResetPartPersonalizationDialog_TXT="Resetting this Web Part will cause you to lose any changes you made.  Are you sure you want to do this? To reset this Web Part, click OK. To keep your changes, click Cancel.",L_RemoveConnection_TXT="Are you sure you want to remove the connection between the %0 Web Part and the %1 Web Part? To remove the connection, click OK. To keep the connection, click Cancel.",L_ExportPersonalization_TXT="This Web Part Page has been personalized. As a result, one or more Web Part properties may contain confidential information. Make sure the properties contain information that is safe for others to read. After exporting this Web Part, view properties in the Web Part description file (.webpart or .dwp) by using a text editor, such as Microsoft Notepad.",L_GetPropertiesFailure_ERR="Cannot retrieve properties at this time.",L_SaveDirtyParts_TXT="Changes have been made to the contents of one or more Web Parts on this page. To save the changes, press OK.  To discard the changes, press Cancel.",L_ToolPaneWidenToolTip_TXT="Widen",L_ToolPaneShrinkToolTip_TXT="Narrow",L_ToolPartExpandToolTip_TXT="Expand Toolpart: %0",L_ToolPartCollapseToolTip_TXT="Collapse Toolpart: %0",L_WebPartBackgroundColor_TXT="Web Part Background Color",L_TransparentTooltip_TXT="Transparent Web Part Background Color",L_InvalidURLPath_ERR="The URL is not valid for the %0 property. Check the URL spelling and path and try again.",L_InvalidFolderPath_ERR="The path to the folder is not valid for the %0 property. Check the path name and try again.",L_InvalidFilePath_ERR="The path to the file or folder is not valid. Check the path and try again.",L_FileOrFolderUnsupported_ERR="The current browser does not support links to files or folders. To specify a link to a file or folder, you must use Microsoft Internet Explorer 5.0 or later",L_Link_TXT="Link",L_TransparentLiteral_TXT="Transparent",L_ContentEditorSaveFailed_ERR="Cannot save your changes.",L_AccessDenied_ERR="Access Denied saving Web Part properties: either the Web Part is embedded directly in the page, or you do not have sufficient permissions to save properties.",L_NoInitArgs_ERR="Cannot create or modify the connection. One of the Web Parts does not have any data fields.",L_PageNotYetSaved_ERR="page not yet saved",a={};a.ResetPagePersonalizationDialogText=L_ResetPagePersonalizationDialog_TXT;a.ResetPartPersonalizationDialogText=L_ResetPartPersonalizationDialog_TXT;a.RemoveConnection=L_RemoveConnection_TXT;a.ExportPersonalizationDialogText=L_ExportPersonalization_TXT;a.GetPropertiesFailure=L_GetPropertiesFailure_ERR;a.SaveDirtyPartsDialogText=L_SaveDirtyParts_TXT;a.ToolPaneWidenToolTip=L_ToolPaneWidenToolTip_TXT;a.ToolPaneShrinkToolTip=L_ToolPaneShrinkToolTip_TXT;a.ToolPartExpandToolTip=L_ToolPartExpandToolTip_TXT;a.ToolPartCollapseToolTip=L_ToolPartCollapseToolTip_TXT;a.WebPartBackgroundColor=L_WebPartBackgroundColor_TXT;a.TransparentTooltip=L_TransparentTooltip_TXT;a.InvalidURLPath=L_InvalidURLPath_ERR;a.InvalidFolderPath=L_InvalidFolderPath_ERR;a.InvalidFilePath=L_InvalidFilePath_ERR;a.FileOrFolderUnsupported=L_FileOrFolderUnsupported_ERR;a.Link=L_Link_TXT;a.TransparentLiteral=L_TransparentLiteral_TXT;a.ContentEditorSaveFailed=L_ContentEditorSaveFailed_ERR;a.AccessDenied=L_AccessDenied_ERR;a.NoInitArgs=L_NoInitArgs_ERR;a.PageNotYetSaved=L_PageNotYetSaved_ERR;return a}var MSOStrings=MSOWebPartPage_GetLocalizedStrings(),L_AccessibleMenu_Text="Menu";typeof Sys!="undefined"&&Sys&&Sys.Application&&Sys.Application.notifyScriptLoaded();typeof NotifyScriptLoadedAndExecuteWaitingJobs!="undefined"&&NotifyScriptLoadedAndExecuteWaitingJobs("msstring.js");function FNEmpWz(a){ULSrLq:;return a&&a!=""}function AChld(b,a){ULSrLq:;b&&a&&b.appendChild(a)}function AImg(a,c,b){ULSrLq:;if(!a)return;FNEmpWz(c)&&a.setAttribute("iconSrc",c);if(FNEmpWz(b))a.setAttribute("iconAltText",b);else a.setAttribute("iconAltText","")}function CMenu(b){ULSrLq:;var a=document.getElementById(b);if(a){a._initialized=false;a._oContents=null;a.innerHTML="";return a}a=document.createElement("MENU");if(!a)return null;if(b)a.id=b;a.className="ms-SrvMenuUI";AChld(document.body,a);return a}function CMItm(b){ULSrLq:;var a=document.createElement("SPAN");if(!a)return null;a.setAttribute("type",b);return a}function SetInnerText(a,b){ULSrLq:;if(document.createTextNode!=null){var c=document.createTextNode(b);a.innerHTML="";a.appendChild(c)}else a.innerText=b}function CMOpt(f,g,e,d,c,b){ULSrLq:;var a=CMItm("option");if(!a)return null;a.setAttribute("text",f);a.setAttribute("onMenuClick",g);b&&a.setAttribute("description",b);AImg(a,e,d);FNEmpWz(c)&&a.setAttribute("sequence",c);return a}function CAMOpt(h,f,g,e,c,d,b){ULSrLq:;var a=CMOpt(f,g,e,c,d,b);if(!a)return null;AChld(h,a);return a}function CIMOpt(c,h,i,g,f,d){ULSrLq:;var a=CMOpt(h,i,g,f,d);if(!a)return null;for(var b=0;b<c.childNodes.length;b++){var e=c.childNodes[b].getAttribute("sequence");if(e)if(e>d){c.childNodes[b].parentNode.insertBefore(a,c.childNodes[b]);return a}}AChld(c,a);return a}function CMSep(){ULSrLq:;var a=CMItm("separator");SetInnerText(a,"");return a}function CAMSep(b){ULSrLq:;var a=CMSep();if(!a)return null;AChld(b,a);return a}function CSubM(f,e,d,c,b){ULSrLq:;var a=CMItm("submenu");if(!a)return null;a.setAttribute("text",f);b&&a.setAttribute("description",b);AImg(a,e,d);FNEmpWz(c)&&a.setAttribute("sequence",c);return a}function CASubM(g,f,e,c,d,b){ULSrLq:;var a=CSubM(f,e,c,d,b);if(!a)return null;AChld(g,a);return a}function FRdy(a){ULSrLq:;if(!a)return false;if(a.readyState==null)return true;switch(a.readyState){case "loaded":case "interactive":case "complete":return true;default:return false}}function OMenu(a,e,c,d,b){ULSrLq:;if(typeof a=="string")a=document.getElementById(a);a&&OMenuInt(a,e,c,d,b);return false}function OMenuInt(a,e,b,d,c){ULSrLq:;(a&&!MenuHtc_isOpen(a)||a&&b)&&MenuHtc_show(a,e,b,d,c)}function OMenuEvnt(){ULSrLq:;var a=event.srcElement;if(a&&FRdy(document)&&FRdy(a)){var e=a.getAttribute("relativeTo"),c=a.getAttribute("forceRefresh"),d=a.getAttribute("flipTop"),b=a.getAttribute("yOffsetTop");e!=null&&a.removeAttribute("relativeTo");c!=null&&a.removeAttribute("forceRefresh");d!=null&&a.removeAttribute("flipTop");b!=null&&a.removeAttribute("yOffsetTop");a.onreadystatechange=null;OMenuInt(a,e,c,d,b)}}var kfnDisableEvent=new Function("return false"),g_menuHtc_lastMenu=null,g_uniqueNumber=0,g_MenuEndOfDOM=false;function RenderECBBackwardCompatibilityMode(a){ULSrLq:;g_MenuEndOfDOM=a}function IsAccessibilityFeatureEnabledProxy(){ULSrLq:;if(typeof IsAccessibilityFeatureEnabled!="undefined")return IsAccessibilityFeatureEnabled();return false}function MenuHtc_show(oMaster,oParent,fForceRefresh,fFlipTop,yOffset){ULSrLq:;if(!(browseris.ie55up||browseris.nav6up||browseris.safari125up))return false;MenuHtc_hide();MenuHtc_init(oMaster);oMaster._oParent=oParent;oMaster._fIsRtL=IsElementRtl(oMaster._oParent);if((browseris.ie||browseris.nav)&&IsAccessibilityFeatureEnabledProxy()){var menu=null;if(oParent.foa!=null){menu=byid(oParent.foa);if(menu==null)menu=eval(oParent.foa)}menu!=null&&menu.onblur!=null&&menu.onblur();RenderAccessibleMenu(oMaster,fForceRefresh);g_menuHtc_lastMenu=oMaster}else{SetBodyEventHandlers(null);AssureId(oParent);var result=ShowRoot(oMaster,oParent,fForceRefresh,fFlipTop,yOffset);g_menuHtc_lastMenu=oMaster;!(typeof _fV4UI!="undefined"&&_fV4UI)&&NavigateToMenu(oMaster);SetBodyEventHandlers(HandleDocumentBodyClick)}if(browseris.ie)if(window.event!=null)window.event.cancelBubble=true;return false}function MenuHtc_hide(){ULSrLq:;ClearTimeOutToHideMenu();var a=g_menuHtc_lastMenu;if(a!=null)if(a._accessibleMenu!=null)CloseAccessibleMenu(a);else HideMenu(a);g_menuHtc_lastMenu=null}function MenuHtc_isOpen(a){ULSrLq:;if(!a||!a._initialized)return false;var b=IsOpen(a);return b}function MenuHtc_item(a,c,b){ULSrLq:;MenuHtc_init(a);var d=GetItem(a,c,b);return d}function TrapMenuClick(a){ULSrLq:;if(a!=null)a.cancelBubble=true;return false}function SetBodyEventHandlers(a){ULSrLq:;document.body.onclick=a}function HandleDocumentBodyClick(){ULSrLq:;if(g_menuHtc_lastMenu!=null){var a=g_menuHtc_lastMenu;a!=null&&HideMenu(a)}return false}function GetEventPopup(b){ULSrLq:;var a=GetEventSrcElement(b);while(a!=null){if(a.master!=null)return a;a=a.parentNode}return null}function GetUniqueNumber(){ULSrLq:;g_uniqueNumber++;return g_uniqueNumber}function MenuHtc_init(a){ULSrLq:;if(a._initialized)return;a._initialized=true;a._wzPrefixID="mp"+GetUniqueNumber();if(a.id==null)a.id=a._wzPrefixID+"_id";a._nLevel=0;a._arrPopup=[];a._arrSelected=[];if(typeof a._onDestroy=="undefined")a._onDestroy=null;a._fLargeIconMode=false;a._fCompactItemsWithoutIcons=false}function PrepContents(a){ULSrLq:;a._fLargeIconMode=a.getAttribute("largeIconMode")=="true";a._fCompactItemsWithoutIcons=a.getAttribute("CompactMode")=="true";if(!browseris.safari){a._oContents=document.createElement("span");a._oContents.style.display="none";var b=a.innerHTML;if(b.indexOf("<IE:MENUITEM ")<0&&b.indexOf("<MENUITEM ")>=0){b="<?XML:NAMESPACE PREFIX=IE />"+b;b=b.replace(/<MENUITEM/g,"<IE:MENUITEM");b=b.replace(/<\/MENUITEM/g,"</IE:MENUITEM")}a._oContents.innerHTML=b}else{a._oContents=a.cloneNode(true);a._oContents.style.display="none"}if(a._fLargeIconMode)if(a._fIsRtL)a._wzMenuStyle="ms-MenuUILargeRtL";else a._wzMenuStyle="ms-MenuUILarge";else if(a._fIsRtL)a._wzMenuStyle="ms-MenuUIRtL";else a._wzMenuStyle="ms-MenuUI";a._wzChkMrkPath="/_layouts/images/ChkMrk.gif";a._wzMArrPath="/_layouts/images/MArr.gif";a._wzMArrPathRtL="/_layouts/images/MArrRtL.gif"}function FixUpMenuStructure(i){ULSrLq:;for(var g=i._oRoot.childNodes,f=null,a=null,d=false,c=0;c<g.length;c++){var b=g[c];if(b.nodeType!=1)continue;var e=false,j=b.style!=null&&b.style.display=="none",k=FIsIHidden(b);if(j||k)e=true;else if(FIsIType(b,"separator"))if(a!=null||c==0)e=true;else{a=b;d=true}else{var h=b.getAttribute("menuGroupId");if(h!=f&&a==null&&c!=0){var a=document.createElement("ie:menuitem");a.setAttribute("type","separator");i._oRoot.insertBefore(a,b)}else if(FIsIType(b,"submenu")&&a!=null&&!d){b.parentNode.removeChild(a);a=null}else a=null;f=h;d=false}if(e){b.parentNode.removeChild(b);c--}}a!=null&&a.parentNode.removeChild(a)}function IsElementRtl(a){ULSrLq:;while(a!=null&&a.tagName!=null){var b=a.getAttribute("dir");if((b==null||b=="")&&a.style!=null)b=a.style.direction;if(b=="rtl")return true;else if(b=="ltr")return false;a=a.parentNode}return false}function getElementOverFlowStyle(b){ULSrLq:;try{var a=b.currentStyle;if(a=="undefined"||a==null)return document.defaultView.getComputedStyle(b,null).getPropertyValue("overflow").toLowerCase();else return a.overflow.toLowerCase()}catch(c){return ""}}function AdjustScrollPosition(d,e,b){ULSrLq:;var a=d;while(a!=null&&a!=e&&a!=d.offsetParent&&a.tagName!=null&&a.tagName.toLowerCase()!="body"&&a.tagName.toLowerCase()!="html"&&!(getElementOverFlowStyle(a)=="hidden")){if(a.scrollWidth>a.clientWidth&&a.offsetWidth>=a.clientWidth&&a.clientWidth!=0)if(!IsElementRtl(a)){if(a.scrollLeft>0)b.x-=a.scrollLeft}else if(browseris.ie8standard)b.x+=a.scrollLeft;else if(browseris.firefox)b.x-=a.scrollLeft;else{var c=getElementOverFlowStyle(a);if(browseris.ie||browseris.safari&&(c=="auto"||c=="scroll"))b.x+=a.scrollWidth-a.clientWidth-a.scrollLeft}if(a.scrollTop>0)b.y-=a.scrollTop;a=a.parentNode}}function MenuHtc_GetElementPosition(a,d){ULSrLq:;var b={};b.x=0;b.y=0;b.width=0;b.height=0;if(a.offsetParent){var c=a;while(c!=null&&c!=d){b.x+=c.offsetLeft;b.y+=c.offsetTop;AdjustScrollPosition(c,d,b);var e=c.tagName.toLowerCase();if(e!="body"&&e!="html"&&c.clientTop!=null&&c.clientLeft!=null&&c!=a){b.x+=c.clientLeft;b.y+=c.clientTop}c=c.offsetParent}}else if(a.offsetLeft||a.offsetTop){b.x=a.offsetLeft;b.y=a.offsetTop}else{if(a.x)b.x=a.x;if(a.y)b.y=a.y}if(a.offsetWidth&&a.offsetHeight){b.width=a.offsetWidth;b.height=a.offsetHeight}else if(a.style&&a.style.pixelWidth&&a.style.pixelHeight){b.width=a.style.pixelWidth;b.height=a.style.pixelHeight}return b}function MenuTag(b,a){ULSrLq:;this.tagName=b;this.className=a}function CreateMenuTag(a){ULSrLq:;if(a.tagName!=null){var b=document.createElement(a.tagName);if(a.className!=null)b.className=a.className;return b}return null}function TransferEventToMenu(b,c){ULSrLq:;var a;if(browseris.ie)a={srcElement:b,keyCode:c.keyCode};else a={target:b,which:c.which};PopupKeyDown(a)}function MenuHtcInternal_Show(c,b,A,n){ULSrLq:;var e={};if(!(typeof _fV4UI!="undefined"&&_fV4UI)){e.popup=new MenuTag("div","ms-MenuUIPopupBody");e.inner=new MenuTag("div",null);e.section=new MenuTag("table",null);e.menubody=new MenuTag("tbody",null)}else{e.popup=new MenuTag("div","ms-MenuUIPopupBody ms-MenuUIPopupScreen");e.inner=new MenuTag("div","ms-MenuUIPopupInner");e.section=new MenuTag("div",null);e.menubody=new MenuTag("ul","ms-MenuUIUL")}var a=c._arrPopup[c._nLevel],i;!c._oContents&&PrepContents(c);if(!c._oContents||IsOpen(c))return;if(!a&&!c._oRoot){c._nLevel=0;c._oRoot=c._oContents}var g=c._nLevel==0;n=n&&g;if(!a){a=CreateMenuTag(e.popup);if(browseris.ie||browseris.safari)a.title="";else if(browseris.nav)a.title=" ";c._arrPopup[c._nLevel]=a;a.isMenu=true;a.master=c;a.level=c._nLevel;i=CreateMenuTag(e.inner);var h=CreateMenuTag(e.section),j=CreateMenuTag(e.menubody);i.isInner=true;a.style.position="absolute";if(c._fIsRtL)a.setAttribute("dir","rtl");else a.setAttribute("dir","ltr");a.style.visibility="hidden";i.style.overflow="visible";h.className=c._wzMenuStyle;if(!(typeof _fV4UI!="undefined"&&_fV4UI)){h.cellSpacing=0;h.cellPadding=0}h.appendChild(j);i.appendChild(h);a.appendChild(i);if(!(typeof _fV4UI!="undefined"&&_fV4UI)||g_MenuEndOfDOM==true)document.body.appendChild(a);else if(b.tagName=="TABLE")b.parentNode.appendChild(a);else b.appendChild(a);FixUpMenuStructure(c);for(var x=0,y=c._oRoot.childNodes.length,p=0;p<y;p++){var q=c._oRoot.childNodes[p];if(q.nodeType!=1)continue;if(!FIsIType(q,"label")){var v=CreateMenuItem(c,q,MakeID(c,c._nLevel,x));v&&j.appendChild(v);x++}}if(typeof _fV4UI!="undefined"&&_fV4UI&&!c._fLargeIconMode){for(var f=0,o=j.getElementsByTagName("a"),m=null,l=0,k=0;k<o.length;k++){l=o[k].childNodes[1].offsetWidth;if(l>f){m=k;f=l}}f=0;if(m==null)f=200;else for(var u=o[m],z=u.childNodes.length,r=0;r<z;r++)f+=u.childNodes[r].offsetWidth;f+=16+5;j.style.width=f+"px";h.style.width=f+4+"px"}a.oncontextmenu=kfnDisableEvent;a.ondragstart=kfnDisableEvent;a.onselectstart=kfnDisableEvent;if(b._onmouseover==null)b._onmouseover=b.onmouseover;if(b._onmouseout==null)b._onmouseout=b.onmouseout;if(b._onmousedown==null)b._onmousedown=b.onmousedown;if(b._onclick==null)b._onclick=b.onclick;if(b._oncontextmenu==null)b._oncontextmenu=b.oncontextmenu;if(typeof _fV4UI!="undefined"&&_fV4UI&&g)if(b._onkeydown==null)b._onkeydown=b.onkeydown;if(browseris.nav){a.onkeypress=function(){ULSrLq:;return false};a.onkeyup=function(){ULSrLq:;return false};a.onkeydown=function(a){ULSrLq:;PopupKeyDown(a);a.cancelBubble=true;return false};a.onmousedown=function(a){ULSrLq:;TrapMenuClick(a);return false};a.onmouseover=function(a){ULSrLq:;PopupMouseOver(a);return false};a.onmouseout=function(a){ULSrLq:;PopupMouseLeave(a);return false};a.onclick=function(a){ULSrLq:;PopupMouseClick(a);TrapMenuClick(a);return false};b.onmouseover=function(a){ULSrLq:;PopupMouseOverParent(a);return false};b.onmouseout=function(a){ULSrLq:;PopupMouseLeaveParent(a);return false};b.onmousedown=function(a){ULSrLq:;TrapMenuClick(a);return false};b.onclick=function(a){ULSrLq:;TrapMenuClick(a);return false};b.oncontextmenu=function(a){ULSrLq:;TrapMenuClick(a);return false};if(typeof _fV4UI!="undefined"&&_fV4UI&&g)b.onkeydown=function(b){ULSrLq:;TransferEventToMenu(a,b);return false}}else{a.onkeydown=new Function("PopupKeyDown(event); event.cancelBubble=true; return false;");a.onmousedown=new Function("TrapMenuClick(event); return false;");a.onmouseover=new Function("PopupMouseOver(event); return false;");a.onmouseout=new Function("PopupMouseLeave(event); return false;");a.onclick=new Function("PopupMouseClick(event); TrapMenuClick(event); return false;");b.onmouseover=new Function("PopupMouseOverParent(event); return false;");b.onmouseout=new Function("PopupMouseLeaveParent(event); return false;");b.onmousedown=new Function("TrapMenuClick(event); return false;");b.onclick=new Function("TrapMenuClick(event); return false;");b.oncontextmenu=new Function("TrapMenuClick(event); return false;");if(typeof _fV4UI!="undefined"&&_fV4UI&&g)b.onkeydown=function(){ULSrLq:;TransferEventToMenu(a,event);return false}}if(g){var t=c.getAttribute("onunloadtext");if(t)a.onunload=new Function(t)}}else{var w=c._arrSelected[c._nLevel];w&&UnselectItem(w)}c._arrSelected[c._nLevel]=null;var d;if(browseris.ie){var s=document.body.scrollLeft;d=document.createElement("iframe");AssureId(d);d.src="/_layouts/blank.htm";d.style.position="absolute";d.style.display="none";d.scrolling="no";d.frameBorder="0";if(!(typeof _fV4UI!="undefined"&&_fV4UI)||g_MenuEndOfDOM==true)document.body.appendChild(d);else if(b.tagName=="TABLE")b.parentNode.appendChild(d);else b.appendChild(d);a.style.zIndex=103;a._backgroundFrameId=d.id;if(s!=document.body.scrollLeft)document.body.scrollLeft=s}SetMenuPosition(c,b,a,i,n,g);a.style.visibility="visible";if(browseris.ie){SetBackFrameSize(null,a);a.onresize=new Function("SetBackFrameSize(event, null);");d.style.display="block";d.style.zIndex=101}}function SetMenuPosition(D,H,d,g,M,z){ULSrLq:;var h=window.screen.width,j=window.screen.height;if(self.innerHeight){h=self.innerWidth;j=self.innerHeight}else if(document.documentElement&&document.documentElement.clientHeight){h=document.documentElement.clientWidth;j=document.documentElement.clientHeight}else if(document.body){h=document.body.clientWidth;j=document.body.clientHeight}var c=d.offsetWidth,f=d.offsetHeight,G=false,x=false;if(c>h-50){G=true;c=h-50<0?0:h-50}if(D._fCompactItemsWithoutIcons&&f>=375){x=true;f=375}if(f>=j-50){x=true;f=j-50<0?0:j-50}if(!G&&!x)g.style.overflow="visible";else if(browseris.ie){if(G){d.style.width=c+"px";g.style.width=c+"px";g.style.overflowX="scroll"}else{g.style.width=c+"px";g.style.overflowX="visible"}if(x){d.style.height=f+"px";g.style.height=f+"px";g.style.overflowY="scroll"}else{g.style.height=f+"px";g.style.overflowY="visible"}}else{d.style.height=f+"px";g.style.height=f+"px";d.style.width=c+"px";g.style.width=c+"px";g.style.overflow="auto"}c=d.offsetWidth;f=d.offsetHeight;var A=0,y=h,a=0,O=0,r=0,s=H;if(browseris.safari)if(s.tagName=="TR"&&s.childNodes.length>0)s=s.childNodes[0];var t=MenuHtc_GetElementPosition(s);a=t.x;r=t.y;var k;if(z){k=t.width;r+=t.height}else k=t.width+1;var N=!M&&!document.body.getAttribute("flipped"),w,F,B,C;if(!D._fIsRtL){var u,q;if(z){B=a;u=a+c;q=a+k-c}else{B=a+k;u=a+k+c;q=a-c}C=q;w=u>y&&q>A;F=!(q<A&&u<y)}else{var p,v;if(z){p=a+k-c;v=a+c;C=a}else{p=a-c;v=a+k+c;C=a+k}B=p;w=p<A&&v<y;F=!(v>y&&p>A)}var l=N?w:F,E=l?C:B,i,n;if(browseris.firefox){i=window.pageXOffset;n=window.pageYOffset}else{var m=document.body.parentElement;if(!IsElementRtl(document.body)){i=document.body.scrollLeft;i+=m.scrollLeft}else if(browseris.ie8standard){i=-document.body.scrollLeft;i+=-m.scrollLeft}else{var I=getElementOverFlowStyle(document.body);if(browseris.ie||browseris.safari&&(I=="auto"||I=="scroll"))i=-document.body.scrollWidth+document.body.clientWidth+document.body.scrollLeft;i+=-m.scrollWidth+m.offsetWidth+m.scrollLeft}n=document.body.scrollTop;n+=m.scrollTop}if(c>=h)E=i;else if(E-i+c>=h)E=i+h-c;var o;if(f>=j)o=n;else if(r+f-n>=j)o=n+j-f;else o=r;if(browseris.safari)o+=window.pageYOffset;else o+=document.documentElement.scrollTop;d.setAttribute("flipped",M?l&&w:l);var b=E,e=o;if(browseris.safari)e-=window.pageYOffset;else e-=document.documentElement.scrollTop;if(typeof _fV4UI!="undefined"&&_fV4UI&&g_MenuEndOfDOM==false)if(!z){if(D._fIsRtL)if(browseris.ie)if(l)b=b-a;else b=b-a+1;else if(l)b=b-a;else b=b-a+3;else if(browseris.ie)if(l)b=b-a+1;else b=b-a;else if(l)b=b-a+3;else b=b-a;if(e==0)e=H.offsetTop-d.offsetParent.firstChild.scrollTop;else e=e-r+H.offsetTop-d.offsetParent.firstChild.scrollTop;if(browseris.ie8standard)e=e-1}else if(d.offsetParent!=null&&d.offsetParent.tagName.toLowerCase()!="body"){var J,K,L=MenuHtc_GetElementPosition(d.offsetParent);J=L.x;K=L.y;e=e-K;b=b-J;if(!D._fLargeIconMode)e=e-1}d.style.left=b+"px";d.style.top=e+"px";d.LeftForBackIframe=b;d.TopForBackIframe=e}function SetBackFrameSize(e,a){ULSrLq:;if(a==null)a=GetEventSrcElement(e);var d=a.offsetWidth,c=a.offsetHeight,b=document.getElementById(a._backgroundFrameId);if(b!=null){b.style.left=a.LeftForBackIframe+"px";b.style.top=a.TopForBackIframe+"px";b.style.width=d+"px";b.style.height=c+"px"}}function HideMenu(a,c){ULSrLq:;ClearTimeOutToHideMenu();if(c==null)c=0;if(c==2){if(a._onDestroy!=null){a._onDestroy();a._onDestroy=null}return}if(IsOpen(a)&&!IsAccessibilityFeatureEnabledProxy()){if(a._oParent!=null){a._oParent.onclick=a._oParent._onclick;a._oParent.onmouseover=a._oParent._onmouseover;a._oParent.onmouseout=a._oParent._onmouseout;a._oParent.onmousedown=a._oParent._onmousedown;a._oParent.oncontextmenu=a._oParent._oncontextmenu;if(typeof _fV4UI!="undefined"&&_fV4UI)a._oParent.onkeydown=a._oParent._onkeydown}SetBodyEventHandlers(null);UpdateLevel(a,0);var b=a._arrPopup[0];if(b!=null){var d=document.getElementById(b._backgroundFrameId);d!=null&&d.parentNode.removeChild(d);b.parentNode!=null&&b.parentNode.removeChild(b);a._arrPopup[0]=null;if(c==0)if(a._onDestroy!=null&&typeof a._onDestroy=="function"){a._onDestroy();a._onDestroy=null}}g_menuHtc_lastMenu=null;RenderECBBackwardCompatibilityMode(false)}}function IsOpen(a){ULSrLq:;if(a._accessibleMenuInProgress||a._accessibleMenu&&!a._accessibleMenu.closed)return true;if(!a._arrPopup)return false;var b=a._arrPopup[a._nLevel];return b}function FindLabel(d){ULSrLq:;var a=d?d.childNodes:null;if(a)for(var b=0;b<a.length;b++){var c=a[b];if(c.nodeType!=1)continue;if(FIsIType(c,"label"))return c}return null}function ShowRoot(a,b,f,d,e){ULSrLq:;UpdateLevel(a,0);if(f){a._oContents=null;a._oRoot=null;a._nLevel=0;a._arrPopup=[];a._arrSelected=[]}else a._oRoot=a._oContents;var c=0;if(b)c+=b.offsetHeight;if(browseris.safari)if(b.tagName=="TR"&&b.childNodes.length>0)c+=b.childNodes[0].offsetTop+b.childNodes[0].offsetHeight-b.offsetTop;if(e)c+=e;d=d!=false;MenuHtcInternal_Show(a,b,c,d)}function ShowSubMenu(a,c,b){ULSrLq:;if(!b)return;if(b.submenuRoot==null)return;UpdateLevel(a,c);a._oRoot=b.submenuRoot;a._nLevel=a._nLevel+1;MenuHtcInternal_Show(a,b,-1)}function ShowSubMenuEvnt(a){ULSrLq:;if(a!=null){var b=a._arrPopup[a._nLevel];if(b){b.removeAttribute("timeoutID");ShowSubMenu(a,a._nLevel,a._arrSelected[a._nLevel])}}}function SetShowSubMenuEvnt(a){ULSrLq:;var b=a._arrPopup[a._nLevel];if(b){ClearTimeOut("timeoutID");document.body.setAttribute("timeoutID",window.setTimeout(function(){ULSrLq:;ShowSubMenuEvnt(a)},100))}}function ClearTimeOut(a){ULSrLq:;var b=document.body.getAttribute(a);b!=null&&window.clearTimeout(b);document.body.removeAttribute(a)}function ClearShowSubMenuEvnt(){ULSrLq:;ClearTimeOut("timeoutID")}function GetEventSrcItem(d,b){ULSrLq:;var c=null;if(!(typeof _fV4UI!="undefined"&&_fV4UI))c="tr";else{if(b!=null&&FIStringEquals(b.tagName,"div")&&b.className.indexOf("ms-MenuUIPopupInner")!=-1)return null;c="li"}for(var a=b;a&&!FIStringEquals(a.tagName,"body");a=a.parentNode)if(FIStringEquals(a.tagName,c)&&a.id.substring(0,d._wzPrefixID.length)==d._wzPrefixID)return a;return null}function UpdateLevel(a,d){ULSrLq:;var b;while(a._nLevel>d){if(a._arrPopup!=null)b=a._arrPopup[a._nLevel];if(b){ClearShowSubMenuEvnt(b);var c=document.getElementById(b._backgroundFrameId);c!=null&&c.parentNode.removeChild(c);b.parentNode.removeChild(b)}a._arrPopup[a._nLevel]=null;a._arrSelected[a._nLevel]=null;a._oRoot=a._oRoot.parentNode;a._nLevel--}if(a._arrPopup!=null)b=a._arrPopup[a._nLevel];b&&ClearShowSubMenuEvnt(b)}function PopupMouseOver(e){ULSrLq:;var d=GetEventPopup(e);if(d!=null){var a=d.master,c=d.level;if(c<0)return;var b=GetEventSrcItem(a,GetEventSrcElement(e));if(b)if(b!=a._arrSelected[c]){if(FIsIType(b,"separator"))return;ToggleMenuItem(a,c,b);FIsIType(b,"submenu")&&EngageSelection(a,true,true,false)}else c<a._nLevel&&UnselectCurrentOption(a);ClearTimeOutToHideMenu()}}function PopupMouseLeave(b){ULSrLq:;var a;a=GetEventPopup(b);if(a!=null){UnselectCurrentOption(a.master);SetTimeOutToHideMenu()}return false}function PopupMouseOverParent(){ULSrLq:;if(g_menuHtc_lastMenu!=null){ClearTimeOutToHideMenu();g_menuHtc_lastMenu._oParent!=null&&g_menuHtc_lastMenu._oParent._onmouseover!=null&&typeof g_menuHtc_lastMenu._oParent._onmouseover=="function"&&g_menuHtc_lastMenu._oParent._onmouseover()}}function PopupMouseLeaveParent(){ULSrLq:;if(g_menuHtc_lastMenu!=null){g_menuHtc_lastMenu._oParent!=null&&g_menuHtc_lastMenu._oParent._onmouseout!=null&&typeof g_menuHtc_lastMenu._oParent._onmouseout=="function"&&g_menuHtc_lastMenu._oParent._onmouseout();SetTimeOutToHideMenu()}}function ClearTimeOutToHideMenu(){ULSrLq:;document.body.getAttribute("HideMenuTimeOut")!=null&&ClearTimeOut("HideMenuTimeOut")}function SetTimeOutToHideMenu(){ULSrLq:;ClearTimeOut("HideMenuTimeOut");document.body.setAttribute("HideMenuTimeOut",window.setTimeout(MenuHtc_hide,5e3))}function PopupMouseClick(a){ULSrLq:;var g=GetEventPopup(a),b=g.master,c=g.level;if(c<0)return;var h=b._arrSelected[c],e=GetEventSrcItem(b,GetEventSrcElement(a));if(h!=e)if(e)b._arrSelected[c]=e;UpdateLevel(b,c);var d,f;if(browseris.nav){f=a&&a.target&&a.target.className=="hierarchy";d=a&&a.target&&a.target.getAttribute("onExpand")}else{f=a&&a.srcElement&&a.srcElement.className=="hierarchy";d=a&&a.srcElement&&a.srcElement.getAttribute("onExpand")}EngageSelection(b,true,false,false,f,d)}function PopupKeyDown(c){ULSrLq:;var d=GetEventPopup(c),b=d.master,f=d.level;if(f<0)return;var a=GetEventKeyCode(c),e=c.shiftKey;if(b._fIsRtL)if(a==37)a=39;else if(a==39)a=37;if(a==9)a=!e?40:38;ClearShowSubMenuEvnt(d);switch(a){case 38:MoveMenuSelection(b,-1);break;case 40:MoveMenuSelection(b,1);break;case 37:case 27:CloseCurrentLevel(b,a==27);break;case 39:case 13:EngageSelection(b,a==13,false,true)}c.returnValue=false}function SetNewId(a){ULSrLq:;a.id="msomenuid"+GetUniqueNumber();return a.id}function AssureId(a){ULSrLq:;if(a.id==null||a.id=="")a.id="msomenuid"+GetUniqueNumber();return a.id}function NavigateToMenu(c){ULSrLq:;if(IsAccessibilityFeatureEnabledProxy())return;var b=null;b=c._arrPopup[c._nLevel].firstChild;AssureId(b);try{var a=b.firstChild.firstChild.firstChild;if(!(typeof _fV4UI!="undefined"&&_fV4UI))a.tabIndex=0;else a=a.getElementsByTagName("A")[0];if(a!=null)if(a.setActive!=null)a.setActive();else a.focus!=null&&a.focus()}catch(d){}}function ExecuteOnClick(fnOnClick,oMaster){ULSrLq:;try{if(browseris.safari)if(FIStringEquals(typeof fnOnClick,"string"))eval("var document=window.document; {"+fnOnClick+"}");else fnOnClick();else{if(FIStringEquals(typeof fnOnClick,"string"))fnOnClick=new Function("event","var document=window.document; {"+fnOnClick+"}");var oTemp=window.document.body.appendChild(window.document.createElement("span"));oTemp.master=oMaster;oTemp.onclick=fnOnClick;var evt,ctx=null;if(typeof currentCtx!="undefined"&&currentCtx!=null)ctx=currentCtx;else if(typeof ctxFilter!="undefined"&&ctxFilter!=null)ctx=ctxFilter;if(browseris.ie)evt={srcElement:oTemp,fakeEvent:1,currentCtx:ctx};else evt={target:oTemp,fakeEvent:1,currentCtx:ctx};oTemp.onclick(evt);oTemp.parentNode.removeChild(oTemp)}}catch(e){}}function EngageSelection(oMaster,fDoSelection,fDelayExpandSM,fEnterSM,fExpand,fCommand){ULSrLq:;var oItem=oMaster._arrSelected[oMaster._nLevel];if(!oItem||oItem.optionDisabled)return;if(FIsIType(oItem,"submenu"))if(fDelayExpandSM)SetShowSubMenuEvnt(oMaster);else{ShowSubMenu(oMaster,oMaster._nLevel,oItem);fEnterSM&&MoveMenuSelection(oMaster,1)}else if(fDoSelection){var fEnabled=oItem.getAttribute("enabled");if(fEnabled!="false")if(!fExpand){var fnOnClick=oItem.getAttribute("onMenuClick");if(fnOnClick){HideMenu(oMaster,1);ExecuteOnClick(fnOnClick,oMaster);HideMenu(oMaster,2)}}else eval(fCommand)}}function CloseCurrentLevel(oMaster,fAllowHideRoot){ULSrLq:;if(oMaster._nLevel>0){UpdateLevel(oMaster,oMaster._nLevel-1);var obj=oMaster._arrSelected[oMaster._nLevel];if(obj!=null&&obj.onclick!=null)obj.onclick=obj._onclick;if(obj!=null)if(!(typeof _fV4UI!="undefined"&&_fV4UI))if(browseris.nav){obj=obj.firstChild.firstChild.firstChild.firstChild.firstChild.nextSibling.firstChild.firstChild;obj.focus!=null&&obj.focus()}else obj.focus!=null&&obj.focus();else{obj=obj.getElementsByTagName("a")[0];if(obj!=null)if(obj.setActive!=null)obj.setActive();else obj.focus!=null&&obj.focus()}}else if(fAllowHideRoot){HideMenu(oMaster);var oParent=oMaster._oParent;while(oParent!=null&&oParent.tagName=="SPAN"&&oParent.getAttribute("contentEditable")=="true")oParent=oParent.parentElement;if(oParent!=null){var focusElement=oParent,foastr=oParent.getAttribute("foa");if(foastr!=null){var foa=null;foa=eval(foastr);if(foa==null)foa=byid(foastr);if(foa!=null)focusElement=foa}else if(focusElement.tagName!="A"){var anchorList=focusElement.getElementsByTagName("a"),anchorListLen=anchorList.length;if(anchorListLen>0)focusElement=anchorList[anchorListLen-1]}if(focusElement!=null)if(focusElement.setActive!=null)focusElement.setActive();else focusElement.focus!=null&&focusElement.focus()}}}function UnselectCurrentOption(a){ULSrLq:;if(a._nLevel>=0){var b=a._arrSelected[a._nLevel];if(FIsIType(b,"option")){UnselectItem(b);a._arrSelected[a._nLevel]=null}}}function MakeID(a,c,b){ULSrLq:;return a._wzPrefixID+"_"+c+"_"+b}function GetItem(a,b,c){ULSrLq:;var d=a._arrPopup[b];return d?document.getElementById(MakeID(a,b,c)):null}function MoveMenuSelection(b,g){ULSrLq:;var a=-1,d=b._oRoot.childNodes.length,f=b._arrSelected[b._nLevel];if(f){var e=f?f.id:null;if(e){var i=parseInt(e.substring(e.lastIndexOf("_")+1,e.length));a=(i+d+g)%d}}if(a<0)a=g>0?0:d-1;var c,h=a;do{c=GetItem(b,b._nLevel,a);a=(a+d+g)%d}while(a!=h&&(!c||c.style.display=="none"||!(FIsIType(c,"option")||FIsIType(c,"submenu"))));ToggleMenuItem(b,b._nLevel,c)}function ToggleMenuItem(d,e,a){ULSrLq:;var b=d._arrSelected[e];if(!a||b&&a.id==b.id)return;if(b){UnselectItem(b);b.onkeydown=null;b.onmousedown=null;b.onmouseover=null;b.onmouseout=null;b.oncontextmenu=null}UpdateLevel(d,e);SelectItem(a);d._arrSelected[e]=a;if(!(typeof _fV4UI!="undefined"&&_fV4UI)){a.tabIndex=0;if(a.setActive!=null)a.setActive();else a.focus!=null&&a.focus()}else{var c=a.firstChild.firstChild;if(c!=null)if(c.setActive!=null)c.setActive();else c.focus!=null&&c.focus()}}function SelectItem(b){ULSrLq:;if(!b)return;if(!(typeof _fV4UI!="undefined"&&_fV4UI)){var a=b.firstChild,d=a.firstChild;if(a.className=="ms-MenuUIItemTableCellCompact")a.className="ms-MenuUIItemTableCellCompactHover";else a.className="ms-MenuUIItemTableCellHover";d.className="ms-MenuUIItemTableHover"}else{var c=b.firstChild;if(c.className.indexOf("ms-MenuUISeparator")==-1)c.className="ms-MenuUIULItemHover"}}function UnselectItem(b){ULSrLq:;if(!b)return;if(!(typeof _fV4UI!="undefined"&&_fV4UI)){var a=b.firstChild,d=a.firstChild;if(a.className=="ms-MenuUIItemTableCellCompactHover")a.className="ms-MenuUIItemTableCellCompact";else a.className="ms-MenuUIItemTableCell";d.className="ms-MenuUIItemTable"}else{var c=b.firstChild;if(c.className.indexOf("ms-MenuUISeparator")==-1)c.className="ms-MenuUIULItem"}}function SetImageSize(c,b,a){ULSrLq:;if(a==null)if(c._fLargeIconMode)a=32;else a=16;b.width=a;b.height=a}function CreateMenuOption(e,l,d,D,C){ULSrLq:;var c={};if(!(typeof _fV4UI!="undefined"&&_fV4UI)){c.icon=new MenuTag("td",null);c.label=new MenuTag("td",null);c.accKey=new MenuTag("td",null);c.arrow=new MenuTag("td",null)}else{c.icon=new MenuTag("span",null);c.label=new MenuTag("span",null);c.accKey=new MenuTag("span",null);c.arrow=new MenuTag("span",null)}var f=null,m=CreateMenuTag(c.icon),b=CreateMenuTag(c.label),i=CreateMenuTag(c.accKey),p=CreateMenuTag(c.arrow);if(!(typeof _fV4UI!="undefined"&&_fV4UI)){l.appendChild(m);l.appendChild(b);l.appendChild(i);l.appendChild(p)}else{f=document.createElement("a");f.className="ms-MenuUIULLink";f.id=D+"_Anchor";f.appendChild(m);f.appendChild(b);f.appendChild(i);f.appendChild(p);if(!e._fIsRtL)i.style.cssFloat="left";else i.style.cssFloat="right";i.style.width="auto";f.href="javascript:;";f.setAttribute("onclick","return false;")}if(e._fLargeIconMode)m.className=!e._fIsRtL?"ms-MenuUIIconLarge":"ms-MenuUIIconLargeRtl";else m.className=!e._fIsRtL?"ms-MenuUIIcon":"ms-MenuUIIconRtL";m.align="center";if(e._fCompactItemsWithoutIcons&&!d.getAttribute("iconSrc"))b.className=!e._fIsRtL?"ms-menuuilabelcompact":"ms-menuuilabelcompactRtl";else b.className=!e._fIsRtL?"ms-MenuUILabel":"ms-MenuUILabelRtL";i.className="ms-MenuUIAccessKey";p.className="ms-MenuUISubmenuArrow";if(!e._fLargeIconMode)b.style.whiteSpace="nowrap";m.style.whiteSpace="nowrap";i.style.whiteSpace="nowrap";p.style.whiteSpace="nowrap";p.style.display="none";b.id=d.id;if(d.getAttribute("enabled")=="false"){l.disabled=true;if(!(typeof _fV4UI!="undefined"&&_fV4UI))b.className+=" ms-MenuUIItemTableCellDisabled"}var q=null,o=null;if(d.getAttribute("checked")=="true"){q=e._wzChkMrkPath;o="*"}else{q=EvalAttributeValue(d,"iconSrc","iconScript");o=d.getAttribute("iconAltText")}var s;if(C)s=C;else s="";var j=EvalAttributeValue(d,"text","textScript");if(j==null||j==""){var t=d.firstChild;if(t!=null&&t.nodeType==3)j=t.nodeValue}var x=EvalAttributeValue(d,"description","descriptionScript"),h=null;if(!(typeof _fV4UI!="undefined"&&_fV4UI))h=document.createElement("div");if(x!=null&&e._fLargeIconMode){var a=document.createElement("span"),u=document.createTextNode(j),E=document.createElement("br"),n=document.createElement("span"),y=document.createTextNode(x);a.style.whiteSpace="normal";n.className="ms-menuitemdescription";n.style.whiteSpace="normal";if(!(typeof _fV4UI!="undefined"&&_fV4UI)){h.appendChild(a);a.appendChild(u);h.appendChild(E);h.appendChild(n);n.appendChild(y)}else{b.appendChild(a);a.appendChild(u);b.appendChild(E);b.appendChild(n);n.appendChild(y)}}else if(j!=null){var a=document.createElement("span"),r=d.getAttribute("hierarchy");if(r!=null){var k=document.createElement("span");k.setAttribute("style","white-space: nowrap;");var B=d.getAttribute("onExpand");B!=null&&k.setAttribute("onExpand",B);k.className="hierarchy";if(!(typeof _fV4UI!="undefined"&&_fV4UI)){h.appendChild(k);k.innerHTML=r;a.setAttribute("style","white-space: nowrap;");h.appendChild(a);a.innerHTML=j}else{b.appendChild(k);k.innerHTML=r;a.setAttribute("style","white-space: nowrap;");b.appendChild(a);a.innerHTML=j}}else{var u=document.createTextNode(j);a.setAttribute("style","white-space: nowrap;");if(!(typeof _fV4UI!="undefined"&&_fV4UI))h.appendChild(a);else b.appendChild(a);a.appendChild(u)}}var v=document.createElement("span");v.innerHTML=s;if(!(typeof _fV4UI!="undefined"&&_fV4UI))h.appendChild(v);else b.appendChild(v);var A=D+"_ICON",g=document.createElement("img");g.className="ms-MenuUIULImg";SetImageSize(e,g);m.appendChild(g);g.id=A;if(!(typeof _fV4UI!="undefined"&&_fV4UI)){var w=document.createElement("LABEL");b.appendChild(w);w.htmlFor=A;w.appendChild(h)}if(q){g.src=q;g.alt=o?o:"";g.title=o?o:""}else{g.src="/_layouts/images/blank.gif";g.alt="";g.title=""}var z=d.getAttribute("accessKeyText");if(z)i.innerHTML=z;else i.style.display="none";SetIType(l,"option");typeof _fV4UI!="undefined"&&_fV4UI&&l.appendChild(f)}function CreateMenuSeparator(a,b){ULSrLq:;if(!(typeof _fV4UI!="undefined"&&_fV4UI)){var d=document.createElement("td"),c=document.createElement("div");b.appendChild(d);d.appendChild(c);if(a._fLargeIconMode)c.className=!a._fIsRtL?"ms-MenuUISeparatorLarge":"ms-MenuUISeparatorLargeRtl";else c.className=!a._fIsRtL?"ms-MenuUISeparator":"ms-MenuUISeparatorRtL";c.innerHTML="&nbsp;"}else{if(a._fLargeIconMode)b.className=!a._fIsRtL?"ms-MenuUISeparatorLarge":"ms-MenuUISeparatorLargeRtl";else b.className=!a._fIsRtL?"ms-MenuUISeparator":"ms-MenuUISeparatorRtL";b.innerHTML="&nbsp;"}SetIType(b,"separator")}function CreateSubmenu(c,b,e,g){ULSrLq:;var f=FindLabel(e);CreateMenuOption(c,b,e,g,f?f.innerHTML:null);var d=null;if(!(typeof _fV4UI!="undefined"&&_fV4UI))d=b.childNodes[3];else d=b.childNodes[0].childNodes[3];d.style.display="inline";var a=document.createElement("img");a.className="ms-MenuUIULImg";SetImageSize(c,a,16);d.appendChild(a);a.src=!c._fIsRtL?c._wzMArrPath:c._wzMArrPathRtL;a.alt=L_SubMenu_Text;a.title="";SetIType(b,"submenu");b.submenuRoot=e}function MergeAttributes(c,b){ULSrLq:;if(browseris.nav||c.mergeAttributes==null){for(var e=b.attributes,d=0;d<e.length;d++){var a=e[d];a!=null&&a.specified&&a.nodeName!="id"&&a.nodeName!="ID"&&a.nodeName!="name"&&c.setAttribute(a.nodeName,a.nodeValue)}b.getAttribute("type")!=null&&c.setAttribute("type",b.getAttribute("type"));if(b.submenuRoot!=null)c.submenuRoot=b.submenuRoot}else c.mergeAttributes(b)}function CreateMenuItem(g,c,h,n){ULSrLq:;if(FIsIType(c,"label"))return;var j={};if(!(typeof _fV4UI!="undefined"&&_fV4UI))j.menuitem=new MenuTag("tr",null);else j.menuitem=new MenuTag("div","ms-MenuUIULItem");var a=CreateMenuTag(j.menuitem);MergeAttributes(a,c);if(FIsIType(c,"separator"))if(!(typeof _fV4UI!="undefined"&&_fV4UI)){CreateMenuSeparator(g,a);return a}else{var b=document.createElement("li");MergeAttributes(b,a);CreateMenuSeparator(g,a);b.appendChild(a);b.id=h;return b}!GetIType(c)&&SetIType(c,"option");var d=null,f=null,e=null,i=null,b=null;if(!(typeof _fV4UI!="undefined"&&_fV4UI)){d=document.createElement("tr");f=document.createElement("td");e=document.createElement("table");i=document.createElement("tbody");d.appendChild(f);f.appendChild(e);e.appendChild(i);i.appendChild(a);if(g._fCompactItemsWithoutIcons&&!c.getAttribute("iconSrc"))f.className="ms-MenuUIItemTableCellCompact";else f.className="ms-MenuUIItemTableCell";e.className="ms-MenuUIItemTable";e.width="100%";e.cellSpacing=0;e.cellPadding=0;if(a.disabled==true||a.getAttribute("enabled")=="false")f.className+=" ms-MenuUIItemTableCellDisabled"}else{b=document.createElement("li");b.appendChild(a)}if(FIsIType(c,"submenu"))CreateSubmenu(g,a,c,h);else FIsIType(c,"option")&&CreateMenuOption(g,a,c,h,n);if(a.disabled==true||a.getAttribute("enabled")=="false"){a.disabled=false;a.className+=" ms-MenuUIDisabled";a.disabled=false;for(var m=a.childNodes.length,l=0;l<m;l++){var k=a.childNodes[l];if(k.nodeType!=1||k.tagName=="A")continue;k.disabled=true}a.optionDisabled=true}if(!(typeof _fV4UI!="undefined"&&_fV4UI)){MergeAttributes(d,a);if(a.optionDisabled!=null)d.optionDisabled=a.optionDisabled;d.id=h;SetIType(d,GetIType(a));return d}else{MergeAttributes(b,a);if(a.optionDisabled!=null)b.optionDisabled=a.optionDisabled;b.id=h;SetIType(b,GetIType(a));return b}}function GetItems(a){ULSrLq:;!a._oContents&&PrepContents(a);return a._oContents.childNodes}function GetIType(a){ULSrLq:;return a?a.getAttribute("type"):null}function FIsIType(b,a){ULSrLq:;return FIStringEquals(GetIType(b),a)}function SetIType(a,b){ULSrLq:;a&&a.setAttribute("type",b)}function FIStringEquals(a,b){ULSrLq:;return a!=null&&b!=null&&a.toLowerCase()==b.toLowerCase()}function RenderAccessibleMenu(a,c){ULSrLq:;if(c){a._oContents=null;a._oRoot=null;a._nLevel=0;a._arrPopup=[];a._arrSelected=[]}else a._oRoot=a._oContents;!a._oContents&&PrepContents(a);if(!a._oContents)return;if(!a._oRoot){a._nLevel=0;a._oRoot=a._oContents}FixUpMenuStructure(a);var d=a._fIsRtL?"rtl":"ltr";g_menuHtc_html="<html dir='"+d+"'><head><title>"+L_AccessibleMenu_Text+"</title></head><body><ul id='root'>";RenderMenuLevel(a,a._oRoot,true);g_menuHtc_html=g_menuHtc_html+"</ul></body></html>";a._accessibleMenuInProgress=true;var b=window.open("/_layouts/blank.htm","_blank","status=no,toolbar=no,menubar=no,location=no");a._accessibleMenu=b;b.document.write(g_menuHtc_html);b.document.close();b.onunload=MenuHtc_hide;b.focus()}function CloseAccessibleMenu(a,b){ULSrLq:;if(b==null)b=0;if(a!=null){a._accessibleMenuInProgress=false;if(b==0||b==1)if(a._accessibleMenu!=null){a._accessibleMenu.close();try{a._accessibleMenu.opener!=null&&a._accessibleMenu.opener.focus()}catch(c){}a._accessibleMenu=null}if(b==0||b==2)if(a._onDestroy!=null){a._onDestroy();a._onDestroy=null}}}function GetMenuItemText(d,b,a){ULSrLq:;if(a==""){a=EvalAttributeValue(b,"text","textScript");var c=EvalAttributeValue(b,"description","descriptionScript");if(c!=null&&c!=""&&d._fLargeIconMode){if(a!="")a=a+": ";a=a+c}}if(b.getAttribute("checked")=="true")a="* "+a;if(b.title!=null&&b.title!="")a=a+": "+b.title;return a}function GetMenuItemEnabled(a,b){ULSrLq:;if(!b)return false;if(a.getAttribute("enabled")=="false")return false;if(a.getAttribute("disabled")!=null&&a.getAttribute("disabled")!="")return false;return true}var g_menuHtc_html;function RenderMenuLevel(c,h,g){ULSrLq:;for(var d=0;d<h.childNodes.length;d++){var a=h.childNodes[d];if(a.nodeType!=1)continue;if(a.style.display=="none")continue;if(FIsIType(a,"option")){var f=GetMenuItemText(c,a,a.innerHTML.trim());if(!GetMenuItemEnabled(a,g))g_menuHtc_html=g_menuHtc_html+'<li><span id="'+a.id+'">'+f+"</span></li>";else g_menuHtc_html=g_menuHtc_html+'<li><a href="#" id="'+a.id+'" onMenuClick="'+a.getAttribute("onMenuClick")+'" onclick="javascript:opener.ExecuteOnAccessibleClick(this.getAttribute(\'onMenuClick\')); return false;">'+f+"</a></li>"}else if(FIsIType(a,"submenu")){var f=GetMenuItemText(c,a,"");g_menuHtc_html=g_menuHtc_html+'<li><span id="'+a.id+'">'+f;for(var e=0;e<a.childNodes.length;e++){var b=a.childNodes[e];if(b.nodeType!=1)continue;if(b.style.display=="none")continue;if(FIsIType(b,"label")){g_menuHtc_html=g_menuHtc_html+" "+b.innerHTML;break}}g_menuHtc_html=g_menuHtc_html+"</span><ul>";RenderMenuLevel(c,a,GetMenuItemEnabled(a,g));g_menuHtc_html=g_menuHtc_html+"</ul></li>"}}}function ExecuteOnAccessibleClick(b){ULSrLq:;var a=g_menuHtc_lastMenu;if(a!=null){CloseAccessibleMenu(a,1);ExecuteOnClick(b,a);CloseAccessibleMenu(a,2)}}function FIsIHidden(oItem){ULSrLq:;if(oItem){var hiddenFunc=oItem.getAttribute("hidden");if(!hiddenFunc)return false;return eval(hiddenFunc)}else return false}function EvalAttributeValue(oNode,sAttribute1,sAttribute2){ULSrLq:;var result=oNode.getAttribute(sAttribute2);if(result!=null&&result.toLowerCase().indexOf("javascript:")==0){result=eval(result.substring(11));if(result!=null&&result!="")return result}var result=oNode.getAttribute(sAttribute1);if(result==null)return "";return result}var MMU_chDelim=",",MMU_chDelimEnc="%2c",MMU_postbackPrefix="javascript:__doPostBack(",MMU_chDelim2="%",MMU_chDelim2Enc="%25";function MHash_New(){ULSrLq:;var a={};a._keys=[];a._values=[];return a}function MHash_Add(a,c,b){ULSrLq:;a._keys.push(c);a._values.push(b)}function MHash_Count(a){ULSrLq:;return a._keys.length}function MHash_Keys(a){ULSrLq:;return a._keys}function MHash_Values(a){ULSrLq:;return a._values}function MHash_Exists(b,c){ULSrLq:;for(var a=0;a<b._keys.length;a++)if(b._keys[a]==c)return true;return false}function MHash_Item(b,c){ULSrLq:;for(var a=0;a<b._keys.length;a++)if(b._keys[a]==c)return b._values[a];return null}var MMU_reDelimEnc=new RegExp(MMU_chDelimEnc,"g"),MMU_reDelim2Enc=new RegExp(MMU_chDelim2Enc,"g"),MMU_reDelimDec=new RegExp(MMU_chDelim,"g"),MMU_reDelim2Dec=new RegExp(MMU_chDelim2,"g");function MMU_EncVal(a){ULSrLq:;return a.replace(MMU_reDelimDec,MMU_chDelimEnc).replace(MMU_reDelim2Dec,MMU_chDelim2Enc)}function MMU_DecVal(a){ULSrLq:;return a.replace(MMU_reDelim2Enc,MMU_chDelim2).replace(MMU_reDelimEnc,MMU_chDelim)}function MMU_ParseNV(h){ULSrLq:;var g=MHash_New(),c=h.split(MMU_chDelim);if(c!=null)for(var f=0;f<c.length;f++){var a=c[f],b=a.indexOf("=");if(b==0)continue;var e=null,d=null;if(b<0)e=a;else{e=a.substr(0,b);if(b<a.length-1)d=MMU_DecVal(a.substr(b+1));else d=""}MHash_Add(g,e,d)}return g}function MMU_ParseNVAttr(a,c){ULSrLq:;var b=a.getAttribute(c);if(b==null&&a.childNodes.length>0&&a.childNodes[0].nodeType==1)b=a.childNodes[0].getAttribute(c);if(b==null)return MHash_New();return MMU_ParseNV(b)}function MMU_ResetMenuState(f,h,i,g,b){ULSrLq:;for(var e=0;e<f.childNodes.length;e++){var a=f.childNodes[e];if(a.nodeType!=1)continue;var c=a.getAttribute("id");if(a!=null&&c!=null&&c.length>0){if(a.childNodes.length>0){MMU_ResetMenuState(a,h,i,g,b);continue}if(MHash_Exists(i,c))a.style.display="none";else{a.style.display="";var d=a.getAttribute("enabledOverride");if(d!=null&&d.length>0)a.setAttribute("enabled",d,0);else if(MHash_Exists(h,c))a.setAttribute("enabled","false",0);else{a.setAttribute("enabled","true",0);if(MHash_Exists(g,c))a.setAttribute("checked","true",0);else a.setAttribute("checked","false",0)}}MMU_ReplTokValAttr(a,"onMenuClick",b);MMU_ReplTokValAttr(a,"text",b);MMU_ReplTokValAttr(a,"description",b);MMU_ReplTokValVal(a,b)}}}function MMU_ReplTokValAttr(c,b,f){ULSrLq:;var a=c.getAttribute(b),d=c.getAttribute(b+"_Original");if(a!=null&&d==null&&MHash_Count(f)>0)c.setAttribute(b+"_Original",a,0);else if(a!=null&&d!=null&&a!=d)a=d;if(a==null||a.length<=0)return;var e=MMU_ReplTokVal(a,f);e!=a&&c.setAttribute(b,e,0)}function MMU_ReplTokValVal(c,e){ULSrLq:;if(c.nextSibling==null)return;var a=c.nextSibling.nodeValue,b=c.getAttribute("valOrig");if(a!=null&&b==null&&MHash_Count(e)>0){b=a;c.setAttribute("valOrig",b,0)}else if(a!=null&&b!=null&&a!=b)a=b;var d=MMU_ReplTokVal(a,e);if(a!=null&&d!=null&&d!=a)c.nextSibling.nodeValue=d}function MMU_ReplTokVal(a,b){ULSrLq:;if(a!=null&&a.indexOf("%")>=0&&b!=null&&MHash_Count(b)>0)for(var d=MHash_Keys(b),e=MHash_Values(b),c=0;c<d.length;c++){var f=d[c],g=e[c];a=a.replace("%"+f+"%",g)}return a}var g_MMU_HighlightedEcbTable=null,g_MMU_HighlightedEcbTableOpen=null,g_MMU_OpenTimeoutHandle=null;function MMU_Open(menu,ecbLink,e,fAlignRight,alignId,delay){ULSrLq:;IsFullNameDefined("CUI.PMetrics.perfMark")&&CUI.PMetrics.perfMark(CUI.PMarker.perfWSSMMUOpenStart);try{if(menu==null||ecbLink==null)return;if(ecbLink.getAttribute("suppressBubbleIfPostback")!=null&&e!=null&&e.srcElement!=null&&e.srcElement.href!=null&&e.srcElement.href.substr(0,MMU_postbackPrefix.length)==MMU_postbackPrefix){event.cancelBubble=true;return}ClearHighlightedEcbTableOpen();if(fAlignRight==null)fAlignRight=true;MMU_ResetMenuState(menu,MMU_ParseNVAttr(ecbLink,"menuItemsDisabled"),MMU_ParseNVAttr(ecbLink,"menuItemsHidden"),MMU_ParseNVAttr(ecbLink,"menuItemsChecked"),MMU_ParseNVAttr(ecbLink,"menuTokenValues"));var elemAlign=null;if(alignId!=null&&alignId.length>0)elemAlign=document.getElementById(alignId);if(elemAlign==null)elemAlign=document.getElementById(ecbLink.id+"_t");if(elemAlign==null)elemAlign=ecbLink;MMU_EcbHighlight(MMU_GetHighlightElement(ecbLink),true);var openMenuScript="MenuHtc_show(document.getElementById('"+menu.id+"'), document.getElementById('"+elemAlign.id+"'), true, "+fAlignRight+", null);";openMenuScript+="SetEcbMouseOutAndDestroy('"+menu.id+"');";if(delay!=null&&delay>0){openMenuScript+=" g_MMU_OpenTimeoutHandle=null;";g_MMU_OpenTimeoutHandle=window.setTimeout(openMenuScript,delay,"javascript")}else eval(openMenuScript);if(e!=null)e.cancelBubble=true}catch(ex){alert(L_Loading_Error_Text)}IsFullNameDefined("CUI.PMetrics.perfMark")&&CUI.PMetrics.perfMark(CUI.PMarker.perfWSSMMUOpenEnd)}function SetEcbMouseOutAndDestroy(a){ULSrLq:;if(g_MMU_HighlightedEcbTable!=null){g_MMU_HighlightedEcbTable.onmouseout=null;g_MMU_HighlightedEcbTableOpen=g_MMU_HighlightedEcbTable;document.getElementById(a)._onDestroy=ClearHighlightedEcbTableOpen}}function ClearHighlightedEcbTableOpen(){ULSrLq:;if(g_MMU_HighlightedEcbTableOpen!=null){MMU_EcbHighlight(g_MMU_HighlightedEcbTableOpen,false);g_MMU_HighlightedEcbTableOpen=null}}function MMU_EcbLinkOnFocusBlurDeferCall(d,c,a){ULSrLq:;if(a)c.onblur=a?new Function("MMU_EcbLinkOnFocusBlurDeferCall(null, this, false)"):null;if(g_MMU_HighlightedEcbTableOpen!=null)return;var b=document.getElementById(c.id+"_t");b!=null&&MMU_EcbHighlight(b,a)}function MMU_EcbTableMouseOverOutDeferCall(b,a){ULSrLq:;if(a){if(b==g_MMU_HighlightedEcbTableOpen)return;b.onmouseout=a?new Function("MMU_EcbTableMouseOverOut(this, false)"):null}MMU_EcbHighlight(b,a)}function MMU_EcbHighlight(a,b){ULSrLq:;if(a==null&&!b)a=g_MMU_HighlightedEcbTableOpen;if(a==null)return;if(b==null)b=false;var d=a.getAttribute("hoverActive"),c=a.getAttribute("hoverInactive");if(d==null)d="ms-selectedtitle";if(c==null)c="ms-unselectedtitle";if(b){a.className=d;g_MMU_HighlightedEcbTable=a}else a.className=c;var e=a.getAttribute("menuformat"),f=document.getElementById(a.id+"i");if(f!=null&&e!=null&&e=="ArrowOnHover")f.style.visibility=b?"visible":"hidden";if(!b)g_MMU_HighlightedEcbTable=null}function MMU_PopMenuIfShowingDeferCall(b){ULSrLq:;if(!IsAccessibilityFeatureEnabledProxy()&&g_menuHtc_lastMenu){var a=g_menuHtc_lastMenu.getAttribute("type");a&&a=="ServerMenu"&&b.onclick()}}function MMU_HandleArrowSplitButtonKeyDown(a,c,b){ULSrLq:;if(!a.shiftKey&&!a.altKey&&!a.ctrlKey&&GetEventKeyCode(a)==13)return;if(b)return MMU_EcbLinkOnKeyDown(byid(c),b,a)}function MMU_HandleArrowOnHoverKeyDown(c,b,a){ULSrLq:;if(!a.shiftKey&&!a.altKey&&!a.ctrlKey&&GetEventKeyCode(a)==13)return;if(b)return MMU_EcbLinkOnKeyDown(c,b,a)}function MMU_GetHighlightElement(b){ULSrLq:;var a=null;a=document.getElementById(b.id+"_t");if(a!=null)return a;else return b}var g_MMU_theFormActionAtPageLoad=null,g_MMU_theFormActionAtPreMenuOpen=null,g_MMU_Form0ActionAtPageLoad=null,g_MMU_Form0ActionAtPreMenuOpen=null;function MMU_CallbackPreMenuOpen(templateClientId,menuClientId,callbackEventReference,timeoutLength,timeoutMessage,e){ULSrLq:;try{g_MMU_theFormActionAtPreMenuOpen=theForm!=null?theForm.action:"null";g_MMU_Form0ActionAtPreMenuOpen=document.forms!=null&&document.forms.length>0?document.forms[0].action:"null";var menuTemplate=document.getElementById(templateClientId),menuLink=document.getElementById(menuClientId);if(menuLink.getAttribute("suppressBubbleIfPostback")!=null&&e!=null&&e.srcElement!=null&&e.srcElement.href!=null&&e.srcElement.href.substr(0,MMU_postbackPrefix.length)==MMU_postbackPrefix){event.cancelBubble=true;return}MMU_StopPendingTimerEventsFromCallback();MMU_RemoveCallbackItemsFromMenuTemplate(menuTemplate);var menu=document.getElementById(menuClientId);menu.setAttribute("callbackInProgress","true",0);var loadingMessageMenuItem=CAMOpt(menuTemplate,L_Loading_Text,"null");if(loadingMessageMenuItem!=null){loadingMessageMenuItem.setAttribute("callbackitem","true",0);loadingMessageMenuItem.setAttribute("enabled","false",0)}var callbackContext=templateClientId+";"+menuClientId+";"+timeoutMessage.replace(/;/g,"%semi%").replace(/\'/g,"%quot%");callbackEventReference=callbackEventReference.replace(/__CALLBACKCONTEXT__/g,callbackContext);eval(callbackEventReference);g_MMU_RequestTimeoutTimeoutHandle=window.setTimeout("MMU_CallbackErrHandler('timeout', '"+callbackContext+"')",timeoutLength,"javascript")}catch(ex){alert(L_Loading_Error_Text)}}var g_MMU_RequestTimeoutTimeoutHandle=null;function MMU_RemoveCallbackItemsFromMenuTemplate(b){ULSrLq:;try{for(var a=0;a<b.childNodes.length;a++){var c=b.childNodes[a];if(c.nodeType==1&&c.getAttribute("callbackitem")=="true"){b.removeChild(c);--a}}}catch(d){alert(L_Loading_Error_Text)}}function MMU_StopPendingTimerEventsFromCallback(){ULSrLq:;if(g_MMU_OpenTimeoutHandle!=null){window.clearTimeout(g_MMU_OpenTimeoutHandle);g_MMU_OpenTimeoutHandle=null}if(g_MMU_RequestTimeoutTimeoutHandle!=null){window.clearTimeout(g_MMU_RequestTimeoutTimeoutHandle);g_MMU_RequestTimeoutTimeoutHandle=null}}function MMU_UpdateMenuTemplateWithErrorItem(a,b){ULSrLq:;MMU_RemoveCallbackItemsFromMenuTemplate(a);var c=CAMOpt(a,b,"null");if(loadingMessageMenuItem!=null){loadingMessageMenuItem.setAttribute("callbackitem","true",0);loadingMessageMenuItem.setAttribute("enabled","false",0)}}function MMU_UpdateOpenedMenuWithErrorItem(c,a,b){ULSrLq:;MMU_UpdateMenuTemplateWithErrorItem(a,b);HideMenu(a);MMU_Open(a,c)}function MMU_CallbackHandler(l,k){ULSrLq:;MMU_StopPendingTimerEventsFromCallback();var j=MMU_ParseContext(k),c=document.getElementById(j.TemplateClientId);if(c==null){alert(L_Loading_Error_Text);return}var b=document.getElementById(j.MenuClientId);if(b==null){alert(L_Loading_Error_Text);return}var g="",i="",h="",f="",e="",a=l.split(MMU_chDelim);if(a==null||a.length!=5)e=MMU_GenerateErrorMenuItem(L_Loading_Error_Text);else{var d=new RegExp(MMU_chDelimEnc,"g");g=a[0].replace(d,MMU_chDelim);i=a[1].replace(d,MMU_chDelim);h=a[2].replace(d,MMU_chDelim);f=a[3].replace(d,MMU_chDelim);e=a[4].replace(d,MMU_chDelim)}b.setAttribute("menuItemsDisabled",g,0);b.setAttribute("menuItemsHidden",i,0);b.setAttribute("menuItemsChecked",h,0);b.setAttribute("menuTokenValues",f,0);MMU_RemoveCallbackItemsFromMenuTemplate(c);c.innerHTML=c.innerHTML+e;HideMenu(c);MMU_Open(c,b);b.setAttribute("callbackInProgress","",0)}function MMU_CallbackErrHandler(f,e){ULSrLq:;try{alert(L_Loading_Error_Text);var a=MMU_ParseContext(e),d=document.getElementById(a.TemplateClientId);if(d==null){alert(L_Loading_Error_Text);return}var b=document.getElementById(a.MenuClientId);if(b==null){alert(L_Loading_Error_Text);return}b.setAttribute("callbackInProgress","",0);var c=L_Loading_Error_Text;if(f=="timeout"&&a.TimeoutMessage!=null&&a.TimeoutMessage.length>0)c=a.TimeoutMessage;MMU_UpdateOpenedMenuWithErrorItem(b,d,c)}catch(g){alert(L_Loading_Error_Text)}}function MMU_ParseContext(c){ULSrLq:;try{var a={},b=c.split(";");a.TemplateClientId=b[0];a.MenuClientId=b[1];a.TimeoutMessage=b[2].replace(/%semi%/g,";").replace(/%quot%/g,"'");return a}catch(d){alert(L_Loading_Error_Text)}}var L_NewFormLibTb3_Text="The document(s) could not be merged.\nThe required application may not be installed properly, or the template for this document library cannot be opened.\n\nPlease try the following:\n1. Check the General Settings for this document library for the name of the template, and install the application necessary for opening the template. If the application was set to install on first use, run the application and then try creating a new document again.\n\n2.  If you have permission to modify this document library, go to General Settings for the library and configure a new template.",L_NewFormLibTb4_Text="Select the document(s) you want to merge, and then click 'Merge Selected Documents' on the toolbar.";function combineDocuments(k,j,g){ULSrLq:;fNewDoc=false;if(browseris.w3c&&!browseris.ie)document.all=document.getElementsByTagName("*");var a=true,b,c;try{var e=document.all.chkCombine;for(i=0;a&&i<e.length;i++)if(e[i].checked&&a){a=false;b=document.all.chkUrl[i].getAttribute("href");c=document.all.chkProgID[i].getAttribute("href")}}catch(d){}try{if(a&&document.all.chkCombine.checked){a=false;b=document.all.chkUrl.getAttribute("href");c=document.all.chkProgID.getAttribute("href")}}catch(d){}if(!a){var f=false;try{NewDocumentButton=new ActiveXObject(c);fNewDoc=NewDocumentButton!=null}catch(d){}if(!fNewDoc)alert(L_NewFormLibTb3_Text);else{try{f=NewDocumentButton.MergeDocuments(b,document.all.chkCombine,makeAbsUrl(g))}catch(h){}if(!f)alert(L_NewFormLibTb3_Text);else window.onfocus=RefreshOnFocus}}else alert(L_NewFormLibTb4_Text)}var L_NewFormLibTb5_Text="Select the document(s) you want to relink, and then click 'Relink Selected Documents' on the toolbar.",L_NewFormLibTb6_Text="Only 500 documents can be relinked at a time. Modify your selection and then try again.";function repairLinks(e,f,g){ULSrLq:;if(browseris.w3c&&!browseris.ie)document.all=document.getElementsByTagName("*");var b=0,d=document.all.SubmitRepairDocs;d.value="";for(var c=document.getElementsByTagName("input"),a=0;a<c.length;a++)if(c[a].id=="chkRepair")if(c[a].checked){d.value+=c[a].getAttribute("docID");d.value+=" ";b++}if(b>0&&b<=500){document.all.SubmitRepairRedirectList.value=f;document.all.SubmitRepairRedirectFolder.value=e;document.all.SubmitRepairDocsForm.action=g+"/submitrepair.aspx";document.all.SubmitRepairDocsForm.submit()}else alert(b==0?L_NewFormLibTb5_Text:L_NewFormLibTb6_Text)}function repairAllLinks(a,b,c){ULSrLq:;if(browseris.w3c&&!browseris.ie)document.all=document.getElementsByTagName("*");document.all.SubmitRepairDocs.value="*";document.all.SubmitRepairRedirectList.value=b;document.all.SubmitRepairRedirectFolder.value=a;document.all.SubmitRepairDocsForm.action=c+"/submitrepair.aspx";document.all.SubmitRepairDocsForm.submit()}function NavigateToManageCopiesPage(a,b){ULSrLq:;STSNavigate(a+"/_layouts/managecopies.aspx?ItemUrl="+b+"&Source="+GetSource())}var L_ViewVersion_Text="View",L_RestoreVersion_Text="Restore",L_DeleteVersion_Text="Delete",L_DenyVersion_Text="Reject this version",L_UnPublishVersion_Text="Unpublish this version";function AddVersionMenuItemsCore(b,c){ULSrLq:;if(currentItemID!=null){var f=currentItemID.toString();if(f.indexOf(".0.")>=0)return}if(!HasRights(0,64))return;var a,e=itemTable.getAttribute("isCur"),h=itemTable.getAttribute("Level"),g=itemTable.getAttribute("canViewProperty");if(currentItemFSObjType==null)currentItemFSObjType=GetAttributeFromItemTable(itemTable,"OType","FSObjType");if(g!="0"){a=CAMOpt(b,L_ViewVersion_Text,"javascript:ViewVersion()","");a.id="ID_ViewVersion"}if(HasRights(0,4)){a=CAMOpt(b,L_RestoreVersion_Text,"javascript:RestoreVersion()","");a.id="ID_RestoreVersion"}if(HasRights(0,128)&&e!="1"){a=CAMOpt(b,L_DeleteVersion_Text,"javascript:DeleteVersion()","");a.id="ID_DeleteVersion"}if(HasRights(0,16)&&HasRights(0,4))if((c.isModerated||c.EnableMinorVersions)&&currentItemFSObjType!=1&&(h==1&&e=="1")){var d=L_DenyVersion_Text;if(c.EnableMinorVersions)d=L_UnPublishVersion_Text;a=CAMOpt(b,d,"javascript:TakeOfflineVersion()","");a.id="ID_TakeOfflineVersion"}}function ViewVersion(){ULSrLq:;if(!IsContextSet())return;STSNavigate(itemTable.getAttribute("verUrl"))}var L_Version_Restore_Confirm_Text="You are about to replace the current version with the selected version.",L_Version_RestoreVersioningOff_Confirm_Text="Versioning is currently disabled. As a result, you are about to overwrite the current version. All changes to this version will be lost.",L_Version_NoRestore_Current_ERR="Cannot restore the current version.";function RestoreVersion(){ULSrLq:;if(!IsContextSet())return;var a=currentCtx;if(itemTable.getAttribute("isMostCur")!="0")alert(L_Version_NoRestore_Current_ERR);else{var b=a.HttpPath+"&op=Restore&ver="+itemTable.getAttribute("verId");if(confirm(a.verEnabled?L_Version_Restore_Confirm_Text:L_Version_RestoreVersioningOff_Confirm_Text)){window.frameElement&&window.frameElement.overrideDialogResult&&window.frameElement.overrideDialogResult(1);SubmitFormPost(b)}}}var L_Version_NoOffline_NonCurrent_ERR="You can only take offline the current published or approved version",L_Version_unpublish_Confirm_Text="Are you sure you want to unpublish this version of the document?",L_Version_deny_Confirm_Text="Are you sure you want to deny this version of the document?";function TakeOfflineVersion(){ULSrLq:;if(!IsContextSet())return;var b=currentCtx,a=L_Version_deny_Confirm_Text;if(b.EnableMinorVersions)a=L_Version_unpublish_Confirm_Text;if(itemTable.getAttribute("isCur")!="1"||itemTable.getAttribute("Level")!=1)alert(L_Version_NoOffline_NonCurrent_ERR);else confirm(a)&&SubmitFormPost(b.HttpPath+"&op=TakeOffline")}var L_Version_Delete_Confirm_Text="Are you sure you want to delete this version?",L_Version_Recycle_Confirm_Text="Are you sure you want to send this version to the site Recycle Bin?",L_Version_NoDelete_Current_ERR="You cannot delete the current checked in version, major version, or approved version.";function DeleteVersion(){ULSrLq:;if(!IsContextSet())return;var a=currentCtx;if(itemTable.getAttribute("isCur")!="0")alert(L_Version_NoDelete_Current_ERR);else{var b=a.HttpPath+"&op=Delete&ver="+itemTable.getAttribute("verId");confirm(a.RecycleBinEnabled?L_Version_Recycle_Confirm_Text:L_Version_Delete_Confirm_Text)&&SubmitFormPost(b)}}var L_Version_DeleteAll_Confirm_Text="Are you sure you want to delete all previous versions associated with this file?",L_Version_RecycleAll_Confirm_Text="Are you sure you want to send all previous versions associated with this file to the site Recycle Bin?",L_Version_DeleteAllMinor_Confirm_Text="Are you sure you want to delete all previous draft versions of this file?",L_Version_RecycleAllMinor_Confirm_Text="Are you sure you want to send all previous draft versions of this file to the site Recycle Bin?",L_Version_NoDeleteAll_None_ERR="There are no previous versions to delete.";function DeleteAllVersions(b,a){ULSrLq:;if(b<=1)alert(L_Version_NoDeleteAll_None_ERR);else confirm(a.RecycleBinEnabled?L_Version_RecycleAll_Confirm_Text:L_Version_DeleteAll_Confirm_Text)&&SubmitFormPost(a.HttpPath+"&op=DeleteAll")}function DeleteAllMinorVersions(b,a){ULSrLq:;if(b<=1)alert(L_Version_NoDeleteAll_None_ERR);else confirm(a.RecycleBinEnabled?L_Version_RecycleAllMinor_Confirm_Text:L_Version_DeleteAllMinor_Confirm_Text)&&SubmitFormPost(a.HttpPath+"&op=DeleteAllMinor")}function EditInGrid(b,a){ULSrLq:;EnsureListControl();if(fListControl){encViewId=escapeProperly(a);strDocUrl=b+"?ShowInGrid=True&View="+encViewId;pageView=GetUrlKeyValue("PageView",true);if(pageView!="")strDocUrl=strDocUrl+"&PageView="+pageView;showWebPart=GetUrlKeyValue("ShowWebPart",true);if(showWebPart!="")strDocUrl=strDocUrl+"&ShowWebPart="+showWebPart;viewId=GetUrlKeyValue("View",true);if(viewId==""||(viewId.toUpperCase()==a.toUpperCase()||viewId.toUpperCase()==encViewId.toUpperCase())){rootFolder=GetUrlKeyValue("RootFolder",true);if(rootFolder!="")strDocUrl=strDocUrl+"&RootFolder="+rootFolder}SubmitFormPost(strDocUrl)}else if(!fListErrorShown){alert(L_EditInGrid_Text);fListErrorShown=true}}function ExitGrid(e){ULSrLq:;var a,b,d,c;a=e;b=GetUrlKeyValue("PageView",true);d=GetUrlKeyValue("View",true);if(d!=""){a=a+"?View="+d;c=GetUrlKeyValue("RootFolder",true);if(c!="")a=a+"&RootFolder="+c;if(b!="")a=a+"&PageView="+b;showWebPart=GetUrlKeyValue("ShowWebPart",true);if(showWebPart!="")a=a+"&ShowWebPart="+showWebPart;a=a+"&ShowInGrid=HTML"}else{a=a+"?ShowInGrid=HTML";if(b!="")a=a+"&PageView="+b;showWebPart=GetUrlKeyValue("ShowWebPart",true);if(showWebPart!="")a=a+"&ShowWebPart="+showWebPart}SubmitFormPost(a)}function _AddSilverlightWebPart(d,b,a){ULSrLq:;var c=new _AddSilverlightWebPartPopupUI(d,b,a);c.show()}function _AddSilverlightWebPartPopupUI(c,b,a){ULSrLq:;this.item=c;this.zoneNum=b;this.zoneIndex=a}function _AddSilverlightWebPartPopupUI_show(){ULSrLq:;var b=this,c=function(){ULSrLq:;var a={};a.url=_spExternalApplicationRegistrationInformation.dialogUrl;a.width=_spExternalApplicationRegistrationInformation.dialogWidth;a.height=_spExternalApplicationRegistrationInformation.dialogHeight;a.dialogReturnValueCallback=Function.createDelegate(b,b.dialogCallback);SP.UI.ModalDialog.showModalDialog(a)},a;try{a=typeof SP.UI.ModalDialog.showModalDialog}catch(d){a="undefined"}EnsureScript("SP.js",a,c)}function _AddSilverlightWebPartPopupUI_dialogCallback(c,a){ULSrLq:;if(c==1){var b=WPAdder._getHiddenField("wpVal");if(b)if(a.applicationXml)b.value=a.applicationXml;else b.value=a.url;WPAdder.addItemToPage(this.item,this.zoneNum,this.zoneIndex)}}_AddSilverlightWebPartPopupUI.prototype.show=_AddSilverlightWebPartPopupUI_show;_AddSilverlightWebPartPopupUI.prototype.dialogCallback=_AddSilverlightWebPartPopupUI_dialogCallback;function _ConfigSilverlightWebpart(b,a,c,f,d){ULSrLq:;var e=new _ConfigSilverlightWebpartPopupUI(b,a,c,f,d);e.show()}function _ConfigSilverlightWebpartPopupUI(b,a,c,e,d){ULSrLq:;this.urlElementId=b;this.appXmlElementId=a;this.dialogUrl=c;this.dialogWidth=e;this.dialogHeight=d}function _ConfigSilverlightWebpartPopupUI_show(){ULSrLq:;var a=this,c=function(){ULSrLq:;var b={};b.url=a.dialogUrl;b.width=a.dialogWidth;b.height=a.dialogHeight;var c={};c.url=document.getElementById(a.urlElementId).value;c.applicationXml=document.getElementById(a.appXmlElementId).value;b.args=c;b.dialogReturnValueCallback=Function.createDelegate(a,a.dialogCallback);SP.UI.ModalDialog.showModalDialog(b)},b;try{b=typeof SP.UI.ModalDialog.showModalDialog}catch(d){b="undefined"}EnsureScript("SP.js",b,c)}function _ConfigSilverlightWebpartPopupUI_dialogCallback(c,b){ULSrLq:;if(c==1){var a=document.getElementById(this.urlElementId);if(a)if(b.url!=null)a.value=b.url;else a.value="";a=document.getElementById(this.appXmlElementId);if(a)if(b.applicationXml!=null)a.value=b.applicationXml;else a.value=""}}_ConfigSilverlightWebpartPopupUI.prototype.show=_ConfigSilverlightWebpartPopupUI_show;_ConfigSilverlightWebpartPopupUI.prototype.dialogCallback=_ConfigSilverlightWebpartPopupUI_dialogCallback;typeof NotifyScriptLoadedAndExecuteWaitingJobs=="function"&&NotifyScriptLoadedAndExecuteWaitingJobs("core.js")