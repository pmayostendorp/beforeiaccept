(function(jQuery){var $=jQuery;var plugin=Echo.Plugin.manifest("TWP_Share","Echo.StreamServer.Controls.Submit");if(Echo.Plugin.isDefined(plugin))return;plugin.init=function(){var item=this.component;var thisContainer=this.config.get("thisContainer");item.config.set("thisContainer",thisContainer);if(thisContainer&&wp_e2[thisContainer].includeshare&&item.config.get("intentID")!="Reply"&&typeof FB=="object")this.extendTemplate("insertBefore","postButton",plugin.templates.share)};plugin.config={"thisContainer":"#echo_container",
"includeshare":false};plugin.templates.share=function(){if(wp_e2&&wp_e2.echo_user&&wp_e2.echo_user.is("logged")&&$("#ugc-photo-gallery").length==0)return'\x3cdiv class\x3d"echo_share-text"\x3e\x3cp\x3eSharing Off\x3c/p\x3e\x3c/div\x3e'+'\x3cdiv class\x3d"echo_share-fb-button {plugin.class:share}" id\x3d"social-share-fb"\x3e\x3cdiv class\x3d"share-click-div"\x3e\x3cdiv class\x3d"fa-facebook"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e';else return""};plugin.events={"Echo.StreamServer.Controls.Submit.onPostComplete":function(topic,
args){var thisContainer=$(args.target).closest(".echo_container").attr("id");if($("#"+thisContainer+" .echo_share-fb-button.active").length>0&&!args.inReplyTo)if(typeof window.FB=="object"){var obj={method:"feed",link:wp_e2[thisContainer].guid,name:document.title,picture:typeof $("meta[property\x3dog\\:image]").attr("content")!="undefined"?$("meta[property\x3dog\\:image]").attr("content"):"",caption:"I just commented on washingtonpost.com: ",description:'"'+args.postData.content[0].object.content+
'"'};if(wp_e2[thisContainer].display_ugc_photos===true){obj.caption=$(args.postData.content[0].object.content).find("img").attr("alt");obj.description=""}plugin.config.fb_callback_container=thisContainer;FB.ui(obj,plugin.methods._FBCallback)}},"Echo.StreamServer.Controls.Submit.onRender":function(topic,args){},"Echo.StreamServer.Controls.Submit.onRerender":function(topic,args){}};plugin.renderers.share=function(element){var plugin=this,stream=plugin.component;element.click(function(event){var shareClickDiv=
$(".share-click-div",element);if(shareClickDiv.hasClass("active")){element.removeClass("active");shareClickDiv.removeClass("active");element.parent().find(".echo_share-text").empty().html("\x3cp\x3eSharing Off\x3c/p\x3e")}else{element.addClass("active");shareClickDiv.addClass("active");element.parent().find(".echo_share-text").empty().html("\x3cp\x3eSharing On\x3c/p\x3e")}})};plugin.methods._FBCallback=function(){var onPostCompleteVars={},thisContainer=plugin.config.fb_callback_container;onPostCompleteVars.eVar26=
wp_e2[thisContainer].display_ugc_photos===true?"submit - ugc":"submit - comments";sendDataToOmniture("echo.fbsharecomplete","event29",onPostCompleteVars);debug&&window.console&&console.log&&console.log("["+(new Date-TWP_Debug.initialTime)/1E3+"]"+"echo2/v2/core/twp_comments_echo2.js - Post COmplete: omniture event3");onPostCompleteVars.eVar26="";plugin.config.fb_callback_container=null};Echo.Plugin.create(plugin)})(Echo.jQuery);
(function(jQuery){var $=jQuery;var plugin=Echo.Plugin.manifest("TWP_formAuth","Echo.StreamServer.Controls.CardUIAuth");plugin.init=function(){var self=this,item=this.component;var thisContainer=this.config.get("thisContainer");item.config.set("thisContainer",thisContainer)};plugin.labels={"viewProfile":"View Profile","viewMyComments":"View My Comments","ignoreUsers":"Stop Ignoring Users","logout":"Sign Out","login":"Sign In","anonUserMessage":'\x3cspan\x3e\x3ca class\x3d"signin" href\x3d""\x3ePlease Sign In to Comment\x3c/a\x3e\x3c/span\x3e',
"notCommenterUserMessage":'\x3cspan\x3eYour profile is incomplete. Please \x3ca class\x3d"verify" href\x3d""\x3eupdate it in order to comment\x3c/a\x3e.\x3c/span\x3e'};plugin.config={"dropdownEntries":[{"visible":true,"title":plugin.labels["viewProfile"],"handler":function(){window.location.href=wp_e2.profileURL+encodeURIComponent(window.location.href.split("?")[0])+"\x26commenting\x3d1"}},{"visible":true,"title":plugin.labels["viewMyComments"],"handler":function(){window.location.href="http://"+
window.location.hostname+"/mycomments"}},{"visible":true,"title":plugin.labels["ignoreUsers"],"handler":function(){window.location.href="http://"+window.location.hostname+"/mycomments#myignoredusers"}},{"visible":true,"title":plugin.labels["logout"],"handler":function(){Backplane.resetCookieChannel();window.location.href=TWP.signin.logouturl_page}}]};plugin.component.renderers.userAnonymous=function(element){var plugin=this,component=this.component;this.parentRenderer("userAnonymous",arguments);this.component.view.get("or").hide();
this.component.view.get("signup").hide();this.component.view.get("login").remove();if(wp_e2._isUserSynced()){if(TWP.isSignedIn()&&wapoIdentity&&!wapoIdentity.isMemberOfCommentingGroup())element.prepend(plugin.labels.get("notCommenterUserMessage"));else element.prepend(plugin.labels.get("anonUserMessage"));element.on("click","a",function(event){var thisTarget=$(event.target);if(thisTarget.hasClass("signin")){window.location.href=wp_e2.logInURL+encodeURIComponent(window.location.href);return false}if(thisTarget.hasClass("register")){window.location.href=
wp_e2.registerURL+encodeURIComponent(window.location.href);return false}if(thisTarget.hasClass("verify")){window.location.href=wp_e2.profileURL+encodeURIComponent(window.location.href.split("?")[0])+"\x26commenting\x3d1";return false}})}};plugin.component.renderers.name=function(element){var self=this,component=this.component;this.parentRenderer("name",arguments);var template='\x3cspan class\x3d"{class:dropdown}"\x3e\x3c/span\x3e';var entries=this.config.get("dropdownEntries");new Echo.GUI.Dropdown({"target":element,
"title":component.user.get("name","")+self.substitute({"template":template}),"extraClass":"nav","entries":$.grep(entries,function(entry){return!!entry.visible})});element.find(".echo-streamserver-controls-carduiauth-dropdown").addClass("caret");return element};plugin.component.renderers.via=function(element){element.remove()};plugin.component.renderers.userLogged=function(element){var self=this,component=this.component;this.parentRenderer("userLogged",arguments);element.find(".echo-clear").remove()};
Echo.Plugin.create(plugin)})(Echo.jQuery);
(function(jQuery){var $=jQuery;var plugin=Echo.Plugin.manifest("TextCounter","Echo.StreamServer.Controls.Submit");if(Echo.Plugin.isDefined(plugin))return;plugin.init=function(){this.extendTemplate("insertAfter","postContainer",plugin.templates.counter)};plugin.events={"Echo.StreamServer.Controls.Submit.onPostComplete":function(topic,args){this.view.render({"name":"counterLabel"})}};plugin.labels={"limited":"{typed}/{left}","unlimited":"{typed}"};plugin.templates.counter='\x3cdiv class\x3d"{plugin.class:counterLabel} echo-primaryFont echo-primaryColor"\x3e\x3c/div\x3e\x3cdiv class\x3d"controls-divider"\x3e\x3cdiv class\x3d"controls-inner-divider"\x3e\x3c/div\x3e\x3c/div\x3e';
plugin.component.renderers.text=function(element){var plugin=this;plugin.parentRenderer("text",arguments);var limit=plugin.config.get("limit",0);var handler=function(){if(limit){var text=element.val();if(text.length<=limit)plugin.set("text",text);else if(text.length>limit){element.val(plugin.get("text"));return}}plugin.view.render({"name":"counterLabel"})};return element.on("blur focus keyup keypress",handler)};plugin.renderers.counterLabel=function(element){var plugin=this,submit=this.component;
var limit=plugin.config.get("limit",0);var typed=submit.view.get("text")&&submit.view.get("text").val()?submit.view.get("text").val().length:0;var label=plugin.labels.get(plugin.config.get("label",limit?"limited":"unlimited"),{"typed":typed,"left":Math.max(limit-typed,0),"limit":limit});return element.text(label)};Echo.Plugin.create(plugin)})(Echo.jQuery);
(function(jQuery){var $=jQuery;var plugin=Echo.Plugin.manifest("TWP_Submit","Echo.StreamServer.Controls.Submit");if(Echo.Plugin.isDefined(plugin))return;plugin.init=function(){var self=this,submit=this.component;var thisContainer=this.config.get("thisContainer");submit.config.set("thisContainer",thisContainer);if(thisContainer&&wp_e2[thisContainer].includevoteofftopic)this.extendTemplate("insertAsFirstChild","controls",plugin.templates.usermarkOfftopic);submit.addPostValidator(function(){})};plugin.config=
{"thisContainer":"#echo_container","includeshare":false,"overlayConfig":{mask:{color:"#000000",loadSpeed:200,opacity:.5},top:"10%",left:"center",closeOnClick:true,closeOnEsc:true,onBeforeLoad:function(){$(this.getTrigger().attr("rel")).find("iframe").attr("src",this.getTrigger().attr("href"))}},"verification_status":{"display_warning":false,"notCommenterUserWarning":'\x3cdiv class\x3d"echo-feature-notification"\x3eYour profile is incomplete. Please  \x3ca class\x3d"verify" href\x3d"'+wp_e2.profileURL+
window.location.href.split("?")[0]+'\x26commenting\x3d1"\x3eupdate it in order to comment.\x3c/a\x3e.\x3cdiv class\x3d"echo-close"\x3e\x3c/div\x3e\x3c/div\x3e',"verified_commenter_cookie":"commenting_verified"}};plugin.labels={"usermark_offtopic_text":"Off-topic","usermark_offtopic_value":"user__flag-offtopic","marker_photo":"photo","marker_video":"video","marker_link":"link"};plugin.templates.usermarkOfftopic=function(){if(wp_e2&&wp_e2.echo_user&&wp_e2.echo_user.is("logged")&&$("#ugc-photo-gallery").length==
0&&this.component.config.get("name")!=="Reply")return'\x3cdiv class\x3d"{plugin.class:userMarkOfftopic}"\x3e'+'\x3cinput type\x3d"checkbox" name\x3d"usermark" value\x3d"'+plugin.labels.usermark_offtopic_value+'"\x3e'+plugin.labels.usermark_offtopic_text+"\x3c/div\x3e"+'\x3cdiv class\x3d"controls-divider"\x3e\x3cdiv class\x3d"controls-inner-divider"\x3e\x3c/div\x3e\x3c/div\x3e';else return""};plugin.events={"Echo.StreamServer.Controls.Submit.onPostComplete":function(topic,args){$(args.target).find("input").prop("checked",
false)},"Echo.StreamServer.Controls.Submit.onPostInit":function(topic,args){},"Echo.StreamServer.Controls.Submit.onRender":function(topic,args){var thisContainer=this.config.get("thisContainer");var featureNotification=$(".utils .echo-feature-notification");if(wp_e2[thisContainer].includefeaturenotification!==false&&featureNotification.length>0&&typeof args.inReplyTo=="undefined"&&$(".echo-apps-conversations-postComposer .echo-feature-notification").length===0){var thisNotification=featureNotification.clone().insertAfter($(".echo-streamserver-controls-submit-container",
args.target));thisNotification.find(" .echo-close").click(function(){$(this).parent().fadeOut("slow")})}if(wp_e2[thisContainer].includefeaturenotification!==false&&wp_e2._isUserSynced()&&TWP.isSignedIn()&&wapoIdentity&&!wapoIdentity.isMemberOfCommentingGroup(plugin.config["verification_status"]["verified_commenter_cookie"])&&typeof args.inReplyTo=="undefined"&&plugin.config["verification_status"]["display_warning"]===true){var thisNotification=$(plugin.config["verification_status"]["notCommenterUserWarning"]).insertAfter($(".echo-streamserver-controls-submit-container",
args.target));thisNotification.find(" .echo-close").click(function(){$(this).parent().fadeOut("slow")})}if(wp_e2[thisContainer].allow_comments!=true&&!$("#"+thisContainer).hasClass("permalink"))$('\x3cdiv class\x3d"closed"\x3e \x3cspan\x3eComments are closed.\x3c/span\x3e\x3c/div\x3e').insertAfter($(".echo-streamserver-controls-submit-container",args.target))},"Echo.StreamServer.Controls.Submit.onRerender":function(topic,args){}};plugin.component.renderers.container=function(element){var plugin=this,
component=this.component;this.parentRenderer("container",arguments);var thisContainer=component.config.get("thisContainer");if(!wp_e2._isUserSynced()||!TWP.isSignedIn()||TWP.isSignedIn()&&wapoIdentity&&!wapoIdentity.isMemberOfCommentingGroup()||wp_e2.echo_user.userSuspended||!($("#"+thisContainer).hasClass("submitbox")||$("#"+thisContainer).hasClass("permalink"))&&component.config.get("name")!="Reply"){component.view.get("body").remove();component.view.get("controls").remove()}else{var wrapper=$('\x3cdiv class\x3d"submit-controls-outer-wrapper"\x3e\x3c/div\x3e');
component.view.get("header").after(wrapper);wrapper.append(component.view.get("body"));wrapper.append(component.view.get("controls"));wrapper.after('\x3cdiv class\x3d"clearfix"\x3e\x3c/div\x3e')}if(wp_e2.echo_user.userSuspended){var bannedTimes=wp_e2["suspend_user_markers"]||{},bannedTexts=wp_e2["suspend_type_text"]||{},userBanned=false,currBanTime="",currBanText="";var userMarkers=wp_e2._isUserSynced()&&wp_e2.echo_user.is("logged")&&wp_e2.echo_user.get("markers")||[];$.each(bannedTimes,function(key,
value){if($.inArray(key,userMarkers)>=0){currBanTime=key;return}});$.each(bannedTexts,function(key,value){if($.inArray(key,userMarkers)>=0){currBanText=key;return}});var bannedText=bannedTexts[currBanText];var bannedNotification='\x3cdiv class\x3d"echo-feature-notification suspended"\x3e\x3ci class\x3d"fa fa-exclamation"\x3e\x3c/i\x3e'+'\x3cdiv class\x3d"notification-text"\x3e\x3cp\x3e'+(typeof bannedText!="undefined"?bannedText:bannedTexts["default"])+wp_e2["suspend_core_text"]+"\x3c/p\x3e"+"\x3cp\x3e"+
bannedTimes[currBanTime]+"\x3c/p\x3e\x3c/div\x3e"+"\x3c/div\x3e";component.view.get("header").after(bannedNotification)}};plugin.component.renderers.text=function(element){var plugin=this,component=this.component;if(component.data&&component.data.object&&component.data.object.content)component.data.object.content="";this.parentRenderer("text",arguments);var thisContainer=this.config.get("thisContainer");component.view.get("text").on({focus:function(){$(this).closest(".submit-controls-outer-wrapper").addClass("active")}})};
plugin.component.renderers.markers=function(element){var plugin=this,component=this.component;this.parentRenderer("markers",arguments);var thisContainer=this.config.get("thisContainer");this.component.view.get("markers").val(this.component.view.get("markers").val()+","+wp_e2[thisContainer].submitMarkers.join(","))};plugin.component.renderers.tags=function(element){var plugin=this,component=this.component;this.parentRenderer("tags",arguments);if(component.config.get("name")&&component.config.get("name").indexOf("Reply")>=
0){var tags=component.view.get("tags").val().split(",");tags.push("replyto_"+plugin.component._prepareEventParams().inReplyTo.actor.title);component.view.get("tags").val(tags.join(","))}};plugin.renderers.userMarkOfftopic=function(element){var plugin=this,item=this.component;element.find("input").on("change",item,function(event){var thisMarker=this.value,thisVal=item.view.get("markers").val(),finalVal=[];if(this.checked){var thisValArray=thisVal.split(",");thisValArray.push(thisMarker)}else{thisVal=
thisVal.replace(new RegExp(thisMarker,"g"),"").trim();var thisValArray=thisVal.split(",")}$.each(thisValArray,function(idx,value){if(value!=="")finalVal.push(value)});item.view.get("markers").val(finalVal.join(","))})};Echo.Plugin.create(plugin)})(Echo.jQuery);
(function(jQuery){var $=jQuery;var plugin=Echo.Plugin.manifest("TWP_Edit","Echo.StreamServer.Controls.Submit");if(Echo.Plugin.isDefined(plugin))return;plugin.init=function(){var self=this,submit=this.component;var thisContainer=this.config.get("thisContainer");submit.config.set("thisContainer",thisContainer)};plugin.config={"thisContainer":"#echo_container","editMarker":["edited"]};plugin.events={"Echo.StreamServer.Controls.Submit.onPostComplete":function(topic,args){var self=this;var thisContainer=
self.config.get("thisContainer");var updatedMarkers=self.config.get("editMarker");$.each(updatedMarkers||[],function(index,value){var data='{"verb": "mark","target": "'+args.targetURL+'","markers": "'+value+'"}';$.ajax({"url":wp_e2.metaUrl,"data":{"appkey":wp_e2.appkey,"content":data,"sessionID":wp_e2.echo_user&&wp_e2.echo_user.get("sessionID","")},"dataType":"jsonp"})})}};Echo.Plugin.create(plugin)})(Echo.jQuery);
(function(jQuery){var $=jQuery;var plugin=Echo.Plugin.manifest("TWP_Submit_VerifiedCommenter","Echo.StreamServer.Controls.Submit");if(Echo.Plugin.isDefined(plugin))return;plugin.init=function(){var self=this,submit=this.component;var thisContainer=this.config.get("thisContainer");self.config.set("thisContainer",thisContainer);var i=document.createElement("input");self.config.set("isPlaceholder","placeholder"in i);var userMarkers=typeof self.config.get("userMarkers")=="undefined "||self.config.get("userMarkers")==
null?self.config.get("userMarkers"):self.config.get("userMarkers");if(self.config.get("isVerifiedCommenterForm")===true){this.extendTemplate("replace","textArea",plugin.contentTemplate);submit.validators=[];submit.addPostValidator(function(){var thisContainer=submit.config.get("thisContainer"),thisText=submit.view.get("text"),validationFailed=false;var thisForm=submit.view.get("content").find(".echo-streamserver-controls-submit-plugin-TWP_Submit_VerifiedCommenter-topCommenterForm");thisForm.find("input").removeClass("echo-streamserver-controls-submit-mandatory");
if(thisForm.find('input[name\x3d"fullName"]').val().length==0){thisForm.find('input[name\x3d"fullName"]').addClass("echo-streamserver-controls-submit-mandatory");validationFailed=true}else thisForm.find('input[name\x3d"fullName"]').removeClass("echo-streamserver-controls-submit-mandatory");if(thisForm.find('input[name\x3d"phoneNumber"]').val().length==0){thisForm.find('input[name\x3d"phoneNumber"]').addClass("echo-streamserver-controls-submit-mandatory");validationFailed=true}else thisForm.find('input[name\x3d"phoneNumber"]').removeClass("echo-streamserver-controls-submit-mandatory");
if(thisForm.find('textarea[name\x3d"address"]').val().length==0){thisForm.find('textarea[name\x3d"address"]').addClass("echo-streamserver-controls-submit-mandatory");validationFailed=true}else thisForm.find('textarea[name\x3d"address"]').removeClass("echo-streamserver-controls-submit-mandatory");if(thisForm.find('input[name\x3d"email"]').val().length==0){thisForm.find('input[name\x3d"email"]').addClass("echo-streamserver-controls-submit-mandatory");validationFailed=true}else thisForm.find('input[name\x3d"email"]').removeClass("echo-streamserver-controls-submit-mandatory");
if(!thisForm.find('input[name\x3d"agreetopolicy"]').prop("checked")){thisForm.find("div.agreetopolicy").addClass("echo-streamserver-controls-submit-mandatory");validationFailed=true}else thisForm.find("div.agreetopolicy").removeClass("echo-streamserver-controls-submit-mandatory");if(validationFailed)return false;var requestHtml="";$.each(thisForm.find("input, textarea"),function(idx,elm){requestHtml=requestHtml+elm.getAttribute("name")+":  "+elm.value+"\n"});thisText.val(requestHtml);return true},
"high")}else this.extendTemplate("insertAsFirstChild","container",plugin.templates.verifiedCommenterCheckbox)};Echo.Events.subscribe({"topic":"TWP.Badge.Request.Complete","context":"global","handler":function(topic,data){if(data&&data.echocontainer){var thisContainer=data.echocontainer;if(wp_e2[thisContainer].includeverifiedcommenters===true&&wp_e2.echo_user)if(wp_e2[thisContainer].verifiedcommenteridlist&&(wp_e2[thisContainer].verifiedcommenteridlist.userArray&&wp_e2[thisContainer].verifiedcommenteridlist.userArray[wp_e2.echo_user.get("identityUrl")])){var thisStatus=
wp_e2[thisContainer].verifiedcommenteridlist.userArray[wp_e2.echo_user.get("identityUrl")].verification_status;var thisElm=$("#"+thisContainer+" .echo-streamserver-controls-submit-container.original-submit");var thisReq=thisElm.find(".echo-streamserver-controls-submit-plugin-TWP_Submit_VerifiedCommenter-verifiedCommenterRequest");thisReq.find("a").remove();thisReq.append('\x3cspan class\x3d"verification-status"\x3e'+plugin.labels[thisStatus]+"\x3c/span\x3e")}}}});plugin.config={"thisContainer":"#echo_container",
"userMarkers":"verified_preferred","addVerifiedCommenterRequest":true,"isVerifiedCommenterForm":false,"verifiedCommenterRequestTarget":"echo-apps-conversations-postComposer","verifiedCommenterSubmitTarget":"echo-topcommenter-form","overlayConfig":{mask:{color:"#000000",loadSpeed:200,opacity:.5},top:"10%",left:"center",closeOnClick:true,closeOnEsc:true,onBeforeLoad:function(){$(this.getTrigger().attr("rel")).find("iframe").attr("src",this.getTrigger().attr("href"))}}};plugin.labels={"topComments":"Top Comments",
"verifiedinput_value":"verified_manual_request","verifiedinput_text":'\x3cspan\x3eMentioned in this story and want to comment? \x3cstrong\x3eClick here\x3c/strong\x3e \x3ci class\x3d"caret"\x3e\x3c/i\x3e\x3c/span\x3e',"verifiedinput_text_anon":'\x3cspan\x3eMentioned in this story and want to comment? \x3ca href\x3d"http://www.washingtonpost.com/blogs/ask-the-post/wp/2014/02/27/comments-what-is-a-preferred-commenter/" target\x3d"_policy"\x3eLearn more\x3c/a\x3e\x3c/span\x3e',"verifiedinput_description":"\x3cp\x3e\x3cb\x3eAre you mentioned in this story?\x3c/b\x3e\x3c/p\x3e\x3cp\x3eWe need to verify your identity. Please provide the following info: \x3c/p\x3e",
"verification_request":"Your verification request has been received.","verification_processing":"Your verification request is being reviewd.","verification_approved":"Your verification request has been approved.","verification_denied":"Your verification request has not been approved.","none":""};plugin.events={"Echo.StreamServer.Controls.Submit.onRender":function(topic,data){},"Echo.StreamServer.Controls.Submit.onPostInit":function(topic,data){},"Echo.StreamServer.Controls.Submit.onPostComplete":function(topic,
data){var self=this;var thisContainer=self.config.get("thisContainer");if($(data.target).hasClass(self.config.get("verifiedCommenterSubmitTarget")))$(data.target).slideUp("fast",function(){self.component.destroy();var thisElm=$("#"+thisContainer+" .echo-streamserver-controls-submit-container.original-submit");var thisReq=thisElm.find(".echo-streamserver-controls-submit-plugin-TWP_Submit_VerifiedCommenter-verifiedCommenterRequest");thisReq.find("a").remove();thisReq.append('\x3cspan class\x3d"verification-status"\x3e'+
plugin.labels.verification_request+"\x3c/span\x3e");thisElm.slideDown("slow")})}};plugin.templates.verifiedCommenterCheckbox=function(){var inputText=wp_e2&&wp_e2.echo_user&&wp_e2.echo_user.is("logged")?'\x3ca class\x3d"submit-request-form"\x3e'+plugin.labels.verifiedinput_text+"\x3c/a\x3e":plugin.labels.verifiedinput_text_anon;if(wp_e2&&wp_e2.echo_user&&(wp_e2.echo_user.get("state")!="ModeratorBanned"&&wp_e2.echo_user.get("state")!="ModeratorDeleted")&&!wp_e2.echo_user.userSuspended&&$("#ugc-photo-gallery").length==
0&&(!this.component.config.get("name")||this.component.config.get("name")&&this.component.config.get("name").indexOf("Reply")<0))return'\x3cdiv class\x3d"{plugin.class:verifiedCommenterRequest}"\x3e'+inputText+"\x3c/div\x3e";else return""};plugin.contentTemplate='\x3cdiv class\x3d"{plugin.class:topCommenterForm}"\x3e'+'\x3cdiv class\x3d"echo-close"\x3e\x26#215;\x3c/div\x3e'+'\x3cdiv class\x3d"description"\x3e'+plugin.labels.verifiedinput_description+"\x3c/div\x3e"+'\x3cinput type\x3d"text" name\x3d"fullName" placeholder\x3d"Full Name" maxlength\x3d"50"\x3e'+
'\x3cinput type\x3d"text" name\x3d"phoneNumber" placeholder\x3d"Phone number" maxlength\x3d"20"\x3e'+'\x3cinput type\x3d"text" name\x3d"affiliation" placeholder\x3d"Affiliation (if relevant)" maxlength\x3d"100"\x3e'+'\x3cinput type\x3d"text" name\x3d"twitterHandle"  placeholder\x3d"Twitter handle (optional)"  maxlength\x3d"30"\x3e'+'\x3ctextarea rows\x3d"2" cols\x3d"50"  name\x3d"address"  placeholder\x3d"Street address" maxlength\x3d"100"/\x3e'+'\x3cinput type\x3d"text" name\x3d"email"  placeholder\x3d"E-mail address" maxlength\x3d"50"\x3e'+
'\x3cinput type\x3d"text" name\x3d"fbPage"  placeholder\x3d"Facebook page (optional)" maxlength\x3d"30"\x3e'+'\x3cdiv class\x3d"agreetopolicy"\x3e\x3cinput type\x3d"checkbox" name\x3d"agreetopolicy" value\x3d"agreedtopolicy"\x3e\x3cp\x3eI have read and understood The Washington Post\'s '+'\x3cspan class\x3d"discussion-policy"\x3e\x3ca href\x3d"http://www.washingtonpost.com/blogs/ask-the-post/discussion-and-submission-guidelines/" target\x3d"_policy"\x3ediscussion policy\x3c/a\x3e\x3c/span\x3e'+" and "+
'\x3cspan class\x3d"discussion-policy"\x3e\x3ca href\x3d"http://www.washingtonpost.com/blogs/ask-the-post/discussion-and-submission-guidelines/#preferred-commenters" target\x3d"_policy"\x3eguidelines on preferred comment placement\x3c/a\x3e\x3c/span\x3e.\x3c/p\x3e\x3c/div\x3e'+"\x3c/div\x3e"+'\x3ctextarea class\x3d"{class:text} {class:textArea} echo-primaryFont echo-primaryColor" style\x3d"display:none;"\x3e\x3c/textarea\x3e';plugin.component.renderers.container=function(element){var item=this.component,
thisContainer=this.config.get("thisContainer");this.parentRenderer("container",arguments);if(this.config.get("addVerifiedCommenterRequest")===true)element.addClass("original-submit");if(wp_e2[thisContainer].verifiedcommenteridlist&&(wp_e2[thisContainer].verifiedcommenteridlist.userArray&&wp_e2[thisContainer].verifiedcommenteridlist.userArray[wp_e2.echo_user.get("identityUrl")])){var thisStatus=wp_e2[thisContainer].verifiedcommenteridlist.userArray[wp_e2.echo_user.get("identityUrl")].verification_status;
var thisElm=$(element).find(".echo-streamserver-controls-submit-plugin-TWP_Submit_VerifiedCommenter-verifiedCommenterRequest");thisElm.find("a").remove();thisElm.append('\x3cspan class\x3d"verification-status"\x3e'+plugin.labels[thisStatus]+"\x3c/span\x3e")}};plugin.component.renderers.userInfoWrapper=function(element){var item=this.component;this.parentRenderer("userInfoWrapper",arguments);$(element).hide()};plugin.renderers.topCommenterForm=function(element){var plugin=this,item=this.component;
var thisContainer=plugin.config.get("thisContainer");var overlay=$("#comment_policy_overlay");overlay.hide();$("body").prepend(overlay);try{window.$(element).find("a").overlay(plugin.config.get("overlayConfig"))}catch(e){}element.find(".echo-close").on("click",plugin,function(event){var thisContainer=plugin.config.get("thisContainer");if($("#"+thisContainer+" ."+plugin.config.get("verifiedCommenterSubmitTarget")).length>0)$("#"+thisContainer+" ."+plugin.config.get("verifiedCommenterSubmitTarget")).slideUp("fast",
function(){plugin.component.destroy();var thisElm=$("#"+thisContainer+" .echo-streamserver-controls-submit-container.original-submit");thisElm.find(".echo-streamserver-controls-submit-plugin-TWP_Submit_VerifiedCommenter-verifiedCommenterRequest a").removeClass("open");thisElm.slideDown("slow")})})};plugin.renderers.verifiedCommenterRequest=function(element){var plugin=this,item=this.component;element.find("a.submit-request-form").on("click",plugin,function(event){if(!$(this).hasClass("open")){$(this).addClass("open");
plugin._startTopCommentsSubmit(plugin)}});return element};plugin.methods._publishEventComplete=function(args){var item=this.component;this.events.publish({"topic":args.topic,"data":args.data})};plugin.methods._startTopCommentsSubmit=function(plugin){var item=plugin.component;var thisContainer=plugin.config.get("thisContainer"),guid=wp_e2[thisContainer].guid;if($("#"+thisContainer).find("."+plugin.config.get("verifiedCommenterSubmitTarget")).length==0)$("."+plugin.config.get("verifiedCommenterRequestTarget")).prepend('\x3cdiv class\x3d"'+
plugin.config.get("verifiedCommenterSubmitTarget")+'"\x3e\x3c/div\x3e');var pluginArray=[{"name":"CardUIShim","submitPermissions":"forceLogin","displaySharingOnPost":false,"nestedPlugins":[{"name":"TWP_formAuth","thisContainer":thisContainer}],"labels":{"post":"Submit","posting":"Submitting..."}},{"name":"TWP_Submit","thisContainer":thisContainer},{"name":"TWP_Submit_VerifiedCommenter","thisContainer":thisContainer,"addVerifiedCommenterRequest":false,"isVerifiedCommenterForm":true}];$("."+plugin.config.get("verifiedCommenterSubmitTarget")).css("display",
"none");var submitConfig={"target":$("."+plugin.config.get("verifiedCommenterSubmitTarget")),"targetURL":guid,"markers":["verification_request"],"appkey":wp_e2.appkey,"type":"http://activitystrea.ms/schema/1.0/badge","plugins":pluginArray,"useSecureAPI":true,"apiBaseURL":wp_e2.apiBaseURL+"/v1/","submissionProxyURL":wp_e2.echoSubmissionProxyURL,"requestMethod":"POST","labels":{"post":"Submit","posting":"Submitting..."}};var topCommentsSubmit=new Echo.StreamServer.Controls.Submit(submitConfig);plugin.config.set("topCommentsSubmit",
topCommentsSubmit);$("#"+thisContainer+" .echo-streamserver-controls-submit-container.original-submit").slideUp("fast",function(){if(!plugin.config.get("isPlaceholder")){$(".echo-streamserver-controls-submit-plugin-TWP_Submit_VerifiedCommenter-topCommenterForm textarea").css({"width":"40%","margin-right":"20px"});$(".echo-streamserver-controls-submit-plugin-TWP_Submit_VerifiedCommenter-topCommenterForm").find("[placeholder]").each(function(){$(this).val($(this).attr("placeholder"));$(this).on("focus",
function(){if($(this).attr("placeholder")==$(this).val())$(this).val("")});$(this).on("blur",function(){if($(this).val()=="")$(this).val($(this).attr("placeholder"))})})}$("."+plugin.config.get("verifiedCommenterSubmitTarget")).slideDown("slow",function(){})})};Echo.Plugin.create(plugin)})(Echo.jQuery);