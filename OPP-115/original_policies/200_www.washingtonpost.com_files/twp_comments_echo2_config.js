(function($){wp_e2=window.wp_e2||{};wp_e2.extensions=$.extend({},wp_e2.extensions);wp_e2.config=$.extend({},wp_e2.config);wp_e2_defaults={allow_comments:true,allow_links:true,allow_photos:false,allow_videos:false,commentmaxlength:2E3,defaulttab:"top",display_ugc_photos:false,display_more:true,includefeaturenotification:true,includeheader:true,includepause:true,includepermalink:false,includereply:true,includereport:true,includerecommend:true,includeshare:true,includesorts:true,includetabs:false,isallcomments:false,
max_items_to_display:0,maxitemstop:3,maxitems:15,moderationrequired:false,photocommentmaxlength:500,source:"washpost.com",topiccommentmaxlength:140,filesMax:1,"data-app-instance":"6634zxcgfd","data-canvas-id":"washpost.com/km4ey0dajm"};wp_e2_core={apiBaseURL:"https://comments-api.ext.nile.works",cdnBaseURL:"//js.washingtonpost.com/pb/resources/js/echo2/",echoSubmissionProxyURL:"https://comments-api.ext.nile.works/v2/esp/activity",appkey:"dev.washpost.com",backplaneSettings:{serverBaseURL:"https://comments-api.ext.nile.works/v1",
busName:"washpost.com"},bookmarkletUrl:"https://testapp12b:7001/bookmarklet/edit-comment.html",counterTarget:".echo-counter",debug:false,default_plugins:{authPluginArray:[{"name":"TWP_formAuth","thisContainer":""}],streamPluginArray:[{"name":"TWP_Stream","thisContainer":""},{"name":"TWP_Stream_Item","thisContainer":""},{"name":"PageVisibilityDetector","thisContainer":""}],submitboxPluginArray:[{"name":"TWP_Share","thisContainer":""},{"name":"TWP_Submit","thisContainer":""}],replyPluginArray:[{"name":"Reply",
"actionString":"Add your thoughts...","nestedPlugins":[{"name":"FormAuth","nestedPlugins":[{"name":"ReplyAuth"}]},{"name":"ReplyForm","thisContainer":""}]}],ugcstreamPluginArray:[{"name":"TWP_UGC_Gallery"}],ugcsubmitboxPluginArray:[{"name":"FormAuth","nestedPlugins":[{"name":"SubmitAuth"}]},{"name":"SubmitForm"},{"name":"FileUpload","thumbnailRes":[90,60],"previewRes":[300,200],"webRes":[610,407],"showDefaultInputs":false,"fileSizeMax":5120,"fileSizeMin":0,"filesMax":1,"storageServer":"//twp_echo_ugc.s3.amazonaws.com/comment_photos/",
"authorName":""}]},allowEdit:true,allowDelete:true,editTime:5,environment:{"dev":{logOutURL:TWP.signin.logouturl_page+"?destination\x3d",logInURL:TWP.signin.logincommentsurl_page+"?destination\x3d",profileURL:TWP.signin.profileurl,registerURL:TWP.signin.registrationcommentsurl_page+"?destination\x3d",proxyURL:"//bunsen.wapolabs.com/identity/1.5.2/js/wapo_jskit_login_redirect.js",twp_echojsUrl:"/rw/sites/twpweb/js/echo2/v2/core/twp_comments_echo2.js",metaUrl:"//comments-api-staging.ext.nile.works/v2/submit/marker",
bookmarkletUrl:"https://testapp12b:7001/bookmarklet/edit-comment.html",mongoUserActionUrl:"//data.washingtonpost.com/features/comment_user_action/",mongoActionUpdateUrl:"//data.washingtonpost.com/features/comment_action/",argusBaseUrl:"https://argus-stg.washingtonpost.com/api/",commentProfileUrl:"/mycomments",commentBadgesUrl:"//dre-dev.wpprivate.com/wp-dre/comments/badges",appkey:"dev.washpost.com",cdnBaseURL:"//pb-new-dev.digitalink.com/pb/resources/js/echo2/",apiBaseURL:"https://comments-api-staging.ext.nile.works",
echoSubmissionProxyURL:"https://comments-api-staging.ext.nile.works/v2/esp/activity",validateURL:"/pb/twp-comment-health.js",backplaneSettings:{serverBaseURL:"https://comments-api-staging.ext.nile.works/v1",busName:"washpost.com"}},"qa":{logOutURL:TWP.signin.logouturl_page+"?destination\x3d",logInURL:TWP.signin.logincommentsurl_page+"?destination\x3d",profileURL:TWP.signin.profileurl,registerURL:TWP.signin.registrationcommentsurl_page+"?destination\x3d",proxyURL:"//bunsen.wapolabs.com/identity/1.5.2/js/wapo_jskit_login_redirect.js",
twp_echojsUrl:"/rw/sites/twpweb/js/echo2/v2/core/twp_comments_echo2.js",metaUrl:"//comments-api-staging.ext.nile.works/v2/submit/marker",bookmarkletUrl:"https://testapp12b:7001/bookmarklet/edit-comment.html",mongoUserActionUrl:"//data.washingtonpost.com/features/comment_user_action/",mongoActionUpdateUrl:"//data.washingtonpost.com/features/comment_action/",argusBaseUrl:"https://argus-stg.washingtonpost.com/api/",commentProfileUrl:"/mycomments",commentBadgesUrl:"http://dre-dev.wpprivate.com/wp-dre/comments/badges",
appkey:"dev.washpost.com",cdnBaseURL:"//pb-new-dev.digitalink.com/pb/resources/js/echo2/",apiBaseURL:"https://comments-api-staging.ext.nile.works",echoSubmissionProxyURL:"https://comments-api-staging.ext.nile.works/v2/esp/activity",validateURL:"//pb-new-dev.digitalink.com/pb/twp-comment-health.js",backplaneSettings:{serverBaseURL:"https://comments-api-staging.ext.nile.works/v1",busName:"washpost.com"}},"stage":{logOutURL:TWP.signin.logouturl_page+"?destination\x3d",logInURL:TWP.signin.logincommentsurl_page+
"?destination\x3d",profileURL:TWP.signin.profileurl,registerURL:TWP.signin.registrationcommentsurl_page+"?destination\x3d",proxyURL:"//bunsen.wapolabs.com/identity/1.5.2/js/wapo_jskit_login_redirect.js",twp_echojsUrl:"/rw/sites/twpweb/js/echo2/v2/core/twp_comments_echo2.js",metaUrl:"//comments-api-staging.ext.nile.works/v2/submit/marker",bookmarkletUrl:"https://testapp12b:7001/bookmarklet/edit-comment.html",mongoUserActionUrl:"//data.washingtonpost.com/features/comment_user_action/",mongoActionUpdateUrl:"//data.washingtonpost.com/features/comment_action/",
argusBaseUrl:"https://argus.washingtonpost.com/api/",commentProfileUrl:"/mycomments",commentBadgesUrl:"http://www.washingtonpost.com/wp-dre/comments/badges",appkey:"prod.washpost.com",cdnBaseURL:"//js.washingtonpost.com/pb/resources/js/echo2/",apiBaseURL:"https://comments-api-staging.ext.nile.works",echoSubmissionProxyURL:"https://comments-api-staging.ext.nile.works/v2/esp/activity",validateURL:"//pb-new-dev.digitalink.com/pb/twp-comment-health.js",backplaneSettings:{serverBaseURL:"https://comments-api-staging.ext.nile.works/v1",
busName:"washpost.com"}},"beta":{logOutURL:TWP.signin.logouturl_page+"?destination\x3d",logInURL:TWP.signin.logincommentsurl_page+"?destination\x3d",profileURL:TWP.signin.profileurl,registerURL:TWP.signin.registrationcommentsurl_page+"?destination\x3d",proxyURL:"//bunsen.wapolabs.com/identity/1.5.2/js/wapo_jskit_login_redirect.js",twp_echojsUrl:"/rw/sites/twpweb/js/echo2/v2/core/twp_comments_echo2.js",metaUrl:"https://comments-api.ext.nile.works/v2/submit/marker",bookmarkletUrl:"https://liveadmin.washingtonpost.com/bookmarklet/edit-comment.html",
mongoUserActionUrl:"https://data.washingtonpost.com/features/comment_user_action/",mongoActionUpdateUrl:"https://data.washingtonpost.com/features/comment_action/",argusBaseUrl:"https://argus.washingtonpost.com/api/",commentProfileUrl:"/mycomments",commentBadgesUrl:"//www.washingtonpost.com/wp-dre/comments/badges",appkey:"prod.washpost.com",cdnBaseURL:"//js.washingtonpost.com/pb/resources/js/echo2/",apiBaseURL:"https://comments-api.ext.nile.works",echoSubmissionProxyURL:"https://comments-api.ext.nile.works/v2/esp/activity",
validateURL:"//js.washingtonpost.com/pb/twp-comment-health.js",backplaneSettings:{serverBaseURL:"https://comments-api.ext.nile.works/v1",busName:"washpost.com"}},"prod":{logOutURL:TWP.signin.logouturl_page+"?destination\x3d",logInURL:TWP.signin.logincommentsurl_page+"?destination\x3d",profileURL:TWP.signin.profileurl,registerURL:TWP.signin.registrationcommentsurl_page+"?destination\x3d",proxyURL:"https://bunsen.wapolabs.com/identity/1.5.2/js/wapo_jskit_login_redirect.js",twp_echojsUrl:"/rw/sites/twpweb/js/echo2/v2/core/twp_comments_echo2.js",
metaUrl:"https://comments-api.ext.nile.works/v2/submit/marker",bookmarkletUrl:"https://liveadmin.washingtonpost.com/bookmarklet/edit-comment.html",mongoUserActionUrl:"https://data.washingtonpost.com/features/comment_user_action/",mongoActionUpdateUrl:"https://data.washingtonpost.com/features/comment_action/",argusBaseUrl:"https://argus.washingtonpost.com/api/",commentProfileUrl:"/mycomments",commentBadgesUrl:"//www.washingtonpost.com/wp-dre/comments/badges",appkey:"prod.washpost.com",cdnBaseURL:"//js.washingtonpost.com/pb/resources/js/echo2/",
apiBaseURL:"https://comments-api.ext.nile.works",echoSubmissionProxyURL:"https://comments-api.ext.nile.works/v2/esp/activity",validateURL:"//js.washingtonpost.com/pb/twp-comment-health.js",backplaneSettings:{serverBaseURL:"https://comments-api.ext.nile.works/v1",busName:"washpost.com"}}},guid:window.location.href,identityjsUrl:"",liveUpdates:{desktop:{"transport":"polling","enabled":true,"polling":{"timeout":15},"websockets":{"maxConnectRetries":3,"serverPingInterval":60}},mobile:{"transport":"polling",
"enabled":true,"polling":{"timeout":120}}},liveUpdatesTimeout:{counter:{"default":60,"closed":3600,"no_webtype":3600},stream:{"default":60,"closed":3600,"no_webtype":3600}},logOutURL:"",logInURL:"",markerDisplay:{"top_commenter":"Post Forum Member","top_local":"Washingtologist","top_sports":"SuperFan","staff":"Post Writer","fact_checker":"Fact Checker","post_recommended":"Post Recommended","world_watcher":"World Watcher","culture_connoisseur":"Culture Connoisseur"},"markerSettings":{"delimiter":"__",
"modPrefix":"mod","userPrefix":"user","votedPrefix":"voted","counterPrefix":"cntr"},metaUrl:"",pageURL:window.location.href,profileURL:"",proxyURL:"",registerURL:"",sectionid:"",source:"washpost.com",streamPluginArray:[],streamSettings:{top:{maxitems:3,childrenItemsPerPage:3},all:{maxitems:15,childrenItemsPerPage:3},appkey:"dev.washpost.com",target:"#comment-stream",apiBaseURL:"",defaultsort:"reverseChronological",displaysort:true,childrenItemsPerPage:3,childrenSortOrder:"chronological",plugins:[],
streamStateLabel:{icon:true,text:true},viaLabel:{icon:true,text:true},reTag:false,streamStateToggleBy:"button",aggressiveSanitization:false,openLinksInNewWindow:true,sortorder:"reverseChronological",reply:false,request:"childrenof",allowedItemStates:["Untouched","CommunityFlagged","ModeratorApproved"],allowedUserStates:["ModeratorApproved"],safeHTML:"aggressive",childrenMaxDepth:2,active:false,userMarkers:[""]},streamClient:null,streamId:"",streamTarget:"#echo_comment_stream",submitboxPluginArray:[],
submitTarget:"#comment-box",suspend_user_markers:{"tsk_h":"Your account has been suspended for up to 24 hours. ","tsk_d":"Your account has been suspended for up to 24 hours. ","tsk_w":"Your account has been suspended for up to 7 days. ","tsk_perm":"Your account is permanently suspended. "},suspend_type_text:{"default":"Your account has been suspended. ","tsk_type_obscenity":"You submitted a comment that violated our guideline against obscene content. ","tsk_type_namecalling":"You submitted a comment that violated our guideline against intimidation and harassment. ",
"tsk_type_profanity":"You submitted a comment that violated our guideline against profane content. ","tsk_type_personal":"You submitted a comment that violated our guideline against personal attacks. ","tsk_type_defamatory":"You submitted a comment that violated our guideline against alleged claims and unfounded accusations. "},suspend_core_text:'\x3cspan class\x3d"discussion-policy"\x3e\x3ca href\x3d"//www.washingtonpost.com/blogs/ask-the-post/discussion-and-submission-guidelines/" target\x3d"_policy"\x3ePlease review the discussion guidelines\x3c/a\x3e\x3c/span\x3e. ',
tabs:"",twp_echojsUrl:"",uploadPhotoPluginArray:[],"voteSettings_flag-offtopic":{"cookie":"wapo_comment_offtopic","flag":"flag-offtopic","threshold":5,"markClass":"offtopic","markText":"Off-topic","controlTextShowing":"Off-topic Shown","controlTextHiding":"Off-topic Hidden"}};wp_e2.createDataObject=function(elm,thisContainer){var data={};if(typeof elm.attr("data")!=="undefined"&&elm.attr("data").length>0){var attrs=elm.attr("data").split("\x26");for(var i=0;i<attrs.length;i++)if(attrs[i]!=""){valArry=
attrs[i].split("\x3d");data[valArry[0].toLowerCase()]=valArry[1]=="true"?true:valArry[1]=="false"?false:valArry[1];wp_e2[thisContainer][valArry[0].toLowerCase()]=data[valArry[0].toLowerCase()]}}else{var attrs=elm[0].attributes;for(var i=0;i<attrs.length;i++){data[attrs[i].nodeName.toLowerCase()]=attrs[i].nodeValue=="true"?true:attrs[i].nodeValue=="false"?false:attrs[i].nodeValue;wp_e2[thisContainer][attrs[i].nodeName.toLowerCase()]=data[attrs[i].nodeName.toLowerCase()]}}return data};wp_e2.initDataObject=
function(elm){var thisContainerElm=typeof elm!="undefined"?elm:$(".comment-vars");thisContainerElm.each(function(index,thisElm){var commentVars=$(thisElm);var thisContainer=commentVars.attr("id");wp_e2[thisContainer]={};data=wp_e2.createDataObject(commentVars,thisContainer);$.each(wp_e2_defaults,function(key,val){wp_e2[thisContainer][key]=typeof data[key]!=="undefined"&&data[key]!==""?data[key]:wp_e2_defaults[key]});wp_e2[thisContainer].streamSettings={};$.extend(wp_e2[thisContainer].streamSettings,
wp_e2_core.streamSettings);wp_e2[thisContainer].allCommentsURL=data.articleurlfacet;wp_e2[thisContainer].streamSettings.sortorder=typeof data.defaultsort!=="undefined"&&data.defaultsort!=""?data.defaultsort:wp_e2.streamSettings.sortorder;wp_e2[thisContainer].streamSettings.childrenItemsPerPage=typeof data.childrenitemsperpage!=="undefined"&&data.childrenitemsperpage!=""?parseInt(data.childrenitemsperpage):wp_e2.streamSettings.childrenItemsPerPage;wp_e2[thisContainer].streamSettings.childrenMaxDepth=
typeof data.childrenmaxdepth!=="undefined"&&data.childrenmaxdepth!=""?parseInt(data.childrenmaxdepth):wp_e2.streamSettings.childrenMaxDepth;wp_e2[thisContainer].itemMarkersTop=data.markers;delete wp_e2[thisContainer].markers;wp_e2[thisContainer].itemMarkers=typeof data.markersall!=="undefined"&&data.markersall!=""?data.markersall.split(","):"";delete wp_e2[thisContainer].markersall;wp_e2[thisContainer].markerDisplay=typeof data.markerdisplay!=="undefined"&&data.markerdisplay!=""?jQuery.parseJSON("{"+
data.markerdisplay.replace(/'/g,'"')+"}"):wp_e2.markerDisplay;wp_e2[thisContainer].userMarkersTop=data.usermarkers;delete wp_e2[thisContainer].usermarkers;wp_e2[thisContainer].userMarkers=typeof data.usermarkersall!=="undefined"&&data.usermarkersall!=""?data.usermarkersall.split():"";delete wp_e2[thisContainer].usermarkersall;wp_e2[thisContainer].webType=typeof data.webtype=="undefined"?"article_story":data.webtype;wp_e2[thisContainer].streamSettings.all.maxitems=typeof data.maxitems!=="undefined"&&
data.maxitems!=""?data.maxitems:wp_e2[thisContainer].streamSettings.all.maxitems;wp_e2[thisContainer].streamSettings.top.maxitems=typeof data.maxitemstop!=="undefined"&&data.maxitemstop!=""?data.maxitemstop:wp_e2[thisContainer].streamSettings.top.maxitems;if(wp_e2[thisContainer].allow_photos||wp_e2[thisContainer].allow_videos)wp_e2[thisContainer].streamSettings.safeHTML="permissive";if(wp_e2[thisContainer].webType.toLowerCase().indexOf("topic_story")>=0)wp_e2[thisContainer].commentmaxlength=typeof wp_e2.config.topiccommentmaxlength!=
"undefined"?wp_e2.config.topiccommentmaxlength:wp_e2_defaults.topiccommentmaxlength;if(wp_e2[thisContainer].webType=="ugc_photo_story")wp_e2[thisContainer].commentmaxlength=wp_e2_defaults.photocommentmaxlength;if(wp_e2[thisContainer].allow_comments==false){wp_e2.liveUpdates.desktop.polling.timeout=wp_e2.liveUpdatesTimeout.stream.closed;wp_e2.liveUpdates.mobile.polling.timeout=wp_e2.liveUpdatesTimeout.stream.closed}wp_e2[thisContainer].plugins={};var plugins={};plugins.streamPluginArray=[];plugins.submitboxPluginArray=
[];var thisElm=$("#"+thisContainer);if(thisElm.hasClass("stream")||thisElm.hasClass("echo-canvas")){if(wp_e2[thisContainer].allow_comments===true&&wp_e2[thisContainer].includereply===true);if(wp_e2[thisContainer].includereport===true)plugins.streamPluginArray=plugins.streamPluginArray.concat({"name":"CommunityFlag","thisContainer":thisContainer});if(wp_e2[thisContainer].webType=="ugc_photo_story")$.each(wp_e2.default_plugins.ugcstreamPluginArray,function(key,obj){plugins.streamPluginArray.push($.extend({},
obj))});else $.each(wp_e2.default_plugins.streamPluginArray,function(key,obj){plugins.streamPluginArray.push($.extend({},obj))})}if(wp_e2[thisContainer].webType=="ugc_photo_story")$.each(wp_e2.default_plugins.ugcsubmitboxPluginArray,function(key,obj){plugins.submitboxPluginArray.push($.extend({},obj))});else $.each(wp_e2.default_plugins.submitboxPluginArray,function(key,obj){plugins.submitboxPluginArray.push($.extend({},obj))});plugins.submitboxPluginArray=plugins.submitboxPluginArray.concat([{"name":"TextCounter",
"limit":wp_e2[thisContainer].commentmaxlength}]);if(wp_e2[thisContainer].includeverifiedcommenters==true)plugins.submitboxPluginArray=plugins.submitboxPluginArray.concat([{"name":"TWP_Submit_VerifiedCommenter"}]);wp_e2[thisContainer].plugins=$.extend({},plugins,wp_e2.plugins);$.each(wp_e2[thisContainer].plugins,function(key,pArray){$.each(pArray,function(key,obj){obj.thisContainer=thisContainer})});wp_e2[thisContainer]=$.extend(wp_e2[thisContainer],wp_e2.config)})};$(".echo_container").not(".processed").buildecho(wp_e2.config.options);
$.extend(wp_e2,wp_e2_core,wp_e2_defaults,wp_e2.config,wp_e2.extensions);wp_e2.initDataObject();wp_e2.streamSettings.apiBaseURL=wp_e2.apiBaseURL;var currEnvironment=typeof TWP==="undefined"||typeof TWP.Data==="undefined"||typeof TWP.Data.environment==="undefined"?"dev":TWP.Data.environment;var baseURL=typeof eidosBase!=="undefined"&&eidosBase!==""?eidosBase:"";$.each(wp_e2.environment[currEnvironment],function(key,value){wp_e2[key]=value});if(Echo&&Echo.Loader)Echo.Loader.config.cdnBaseURL=wp_e2.cdnBaseURL;
if(window.location.href.indexOf("echodebug\x3dtrue",0)>0)wp_e2.debug=true;if(typeof TWP_Debug=="undefined"||TWP_Debug=="")TWP_Debug={};if(!TWP_Debug.initialTime)TWP_Debug.initialTime=new Date;wp_e2.debug&&window.console&&console.log&&console.log("["+(new Date-TWP_Debug.initialTime)/1E3+"]"+"echo2/v2/core/twp_comments_echo2_config.js - Starting Identity Load")})(jQuery);